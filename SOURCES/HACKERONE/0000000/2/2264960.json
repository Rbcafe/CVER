{
  "id": 2264960,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjY0OTYw",
  "url": "https://hackerone.com/reports/2264960",
  "title": "Unrestricted Access to Celery Flower Instance",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2023-11-27T11:14:05.247Z",
  "submitted_at": "2023-11-27T11:14:05.531Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ashwarya",
    "url": "/ashwarya",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/w7djebsci4x6010phg50ojw24kod/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 12719,
    "url": "https://hackerone.com/exness",
    "handle": "exness",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/012/719/cbbefceced84ac5354697307cb78a19df85a633f_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/012/719/cbbefceced84ac5354697307cb78a19df85a633f_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "EXNESS",
      "twitter_handle": "",
      "website": "https://www.exness.com",
      "about": "We provide best trading conditions across multiple markets for clients all over the world."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-12-14T15:12:14.139Z",
  "bug_reporter_agreed_on_going_public_at": "2023-12-14T15:12:14.047Z",
  "team_member_agreed_on_going_public_at": "2023-12-14T15:10:50.957Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi Team,\n\nThe Celery Flower instance is running and publicly accessible via the PIM mobile route /pim/flower/*. The access to this service is presently unrestricted. \n\nI quickly took a glance at the API to ensure that access is unrestricted. From this quick look, it appears possible to shut down a worker instance, revoke or terminate tasks, and perform other actions. In addition to unrestricted access to tasks and workers, I observed ███ via `/api/tasks` endpoint. Most importantly, the endpoint `/api/task/async-apply/*` seems to apply a task asynchronously, and there seems to be a possibility to execute arbitrary code on the Celery worker through this endpoint. I believe it's unwise for me to go beyond this since the instance is running in the prod environment, so I'm sending this quick report to you. If some form of escalation is needed for impact assessment, please let me know.\n\n##Vulnerable Endpoint\n```\nhttps://api.excalls.mobi/pim/flower/\n```\n\n#Steps to Reproduce\n\n```\nhttps://api.excalls.mobi/pim/flower/api/workers\nhttps://api.excalls.mobi/pim/flower/api/tasks\nhttps://api.excalls.mobi/pim/flower/api/task/info/dc58fcb7-be31-4f4e-aeff-5837f0c32d30\n```\n\n\n\n#Proof of Concept\n█████\n\n████\n\n██████\n\n\n#Suggested Mitigation\n\nSet the `flower_unauthenticated_api` environment variable to `false`\n\n## Impact\n\nThe impact includes, but is not limited to:\n\n1. Manipulating tasks to achieve unintended outcomes, such as disrupting or halting PIM processes.\n2. ███\n3. A malicious actor could continuously monitor and revoke tasks as they are created, preventing their execution and consuming resources. This could exhaust the Celery worker's resources and hinder its ability to handle legitimate tasks.\n4. There seems to be a possibility to execute arbitrary code on the Celery worker by executing a task asynchronously.",
  "bounty_amount": "4337.0",
  "formatted_bounty": "$4,337",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 85,
  "voters": [
    "8910jq",
    "n1m0",
    "ganeshbagaria",
    "haxor31337",
    "m0chan",
    "zy9ard3",
    "justynot",
    "bug_vs_me",
    "akashsky",
    "reactors08",
    "and 75 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.8,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 440322,
    "asset_type": "URL",
    "asset_identifier": "api.excalls.mobi",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 384200,
      "category": "team",
      "content": "The publicly accessible Celery Flower instance allowed unrestricted access, exposing sensitive information, and the ability to manipulate tasks.",
      "user": {
        "id": 1609770,
        "username": "mickey01x",
        "name": "Mikhail Nabiullin",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://hackerone.com/mickey01",
        "location": "",
        "created_at": "2021-03-23T13:44:53.515Z",
        "url": "https://hackerone.com/mickey01x",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
