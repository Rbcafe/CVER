{
  "id": 2037902,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDM3OTAy",
  "url": "https://hackerone.com/reports/2037902",
  "title": "Authentication bypass on JetPack SSO manager - Allows to access the administration panel of wordpress without user interaction",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2023-06-25T19:28:52.939Z",
  "submitted_at": "2023-06-25T19:28:53.048Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "sodium_",
    "url": "/sodium_",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/dqpjcqmh37adksji41j2p8hyn2p3/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 111,
    "url": "https://hackerone.com/automattic",
    "handle": "automattic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Automattic",
      "twitter_handle": "",
      "website": "https://automattic.com",
      "about": "WordPress.com, Jetpack, Texts, Akismet, Gravatar, WooCommerce, Crowdsignal, Tumblr and more!"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-12-28T07:44:04.545Z",
  "bug_reporter_agreed_on_going_public_at": "2023-12-28T07:44:04.412Z",
  "team_member_agreed_on_going_public_at": "2023-12-25T10:57:34.630Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello team,\n\n## Summary:\nThe JetPack SSO manager is plugin that allows any user to log into their wordpress using the same log-in credentials you use for WordPress.com, then they’ll now be able to register for and sign in to self-hosted WordPress.org sites quickly, example :\n\nUser creates their wordpress instance at host.com, they install and enable  JetPack SSO\nThey later can login into their wordpress instance at host.com using wordpress.com, users are also can make other users register/login with the same company email (@host.com) and access the administration panel of the host\n\n\n## Description :\nThe user anyways when he tries to authenticate into his wordpress instance via wordpress.com he gotta have his email confirmed, otherwise it won't work, interstingly there is a way that bypasses the email confirmation when a user invites you to his account and you accept his invite your account will be confirmed, chaining those issues the following scenario can result for the authentication bypass of any wordpress  instance when these circumestances are met :\n\n* wordpress installed on host.com have jetpack installed and \"Match accounts using email addresses\" enabled (IDK if this is necessary anyways) \n* wordpress instance have a user with specific email, that email does not exist on wordpress.com\n\nYou can access this host.com wordpress panel via\n\n## Steps To Reproduce:\n**Setup**\n\n  1. Install Jetpack latest version, once installed go to plugins>Jetpack>settings>\"Match accounts using email addresses\">enable (I'm not sure if this is intended or not)\n  2. Add user into your wordpress (host.com) with their email (says something@company.com)\n\n\n* **As attacker (email confirmation bypass)** :\n  1. Create two accounts at Wordpress.com \n        A/. One with your personal email and confirm it \n        B/.  Second with the victim's existed user at host.com email (something@company.com)\n\n  2. At your confirmed wordpress.com account go to settings >users invite your second account (something@company.com)\n  3. At your second account go to notifications at the top right, see the invitation and accept it \n  4. See that your Wordpress.com account’s email has been verified (email confirmation bypass )\n\n* **access the wordpress admin panel**\n  1. Now at the same browser where the (something@company.com) Wordpress.com account \n  2. go to host.com wordpress panel \n  3. Click on sign in with wordpress.com\n  4. Forward \n  5. See yourself logged in as admin on host.com wordpress\n\n## Platform(s) Affected:\nJetPack latest version\n\n\n\n\n## Supporting Material/References:\nAs example I bypass ███████ \n\n██████\n\n## Impact\n\n* Bypass authentication of websites that runs wordpress with JetPack plugin without any user inteaction\n\n\nRegards,\n\nAdam",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 32,
  "voters": [
    "0xhuz",
    "8910jq",
    "muslimfrompk",
    "zy9ard3",
    "najeh_halawani",
    "ronak_9889",
    "exec_iq",
    "shubham_srt",
    "sodium_",
    "0xm1racle",
    "and 22 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 387276,
      "category": "team",
      "content": "The main issue in this report was that someone could invite an arbitrary email to a site, and then also verify that email address.\n\nIf someone was using that email on a Jetpack site, SSO and \"Match accounts using email addresses\" was enabled, the attacker could gain access to that site where account with that arbitrary email existed.",
      "user": {
        "id": 733677,
        "username": "ehtis",
        "name": "Ehtisham",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2019-09-05T15:13:14.638Z",
        "url": "https://hackerone.com/ehtis",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
