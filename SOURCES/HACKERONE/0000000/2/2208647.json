{
  "id": 2208647,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjA4NjQ3",
  "url": "https://hackerone.com/reports/2208647",
  "title": "CVE-2023-42780: Apache Airflow: Improper access control vulnerability in the \"List dag warnings\" feature",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2023-10-13T16:39:59.840Z",
  "submitted_at": "2023-10-13T16:40:00.001Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "balis0ng",
    "url": "/balis0ng",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/129/870/f7fae9533c89d599194353645d3b027d33ad8c77_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGD4AUG7%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143947Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDpFrYOsYB5%2FZnNgefzkV44NzOEteiLNr5fTaq13l6JbwIhAOtMLRNQibBBBQxVAxTqTJbMe1i9E5%2B1umZpNEn1KLyWKrIFCHcQAxoMMDEzNjE5Mjc0ODQ5IgyMBkX2hVh%2BhOexaD0qjwWIVul16aokM%2B%2Bk3syXpumdmzjMxBJZIlILTLHDJJHPrp2ZulcJH5q8hr9%2Bpzae%2FyLNUn3QxArdyG9%2Bs%2FxGCEp4uZNVh%2BRETskKt1TTkBBRYx15m1k85ya0qUhv5MdFnIOgnN%2BUWZz1KczjvI%2F9gU0cFH5qy0jkk0I0a6XKsrqTyUBwjrz3RWZzAEvvKYZjHVOrSfeF4C%2BLkz%2BCi%2B7CB11hXtvApsy6s5ePqH91wth7AZHeZAfYwp4Jnbh1p8KmbK30Q47o97dgiNK9E0ES5ZpULPKTxo%2FhRByGRQHuR396JknClT4rG1WurwWjsEx1iTWp3%2BIyTzoS79dILDtAL%2F4k6kS82%2BTv041OCmlhT2B%2Ft31QPcmKZ6jmLgkpliqLSmJDm90SuNY88u223KuIbsJpgJHAObccd017eHct%2FkVwHEB%2BWYeet8ZAMA08ytFzqBv2hcgKOkqLW5Es9oxAzTSbck%2BQRB6jSoC0NgXimudsmbneFbg7yF0Y4IBopwxKtxzDjFFgbqtU9cifZxLTARKETqFVYNINfaUl1vUUUvvkTDk0CNMbrAubZXn7s0fQcUJiBZyRPwXoLHa175h9cNhBU%2FOLVWTdnO4PBAbW3lSNaGkkw83zfmu4x1evle4xFNUDEFXt%2FCNtrb5Xuz1UPtXUEMIsbJZyfLVfMsZqnXu3XD%2BgaLXVFeOtUZvtS%2BIOszbnbTkQRmQ1C%2BxZYiTZYZZuq2Txxz0OVd%2FxefqHFQPV1seIRusOsVC4oy1XhH0CCINVqoCeaTiePOtTAuKY03KLGUc6WfkNBXO%2BiVaNwyTB8btNWytKGGVTY2wswL4EamHwyISg4jCGjpNEMarw6vV5fAIj9BUCtLwnocnN45LiMPXura4GOrABXhfw1V%2BVbu3djc3Jv5AaOf2JhHj80K2MUdzk1WSbySNmDeWK9ok%2FYyzcrq0MY0OW%2Bl8NMAkgeiT3MzBHvXRej72j35zM40rM4yOAw%2BPSNL4BdRz0Hdu5xBbq9Ne4xLyjRbZ4%2FFXajcCr8XcRm47GzUGEyrM2FhYCbhQkAe3yQa%2FttcE2P8mDMzi6ernjG0nfaKdYSIZw8giUSplPOv6L5R2e48BOSJBGCcNI6hcDZtM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3baaecdcecdf43ffcc15802058d1453a0011019ad438703c94f2276896a3c158",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGD4AUG7%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143947Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDpFrYOsYB5%2FZnNgefzkV44NzOEteiLNr5fTaq13l6JbwIhAOtMLRNQibBBBQxVAxTqTJbMe1i9E5%2B1umZpNEn1KLyWKrIFCHcQAxoMMDEzNjE5Mjc0ODQ5IgyMBkX2hVh%2BhOexaD0qjwWIVul16aokM%2B%2Bk3syXpumdmzjMxBJZIlILTLHDJJHPrp2ZulcJH5q8hr9%2Bpzae%2FyLNUn3QxArdyG9%2Bs%2FxGCEp4uZNVh%2BRETskKt1TTkBBRYx15m1k85ya0qUhv5MdFnIOgnN%2BUWZz1KczjvI%2F9gU0cFH5qy0jkk0I0a6XKsrqTyUBwjrz3RWZzAEvvKYZjHVOrSfeF4C%2BLkz%2BCi%2B7CB11hXtvApsy6s5ePqH91wth7AZHeZAfYwp4Jnbh1p8KmbK30Q47o97dgiNK9E0ES5ZpULPKTxo%2FhRByGRQHuR396JknClT4rG1WurwWjsEx1iTWp3%2BIyTzoS79dILDtAL%2F4k6kS82%2BTv041OCmlhT2B%2Ft31QPcmKZ6jmLgkpliqLSmJDm90SuNY88u223KuIbsJpgJHAObccd017eHct%2FkVwHEB%2BWYeet8ZAMA08ytFzqBv2hcgKOkqLW5Es9oxAzTSbck%2BQRB6jSoC0NgXimudsmbneFbg7yF0Y4IBopwxKtxzDjFFgbqtU9cifZxLTARKETqFVYNINfaUl1vUUUvvkTDk0CNMbrAubZXn7s0fQcUJiBZyRPwXoLHa175h9cNhBU%2FOLVWTdnO4PBAbW3lSNaGkkw83zfmu4x1evle4xFNUDEFXt%2FCNtrb5Xuz1UPtXUEMIsbJZyfLVfMsZqnXu3XD%2BgaLXVFeOtUZvtS%2BIOszbnbTkQRmQ1C%2BxZYiTZYZZuq2Txxz0OVd%2FxefqHFQPV1seIRusOsVC4oy1XhH0CCINVqoCeaTiePOtTAuKY03KLGUc6WfkNBXO%2BiVaNwyTB8btNWytKGGVTY2wswL4EamHwyISg4jCGjpNEMarw6vV5fAIj9BUCtLwnocnN45LiMPXura4GOrABXhfw1V%2BVbu3djc3Jv5AaOf2JhHj80K2MUdzk1WSbySNmDeWK9ok%2FYyzcrq0MY0OW%2Bl8NMAkgeiT3MzBHvXRej72j35zM40rM4yOAw%2BPSNL4BdRz0Hdu5xBbq9Ne4xLyjRbZ4%2FFXajcCr8XcRm47GzUGEyrM2FhYCbhQkAe3yQa%2FttcE2P8mDMzi6ernjG0nfaKdYSIZw8giUSplPOv6L5R2e48BOSJBGCcNI6hcDZtM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a6818a6b1798e8d494dff682bb06ecaae28ab5c8a7744df28dd00347dfe377d6"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2023-42780"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-11-29T20:12:41.794Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2023-10-30T20:12:24.169Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Apache Airflow, versions prior to 2.7.2, contains a security vulnerability that allows authenticated users of Airflow to list warnings for all DAGs, even if the user had no permission to see those DAGs. It would reveal the dag_ids and the stack-traces of import errors for those DAGs with import errors.\n\n# Steps to reproduce :\n1. Here I create a role with very little permission. It only has read permissions for the DAG \"example_setup_teardown_taskflow\" and read warning permissions.\n2. Assign the role to an account and log in.\n3. Use burpsuite to send the following message, and you can see the warnings of other DAGs. (replaced with the session of the account)\n```\nGET /api/v1/dagWarnings HTTP/1.1\nHost: testvul.com:8080\nAccept: application/json\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36\ncontent-type: application/json\nReferer: http://testvul.com:8080/dags/example_external_task_marker_parent/grid\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9,en;q=0.8\nCookie: session=6ba0ebcd-94b6-41e9-8143-2ada52d554b1.IGPZy1m5c8235p5r8qo4GhPl_YM\nConnection: close\nContent-Length: 0\n\n\n```\n{F2771429}\n\n**Security Advisory**: https://lists.apache.org/thread/h5tvsvov8j55wojt5sojdprs05oby34d\n**Severity**: Low\n**Credit**: balis0ng\n\n## Impact\n\nIt allows authenticated users of Airflow to list warnings for all DAGs, even if the user had no permission to see those DAGs. It would reveal the dag_ids and the stack-traces of import errors for those DAGs with import errors.",
  "bounty_amount": "540.0",
  "formatted_bounty": "$540",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 2771429,
      "file_name": "4.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3df6dwqge9syxl512beyjsfdx150?response-content-disposition=attachment%3B%20filename%3D%224.png%22%3B%20filename%2A%3DUTF-8%27%274.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSGD4AUG7%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143947Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDpFrYOsYB5%2FZnNgefzkV44NzOEteiLNr5fTaq13l6JbwIhAOtMLRNQibBBBQxVAxTqTJbMe1i9E5%2B1umZpNEn1KLyWKrIFCHcQAxoMMDEzNjE5Mjc0ODQ5IgyMBkX2hVh%2BhOexaD0qjwWIVul16aokM%2B%2Bk3syXpumdmzjMxBJZIlILTLHDJJHPrp2ZulcJH5q8hr9%2Bpzae%2FyLNUn3QxArdyG9%2Bs%2FxGCEp4uZNVh%2BRETskKt1TTkBBRYx15m1k85ya0qUhv5MdFnIOgnN%2BUWZz1KczjvI%2F9gU0cFH5qy0jkk0I0a6XKsrqTyUBwjrz3RWZzAEvvKYZjHVOrSfeF4C%2BLkz%2BCi%2B7CB11hXtvApsy6s5ePqH91wth7AZHeZAfYwp4Jnbh1p8KmbK30Q47o97dgiNK9E0ES5ZpULPKTxo%2FhRByGRQHuR396JknClT4rG1WurwWjsEx1iTWp3%2BIyTzoS79dILDtAL%2F4k6kS82%2BTv041OCmlhT2B%2Ft31QPcmKZ6jmLgkpliqLSmJDm90SuNY88u223KuIbsJpgJHAObccd017eHct%2FkVwHEB%2BWYeet8ZAMA08ytFzqBv2hcgKOkqLW5Es9oxAzTSbck%2BQRB6jSoC0NgXimudsmbneFbg7yF0Y4IBopwxKtxzDjFFgbqtU9cifZxLTARKETqFVYNINfaUl1vUUUvvkTDk0CNMbrAubZXn7s0fQcUJiBZyRPwXoLHa175h9cNhBU%2FOLVWTdnO4PBAbW3lSNaGkkw83zfmu4x1evle4xFNUDEFXt%2FCNtrb5Xuz1UPtXUEMIsbJZyfLVfMsZqnXu3XD%2BgaLXVFeOtUZvtS%2BIOszbnbTkQRmQ1C%2BxZYiTZYZZuq2Txxz0OVd%2FxefqHFQPV1seIRusOsVC4oy1XhH0CCINVqoCeaTiePOtTAuKY03KLGUc6WfkNBXO%2BiVaNwyTB8btNWytKGGVTY2wswL4EamHwyISg4jCGjpNEMarw6vV5fAIj9BUCtLwnocnN45LiMPXura4GOrABXhfw1V%2BVbu3djc3Jv5AaOf2JhHj80K2MUdzk1WSbySNmDeWK9ok%2FYyzcrq0MY0OW%2Bl8NMAkgeiT3MzBHvXRej72j35zM40rM4yOAw%2BPSNL4BdRz0Hdu5xBbq9Ne4xLyjRbZ4%2FFXajcCr8XcRm47GzUGEyrM2FhYCbhQkAe3yQa%2FttcE2P8mDMzi6ernjG0nfaKdYSIZw8giUSplPOv6L5R2e48BOSJBGCcNI6hcDZtM%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ee6a93e982e47bd410bfd62824b55aae8b817e737cdf3f9d8f55c43a30e4c200",
      "file_size": 169562,
      "type": "image/png",
      "moderated": false
    }
  ],
  "allow_singular_disclosure_at": "2023-11-29T20:12:24.360Z",
  "allow_singular_disclosure_after": -6546443.025456832,
  "singular_disclosure_allowed": true,
  "vote_count": 16,
  "voters": [
    "zy9ard3",
    "trinityisdead",
    "sajid626",
    "pomshi",
    "metassassin",
    "saurav121",
    "henners111",
    "findme34",
    "1_____________poc____________1",
    "machiavelliii",
    "and 6 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 86381,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/apache/airflow",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 367672,
      "category": "team",
      "content": "CVE-2023-42780: Apache Airflow: Improper access control vulnerability in the \"List dag warnings\" feature\nSeverity: low\n\nAffected versions:\n- Apache Airflow before 2.7.2\n\nDescription:\nApache Airflow, versions prior to 2.7.2, contains a security vulnerability that allows authenticated users of Airflow to list warnings for all DAGs, even if the user had no permission to see those DAGs. It would reveal the dag_ids and the stack-traces of import errors for those DAGs with import errors.\nUsers of Apache Airflow are advised to upgrade to version 2.7.2 or newer to mitigate the risk associated with this vulnerability.\n\nCredit:\nbalis0ng (finder)\nHussein Awala (remediation developer)\n\nFull Security Advisory: https://lists.apache.org/thread/h5tvsvov8j55wojt5sojdprs05oby34d\n",
      "user": {
        "id": 904892,
        "username": "kunderkoffler",
        "name": "Kayla Underkoffler",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2020-01-13T19:26:22.339Z",
        "url": "https://hackerone.com/kunderkoffler",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
