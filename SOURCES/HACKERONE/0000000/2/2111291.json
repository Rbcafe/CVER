{
  "id": 2111291,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTExMjkx",
  "url": "https://hackerone.com/reports/2111291",
  "title": "Stored Xss on bugzilla.mozilla.org via comment edit feature from non-admin to admin.",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2023-08-16T05:14:13.798Z",
  "submitted_at": "2023-08-16T05:14:13.951Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "r3dpars3c",
    "url": "/r3dpars3c",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/xddaplfpsmjmniuzl2iqtluaglm2/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 63475,
    "url": "https://hackerone.com/mozilla_critical_services",
    "handle": "mozilla_critical_services",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/aa8lqjkx88jd2epgey2sk75jq83b/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/aa8lqjkx88jd2epgey2sk75jq83b/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mozilla Critical Services",
      "twitter_handle": "",
      "website": "https://www.mozilla.org",
      "about": "Mozilla web bug bounty program specific to encouraging security research in Mozilla's critical backend services and tools used by the Firefox browser"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-09-20T10:16:33.329Z",
  "bug_reporter_agreed_on_going_public_at": "2023-09-20T10:16:33.239Z",
  "team_member_agreed_on_going_public_at": "2023-09-20T09:38:14.176Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi There !\nThere is Stored xss on comment feature.\nThe XSS executed when admin tries to edit the comment. The XSS fires.\nI tried to Bypass the CSP But was not able to.\n\nSteps To Reproduce.\n1. Create a report in bugzilla.mozilla.org as users.\n2.  Comment this xss payload as users ``</base</sTyle/</scRIpt/</textArea/</noScript/</tiTle/-->ï¼œh1/<h1><image/onerror=\"import('data:application/javascript;charset=utf-8;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKTtjb25zb2xlLmxvZyhkb2N1bWVudC5kb21haW4pOy8v')//%27\"src><script>``\n3. Now as admin, TRy to edit the comment, you will see xss popup with document.domain when csp disabled.\n\nI am working on to bypass the csp\nI have filed a bug report on bugzilla with my xss containing comment.\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1848911\nTry to edit and  check your browser console if csp is enabled. if csp isn't enabled, you will be able to see popup.\nI tested this on my local instance, and this worked.\n\nThanks\nBest Regards\nr3dpars3c\n\n## Impact\n\nClient side javascript execution.",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2023-10-20T09:38:14.284Z",
  "allow_singular_disclosure_after": -10040433.63250942,
  "singular_disclosure_allowed": true,
  "vote_count": 18,
  "voters": [
    "shreyaschavhan",
    "zy9ard3",
    "shubham_srt",
    "dilawer",
    "kerolesmagdy",
    "eminf",
    "horacy",
    "w4tch3rr",
    "29820948",
    "m333rl1n",
    "and 8 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 388480,
    "asset_type": "URL",
    "asset_identifier": "bugzilla.mozilla.org",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
