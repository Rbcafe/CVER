{
  "id": 2281075,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjgxMDc1",
  "url": "https://hackerone.com/reports/2281075",
  "title": "access list owner can escalate his role to the highest roles",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2023-12-11T18:28:32.289Z",
  "submitted_at": "2023-12-11T18:28:32.478Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "moaz219",
    "url": "/moaz219",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/rrll5z1gynac7cs01jb9nb7y3kh2/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 57187,
    "url": "https://hackerone.com/teleport",
    "handle": "teleport",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/vszqnqdi82j4450azhettty49bgj/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/vszqnqdi82j4450azhettty49bgj/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Teleport",
      "twitter_handle": "goteleport",
      "website": "https://goteleport.com",
      "about": "Teleport is an open-source tool for providing zero trust access to servers and cloud applications using SSH, Kubernetes, and HTTPS."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-12-29T21:08:31.495Z",
  "bug_reporter_agreed_on_going_public_at": "2023-12-29T21:08:31.314Z",
  "team_member_agreed_on_going_public_at": "2023-12-29T18:05:29.112Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\n1. Go to [your-domain.teleport.sh/web/accesslists].\n\n2. Create a new access list and add a role to \"Roles Granted,\" e.g., \"reviewer\" role.\n\n3. Add a user as the Access List Owner.\n\n4. The user, as the Access List Owner, can escalate the role of the list to higher roles, thereby escalating their own account's role.\n\nThis is a prohibited procedure, as stated [here](https://goteleport.com/docs/access-controls/access-lists/reference/#access-list-ownership), that Owners are not able to control what roles and traits are granted by the Access List.\n\n## Steps To Reproduce:\n\n### From Organization Owner Account:\n\n1. Go to [your-domain.teleport.sh/web/accesslists].\n\n2. Create a new access list.\n\n3. Add a user as List Owner.\n\n4. Add a role to \"Roles Granted,\" e.g., \"reviewer\" role.\n\n### From Access List Owner Account:\n\n1. Add a new member to the access list and intercept the request.\n\n2. Add \"editor\" role on \"grants roles.\"\n\n3. The \"editor\" role will be added to \"Permissions Granted.\"\n\n4. Logout and relogin.\n\n5. Now, the user has the \"editor\" role and can perform any action on the organization.\n\n## Impact\n\n- Unauthorized Access: Potential for unauthorized access to sensitive information.\n- Security Breach: Risk of compromising the overall security of the system.\n- Privilege Escalation: Violation of the principle of least privilege.\n- Violation of Access Control Policies: Contradiction with Teleport's documentation and policies.\n- Risk of Insider Threats: Potential exploitation by malicious insiders.",
  "bounty_amount": "21000.0",
  "formatted_bounty": "$21,000",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 2916110,
      "file_name": "PE_POC.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/m1g64zs3uv6onpmz955v2cwg389k?response-content-disposition=attachment%3B%20filename%3D%22PE_POC.mp4%22%3B%20filename%2A%3DUTF-8%27%27PE_POC.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXI6L5U2T%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T144100Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCyun7sOetTGndQ%2B2OZpSMCZYm3XfrwOOXjo8KeObbT1AIgD4OLEHGezUrjMZ%2FBSmHxYX5vX%2FbtpckOVq9NXgNsWtwqsQUIdxADGgwwMTM2MTkyNzQ4NDkiDNNgB8sVBJy0zRxycyqOBU6qYFPm4SyFbkI3oHxOHOmqcEHc1D%2ByFYxwhKv4JO5iDxKPT4tHrvDqD5%2FIeinv214I1SwDMYYwnzNKWbx3LiUqK3S7O6mA%2F%2FVRlmAX5cye5B4eFOVyxgZkem8yQedECsdMi2DQd704xqbHrBMjxn0aY64tlt9Tkts47cVVLjQLbPAsQVd29BnvZRnUYNt963sgm5ezro7mZOY7QzLnaQ3A%2FRUrDYD4BKo1vyOpGbgprd62e1JnLMzNPIZCOb8PqBe1IHlnGyum74n7lUzpcHbtb1vP%2BFAfiQU7KjUXJKmp%2BA23vWex7F69IYH%2BL1wSVqkcjEPmLfRH4sE3rhlHrsriMbbRita%2FEqeEKZELzm3EiP3pyZChUOCekoKd%2FEmIfJ7QRdMw2m5JRgcGW4HpGA4bntaATIDNu8TqGjWGUF63wj6BJFvJYp8T6Jn6I7eVE7oYkxELkIzqaeCeuKa2u9ZqL57XynQQczY8FYtAUib3Ks1%2B2MSANcSpmZMaCadj83slTH%2F%2Bzq3kCV2WG1LcX8Hjj0OfQn88T3wWX%2Fe6wIYucH6i84pElLxU5EkecNluYrwi4l8hfEIwHobXdIXwWRpV6kmvadn8fLPaBKpC8kW6DwXLRptswsTK9PbMZRrJdzjPDX4VHu3NE%2ByhvrK%2Fw6GY7bOzpgTl%2FFVayCNJTT5JRC4X3w7o%2BuX2OtE7iDRXGt8woSR%2Bd9KNqMOqRwriO%2BYvu64lkUmRCPylXJAQuxw3l49ZnShcfHeie1Cy%2FaTm8Hy8EarualJRyU%2BCI2MM6lSI2bugAbf02SvfOo9rDjzPouZzW6cVHivRvPV9KKnXf8ugO4DUQe27r3ivddhZm1T%2FtZncliEvPX%2FhD8hK2zDJ662uBjqxAe00ljVWnMj3BSW%2BvlOoi1D6kt8mxxopSo5%2BDow8AIZJnhzQDnfKwkuzDIuZKuI5ECCKJHjZv7mg5T8PcKkO3434ewqdvOOqhL6huO8rauD33Cq7zdlVx%2BU89TCavU4CDfRc3v5hQygJBY%2FxXKJoWmIY4xiJTLuDmwouygTe6Yoq7HqvEBYtUspEda5bD6BIw4assvrc9zgqIjnyMahlw%2BMAOdLDB4rxnIK23gvF51BxxQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f27c9aed4486a4e23b12ab8b9c2746f2d4c24eba13644d06b33661a6f9fdfa1e",
      "file_size": 20571502,
      "type": "video/mp4",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 238,
  "voters": [
    "mr-medi",
    "cxzer0",
    "xchessy",
    "8910jq",
    "shreyaschavhan",
    "0ranos",
    "ra5h",
    "ahmed0x59",
    "urinaori",
    "muslimfrompk",
    "and 228 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "low",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 159098,
    "asset_type": "URL",
    "asset_identifier": "h1-your-domain.teleport.sh",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
