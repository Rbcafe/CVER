{
  "id": 1694171,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjk0MTcx",
  "url": "https://hackerone.com/reports/1694171",
  "title": "Multiple cross-site scripting (XSS) vulnerabilities in Revive Adserver",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2022-09-07T21:32:37.758Z",
  "submitted_at": "2022-09-07T21:32:37.816Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "l4stb1t",
    "url": "/l4stb1t",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/8beuu38v8q2fbuj1s4d0plxm4edj/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 2367,
    "url": "https://hackerone.com/revive_adserver",
    "handle": "revive_adserver",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Revive Adserver",
      "twitter_handle": "revive_adserver",
      "website": "https://www.revive-adserver.com",
      "about": "Revive Adserver is a free open source ad serving system"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [
    "CVE-2023-38040"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-09-13T12:17:54.033Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2023-09-13T12:16:04.009Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2023-10-13T12:16:04.105Z",
  "allow_singular_disclosure_after": -10635241.441496084,
  "singular_disclosure_allowed": true,
  "vote_count": 5,
  "voters": [
    "shreyaschavhan",
    "zy9ard3",
    "shubham_srt",
    "eminf",
    "mohamednaeem"
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 154,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/revive-adserver/revive-adserver",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 344385,
      "category": "team",
      "content": "From @l4stb1t orginal report:\n\nThere are multiple XSS vulnerabilities on the default layerstyles provided by the adserver.\n\nFor the \"simple\" layer style (source code at \"plugins_repo/openXInvocationTags/plugins/invocationTags/oxInvocationTags/layerstyles/simple/layerstyle.inc.php\"):\n - CSS code injection on the \"padding\" parameter\n - CSS code injection on the \"bordercolor\" parameter\n - JavaScript code injection on the \"shifth\" parameter when the \"align\" parameter is set to \"center\"\n - JavaScript code injection on the \"shiftv\" parameter when the \"valign\" parameter is set to \"middle\"\n\nFor the \"geocities\" layer style (source code at plugins_repo/openXInvocationTags/plugins/invocationTags/oxInvocationTags/layerstyles/geocities/layerstyle.inc.php\"):\n - CSS code injection on the \"padding\" parameter\n - HTML code injection on the \"closetext\" parameter\n\nFor the \"floater\" layer style (source code at plugins_repo/openXInvocationTags/plugins/invocationTags/oxInvocationTags/layerstyles/floater/layerstyle.inc.php\"):\n - JavaScript code injection on the \"rmargin\" parameter\n - JavaScript code injection on the \"lmargin\" parameter\n - CSS code injection on the \"shiftv\" parameter\n - JavaScript code injection on the \"loop\" parameter\n\nFor the \"cursor\" layer style (source code at plugins_repo/openXInvocationTags/plugins/invocationTags/oxInvocationTags/layerstyles/cursor/layerstyle.inc.php\"):\n - JavaScript code injection on the \"stickyness\" parameter when the \"trail\" parameter is set to \"1\"\n - JavaScript code injection on the \"offsetx\" parameter when the \"trail\" parameter is set to \"1\"\n - JavaScript code injection on the \"offsety\" parameter when the \"trail\" parameter is set to \"1\"\n - JavaScript code injection on the \"transparancy\"\n - JavaScript code injection on the \"delay\" parameter when the \"hide\" parameter is set to \"1\"\n\nThe vulnerabilities may also affect other layerstyles copied from the ones listed above.\nThrough the CSS code injection an attacker may create request to external resources by suppling \"0;background:url(<link here>);\", while through the HTML and JavaScript code injection the attacker may run JavaScript code on the host website. \n\nExample exploitation:\nAssuming that the adserver runs under ads.example.com, and the zoneid 1 is a valid id of an active campaign, an attacker may conduct the following request from the server:\nhttps://ads.example.com/www/delivery/al.php?zoneid=1&layerstyle=geocities&closetext=%3Cscript%3Ealert(123);%3C/script%3E\nand the server will return JavaScript code with the attacker's payload as delivered by the closetext parameter.\n\n## Impact\n\nSince the endpoints return JavaScript code, benefit from the exploitation of the vulnerability the attacker has to chain it along with a specific behavior on the host site (the site showing the ads) allowing him to alter the parameters passed to the adserver. For example, if the host site forwards a client identifier from its parameters to the parameters of the adserver (e.g. passing a kid=XYZ), an attacker may use this to smuggle extra parameters to the adserver and eventually run JavaScript code or make external requests.\n\nThis method could also be used by an attacker to bypass Cross-Origin Resource Sharing (CORS) rules assuming that the adserver is whitelisted.\n\nThus, the impact of this vulnerability is relatively small.",
      "user": {
        "id": 33877,
        "username": "mbeccati",
        "name": "Matteo Beccati",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "http://beccati.com/",
        "location": "Ferrara, Italy",
        "created_at": "2015-06-15T06:34:18.488Z",
        "url": "https://hackerone.com/mbeccati",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
