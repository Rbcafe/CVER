{
  "id": 1067809,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDY3ODA5",
  "url": "https://hackerone.com/reports/1067809",
  "title": "Cookie poisoning leads to DOS and Privacy Violation",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2020-12-28T21:56:02.827Z",
  "submitted_at": "2020-12-28T21:56:02.912Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "benjamin-mauss",
    "url": "/benjamin-mauss",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/1eq5yyac9912hdghuvjuk35l72o0/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 48311,
    "url": "https://hackerone.com/cs_money",
    "handle": "cs_money",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/6zBhWTJ4KuDdcSg86WvWXrFV/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "CS Money",
      "twitter_handle": "csmoneytrade",
      "website": "https://cs.money",
      "about": "CS:GO trading platform that helps people to trade, buy, sell and search for the best skins and deals they could possibly find."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-02-25T09:44:37.897Z",
  "bug_reporter_agreed_on_going_public_at": "2021-02-08T14:38:46.654Z",
  "team_member_agreed_on_going_public_at": "2021-02-25T09:44:37.809Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "bounty_amount": "700.0",
  "formatted_bounty": "$700",
  "weakness": {
    "id": 46,
    "name": "Privacy Violation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 30,
  "voters": [
    "m4t35z",
    "dazaiii",
    "benjamin-mauss",
    "run_win",
    "amr_",
    "ali",
    "0xelkomy",
    "romesful",
    "ayoub0x1",
    "akashhamal0x01",
    "and 20 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 45903,
    "asset_type": "URL",
    "asset_identifier": "support.cs.money",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 26872,
      "category": "team",
      "content": "Summary, submitted by `gatolouco` requires no additions by us and fully expresses impact and reasons behind the vulnerability.",
      "user": {
        "id": 945013,
        "username": "triage_team",
        "name": "",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2020-02-13T10:06:48.448Z",
        "url": "https://hackerone.com/triage_team",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/8YgxVBkgWzPrnmtFYUro9KKb/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "id": 26237,
      "category": "researcher",
      "content": "# Summary\nBy change the value of the cookie avatar, a hacker could not only get information of the support agent IP address, but also disconnect all the supports without interaction.\n\n## Vulnerability\n\nThe cookie avatar should have the value of a link to the user's steam avatar.\nA normal cookie is like that: `https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/ae/ae6680902f4fe18e692ba9ea250bd694b34ad417_medium.jpg`\n\nBut in the server, there is a verification like that (pseudocode):\n````\nbool valid_url = false;\nif(cookies[\"avatar\"].contains(\"https://steamcdn-a.akamaihd.net/steamcommunity/\")){\n    valid_url = true;\n}else{\n    valid_url = false;\n}\n```\nNow start a chat with a support by sending a message.\n\nOk, so what if we insert the url, but after the hacker server?\n\n### Privacy Violation (IP Address exposed)\n`[hacker_server]/?https://steamcdn-a.akamaihd.net/steamcommunity/`\nThe server accept it and, when the support receive a message from the hacker, the support browser will try to load the url of the hacker's avatar and send a request to the hacker server. Now the hacker got his IP address.\n\n### DOS (Forced log out)\n`https://cs.money/logout?https://steamcdn-a.akamaihd.net/steamcommunity/`\nnow think. What if instead of the hacker server, we insert the URL of the logout in cs.money?\nBingo!\nThe support browser will make a request to the logout URL and it will disconnect him.\n\n### Ending\n\nOne thing that I noticed is that not only the current support agent that we are talking, but all the online supports will try to load my avatar cookie.\n\nOk, now think in the first vulnerability, that is the `Privacy Violation`. The impact is that a hacker could get privacy information of the support and use this for phishing.\n\nWhat about the second one? I think I don't even need to say the impact, but anyway: \nThe impact is that a hacker could set the support function of the website offline: without supports agents there is no support :)\nHow much days would take to the devs know that this is a security problem, find it and fix it?\n\nI am glad I can help.\n#### If would like to contact me, don't hesitate to send a message to GatoLouco#3684 (message, not friend request XD)\n",
      "user": {
        "id": 901426,
        "username": "benjamin-mauss",
        "name": "Benjamin Mauss",
        "bio": "CEO at Dorak",
        "cleared": false,
        "verified": false,
        "website": "https://dorak.com.br/",
        "location": "RS, Brazil",
        "created_at": "2020-01-10T19:25:02.972Z",
        "url": "https://hackerone.com/benjamin-mauss",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/1eq5yyac9912hdghuvjuk35l72o0/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/1eq5yyac9912hdghuvjuk35l72o0/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/1eq5yyac9912hdghuvjuk35l72o0/d7b0d969b6320751e1c58b9e3efff1e228054ee3d8eade5c51c4c79b25513a9c"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
