{
  "id": 1861487,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODYxNDg3",
  "url": "https://hackerone.com/reports/1861487",
  "title": "inDriver Job - Admin Approval Bypass",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-02-03T16:35:23.279Z",
  "submitted_at": "2023-02-03T16:40:15.028Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mikejohnson_1",
    "url": "/mikejohnson_1",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/8zbr17i6z9e3ljt653m1vjyhdwg9/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 58857,
    "url": "https://hackerone.com/indrive",
    "handle": "indrive",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/765s9sszvp9zyt9qwkeaa52vvkf3/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/765s9sszvp9zyt9qwkeaa52vvkf3/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "inDrive",
      "twitter_handle": "indrive",
      "website": "https://indrive.com/",
      "about": "inDrive is a global mobility and urban services platform with over 150 million downloads  in more than 700 cities across 47 countries."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-07-05T09:43:12.826Z",
  "bug_reporter_agreed_on_going_public_at": "2023-07-05T09:43:12.756Z",
  "team_member_agreed_on_going_public_at": "2023-06-28T09:10:00.003Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nA vulnerability has been found in \"inDriver Job\", an application located at https://injob.indriver.com/, a platform that allows employers to **publish job offers** and candidates to sign up for them. It seems like the application has **heavy use**, with a plethora of job offers in many categories.\n\nIn the app, anyone can request to **create job offers**, but, to prevent spam, scamming and phishing, every job offer creation and edit **has to be approved by a site admin** before being published. This is essential, since it prevents the app from getting **flooded with scammers**.\n\nThe vulnerability discovered allows an attacker to **completely bypass** this approval step, allowing the publishing of arbitrary content.\n\n## Technical Details:\nOn the last step of the job offer creation, the application makes a final `POST` request to `/api/graphql`, calling for `UpdateVacancyStatus`.\n\n```\n{\"operationName\":\"UpdateVacancyStatus\",\"variables\":{\"vacancyId\":\"█████\",\"status\":\"MODERATION\"}\n...\n```\nRe-sending this request, but modifying the **\"status\" variable to \"ACTIVE\"**, bypasses the need for a moderator approval, **publishing the ad**.\n\n## Video POC\n██████████\n\n## Steps To Reproduce:\n*Note for Triager: A phone number is required for signup. To skip this step, I've attached my session cookies. Using these, you could reproduce the steps noted below.*\n\n(Please see video for in-depth demo)\n  1. In employer mode, create a new job offer\n  2. Fill in the required fields\n  3. After the creation, the offer will appear as \"Pending Approval\"\n  4. In Burp Proxy, send the last \"UpdateVacancyStatus\" request to Repeater, modifying \"status\":\"ACTIVE\"\n  5. The arbitrary ad will now show up as \"Active\", it will have been verified and published. All users will be able to see it.\n\n## Impact\n\nAn attacker can use this vulnerability to upload arbitrary content, for **scamming**, **malware** or even **advertising** purposes.\nIt is also possible to **flood the platform** with infinite offers, making it unusable for legitimate users.",
  "bounty_amount": "1000.0",
  "formatted_bounty": "$1,000",
  "weakness": {
    "id": 128,
    "name": "Incorrect Authorization"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 136,
  "voters": [
    "shreyaschavhan",
    "pavan_k",
    "0xsp1der",
    "kristoferent",
    "mikejohnson_1",
    "n1m0",
    "ganeshbagaria",
    "zy9ard3",
    "fanimalikhack",
    "bitsscrambler",
    "and 126 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 360537,
    "asset_type": "URL",
    "asset_identifier": "injob.indriver.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 312629,
      "category": "team",
      "content": "The authorization malfunctioning vulnerability was found allowing an attacker to completely bypass the moderator's approval step within the vacancy or CV publishing process, giving the attacker the ability to publish any content even that one contradicting the Terms of Use or general morals.",
      "user": {
        "id": 2435873,
        "username": "majesttic",
        "name": "Kirill Egorov",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2022-08-16T07:58:13.212Z",
        "url": "https://hackerone.com/majesttic",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
