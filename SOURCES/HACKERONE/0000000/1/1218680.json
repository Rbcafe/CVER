{
  "id": 1218680,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjE4Njgw",
  "url": "https://hackerone.com/reports/1218680",
  "title": "Improper authorization on `/api/as/v1/credentials/` for  Dev Role User with Limited Engine Access",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2021-06-06T19:56:04.176Z",
  "submitted_at": "2021-06-06T19:56:04.315Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "superman85",
    "url": "/superman85",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/bn2ryz67b6bagah1b0ac9l3hxp3b/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23607,
    "url": "https://hackerone.com/elastic",
    "handle": "elastic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/607/c5cce6a2e2d95af85e014db95c2d7560e73e9bec_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/607/c5cce6a2e2d95af85e014db95c2d7560e73e9bec_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Elastic",
      "twitter_handle": "elastic",
      "website": "https://www.elastic.co/",
      "about": "Search, solve, and succeed with one platform, three search-powered solutions, built on a single technology stack"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": true,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-08-03T17:12:41.321Z",
  "bug_reporter_agreed_on_going_public_at": "2021-08-03T15:05:20.241Z",
  "team_member_agreed_on_going_public_at": "2021-08-03T17:12:41.112Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\nDear Team,\n\nSince  #1168528 was resolved. I have checking again for other roles. At Dev Role with Limited Engine Access, an user still can access API endpoint \n`/api/as/v1/credentials/` to get all API keys (private-key, search-key ... )\n\n## Steps To Reproduce:\n\n1 - Log in Kibana with the admin (elastic) user and go to the Stack Management > Users page (/app/management/security/users/)\n2 - Choose an username , password and role for this user. For example you can choose username: **dev**\n3 - Log in App Search with the admin (elastic) user and go to the Users & roles page (/as#/role-mappings/)\n4 - Click Add mapping\n5 - External Attribute choose **username** , in the Attribute value field enter **dev**\n6 - In the Role box select Dev\n7 - In Engine Access select Limited Engine Access, no need to select any engine\n8 - Login to App Search with user **dev**\n9 - Go to endpoint https://your_app_search_instance/api/as/v1/credentials/\n10 - You still can get all api keys \n\nI have attached video PoC\n█████████\n\n## Impact\n\nPrivilege escalation. The default App Search install has a Private API Key with read/write access to all engines. If a Private Admin Key has been created before. the attacker can use it to create new API keys or delete existing ones.\n\nWith Limited Engine Acess, an user should create and managed their own api keys",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-09-02T15:05:20.363Z",
  "allow_singular_disclosure_after": -77238456.86678778,
  "singular_disclosure_allowed": true,
  "vote_count": 13,
  "voters": [
    "haxor31337",
    "drsniper",
    "run_win",
    "akashhamal0x01",
    "merlin_sec01",
    "anuj_manav",
    "official_blackhat13",
    "2001806",
    "thisisan",
    "hokkonana",
    "and 3 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 4424,
    "asset_type": "URL",
    "asset_identifier": "cloud.elastic.co",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
