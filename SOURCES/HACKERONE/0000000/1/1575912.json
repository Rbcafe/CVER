{
  "id": 1575912,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTc1OTEy",
  "url": "https://hackerone.com/reports/1575912",
  "title": "HTTP request smuggling with Origin Rules using newlines in the host_header action parameter",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2022-05-19T17:12:55.201Z",
  "submitted_at": "2022-05-19T17:12:55.374Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "albertspedersen",
    "url": "/albertspedersen",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/57i177382uzbptw7rg8wpc509mll/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 41,
    "url": "https://hackerone.com/cloudflare",
    "handle": "cloudflare",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/041/a819f0d518a4854df667be26210167805f38a6a4_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Cloudflare Public Bug Bounty",
      "twitter_handle": "cloudflare",
      "website": "https://www.cloudflare.com/disclosure",
      "about": "Help us build a better Internet"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-06-27T16:32:12.123Z",
  "bug_reporter_agreed_on_going_public_at": "2022-05-25T19:08:24.343Z",
  "team_member_agreed_on_going_public_at": "2022-06-27T16:32:11.989Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "bounty_amount": "3100.0",
  "formatted_bounty": "$3,100",
  "weakness": {
    "id": 86,
    "name": "HTTP Request Smuggling"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 44,
  "voters": [
    "n1m0",
    "drsniper",
    "proper-lay",
    "zy9ard3",
    "thruster",
    "yassinek3ch",
    "polem4rch",
    "sudi",
    "kmxx",
    "ankitsingh",
    "and 34 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 163483,
      "category": "team",
      "content": "The `host_header` action parameter available to rulesets in the [Origin Rules API](https://developers.cloudflare.com/rules/origin-rules/) lacked sufficient input validation i.e., allowing CRLF characters. Because of this, it was possible to inject arbitrary headers and, as a consequence, smuggle HTTP requests. This vulnerability enabled bypassing security products such as Cloudflare Access and viewing the content of internal origin servers.\nThe issue was fixed by Cloudflare engineers and an Internal investigation proved that no Cloudflare customers were affected by exploitation of this vulnerability.\nAs a recommendation, we advise Cloudflare Access customers  to always verify the [Authorization JWT token](https://developers.cloudflare.com/cloudflare-one/identity/users/validating-json#programmatic-verification) before processing requests from the Cloudflare edge which prevents similar attempts. ",
      "user": {
        "id": 1982826,
        "username": "m0nia",
        "name": "Monika S",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2021-09-24T07:21:49.521Z",
        "url": "https://hackerone.com/m0nia",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
