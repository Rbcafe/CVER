{
  "id": 1913733,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTEzNzMz",
  "url": "https://hackerone.com/reports/1913733",
  "title": "CVE-2023-28319: UAF in SSH sha256 fingerprint check",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-03-21T12:05:28.374Z",
  "submitted_at": "2023-03-21T12:05:28.463Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "wct",
    "url": "/wct",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool for doing internet transfers"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2023-28319"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-05-24T08:25:54.715Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2023-05-17T09:51:32.491Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nThe fingerprint_b64 pointer is as parameter for failure logging after it is freed.\n\n## Steps To Reproduce:\n1. git clone https://github.com/curl/curl\n2. vim curl/lib/vssh/libssh2.c\n3. search for the string 'free(fingerprint_b64)' and note that fingerprint_b64 is used as parameter immediately after it is freed.\n\n## Supporting Material/References:\nThe following are the details of the code.\n\ngit commit a51f90ec0f74176776f5d14b99689f9241660eaa (HEAD -> master, origin/master, origin/HEAD)\n\nIn curl/lib/vssh/libssh2.c\n 653 static CURLcode ssh_check_fingerprint(struct Curl_easy *data)\n 654 {\n ...\n 667     char *fingerprint_b64 = NULL;\n ...\n 729     if((pub_pos != b64_pos) ||\n 730        strncmp(fingerprint_b64, pubkey_sha256, pub_pos)) {\n 731       free(fingerprint_b64);\n 732 \n 733       failf(data,\n 734             \"Denied establishing ssh session: mismatch sha256 fingerprint. \"\n 735             \"Remote %s is not equal to %s\", fingerprint_b64, pubkey_sha256);\n\nAccording to git blame, the following commits were involved:\n\nd1e7d9197b lib/vssh/libssh2.c (Mats Lindestam          2021-09-26 23:20:53 +0200  731)       free(fingerprint_b64);\nd1e7d9197b lib/vssh/libssh2.c (Mats Lindestam          2021-09-26 23:20:53 +0200  732) \nd1e7d9197b lib/vssh/libssh2.c (Mats Lindestam          2021-09-26 23:20:53 +0200  733)       failf(data,\nff2f3e8367 lib/vssh/libssh2.c (Daniel Stenberg         2022-04-25 11:41:20 +0200  734)             \"Denied establishing ssh session: mismatch sha256 fingerprint. \"\nff2f3e8367 lib/vssh/libssh2.c (Daniel Stenberg         2022-04-25 11:41:20 +0200  735)             \"Remote %s is not equal to %s\", fingerprint_b64, pubkey_sha256);\n\n## Impact\n\nDepends on which memory is the pointer fingerprint_b64 pointing to at the time failf() is called, it may either crash the application or it may print out whatever was in memory at the time leading to information leak in the fail log.",
  "weakness": {
    "id": 50,
    "name": "Use After Free"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2023-06-16T09:51:32.587Z",
  "allow_singular_disclosure_after": -20925834.43637012,
  "singular_disclosure_allowed": true,
  "vote_count": 20,
  "voters": [
    "maskopatol",
    "zy9ard3",
    "pacmanx",
    "shivammusic",
    "casterradev",
    "sho_von",
    "dllall",
    "thecoder3",
    "anthonyeagle1776",
    "theheadhunter2492",
    "and 10 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
