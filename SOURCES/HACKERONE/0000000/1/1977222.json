{
  "id": 1977222,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTc3MjIy",
  "url": "https://hackerone.com/reports/1977222",
  "title": "Open redirect on \"Unsupported browser\" warning",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-05-08T15:24:16.203Z",
  "submitted_at": "2023-05-08T15:24:16.321Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "akshayravic09yc47",
    "url": "/akshayravic09yc47",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fEvfEu8B4fPJiQbHKY5BSsrw/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2023-35171"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-06-22T06:54:21.862Z",
  "bug_reporter_agreed_on_going_public_at": "2023-06-22T06:54:21.728Z",
  "team_member_agreed_on_going_public_at": "2023-06-22T06:16:04.841Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello team,\nThe below mentioned source code is using a unsanitized URL redirection mechanism which will cause open redirection vulnerability\n\n```\n\t\t\tconst urlParams = new URLSearchParams(window.location.search)\n\t\t\tif (urlParams.has('redirect_url')) {\n\t\t\t\tconst redirectPath = Buffer.from(urlParams.get('redirect_url'), 'base64').toString() || '/'\n\t\t\t\twindow.location = redirectPath\n\t\t\t\treturn\n\t\t\t}\n```\nThe `UnsupportedBrowser.vue` component used to display a message to users of unsupported browsers. If the user's browser is unsupported, it will display a message with an icon and a button to continue browsing with the unsupported browser.The script checks if there is a query parameter called `redirect_url` in the query string. If the parameter is present, it decodes the value of the parameter from base64 and then redirects the user to the decoded URL and it does not validate the decoded URL or check whether it is a trusted URL before redirecting the user. This makes it possible for an attacker to construct a malicious URL that includes the `redirect_url` parameter and a URL of their choice. When a user clicks on the link, the script will decode the value of the `redirect_url` parameter and redirect the user to the attacker's URL\n\n#Vulnerable Source Permalink:\nhttps://github.com/nextcloud/server/blob/master/core/src/views/UnsupportedBrowser.vue#L140-#L146\n\n#Mitigation:\n- Use any functions that check if the input of the `redirect_url` parameter and ensure that it is a trusted URL before redirecting the user.\n- Add a Link warning popup like hackerone do, proceed redirection only when user accept the conditions, example like this:\n\n{F2340720}\n\n## Impact\n\nIf the app does not validate untrusted user input, an attacker could supply a URL that redirects an unsuspecting victim from a legitimate domain to an attacker's site.",
  "bounty_amount": "150.0",
  "formatted_bounty": "$150",
  "weakness": {
    "id": 53,
    "name": "Open Redirect"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 2340720,
      "file_name": "Screenshot_2023-05-08_at_8.48.54_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/osbefdd0wqs6xwfvplubcf18txwl?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2023-05-08_at_8.48.54_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2023-05-08_at_8.48.54_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXI6L5U2T%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143636Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCyun7sOetTGndQ%2B2OZpSMCZYm3XfrwOOXjo8KeObbT1AIgD4OLEHGezUrjMZ%2FBSmHxYX5vX%2FbtpckOVq9NXgNsWtwqsQUIdxADGgwwMTM2MTkyNzQ4NDkiDNNgB8sVBJy0zRxycyqOBU6qYFPm4SyFbkI3oHxOHOmqcEHc1D%2ByFYxwhKv4JO5iDxKPT4tHrvDqD5%2FIeinv214I1SwDMYYwnzNKWbx3LiUqK3S7O6mA%2F%2FVRlmAX5cye5B4eFOVyxgZkem8yQedECsdMi2DQd704xqbHrBMjxn0aY64tlt9Tkts47cVVLjQLbPAsQVd29BnvZRnUYNt963sgm5ezro7mZOY7QzLnaQ3A%2FRUrDYD4BKo1vyOpGbgprd62e1JnLMzNPIZCOb8PqBe1IHlnGyum74n7lUzpcHbtb1vP%2BFAfiQU7KjUXJKmp%2BA23vWex7F69IYH%2BL1wSVqkcjEPmLfRH4sE3rhlHrsriMbbRita%2FEqeEKZELzm3EiP3pyZChUOCekoKd%2FEmIfJ7QRdMw2m5JRgcGW4HpGA4bntaATIDNu8TqGjWGUF63wj6BJFvJYp8T6Jn6I7eVE7oYkxELkIzqaeCeuKa2u9ZqL57XynQQczY8FYtAUib3Ks1%2B2MSANcSpmZMaCadj83slTH%2F%2Bzq3kCV2WG1LcX8Hjj0OfQn88T3wWX%2Fe6wIYucH6i84pElLxU5EkecNluYrwi4l8hfEIwHobXdIXwWRpV6kmvadn8fLPaBKpC8kW6DwXLRptswsTK9PbMZRrJdzjPDX4VHu3NE%2ByhvrK%2Fw6GY7bOzpgTl%2FFVayCNJTT5JRC4X3w7o%2BuX2OtE7iDRXGt8woSR%2Bd9KNqMOqRwriO%2BYvu64lkUmRCPylXJAQuxw3l49ZnShcfHeie1Cy%2FaTm8Hy8EarualJRyU%2BCI2MM6lSI2bugAbf02SvfOo9rDjzPouZzW6cVHivRvPV9KKnXf8ugO4DUQe27r3ivddhZm1T%2FtZncliEvPX%2FhD8hK2zDJ662uBjqxAe00ljVWnMj3BSW%2BvlOoi1D6kt8mxxopSo5%2BDow8AIZJnhzQDnfKwkuzDIuZKuI5ECCKJHjZv7mg5T8PcKkO3434ewqdvOOqhL6huO8rauD33Cq7zdlVx%2BU89TCavU4CDfRc3v5hQygJBY%2FxXKJoWmIY4xiJTLuDmwouygTe6Yoq7HqvEBYtUspEda5bD6BIw4assvrc9zgqIjnyMahlw%2BMAOdLDB4rxnIK23gvF51BxxQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a2dc374a90a1105dee0ac4c5a8a04bd26459ba7aa2b284f16329ea43009747eb",
      "file_size": 114348,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2023-07-22T06:16:04.927Z",
  "allow_singular_disclosure_after": -17828431.114829276,
  "singular_disclosure_allowed": true,
  "vote_count": 5,
  "voters": [
    "shreyaschavhan",
    "zy9ard3",
    "shubham_srt",
    "shivammusic",
    "kurd_112113"
  ],
  "severity": {
    "rating": "medium",
    "score": 4.1,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 13,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/server",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 309788,
      "category": "team",
      "content": "Security advisory at https://github.com/nextcloud/security-advisories/security/advisories/GHSA-h353-vvwv-j2r4",
      "user": {
        "id": 89223,
        "username": "nickvergessen",
        "name": "Joas Schilling",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "Germany",
        "created_at": "2016-07-01T08:17:59.061Z",
        "url": "https://hackerone.com/nickvergessen",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
