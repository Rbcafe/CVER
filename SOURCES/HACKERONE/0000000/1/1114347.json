{
  "id": 1114347,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTE0MzQ3",
  "url": "https://hackerone.com/reports/1114347",
  "title": "Account takeover due to misconfiguration",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-03-02T05:46:13.703Z",
  "submitted_at": "2021-03-02T05:46:13.770Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "akashhamal0x01",
    "url": "/akashhamal0x01",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/vdyDQhCg37orFjBs8DU9T7Lf/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35268,
    "url": "https://hackerone.com/mattermost",
    "handle": "mattermost",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/268/9c24022b929e7fae94799068cf956f5c69d3ea15_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/268/9c24022b929e7fae94799068cf956f5c69d3ea15_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mattermost",
      "twitter_handle": "Mattermost",
      "website": "https://mattermost.com",
      "about": "Open-source collaboration, self-managed or SaaS"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-09-17T05:19:55.583Z",
  "bug_reporter_agreed_on_going_public_at": "2021-08-18T05:19:44.924Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\nHI team, i hope you are good :)\n\nIts a very simple logical flaw that results in this\n\nSo suppose we are victim@gmail.com , now login into the website then\n\n1. go to account settings and then change mail address to victim111@gmail.com\n2. a link will be sent to victim111@gmail.com, now the user realizes that he have lost access to victim111@gmail.com due to some reasons \n3. so he will probably change mail to the another mail address for e.g victim999@gmail.com which he owns and has access to\n4. but it is found that even after verifying victim999@gmail.com, the old link which was sent to victim111@gmail.com is active, so user/attacker having access to that mail can verify it and takeover acc\n\n\nIn a nutshell : \n\nIt is mandatory for a web app to invalidate the tokens in time to secure its user \n\nIn this case, suppose while changing mail address the user mistakenly typed wrong mail address, so the link will be sent to that mail address. \n\nSo the user probably don't want the user of that mail address to verify it, so he will quickly change his mail address to one he owns and verify it\n\nwhat he doesn't know is that even after verification(change of major state), the old link is still active \n\nthe flaw :\n\nuser changes mail to attacker@gmail.com -> user realizes that he mistyped the mail -> so he again changes to mail he owns and verifies it -> old link sent to attacker@gmail.com is still active even after new mail has been verified\n\n## Impact\n\nAn attacker can takeover acc due to misconfiguration, not invalidation of tokens at major state change, in time",
  "weakness": {
    "id": 38,
    "name": "Use of a Key Past its Expiration Date"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-09-17T05:19:45.104Z",
  "allow_singular_disclosure_after": -75977203.75403486,
  "singular_disclosure_allowed": true,
  "vote_count": 113,
  "voters": [
    "alp",
    "iismailu",
    "zy9ard3",
    "al_moalem",
    "run_win",
    "bug_vs_me",
    "ali",
    "shubham_srt",
    "retr02332",
    "akashhamal0x01",
    "and 103 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.7,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 17022,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "mattermost/mattermost-server",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
