{
  "id": 1621540,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjIxNTQw",
  "url": "https://hackerone.com/reports/1621540",
  "title": "Web Cache Poisoning leads to XSS and DoS",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2022-07-01T05:01:09.515Z",
  "submitted_at": "2022-07-01T05:01:09.596Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "nokline",
    "url": "/nokline",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/21as5318nc1hn5j4lncmpohiz51m/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 204,
    "url": "https://hackerone.com/glassdoor",
    "handle": "glassdoor",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/u258rsub76htn189l6jc17ycwrc4/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/u258rsub76htn189l6jc17ycwrc4/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Glassdoor",
      "twitter_handle": "glassdoor",
      "website": "https://www.glassdoor.com/",
      "about": "Your work people are here"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": true,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2022-09-13T13:36:15.462Z",
  "bug_reporter_agreed_on_going_public_at": "2022-09-10T05:06:34.883Z",
  "team_member_agreed_on_going_public_at": "2022-09-13T13:36:15.295Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 57,
  "voters": [
    "shreyaschavhan",
    "thr3athunt3r",
    "jumpydata",
    "mizzle",
    "palaziv",
    "nakyamad",
    "bombon",
    "alp",
    "zy9ard3",
    "nokline",
    "and 47 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 8181,
    "asset_type": "WILDCARD",
    "asset_identifier": "https://www.glassdoor.com/*",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 191703,
      "category": "team",
      "content": "@nokline and @bombon were able to utilize URL parser confusion in combination with reflected XSS under https://glassdoor.com/Job/ and https://glassdoor.com/mz-survey/interview/collectQuestions_input.htm/ by caching XSS payloads via cookie and header params into a stored XSS for URLs /Award/* and /List/* endpoints.\nThe above combination allowed the self-reflected XSS to be converted to a stored XSS which was cached to a local CDN for a duration of approximately 10 mins.\nTo affect all of the users, researchers specified that they can theoretically target all CDNs and loop every 10 mins to keep the cache loaded with stored XSS.\nWe resolved the above by\n1. Fixing the XSS by handling the output encoding appropriately.\n2. Tightening up caching rules to be more strict on /Awards/ and /List/ endpoints.\n\nGiven the tricky nature of this finding, we are grateful that the researchers were cooperative and helped us all the way through the investigation. Thanks once again and looking forward to more findings from you.",
      "user": {
        "id": 812081,
        "username": "jjone",
        "name": "JJ",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2019-11-07T21:07:23.824Z",
        "url": "https://hackerone.com/jjone",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "id": 191171,
      "category": "researcher",
      "content": "I was able to escalate 2 unexploitable XSS vulnerabilities, one in the cookie + parameter under every page in https://glassdoor.com/Job/ to a reflected XSS, and one in the cookie+header under every page in https://glassdoor.com/mz-survey/interview/collectQuestions_input.htm/ to a stored XSS with web cache poisoning. I was able to poison the cache with these XSS vulnerabilities by abusing a URL parser confusion. This URL parser confusion was a misinterpretation of dot segments `/../` between the frontend caching server and the backend web server, where the frontend server normalized (removed) the dot segmants, but the backend didn't and considered it as a valid part of the path (disagreement over RFC 3986 section 5.2.4). Prior to this finding, I also found super relaxed cache rules in https://glassdoor.com/Award/* and https://glassdoor.com/List/* , which assumed every page under these paths were static and were subsequently cached. With these findings, I was able to abuse the URL parser confusion to construct a payload with a dot segment which will cache the unexploitable XSS vulnerabilities in `/Job/*` and `/mz-survey/interview/collectQuestions_input.htm/*` under every page in `/List/*` and `/Award/*`.  \nFull writeup: https://nokline.github.io/bugbounty/2022/09/02/Glassdoor-Cache-Poisoning.html",
      "user": {
        "id": 1038784,
        "username": "nokline",
        "name": "Nokline",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://nokline.github.io",
        "location": "",
        "created_at": "2020-04-12T02:03:01.701Z",
        "url": "https://hackerone.com/nokline",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/21as5318nc1hn5j4lncmpohiz51m/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/21as5318nc1hn5j4lncmpohiz51m/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/21as5318nc1hn5j4lncmpohiz51m/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
