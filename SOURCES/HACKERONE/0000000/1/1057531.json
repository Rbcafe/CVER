{
  "id": 1057531,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDU3NTMx",
  "url": "https://hackerone.com/reports/1057531",
  "title": "GET /api/v2/url_info endpoint is vulnerable to Blind SSRF",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "high",
  "readable_substate": "Informative",
  "created_at": "2020-12-12T17:01:03.464Z",
  "submitted_at": "2020-12-12T17:01:03.517Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "atc_h1h1",
    "url": "/atc_h1h1",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/XdLRnHdz17EXjNHGVBybifpc/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 111,
    "url": "https://hackerone.com/automattic",
    "handle": "automattic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Automattic",
      "twitter_handle": "",
      "website": "https://automattic.com",
      "about": "WordPress.com, Jetpack, Texts, Akismet, Gravatar, WooCommerce, Crowdsignal, Tumblr and more!"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-12-15T13:03:15.978Z",
  "bug_reporter_agreed_on_going_public_at": "2020-12-15T02:48:28.266Z",
  "team_member_agreed_on_going_public_at": "2020-12-15T13:03:15.915Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nGET /api/v2/url_info endpoint is vulnerable to Blind SSRF. I am able to hit both Internal and External services via **url** parameter by replacing with internal and external url.\n\n## Platform(s) Affected:\nhttps://www.tumblr.com/\n\n## Steps To Reproduce:\n\n  1. Login to https://www.tumblr.com/\n  2. Follow any blog and intercept request via Proxy\n\nRequest :\n\nGET /api/v2/url_info?url={{}}&fields%5Bblogs%5D=avatar%2Cname%2Ctitle%2Curl%2Cdescription_npf%2Ctheme%2Cuuid%2Ccan_be_followed%2C%3Ffollowed%2C%3Fis_member%2Cshare_likes%2Cshare_following%2Ccan_subscribe%2Ccan_message%2Csubscribed%2Cask%2C%3Fcan_submit%2C%3Fis_blocked_from_primary%2C%3Fadvertiser_name%2C%3Ftop_tags%2C%3Fprimary HTTP/1.1\nHost: www.tumblr.com \n\nResponse:\nHTTP/1.1 200 OK\nContent-Type: application/json; charset=utf-8\n\n3. Now replace **url** parameter to your controller server url and send it.\n4. You will get request to your server.\n\nI could get verify it via IP Address: **74.114.154.11**\nNetRange:       74.114.152.0 - 74.114.155.255\nCIDR:           74.114.152.0/22\nNetName:        AUTOMATTIC\nNetHandle:      NET-74-114-152-0-1\nParent:         NET74 (NET-74-0-0-0-0)\nNetType:        Direct Assignment\nOriginAS:       AS2635\nOrganization:   Automattoque (AU-187)\nRegDate:        2017-04-20\nUpdated:        2017-04-21\nRef:            https://rdap.arin.net/registry/ip/74.114.152.0\n\nOrgName:        Automattoque\nOrgId:          AU-187\nAddress:        P.O. Box 997\nCity:           Halifax\nStateProv:      NS\nPostalCode:     B3J 2X2\nCountry:        CA\nRegDate:        2015-11-25\nUpdated:        2017-04-21\nRef:            https://rdap.arin.net/registry/entity/AU-187\n\n5. Now replace it with localhost url -> http://127.0.0.1:9090 and see response will be 404 but based on response time, port status can be identified.\n\nLimited Internal and External SSRF is performed. Attacker can target internal services by sending requests in bulk via mentioned endpoint.\nAttacker can get ports status by fuzzing or intruder attacker based on response time.\nAttacker would be able to target internal services and try to exhaust/target internal infrastructure.\n\n**Remediation Strategies :**\n\n1. **Only white listed URLs should be allowed for this endpoint. As user can only follow tumblr blogs, there would be some sort of filter mechanism to whitelist tumblr blogs. Any other URLs should be blocked.**\n2. **Not only for this API endpoint, any localhost URLs provided by user should be blocked.**\n2. **Any Out-of-band request from tumblr should be sent via CLIENT only. Here  in this case, server is requesting user controller URL input and requesting resource which is exposing internal IP details.**\n\n## Impact\n\nAttacker can get ports status by fuzzing or intruder attacker based on response time.\nAttacker would be able to target internal services and try to exhaust/target internal infrastructure.",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 7,
  "voters": [
    "rickiex",
    "rook1337",
    "tess",
    "xsstestov",
    "h1-qualys-scan",
    "hallbryght",
    "z3rod3x"
  ],
  "severity": {
    "rating": "high",
    "score": 8.4,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 42403,
    "asset_type": "URL",
    "asset_identifier": "www.tumblr.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
