{
  "id": 1357013,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzU3MDEz",
  "url": "https://hackerone.com/reports/1357013",
  "title": "ABLE TO TRICK THE VICTIM INTO USING A CRAFTED EMAIL ADDRESS FOR A PARTICULAR  SESSION AND THEN LATER TAKE BACK THE ACCOUNT ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-10-01T22:47:08.994Z",
  "submitted_at": "2021-10-01T22:47:09.041Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "at11zt00",
    "url": "/at11zt00",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35268,
    "url": "https://hackerone.com/mattermost",
    "handle": "mattermost",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/268/9c24022b929e7fae94799068cf956f5c69d3ea15_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/268/9c24022b929e7fae94799068cf956f5c69d3ea15_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mattermost",
      "twitter_handle": "Mattermost",
      "website": "https://mattermost.com",
      "about": "Open-source collaboration, self-managed or SaaS"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2021-37862"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2022-01-05T05:15:51.283Z",
  "bug_reporter_agreed_on_going_public_at": "2022-01-01T15:40:15.498Z",
  "team_member_agreed_on_going_public_at": "2022-01-05T05:15:51.163Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi\nI have found a vulnerability in your website using which i can trick the victim into using a specific email address to login in into the website and him thinking that he is using his own email address and continuing the session and then later we can take back the account and check what are the chats he made\nUNDER SOME CIRCUMSTANCES\n\nHOW TO REPRODUCE:-\nscenarios - a team admin sends you and the victim a joining link to his team.\nit looks like this:-\nhttps://hackerone.cloud.mattermost.com/signup_user_complete/?d={\"display_name\":\"\\u003ch1\\u003ea\",\"email\":\"██████████\",\"name\":\"main\"}&t=cqtkyznxn8e43yagt9fjcsrc4nh6yoqq914in3zg4ykj1jkjbc9bippckjikj4cw\n\nnow we can see that there is an Email value and a token value. here the email value doesn't matter because even if we change it .  you will be login as the \nemail to which the link was send. the token is assigned according to a particular email value\nbut interesting thing happens when we remove the email value and keep it blank (REFER TO THIS EMAIL)\n\nhttps://hackerone.cloud.mattermost.com/signup_user_complete/?d={\"display_name\":\"\\u003ch1\\u003ea\",\"email\":\"\",\"name\":\"main\"}&t=cqtkyznxn8e43yagt9fjcsrc4nh6yoqq914in3zg4ykj1jkjbc9bippckjikj4cw\n\nIF we go to the first link it asks us for name and password\nBUT if we go to the second link it ask's for username password and email(HERE things get interesting)\neven if we give a different email address to it . you will be signed as the attacker email id and the you can continue the session thinking that its your own email id you are using\n\n## Impact\n\nthe attacker can use his own invite link and then remove the email value from it and send it to the victim. when the victim clicks he sees 3 fields he give his own email id password and username and continue the session when done he log's out then the attacker can use forget password to take back his account and look through all of his private messages\n\nSTEPS TO REPRODUCE :-\n1. go to the first link you will be asked for username and password(DON'T SUBMIT JUST SEE THE CONTENTS)\n2.go to the second link you will be also asked for email(ENTER ALL THE VALUES )\n3.now if you check the email address it will be different from the original email address (you are using a forged email id) of the attacker\n\nNOW I HAVE RATED IT HIGH BECAUSE USING THIS WE CAN  SEE ALL THE CONVERSATION'S HE DID FOR A PARTICULAR SESSION\nI WILL ATTACH THE POC BELOW",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1468275,
      "file_name": "value_not_set_to_email_field.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7ji1qj3ob515ypivsu5p1tftqquq?response-content-disposition=attachment%3B%20filename%3D%22value_not_set_to_email_field.png%22%3B%20filename%2A%3DUTF-8%27%27value_not_set_to_email_field.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXDXMWQX4%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T141803Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBXiIatSvXxAR8ZBwoq9n9qamV3%2Beh4VxZ3KYO4Dx8ipAiBhqaPFcz1fCY4UiwnoQpCKbjkuyniJ5UnHxhrd1V7sPCqxBQh2EAMaDDAxMzYxOTI3NDg0OSIMI7x1nUgRkEN0qOmcKo4FXYYyeBqpZepmBlG%2Bn8RIW4ybBvBDLTs5NzQS7p452M4cH8%2FOy1nnGTSEGOnFuQ1hr8I838Py4bbR2k0%2FeAXwEKBwp9kUx1f6xHqwuZ%2BZJE6IBIkxerlv%2FE3eoTBjleGGo2wwfiOgBypgZ5sXatzcXx72vmVtwhxsDHzFmuJonyOALDBbiuqGbIPREpmA3jUxq%2BMAacTvuf9XMxNE478SaHCKprf1SFobf84oc7fT%2FWNU4UeJ8GNMQeSenAKYY%2BrLefa1UY4wwj6g5D0GjwCVp9bHXI21rt%2BOchx%2BJy%2Ff8hhrWt2fFEziDHK2ejHlzmon20KSav3Ecka%2Fl7q%2FXbFq%2B5cHQ3Fnv6Hsuz%2BtzfIL4EI8nN4PTXJ959QXCgSq68M3r%2FCq038IGGPaf9q5IZ44XiRhpk9WyrUqaUvKDpIG2kZMpC6jLDCikWY%2F0pq0aLMVs8K3zMuHvUvoA%2B2gV%2Bcm6EdoBU1pM0KqEZ4gTsmJdr8mPFqfdK1P4IwECSvHVNNvRZ%2FytigAMyryjJi%2FzrEs38Y9%2FrEkIQq4jS7aMXa2dJvo8qo%2BMpwzgI63Zc9%2BUb7QMMj32n1iEhgvRp0P4HsvjBZW5a45NrCNrdPawRXUjURzopS4c1KkPmoIyqVJLA%2FcZfSuGhSIBnYcB3irx3ar6nXnb1BlJQeYwVq%2BGugPDwYF7JnE98PVLlThTxxkQLe6rmhG98KDMqkM2rSCOaoIoCAr8pyrGNylV531TI6WsbwObHBBin8dGaMs5bPKof2pfOiufJXYwPbUfatl0yR4eeNEDZ2ojVwsNt%2FXz0I%2BnOHi3gFnlaTXXL2pE75y8B8i2gdpWyljLCB%2Bnh8JAX4zJ9W5uSJwboRkdOBCbm1EMOnJra4GOrIBAGTU0E8gZ3I1JcYpghGRH630deXcWBT7WyMmozUTe6qarc28Ss1LWSuryHkoMrH7Sud0DqGFERBVj7YzRXPoLL7BGEhCuNa2uCE2kvLJYBOVb8O0U%2BA8CX4iNwz55KlL7rByi1vNt6ahpUI7DJZTOvkkTX1DSVfQF%2Baicg%2BfMtGKT4Z2J8HGmzqC%2FR%2FqkC6K2vyecQNgl1yG%2BNZWxHLH3sMFQGgXVbyipFgwNo8D0TTcrQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a05d1e69c4169ae04c35815cd0afbea3e98fa7c2c96c246628486b4802e8d89a",
      "file_size": 163276,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2022-01-31T15:40:15.609Z",
  "allow_singular_disclosure_after": -64190267.49185942,
  "singular_disclosure_allowed": true,
  "vote_count": 47,
  "voters": [
    "fqdn",
    "yassinek3ch",
    "tess",
    "shubham_srt",
    "sudi",
    "pacmanx",
    "ibring",
    "n1ghtmar3_2421",
    "tejaspawar172000",
    "el_ahmed",
    "and 37 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.7,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 57045,
    "asset_type": "WILDCARD",
    "asset_identifier": "h1-*your-own-instance*.cloud.mattermost.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
