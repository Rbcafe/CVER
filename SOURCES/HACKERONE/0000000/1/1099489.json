{
  "id": 1099489,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDk5NDg5",
  "url": "https://hackerone.com/reports/1099489",
  "title": "REST API Endpoint leads to Unauthorized user disclosed private [ issue ] details",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2021-02-09T17:41:45.237Z",
  "submitted_at": "2021-02-09T17:41:45.299Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "updatelap",
    "url": "/updatelap",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/vb35rkj89g30glscmc8zqj6auios/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 65,
    "url": "https://hackerone.com/mailru",
    "handle": "mailru",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mail.ru",
      "twitter_handle": "",
      "website": "https://vk.company/",
      "about": "Building the Internet since 1998"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-11-06T18:48:10.501Z",
  "bug_reporter_agreed_on_going_public_at": "2021-10-07T18:48:02.080Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary\nJira allows an administrator to restrict access to projects to specific users only. Or adjusting all project properties to be available only to the system administrator, which means that all users in the jira account cannot access issues, project, dashboard and any information about the project, view, modify, delete or add to the project, or even Conf. for the apps associated with this project. So, After install and analyzing the  [Query Issues Custom Fields](https://marketplace.atlassian.com/apps/1211009/query-issues-custom-fields?hosting=server&tab=overview) source code I found several endpoints. some of this endpoint Leads Unauthorized user access to disclose private data.\n\n# Description:\nAfter installing and analyze the source code [Query Issues Custom Fields](https://marketplace.atlassian.com/apps/1211009/query-issues-custom-fields?hosting=server&tab=overview), I headed to the next file\n\n`\nQuery Issues Custom Fields/ru/mail/jira/plugins/lf/queryfields/js/linker-field-app.js\n`\n\nWhen looking for endpoints in this file, you find the next endpoint: ` /rest/queryfields/1.0/customfields/linkerfield/option?issueKey=`\n\n```js \nE = function () {\n                    function e(e, t, n, a, i, l, r) {\n                        var c = this;\n                        this.hasError = !1, this.isLoading = !1, this.changeLoadingState = function (e) {\n                            c.isLoading = e\n                        }, this.loadValue = function () {\n                            c.isLoading = !0, null == c.issueKey || 0 == c.issueKey.length ? O.a.get(b()() + \"/rest/queryfields/1.0/customfields/linkerfield/option?issueKey=\" + c.defaultValue).then(Object(p.action)((function (e) {\n                                c.value = e.data\n                            }))).catch().finally((function () {\n                                return c.changeLoadingState(!1)\n....\n```\n\nAs the parameter name indicates, it takes a value for `issueKey=` so I created a new case and copied the issue keyID and added it to the endpoint.\n`{BaseUrl}/rest/queryfields/1.0/customfields/linkerfield/option?issueKey=PRJ-1` And as it appears in the `.js` code, this request is sent through the GET Request `O.a.get(b()()`, so I sent this request using the administrator's account and the response contains the case information\n\n```bash\ncurl  -X GET -u admin:admin \"http://localhost:8080/rest/queryfields/1.0/customfields/linkerfield/option?issueKey=PRJ-1\"\n```\n\n## Response \n\n```json\n{\n   \"key\":\"PRJ-2\",\n   \"summary\":\"As a product owner, I'd like to express work in terms of actual user problems, aka User Stories, and place them in the backlog ... etc\",\n   \"description\":\"When you click  Create Issue....etc\",\n   \"issueType\":\"Story\",\n   \"issueTypeIconUrl\":\"/images/icons/issuetypes/story.svg\",\n   \"status\":\"To Do\",\n   \"statusColor\":\"blue-gray\",\n   \"priority\":\"Medium\",\n   \"priorityIconUrl\":\"/images/icons/priorities/medium.svg\",\n   \"assignee\":{\n      \"displayName\":\"Unassigned\"\n   },\n   \"deleted\":false,\n   \"customFields\":[\n      \n   ]\n}\n```\n\nThen I created the account for user B and from the administrator account restricted the access of the user so that it would not have any permissions. This means that User B cannot access projects, cases, dashboards, or anything with userB account. Using User B's account, I resubmitted the previous request, and it turned out that the request was not protected as the user was able to access all the issues information\n\n```bash\ncurl  -X GET -u user:user \"http://localhost:8080/rest/queryfields/1.0/customfields/linkerfield/option?issueKey=PRJ-1\"\n```\n\nIn this case, User B can disclose private information about all issues in the `jira account` that he is supposed to not reach by sending the following request:\n\n### Steps:\n\n1. Create Jira account.\n1. Create Jira user with no_permissions.\n1. The administrator limits access to the project only to the administrator.\n\n{F1189720}\n1. Admin install  [Query Issues Custom Fields](https://marketplace.atlassian.com/apps/1211009/query-issues-custom-fields?hosting=server&tab=overview). \n1. using the user with no permission, call:\n\n```bash\ncurl  -X GET -u user:user \"http://localhost:8080/rest/queryfields/1.0/customfields/linkerfield/option?issueKey=PRJ-1\"\n```\n\nBest,\n* Jafar\n\n## Impact\n\nREST API Endpoint leads to Unauthorized user disclosed private [ issue ] details",
  "bounty_amount": "1000.0",
  "formatted_bounty": "$1,000",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 1189720,
      "file_name": "PrivPerSch.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/57katja58rxw0rq0ypn7d9c4fxd8?response-content-disposition=attachment%3B%20filename%3D%22PrivPerSch.png%22%3B%20filename%2A%3DUTF-8%27%27PrivPerSch.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5A3QBGAF%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T140525Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDOmRjyw5I%2FTlNnXkSaQt0HWBvcx4KUqlbsBDywYvgMjAIgc1T3omLkZfSHGnxG7u3M%2BDm3ZU5hXXACm6d42GSb7EAqsQUIdhADGgwwMTM2MTkyNzQ4NDkiDI1cp4QslnXVHIUCaCqOBecH%2BJNC0KwQ%2BfCYMGM86f%2FOS1Dm%2BIA%2BHjSlOORnFjZmELOvSSorEYFhUaPaxwQcFsTE7OMurOw%2BQnTNbwJzmGH%2FjDpGT%2FxwOi1Yf0v9t5xHdyje9QeqWvWnPlxRuLTKdeHLfuYjPaGYHjDPk%2ByYZLTVi%2F6fLFk1LMc7Dx726KzEvXPKCa4bME8qI31URj4F9nDQiBGwytvr7Hm1EMgKGmVAK6%2Fbzd%2BJiZVqxHd3sYJSTbmtS%2BAl2zqAc8BSfBosM0X88oi3lBTlSqMNhfG3CaAXBePpXwzrVOqz74NfDYXdsP4VQdYegntsv6fFEZFiKkjhlglh0X4pAXPbvFNkY8C7BzpUD2tNRzacCXSlRaco9RM5vUg086o63M3dgo9tb8DkSAwOHamrNu%2F2KO2aggnlYsi1aZ7EJQTnQ4h%2BcjkM2D28%2Bxcxlpa3Ec2gB5yd%2BQcUjU%2BzbbmFbStd4UJXYiE38Skp99somT%2BpCEikiE7WFVYA5Pgb9J6BqOzjaorE7DzLysbe4e0jMnv06eVq4H%2Bz42eH%2FkluYPtzip94lWrairjO%2BPy%2BVDKDVJai6d1iVpfcEFmbncPaNpU53sKrhSNhpvIUbUDu5YaFK6X%2FbL%2BeFksXVgGaf0JwUeSzAh%2FGbxLEuo6xDzuhAOmMHndLW%2FF8uphSoqM7NkjvQNWF4znkPMyfsDxu0sKfOHhED1nQ5geErhYuMeCPDWNlWvJKC2X93i%2B8i8WntV0NtA21WXhLXSnrHVz2HCPlDghBMIvH7mgPpfyFhSMGQDeGjpSbj3uInocAFuDTAgJeZIwRGGMYeOXoRMIVrM6FWdeiP%2FaI3a0LUECdOBOPVvRMLQuf7VJvF0078t1crT4PlcQMPTC%2Fwq2uBjqxAVnkBdxFUTWQ4ZupRlHVu9PZr1k7xqw4QHDS7pllKyJWE05aIrKtcQLI8f74A6IlC2qLL0KpjvsW622557lHAqxIiBIxR28dhgaLkoywMH6F6KWd%2BowMbbVNahcgFgF8sWKuHHJPaj4kiHcEz7czNhJgm88FkmgTRhhw7HW2Z01FS2x%2BrnGRx5%2BvOZPEvDu%2BIRvDNGu%2FVrwK5wtu%2BRwxD8V7oEVMXOuAFSFlduj5GO6kbQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=69f50b151800bc298d7963aa6747740ff09c92aa05ef53a915ad4e6bdd80817d",
      "file_size": 74034,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2021-11-06T18:48:02.159Z",
  "allow_singular_disclosure_after": -71608643.8040446,
  "singular_disclosure_allowed": true,
  "vote_count": 23,
  "voters": [
    "bazzadrox",
    "7odamoo",
    "h4x0r_dz",
    "sodium_",
    "updatelap",
    "f1ras",
    "yyn_",
    "official_blackhat13",
    "enwuft",
    "sukhdeothakur96",
    "and 13 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.1,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 40418,
    "asset_type": "OTHER",
    "asset_identifier": "Ext. A Scope",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
