{
  "id": 1085336,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDg1MzM2",
  "url": "https://hackerone.com/reports/1085336",
  "title": "CSRF when unlocking lenses leads to lenses being forcefully installed without user interaction",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-01-23T14:19:13.358Z",
  "submitted_at": "2021-01-23T14:19:13.410Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "sdushantha",
    "url": "/sdushantha",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/135/666/e86acdab340fe947a4f9c8eee2e0193c99c0bac1_original.JPG/cccd3716a6d2e06174d2a41492445cb1d4bf85b4611a755bc810b9246a24d951"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 513,
    "url": "https://hackerone.com/snapchat",
    "handle": "snapchat",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/513/87067c5c4ed63c2c07a522ca3198d2310e2a14c6_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Snapchat",
      "twitter_handle": "",
      "website": "https://www.snapchat.com/",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-07-29T22:33:23.649Z",
  "bug_reporter_agreed_on_going_public_at": "2021-07-27T05:49:50.628Z",
  "team_member_agreed_on_going_public_at": "2021-07-29T22:33:23.499Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi,\n\nThe url below allows a user to unlock a particular lens. Once they have opened the URL on their phone, Snapchat opens up and prompts the user to unlock this lens.\n```\nhttps://www.snapchat.com/unlock/?type=SNAPCODE&uuid=6ff5a565fca249a1948b1963ee2881b4&metadata=01\n```\n\nBy changing the value of  `type` in the URL above, from `SNAPCODE` to `SNAPCODE_NO_PROMPT`, we can bypass the prompt mentioned earlier, and instead forcefully unlock the lens and make them use it, hence why this is a CSRF:\n```\nhttps://www.snapchat.com/unlock/?type=SNAPCODE_NO_PROMPT&uuid=6ff5a565fca249a1948b1963ee2881b4&metadata=01\n```\n\nThis issue also happens to Snapchat's deeplink on Android:\n```\nsnapchat://unlock/?type=SNAPCODE_NO_PROMPT&uuid=6ff5a565fca249a1948b1963ee2881b4&metadata=01\n```\n\n\nI do not have an iOS device but I am certain that this issue also occurs on the iOS version of Snapchat.\n\n## Impact\n\nA Snapchat lens developer can abuse this bug and increase the number of people who use their lens by making people opening the URL to the lens and replacing `SNAPCODE` with `SNAPCODE_NO_PROMPT`.  This can cause false popularity for that lens as it is being unlocked without the user wanting to do so. This would then lead to the user having to manually delete the lense that was automatically added.",
  "bounty_amount": "250.0",
  "formatted_bounty": "$250",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 15,
  "voters": [
    "osman1337",
    "tolga",
    "ali",
    "h4x0r_dz",
    "dastan_9408",
    "i5nipe",
    "sdushantha",
    "bracii",
    "kxddah",
    "keerthi04",
    "and 5 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 11817,
    "asset_type": "GOOGLE_PLAY_APP_ID",
    "asset_identifier": "com.snapchat.android",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 72711,
      "category": "team",
      "content": "By sending a message containing a specially crafted link using the `SNAPCHAT_NO_PROMPT` type, a CSRF attack can be performed, causing the victim to unlock a Lens for their snapchat account without the prompt appearing.",
      "user": {
        "id": 634581,
        "username": "quanyang-sc",
        "name": "Quan Yang Yeo",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2019-06-03T22:00:45.066Z",
        "url": "https://hackerone.com/quanyang-sc",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
