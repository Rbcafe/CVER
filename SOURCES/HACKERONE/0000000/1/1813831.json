{
  "id": 1813831,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODEzODMx",
  "url": "https://hackerone.com/reports/1813831",
  "title": "CVE-2022-43551: Another HSTS bypass via IDN",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2022-12-21T08:51:43.585Z",
  "submitted_at": "2022-12-21T08:51:43.681Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kurohiro",
    "url": "/kurohiro",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVEZVZRGT%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143323Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDWYnKQYclS61T7MxyY%2BjY2cTGJfHQYiuqjFad7wYMiIQIgNeAdMumlTdeq4lMQ9WuVLpSm3yzw1mGivXNXDgULpQYqsgUIdxADGgwwMTM2MTkyNzQ4NDkiDMLcGZVE5RFfToAXbiqPBSIrlo8UgAGVOM8KidbtxWc6SkEozzwTegh3NbBOLdZfEvWEihLuxXAShaviKXGRtWGNNcTm30P5A0mmD4y97LGN5riH00YMLzMEuOG2a7fdYJ36B23e4AS9L88QjHyhr4MbbEfdVWyqQkwdoR89KYCUi7N4tmQ7ndMbdcgw5PoIhNIEyEF4J%2FAET2o9v3OatrFuPPhODhA4By164RMLG2fJxZ8GftDPQmkdaFW1bRI66pI3%2FabuYCXZR5qcQprepoZ83IaWDJp0PZqOr5GlqhAUmcIT7NSizOv3%2BUQA2ktAImaQWn4WqqotIaa1%2FISuePrF9hRRbOPlzGaH6nERd3ZZbEWircOqLnPqxKHKmJfpZ4tm%2BPm6Gu7Sy2jeJRK0c3GsKhnxrHLIQ1s4OOKyH7RRCG0xdjjm201jL2Zx1tK%2FBjFvP45y%2BozBkPWCUuUXdKMvx6jAEMVi75IwkdWD%2Fv8G0sCRNQb3jle%2Fmx6KDqwzLJ61QViZ2AGNrOhLosvGR5M9GNR4b4wYml2K0Bu5CGhw9a5rTkbK%2F5%2FXumd4%2FF%2BNdGWl9PEeESKTEVD%2B8Ti74UzGOZUVZAvYLaQDU%2BitzQkZvaIru2uRPMT1G7GlxZg7EeoDu1AqxijegN5a0N8KR9plwCv7j5jk8Jkh0zALBB1XOLuu7HQPHqoWmIfCFT3pA%2Bgoeb83sKkUxgGaQNO7duOQDVAR6VNIOnu3frRnR5z4sTEHwdgrpHZCzSExVCERP%2BGHtiP36f62T%2F8Dk8%2B%2Bf4MFMY4aOT0b4EKRltyMscVBoUl7LuMMf6y8xRYStpCeW8ug%2BfEf2b8xJrHFwa8%2FefhAWgLmq7Gs19XL8CpFpfhEz81WFH0hs%2B0gP3FgGdEwwumtrgY6sQH%2BYDXfy1qTDKNd5azqxyOrh0eirJIDZhcGnN9ZlMSVfbiighCHS998IAIcNaZpNCNOqybBEqous9HWd6Om7k2j1GGXF5s6J69JZPlpit380jbtUquAnwR%2B52D9JK5omCjq7IvKcx%2BJYvXi2FlHutTh32wphToYyGkZGs03Xyfk5rzXvwyB18SUMnaLEmwojIY9Hh9wOsOU4ydsoidjFzrlQdMgNa26f2pGAVps0viYSzs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=385a3e2186c5920fecb9bf6a2da373d7cee262f6a01f1f2a4a8898b130112901",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVEZVZRGT%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143323Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDWYnKQYclS61T7MxyY%2BjY2cTGJfHQYiuqjFad7wYMiIQIgNeAdMumlTdeq4lMQ9WuVLpSm3yzw1mGivXNXDgULpQYqsgUIdxADGgwwMTM2MTkyNzQ4NDkiDMLcGZVE5RFfToAXbiqPBSIrlo8UgAGVOM8KidbtxWc6SkEozzwTegh3NbBOLdZfEvWEihLuxXAShaviKXGRtWGNNcTm30P5A0mmD4y97LGN5riH00YMLzMEuOG2a7fdYJ36B23e4AS9L88QjHyhr4MbbEfdVWyqQkwdoR89KYCUi7N4tmQ7ndMbdcgw5PoIhNIEyEF4J%2FAET2o9v3OatrFuPPhODhA4By164RMLG2fJxZ8GftDPQmkdaFW1bRI66pI3%2FabuYCXZR5qcQprepoZ83IaWDJp0PZqOr5GlqhAUmcIT7NSizOv3%2BUQA2ktAImaQWn4WqqotIaa1%2FISuePrF9hRRbOPlzGaH6nERd3ZZbEWircOqLnPqxKHKmJfpZ4tm%2BPm6Gu7Sy2jeJRK0c3GsKhnxrHLIQ1s4OOKyH7RRCG0xdjjm201jL2Zx1tK%2FBjFvP45y%2BozBkPWCUuUXdKMvx6jAEMVi75IwkdWD%2Fv8G0sCRNQb3jle%2Fmx6KDqwzLJ61QViZ2AGNrOhLosvGR5M9GNR4b4wYml2K0Bu5CGhw9a5rTkbK%2F5%2FXumd4%2FF%2BNdGWl9PEeESKTEVD%2B8Ti74UzGOZUVZAvYLaQDU%2BitzQkZvaIru2uRPMT1G7GlxZg7EeoDu1AqxijegN5a0N8KR9plwCv7j5jk8Jkh0zALBB1XOLuu7HQPHqoWmIfCFT3pA%2Bgoeb83sKkUxgGaQNO7duOQDVAR6VNIOnu3frRnR5z4sTEHwdgrpHZCzSExVCERP%2BGHtiP36f62T%2F8Dk8%2B%2Bf4MFMY4aOT0b4EKRltyMscVBoUl7LuMMf6y8xRYStpCeW8ug%2BfEf2b8xJrHFwa8%2FefhAWgLmq7Gs19XL8CpFpfhEz81WFH0hs%2B0gP3FgGdEwwumtrgY6sQH%2BYDXfy1qTDKNd5azqxyOrh0eirJIDZhcGnN9ZlMSVfbiighCHS998IAIcNaZpNCNOqybBEqous9HWd6Om7k2j1GGXF5s6J69JZPlpit380jbtUquAnwR%2B52D9JK5omCjq7IvKcx%2BJYvXi2FlHutTh32wphToYyGkZGs03Xyfk5rzXvwyB18SUMnaLEmwojIY9Hh9wOsOU4ydsoidjFzrlQdMgNa26f2pGAVps0viYSzs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3cfaee90ecc2876d733f1e73db22d606e7afa8cd90bc5ee9e7a84b74967ad5e4"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2022-43551"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-02-03T18:01:16.557Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2023-01-04T18:01:15.880Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Original Report:https://hackerone.com/reports/1755083\n\n## Impact\n\nHSTS bypass.",
  "weakness": {
    "id": 34,
    "name": "Cleartext Transmission of Sensitive Information"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2023-02-03T18:01:16.025Z",
  "allow_singular_disclosure_after": -32387527.149973184,
  "singular_disclosure_allowed": true,
  "vote_count": 10,
  "voters": [
    "zy9ard3",
    "shubham_srt",
    "freedfr0md3sire",
    "rvats",
    "shivammusic",
    "codestroker",
    "ostronics",
    "sidvesna",
    "unknown1122w",
    "eng4ge"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 80985,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 235255,
      "category": "team",
      "content": "CVE-2022-43551: Another HSTS bypass via IDN\n===========================================\n\nProject curl Security Advisory, December 21 2022 -\n[Permalink](https://curl.se/docs/CVE-2022-43551.html)\n\nVULNERABILITY\n-------------\n\ncurl's HSTS check could be bypassed to trick it to keep using HTTP.\n\nUsing its HSTS support, curl can be instructed to use HTTPS instead of using\nan insecure clear-text HTTP step even when HTTP is provided in the URL.\n\nThe HSTS mechanism could be bypassed if the host name in the given URL first\nuses IDN characters that get replaced to ASCII counterparts as part of the IDN\nconversion. Like using the character UTF-8 U+3002 (IDEOGRAPHIC FULL STOP)\ninstead of the common ASCII full stop (U+002E) `.`. Then in a subsequent\nrequest, it does not detect the HSTS state and makes a clear text\ntransfer. Because it would store the info IDN encoded but look for it IDN\ndecoded.\n\nReproducible like this:\n\n    curl --hsts hsts.txt https://curl%E3%80%82se\n    curl --hsts hsts.txt http://curl%E3%80%82se\n\nWe are not aware of any exploit of this flaw.\n\nINFO\n----\n\nThis flaw was introduced in [commit\n7385610d0c7](https://github.com/curl/curl/commit/7385610d0c7), which was\nshipped enabled by default from [commit\nd71ff2b9db566b3f](https://github.com/curl/curl/commit/d71ff2b9db566b3f) in\ncurl 7.77.0.\n\nThis issue is similar to both the previous issues\n[CVE-2022-42916](https://curl.se/docs/CVE-2022-42916.html) and\n[CVE-2022-30115](https://curl.se/docs/CVE-2022-30115.html).\n\nThis become a new separate vulnerability simply because we did not test and\nresearch related side-issues while we worked on fixing the previous issues.\n\nThe Common Vulnerabilities and Exposures (CVE) project has assigned the name\nCVE-2022-43551 to this issue.\n\nCWE-319: Cleartext Transmission of Sensitive Information\n\n###Severity: Medium\n\nAFFECTED VERSIONS\n-----------------\n\n- Affected versions: curl 7.77.0 to and including 7.86.0\n- Not affected versions: curl < 7.77.0 and curl >= 7.86.0\n\ncurl built without IDN support is not vulnerable.\n\nlibcurl is used by many applications, but not always advertised as such!\n\nTHE SOLUTION\n------------\n\nA [fix for CVE-2022-43551](https://github.com/curl/curl/commit/9e71901634e276dd)\n\nRECOMMENDATIONS\n--------------\n\n A - Upgrade curl to version [7.87.0](https://curl.se/docs/vuln-7.87.0.html)\n\n B - Apply the patch to your local version\n \n C - Stick to always using `HTTPS://` in URLs\n \nTIMELINE\n--------\n\nThis issue was reported to the curl project on October 29, 2022. We contacted\ndistros@openwall on December XX, 2022.\n\ncurl [7.87.0](https://curl.se/docs/vuln-7.87.0.html) was released on December 21 2022, coordinated with the publication\nof this advisory.",
      "user": {
        "id": 2032618,
        "username": "pr0tag0nist",
        "name": "Sandeep Singh",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2021-10-18T10:02:41.859Z",
        "url": "https://hackerone.com/pr0tag0nist",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
