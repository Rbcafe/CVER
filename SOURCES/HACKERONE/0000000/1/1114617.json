{
  "id": 1114617,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTE0NjE3",
  "url": "https://hackerone.com/reports/1114617",
  "title": "Privilege Escalation leading to post in channel without having privilege",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-03-02T12:21:42.066Z",
  "submitted_at": "2021-03-02T12:21:42.110Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "fuzzsqlb0f",
    "url": "/fuzzsqlb0f",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35268,
    "url": "https://hackerone.com/mattermost",
    "handle": "mattermost",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/268/9c24022b929e7fae94799068cf956f5c69d3ea15_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/268/9c24022b929e7fae94799068cf956f5c69d3ea15_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mattermost",
      "twitter_handle": "Mattermost",
      "website": "https://mattermost.com",
      "about": "Open-source collaboration, self-managed or SaaS"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-09-13T05:36:41.848Z",
  "bug_reporter_agreed_on_going_public_at": "2021-09-03T05:46:43.759Z",
  "team_member_agreed_on_going_public_at": "2021-09-13T05:36:41.703Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi H1,\n\nmattermost.cloud has a feature of making a channel and once its set to public any other user can join the channel and post comments on that channel. In System Console --> Channel --> Permission channel owner can assign wether member can post comment or not. Once channel owner selects that channel member can not post even than they can post the comment in channel.\n\n\nSteps To Reproduce:\n\n\n- Step1: user1 `█████` created a channel which is public and under System Console --> Channel --> Permission gives guest and members to post comment.\n\n- Step2: user2 `█████` joined user1 channel `mikefourchannel`  (already joined)\n\n- Step3: user2 posted comment `has permission to comment in channel` in `mikefourchannel`  and captured the request and send it to repeater (\n\n- Step3: user2 `███████` also created a channel `privilegeescalation` (already done)\n\n- Step4: user1 `█████` and under System Console --> Channel --> Permission  guest and members removes right to comment.\n\n- Step5: user2 `████████` now can not post any comment `This channel is read only. Only members with permission can post here`\n\n- Step6: user2 `██████` goes to channel `privilegeescalation` and posted comment and captures the request and used post request which was captured in `Step3`\n\nNote:\nIn video POC at time 0:01:42 user2 commenting when he was having privilege of commenting in channel and there is only that comment `has permission to comment in channel` below there is no other comment now plz go to time 0:04:29  you can see user2 commented `commenting in mike4 channel even no privielge` in user1 channel without proper privileges\n\nVideo POC attached for your reference.\n\nResult:\n\nuser2 `███` posted comment in user1 channel `mikefourchannel` even user2 dosen't have privilege to do so.\n\n## Impact\n\nImpact:\n\nPrivilege escalation leading to comment on channel.",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-10-03T05:46:43.847Z",
  "allow_singular_disclosure_after": -74593185.67840491,
  "singular_disclosure_allowed": true,
  "vote_count": 40,
  "voters": [
    "alp",
    "run_win",
    "tess",
    "dnelsaka",
    "ali",
    "ayoub0x1",
    "deadrobin",
    "sudi",
    "akashhamal0x01",
    "refaat01",
    "and 30 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 2.6,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 57045,
    "asset_type": "WILDCARD",
    "asset_identifier": "h1-*your-own-instance*.cloud.mattermost.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
