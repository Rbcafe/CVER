{
  "id": 1652042,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjUyMDQy",
  "url": "https://hackerone.com/reports/1652042",
  "title": "CVE-2022-21831: Possible code injection vulnerability in Rails / Active Storage",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2022-07-27T20:03:32.375Z",
  "submitted_at": "2022-07-27T20:03:32.455Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "gquadros_",
    "url": "/gquadros_",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQQSQTJWE%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T142850Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICMbzzKBCraFobXOcCqfodxzM%2F89seEFEtkolz9ym8yYAiEA%2Fsvto%2F251HQZfvVraGJNSEE9N05zP%2BaGv%2FBSxh9MwpMqsgUIdxADGgwwMTM2MTkyNzQ4NDkiDLRiPgXnAALYKAeN%2BSqPBWHgzJxP51a7MbYBgyoxP1LDcsLwdgUbUtgcBcVihNzgjkpkX1z4v6%2FjmlETXMHpM%2FauQHP0xGmCQhKLjGzIinKmY6tZ4kZl141nt3bExoUI5fWVsWEB7O84QdqCtoGtUZA0f1O7EIdYBJQb%2FmNKqwZEWaU%2F7PgkRk0H3XNrhegcIQuivj4XNypNwJPOxdtitDeFDYLpO12smqVJ5amk5ztkBZAoq8E%2Fxhaobm%2BP%2BcLxlPXFMWF2mULZXnUB%2BQexzDE%2FeLT2%2F%2FCafZViAqQkXNNhRc1onMPfkORBF3TWhoGrNIEBTcxPrms3Wk4KLaYQfHMpRmDn8NdWo6rpTdWGmrWp15yhtPtvFe8ReFe1qwFRwBcnvbxbIpos0u911N8KZcdmsYZha%2FoJ5gCaJUsYWiujZHGn6f5ac2aDT02iO7y%2FvFGh%2BiiCuJnTr%2FTPbUjsuYpUKRWvX0lbNazDhrREV3P7R16HgWupyfQVvDMUxflgXVEIBtoH%2F3PlfIvSwDTjDdb04Ji5mlT6sdPmo0lfcQgYurG6SnsI6MgswsJjYI2WOlv2p1tmsRt%2ByFO3bcNXUIH7i5sX1gS7pDgOE42otZhfgnqjvs281xt%2FxdyiAtfzcabnG58C%2F6LMJcKeiNXLZWzeSL%2FsIKZbRGv7%2BbTcyt4NUuw0Q8qvXsuEQa6pysO9CNZrAUmcPtXKlyDUNPvymrupyNL%2BTMEhXfQtQ9GR77FBbp2W1g6N%2BZC4U3Pyjd%2B5zay1bpkCArA0SfRd1XoibXzi71Y30tA%2FNUr4Rib62%2FqhPMoV5VVGpkLtyTBkmmVyf%2FESSQWdUjQsHkdlrlefv2cMA97YY4fWehghMcS0o3sWAL6LKEbcYmXkUd9uubUwzuGtrgY6sQGqVPKMUtXZrBKkrmums9UdPoAQiHM9bDEAcx6q6dTbsaND9EZI1kiWjVkhOtlNqyZzZiln%2BiwOaBZiB%2FQiRz7jN%2F4j0Xau5GsUBxICzxeYF6QfWg9kdjLfouuoymOG0OykNz%2FXKrjHdQ4BrNO6%2BP5iYizFhSP9s5uBbIRfMqyUWVBdXawoABdBVubTk5tCNVNh%2FWifWwE4VS1yIJoLSgY8wRQ3gW0tXMWlxD895PitKQQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=736d942e066d225a1e2a4825f08bffc902eb7b0f339cd9e13487f3f690c36e37",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQQSQTJWE%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T142850Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICMbzzKBCraFobXOcCqfodxzM%2F89seEFEtkolz9ym8yYAiEA%2Fsvto%2F251HQZfvVraGJNSEE9N05zP%2BaGv%2FBSxh9MwpMqsgUIdxADGgwwMTM2MTkyNzQ4NDkiDLRiPgXnAALYKAeN%2BSqPBWHgzJxP51a7MbYBgyoxP1LDcsLwdgUbUtgcBcVihNzgjkpkX1z4v6%2FjmlETXMHpM%2FauQHP0xGmCQhKLjGzIinKmY6tZ4kZl141nt3bExoUI5fWVsWEB7O84QdqCtoGtUZA0f1O7EIdYBJQb%2FmNKqwZEWaU%2F7PgkRk0H3XNrhegcIQuivj4XNypNwJPOxdtitDeFDYLpO12smqVJ5amk5ztkBZAoq8E%2Fxhaobm%2BP%2BcLxlPXFMWF2mULZXnUB%2BQexzDE%2FeLT2%2F%2FCafZViAqQkXNNhRc1onMPfkORBF3TWhoGrNIEBTcxPrms3Wk4KLaYQfHMpRmDn8NdWo6rpTdWGmrWp15yhtPtvFe8ReFe1qwFRwBcnvbxbIpos0u911N8KZcdmsYZha%2FoJ5gCaJUsYWiujZHGn6f5ac2aDT02iO7y%2FvFGh%2BiiCuJnTr%2FTPbUjsuYpUKRWvX0lbNazDhrREV3P7R16HgWupyfQVvDMUxflgXVEIBtoH%2F3PlfIvSwDTjDdb04Ji5mlT6sdPmo0lfcQgYurG6SnsI6MgswsJjYI2WOlv2p1tmsRt%2ByFO3bcNXUIH7i5sX1gS7pDgOE42otZhfgnqjvs281xt%2FxdyiAtfzcabnG58C%2F6LMJcKeiNXLZWzeSL%2FsIKZbRGv7%2BbTcyt4NUuw0Q8qvXsuEQa6pysO9CNZrAUmcPtXKlyDUNPvymrupyNL%2BTMEhXfQtQ9GR77FBbp2W1g6N%2BZC4U3Pyjd%2B5zay1bpkCArA0SfRd1XoibXzi71Y30tA%2FNUr4Rib62%2FqhPMoV5VVGpkLtyTBkmmVyf%2FESSQWdUjQsHkdlrlefv2cMA97YY4fWehghMcS0o3sWAL6LKEbcYmXkUd9uubUwzuGtrgY6sQGqVPKMUtXZrBKkrmums9UdPoAQiHM9bDEAcx6q6dTbsaND9EZI1kiWjVkhOtlNqyZzZiln%2BiwOaBZiB%2FQiRz7jN%2F4j0Xau5GsUBxICzxeYF6QfWg9kdjLfouuoymOG0OykNz%2FXKrjHdQ4BrNO6%2BP5iYizFhSP9s5uBbIRfMqyUWVBdXawoABdBVubTk5tCNVNh%2FWifWwE4VS1yIJoLSgY8wRQ3gW0tXMWlxD895PitKQQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e021cad46aa991410467c28541fd34a6498a84fa85f6c9b41ac43bf985fbc664"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2022-21831"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2022-09-10T19:12:29.774Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2022-08-11T19:12:28.214Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Original report: https://hackerone.com/reports/1154034\nRails advisory: https://discuss.rubyonrails.org/t/cve-2022-21831-possible-code-injection-vulnerability-in-rails-active-storage/80199\nBlogpost: https://blog.convisoappsec.com/en/cve-2022-21831-overview-of-the-security-issues-we-found-in-railss-image-processing-api/\n\nIf the report is eligible for a bounty, please split it equally between me and @rsilva, if possible.\n\n## Impact\n\nVulnerable code patterns could allow the attacker to achieve RCE.",
  "bounty_amount": "2000.0",
  "formatted_bounty": "$2,000",
  "weakness": {
    "id": 70,
    "name": "Code Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2022-09-10T19:12:28.328Z",
  "allow_singular_disclosure_after": -44997382.429308675,
  "singular_disclosure_allowed": true,
  "vote_count": 14,
  "voters": [
    "mk1338",
    "zy9ard3",
    "bl4de",
    "emanuelgustavo",
    "shivammusic",
    "yeshwanth001",
    "aelsaedy",
    "regan_temudo",
    "kskull_01",
    "protonnegativo",
    "and 4 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 80881,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/rails",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 183032,
      "category": "team",
      "content": "[CVE-2022-21831] Possible code injection vulnerability in Rails / Active Storage\n\nThere is a possible code injection vulnerability in the Active Storage module of Rails. This vulnerability has been assigned the CVE identifier CVE-2022-21831.\n\nVersions Affected: >= 5.2.0 Not affected: < 5.2.0 Fixed Versions: 7.0.2.3, 6.1.4.7, 6.0.4.7, 5.2.6.3\n\nImpact\nThere is a possible code injection vulnerability in the Active Storage module of Rails. This vulnerability impacts applications that use Active Storage with the image_processing processing in addition to the mini_magick back end for image_processing.\n\nVulnerable code will look something similar to this:\n\n<%= image_tag blob.variant(params[:t] => params[:v]) %>\nWhere the transformation method or its arguments are untrusted arbitrary input.\n\nAll users running an affected release should either upgrade or use one of the workarounds immediately.\n\nReleases\nThe fixed releases are available at the normal locations.\n\nWorkarounds\nTo work around this issue, applications should implement a strict allow-list on accepted transformation methods or arguments. Additionally, a strict image magick security policy will help mitigate this issue.\n\nImageMagick – Security Policy 70\n\nPatches\nTo aid users who aren’t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.\n\n5-2-active-storage-code-injection.patch - Patch for 5.2 series\n6-0-active-storage-code-injection.patch - Patch for 6.0 series\n6-1-active-storage-code-injection.patch - Patch for 6.1 series\n7-0-active-storage-code-injection.patch - Patch for 7.0 series\nPlease note that only the 7.0.Z, 6.1.Z, 6.0.Z, and 5.2.Z series are supported at present. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.\n\nCredits\nThanks to @gquadros_ for reporting this and Zack Deveau of Shopify for writing the patches\n\nLink to Security Advisory: https://discuss.rubyonrails.org/t/cve-2022-21831-possible-code-injection-vulnerability-in-rails-active-storage/80199\nLink to GHSA: https://github.com/advisories/GHSA-w749-p3v6-hccq",
      "user": {
        "id": 904892,
        "username": "kunderkoffler",
        "name": "Kayla Underkoffler",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2020-01-13T19:26:22.339Z",
        "url": "https://hackerone.com/kunderkoffler",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
