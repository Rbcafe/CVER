{
  "id": 1889161,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODg5MTYx",
  "url": "https://hackerone.com/reports/1889161",
  "title": "JWT audience claim is not verified",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2023-02-28T18:06:26.462Z",
  "submitted_at": "2023-02-28T18:06:26.575Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "farcaller",
    "url": "/farcaller",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQR3LOZ34E%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143455Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDWrw%2BabNi5FYA36SsKLXsWapZP8oD0cb6mlyJZlOiG%2BAiEA27B8%2Fr%2FSmYlcTxqwi5r8KNFFVvDYBNDLIZ1pULigN9cqsQUIdxADGgwwMTM2MTkyNzQ4NDkiDMDsoyRbmB2fznYP4SqOBZjZXRr4HW3gTNvoF6bdzvFgr1e7M%2BOpNIGjIPuSkr%2BbNv4pUSvE4S5VhqZAsWhc2lMKM6Bf9oBvU8aHtLZVKIg2nP7QY4Pi82JMTD6v83qvK6HMq%2BO0LEPP05zjE6rTFOMC7SrToKkZcVkZ3lWzUKGq18RnktiHbRvvRNy3SGBzhBvyiAFtMed%2BO0533NiNsVN7uOTlEx%2Bw85oqT87ZRrZR9w6pcBQpeDiMzh19WA9AUUYLPiP9pSiNVrB6k08wdqhTg%2FyVB0jNFS8u2WfrzSb7%2BoGsyZmsKqpmnxLnh8btcBepkwtzR216nLyuFvgTJmCzirFN8unanAFRHZ3qJFumdvVRfe2xS8p7F5u5mgBdDzv4mhKKoESpW32ogutCs2K20K1SKM12mcGO4BBQPJwaWRzmby5TkuByrfaYxMMwp%2BIaonr%2FCg5m9WOzNKLl7bFYfbyUhxz4I0CjRbrDboLzKq9FxRz2okU3iF6KQT3RP5urmkUImjbo69gl2Lhp1csaq%2BsPv4g30eibN5ZKAKi%2FV%2FkXhc26dpaQKRIjQYnYKK7m5Aauh9%2BgpNbdhx4C6VgAM8FJw5X04P4RMb13iT7njO5E8BMbTDOHhmCCnleZtu81gNCeGe1OWHLKa9s7RTS9U%2BMTFr8kOSUnSEuxr6z5F32VsdsLED6Rzoz5p6bKWccOP83MMhRHwxS21p4UPQAPVIlO1Y1GNfOJJT1bSstX%2FJ9e74s%2B6V6tqnsDjT%2B9%2Fl2%2FpzHlT3xbu8yqZ%2B0xN%2BqAJOtHaEp7LUa1yqoxiGD28i7FwsXDckebTHZyjbmZzLh4OHnFxKt8Ru2ahBhbCOSNIJI2hjT8EUGAdQ9sPkg4sAcKxEj4MgzDnDBqvDDP5a2uBjqxAXjDc1bWWv1wT0%2Fj5w4MwPmTV%2FMmryvYoNlEQArqMA%2Fo5WTEHb3sNECRCIjLuJJkv%2FU0alCBR0%2FF92NDKHPPmMRhnRlTrdW0hDQElJMPdIEBgNIvxoUaSZe1DtJHz1ZbRVRAzQDOizEnnvSgxTRbi6cGd57MGitOqp7nVl%2BEg7V302txJLPRb%2BDM8%2BVHdjgizI36AjILXohDhlS%2BQ2PBzXouPgj%2BRMrtc4nvrAA0DRZhkg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0d1185f7e112ce488397ab522b29716a60b2e9422f39f950e16a5e45458a3727",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQR3LOZ34E%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143455Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDWrw%2BabNi5FYA36SsKLXsWapZP8oD0cb6mlyJZlOiG%2BAiEA27B8%2Fr%2FSmYlcTxqwi5r8KNFFVvDYBNDLIZ1pULigN9cqsQUIdxADGgwwMTM2MTkyNzQ4NDkiDMDsoyRbmB2fznYP4SqOBZjZXRr4HW3gTNvoF6bdzvFgr1e7M%2BOpNIGjIPuSkr%2BbNv4pUSvE4S5VhqZAsWhc2lMKM6Bf9oBvU8aHtLZVKIg2nP7QY4Pi82JMTD6v83qvK6HMq%2BO0LEPP05zjE6rTFOMC7SrToKkZcVkZ3lWzUKGq18RnktiHbRvvRNy3SGBzhBvyiAFtMed%2BO0533NiNsVN7uOTlEx%2Bw85oqT87ZRrZR9w6pcBQpeDiMzh19WA9AUUYLPiP9pSiNVrB6k08wdqhTg%2FyVB0jNFS8u2WfrzSb7%2BoGsyZmsKqpmnxLnh8btcBepkwtzR216nLyuFvgTJmCzirFN8unanAFRHZ3qJFumdvVRfe2xS8p7F5u5mgBdDzv4mhKKoESpW32ogutCs2K20K1SKM12mcGO4BBQPJwaWRzmby5TkuByrfaYxMMwp%2BIaonr%2FCg5m9WOzNKLl7bFYfbyUhxz4I0CjRbrDboLzKq9FxRz2okU3iF6KQT3RP5urmkUImjbo69gl2Lhp1csaq%2BsPv4g30eibN5ZKAKi%2FV%2FkXhc26dpaQKRIjQYnYKK7m5Aauh9%2BgpNbdhx4C6VgAM8FJw5X04P4RMb13iT7njO5E8BMbTDOHhmCCnleZtu81gNCeGe1OWHLKa9s7RTS9U%2BMTFr8kOSUnSEuxr6z5F32VsdsLED6Rzoz5p6bKWccOP83MMhRHwxS21p4UPQAPVIlO1Y1GNfOJJT1bSstX%2FJ9e74s%2B6V6tqnsDjT%2B9%2Fl2%2FpzHlT3xbu8yqZ%2B0xN%2BqAJOtHaEp7LUa1yqoxiGD28i7FwsXDckebTHZyjbmZzLh4OHnFxKt8Ru2ahBhbCOSNIJI2hjT8EUGAdQ9sPkg4sAcKxEj4MgzDnDBqvDDP5a2uBjqxAXjDc1bWWv1wT0%2Fj5w4MwPmTV%2FMmryvYoNlEQArqMA%2Fo5WTEHb3sNECRCIjLuJJkv%2FU0alCBR0%2FF92NDKHPPmMRhnRlTrdW0hDQElJMPdIEBgNIvxoUaSZe1DtJHz1ZbRVRAzQDOizEnnvSgxTRbi6cGd57MGitOqp7nVl%2BEg7V302txJLPRb%2BDM8%2BVHdjgizI36AjILXohDhlS%2BQ2PBzXouPgj%2BRMrtc4nvrAA0DRZhkg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4c8975ccda1e1c2e940305098844e0bb84f3d58f9e875a7821f445b691c293c3"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2023-22482"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-04-16T18:43:01.524Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2023-03-17T18:42:57.904Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "All versions of Argo CD starting with v1.8.2 are vulnerable to an improper authorization bug causing the API to accept certain invalid tokens.\n\nOIDC providers include an aud (audience) claim in signed tokens. The value of that claim specifies the intended audience(s) of the token (i.e. the service or services which are meant to accept the token). Argo CD does validate that the token was signed by Argo CD's configured OIDC provider. But Argo CD does not validate the audience claim, so it will accept tokens that are not intended for Argo CD.\n\n## Impact\n\nIf Argo CD's configured OIDC provider also serves other audiences (for example, a file storage service), then Argo CD will accept a token intended for one of those other audiences. Argo CD will grant the user privileges based on the token's groups claim, even though those groups were not intended to be used by Argo CD.\n\nThis bug also increases the blast radius of a stolen token. If an attacker steals a valid token for a different audience, they can use it to access Argo CD.",
  "weakness": {
    "id": 159,
    "name": "Missing Critical Step in Authentication"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2023-04-16T18:42:57.992Z",
  "allow_singular_disclosure_after": -26164317.50321013,
  "singular_disclosure_allowed": true,
  "vote_count": 87,
  "voters": [
    "0x00bedo",
    "awhacken",
    "mrpzk",
    "p4n7h3rx",
    "n1m0",
    "haxor31337",
    "zy9ard3",
    "michiel",
    "bug_vs_me",
    "anomaly_",
    "and 77 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.0,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 154298,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/argoproj/argoproj",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 266646,
      "category": "team",
      "content": "JWT audience claim is not verified \nSeverity: Critical\n\nDescription\nImpact\nAll versions of Argo CD starting with v1.8.2 are vulnerable to an improper authorization bug causing the API to accept certain invalid tokens.\n\nOIDC providers include an aud (audience) claim in signed tokens. The value of that claim specifies the intended audience(s) of the token (i.e. the service or services which are meant to accept the token). Argo CD does validate that the token was signed by Argo CD's configured OIDC provider. But Argo CD does not validate the audience claim, so it will accept tokens that are not intended for Argo CD.\n\nIf Argo CD's configured OIDC provider also serves other audiences (for example, a file storage service), then Argo CD will accept a token intended for one of those other audiences. Argo CD will grant the user privileges based on the token's groups claim, even though those groups were not intended to be used by Argo CD.\n\nThis bug also increases the blast radius of a stolen token. If an attacker steals a valid token for a different audience, they can use it to access Argo CD.\n\nPatches\nA patch for this vulnerability has been released in the following Argo CD versions:\n\nv2.6.0-rc5\nv2.5.8\nv2.4.20\nv2.3.14\n\nCredits\nThe Argo CD team would like to express their gratitude to Vladimir Pouzanov [@farcaller](https://github.com/farcaller) from Indeed, who discovered the issue, reported it confidentially according to our guidelines, and actively worked with the project to provide a remedy. Many thanks to Vladimir!\n\nFull GHSA: https://github.com/argoproj/argo-cd/security/advisories/GHSA-q9hr-j4rf-8fjc\n\n",
      "user": {
        "id": 904892,
        "username": "kunderkoffler",
        "name": "Kayla Underkoffler",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2020-01-13T19:26:22.339Z",
        "url": "https://hackerone.com/kunderkoffler",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
