{
  "id": 1431042,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDMxMDQy",
  "url": "https://hackerone.com/reports/1431042",
  "title": "Prototype pollution via console.table properties",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2021-12-20T00:35:48.395Z",
  "submitted_at": "2021-12-20T00:35:48.498Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "rugvip",
    "url": "/rugvip",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/gb2f2ro91pobqu67wpqfoiio1edv/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 22984,
    "url": "https://hackerone.com/nodejs",
    "handle": "nodejs",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/022/984/e600648ace4a8553247bce967d461a030aa81d49_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Node.js",
      "twitter_handle": "nodejs",
      "website": "https://nodejs.org",
      "about": "The Node.js JavaScript Runtime"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2022-21824"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2022-01-11T17:23:04.445Z",
  "bug_reporter_agreed_on_going_public_at": "2022-01-11T17:23:04.348Z",
  "team_member_agreed_on_going_public_at": "2022-01-11T01:24:50.005Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\n\nAttacker control of the second `properties` parameter of `console.table` may lead to prototype pollution.\n\n**Description:**\n\nDue to the formatting logic of the `console.table` function it is not safe to allow user controlled input to be passed to the `properties` parameter while simultaneously passing a plain object with at least one property as the first parameter.\n\nThe prototype pollution has very limited control, in that it only allows an empty string to be assigned numerical keys of the object prototype.\n\n## Steps To Reproduce:\n\nThe vulnerability can be reproduced in the Node.js REPL, tested with version `v16.7.0`:\n\n  1. Run the following: `console.table({foo: 'bar'}, ['__proto__'])`\n  2. Verify that the object prototype has been polluted: `Object.prototype[0] === ''`\n\nThe pollution will vary depending on the number of properties on the object passed as the first parameter, with each additional property assigning another incrementing index of the object prototype. This means that if the first parameter is also controlled by the attacker, it is possible to assign empty strings from `0..n` to the object prototype, for any `n`:\n\n```\n> console.table({a: 1, b: 1, c: 1}, ['__proto__'])\nUncaught TypeError: Cannot create property '0' on string ''\n\n> Object.prototype\n[Object: null prototype] { '0': '', '1': '', '2': '' }\n```\n\nThe vulnerable assignment can be found [here](https://github.com/nodejs/node/blob/3f7dabdfdc9e2a3cd3f92e377755c0dd43f6751b/lib/internal/console/constructor.js#L576) in the Node.js `console.table` implementation.\n\nA suggested remediation is to ignore `properties` named `'__proto__'`, or to use a different data structure to store the computed table fields. For example:\n\n```diff\n const keys = properties || ObjectKeys(item);\n for (const key of keys) {\n+  if (key === '__proto__') {\n+    continue\n+  }\n   if (map[key] === undefined)\n     map[key] = [];\n```\n\n## Impact:\n\nUsers of `console.table` have no reason to expect the danger of passing on user input to the second `properties` array, and may therefore do so without sanitation. In the even that for example a web server is exposed to this vulnerability, it is likely to be a very effective denial of service attack. In extremely rare cases the prototype pollution can lead to more severe attack vectors such as bypassing authorization mechanisms, although due to limited control of the pollution this is unlikely.\n\n## Supporting Material/References:\n\n  * [CWE-1321: Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')](https://cwe.mitre.org/data/definitions/1321.html)\n  * [The vulnerable assignment](https://github.com/nodejs/node/blob/3f7dabdfdc9e2a3cd3f92e377755c0dd43f6751b/lib/internal/console/constructor.js#L576)\n\n## Impact\n\nUsers of `console.table` have no reason to expect the danger of passing on user input to the second `properties` array, and may therefore do so without sanitation. In the even that for example a web server is exposed to this vulnerability, it is likely to be a very effective denial of service attack. In extremely rare cases the prototype pollution can lead to more severe attack vectors such as bypassing authorization mechanisms, although due to limited control of the pollution this is unlikely.",
  "weakness": {
    "id": 106,
    "name": "Modification of Assumed-Immutable Data (MAID)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2022-02-10T01:24:50.176Z",
  "allow_singular_disclosure_after": -63377771.05795309,
  "singular_disclosure_allowed": true,
  "vote_count": 14,
  "voters": [
    "p4n7h3rx",
    "ali_shehab",
    "run_win",
    "tess",
    "ibring",
    "k_rohith",
    "official_blackhat13",
    "antmann2021",
    "obtusemoose",
    "oct0bermagic",
    "and 4 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 2.2,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 666,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/nodejs/node",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
