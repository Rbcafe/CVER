{
  "id": 1916583,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTE2NTgz",
  "url": "https://hackerone.com/reports/1916583",
  "title": "Authenticated but unauthorized users may enumerate Application names via the API",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2023-03-24T08:50:46.515Z",
  "submitted_at": "2023-03-24T08:50:46.704Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bean-zhang",
    "url": "/bean-zhang",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/uecym7bu16jik0hoj0wlt8irjlcr/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQQSQTJWE%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143532Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICMbzzKBCraFobXOcCqfodxzM%2F89seEFEtkolz9ym8yYAiEA%2Fsvto%2F251HQZfvVraGJNSEE9N05zP%2BaGv%2FBSxh9MwpMqsgUIdxADGgwwMTM2MTkyNzQ4NDkiDLRiPgXnAALYKAeN%2BSqPBWHgzJxP51a7MbYBgyoxP1LDcsLwdgUbUtgcBcVihNzgjkpkX1z4v6%2FjmlETXMHpM%2FauQHP0xGmCQhKLjGzIinKmY6tZ4kZl141nt3bExoUI5fWVsWEB7O84QdqCtoGtUZA0f1O7EIdYBJQb%2FmNKqwZEWaU%2F7PgkRk0H3XNrhegcIQuivj4XNypNwJPOxdtitDeFDYLpO12smqVJ5amk5ztkBZAoq8E%2Fxhaobm%2BP%2BcLxlPXFMWF2mULZXnUB%2BQexzDE%2FeLT2%2F%2FCafZViAqQkXNNhRc1onMPfkORBF3TWhoGrNIEBTcxPrms3Wk4KLaYQfHMpRmDn8NdWo6rpTdWGmrWp15yhtPtvFe8ReFe1qwFRwBcnvbxbIpos0u911N8KZcdmsYZha%2FoJ5gCaJUsYWiujZHGn6f5ac2aDT02iO7y%2FvFGh%2BiiCuJnTr%2FTPbUjsuYpUKRWvX0lbNazDhrREV3P7R16HgWupyfQVvDMUxflgXVEIBtoH%2F3PlfIvSwDTjDdb04Ji5mlT6sdPmo0lfcQgYurG6SnsI6MgswsJjYI2WOlv2p1tmsRt%2ByFO3bcNXUIH7i5sX1gS7pDgOE42otZhfgnqjvs281xt%2FxdyiAtfzcabnG58C%2F6LMJcKeiNXLZWzeSL%2FsIKZbRGv7%2BbTcyt4NUuw0Q8qvXsuEQa6pysO9CNZrAUmcPtXKlyDUNPvymrupyNL%2BTMEhXfQtQ9GR77FBbp2W1g6N%2BZC4U3Pyjd%2B5zay1bpkCArA0SfRd1XoibXzi71Y30tA%2FNUr4Rib62%2FqhPMoV5VVGpkLtyTBkmmVyf%2FESSQWdUjQsHkdlrlefv2cMA97YY4fWehghMcS0o3sWAL6LKEbcYmXkUd9uubUwzuGtrgY6sQGqVPKMUtXZrBKkrmums9UdPoAQiHM9bDEAcx6q6dTbsaND9EZI1kiWjVkhOtlNqyZzZiln%2BiwOaBZiB%2FQiRz7jN%2F4j0Xau5GsUBxICzxeYF6QfWg9kdjLfouuoymOG0OykNz%2FXKrjHdQ4BrNO6%2BP5iYizFhSP9s5uBbIRfMqyUWVBdXawoABdBVubTk5tCNVNh%2FWifWwE4VS1yIJoLSgY8wRQ3gW0tXMWlxD895PitKQQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=fb62176026ab6475ac5f7b0f4619a71f770c4579107f385a581f87796081b601",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQQSQTJWE%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143532Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICMbzzKBCraFobXOcCqfodxzM%2F89seEFEtkolz9ym8yYAiEA%2Fsvto%2F251HQZfvVraGJNSEE9N05zP%2BaGv%2FBSxh9MwpMqsgUIdxADGgwwMTM2MTkyNzQ4NDkiDLRiPgXnAALYKAeN%2BSqPBWHgzJxP51a7MbYBgyoxP1LDcsLwdgUbUtgcBcVihNzgjkpkX1z4v6%2FjmlETXMHpM%2FauQHP0xGmCQhKLjGzIinKmY6tZ4kZl141nt3bExoUI5fWVsWEB7O84QdqCtoGtUZA0f1O7EIdYBJQb%2FmNKqwZEWaU%2F7PgkRk0H3XNrhegcIQuivj4XNypNwJPOxdtitDeFDYLpO12smqVJ5amk5ztkBZAoq8E%2Fxhaobm%2BP%2BcLxlPXFMWF2mULZXnUB%2BQexzDE%2FeLT2%2F%2FCafZViAqQkXNNhRc1onMPfkORBF3TWhoGrNIEBTcxPrms3Wk4KLaYQfHMpRmDn8NdWo6rpTdWGmrWp15yhtPtvFe8ReFe1qwFRwBcnvbxbIpos0u911N8KZcdmsYZha%2FoJ5gCaJUsYWiujZHGn6f5ac2aDT02iO7y%2FvFGh%2BiiCuJnTr%2FTPbUjsuYpUKRWvX0lbNazDhrREV3P7R16HgWupyfQVvDMUxflgXVEIBtoH%2F3PlfIvSwDTjDdb04Ji5mlT6sdPmo0lfcQgYurG6SnsI6MgswsJjYI2WOlv2p1tmsRt%2ByFO3bcNXUIH7i5sX1gS7pDgOE42otZhfgnqjvs281xt%2FxdyiAtfzcabnG58C%2F6LMJcKeiNXLZWzeSL%2FsIKZbRGv7%2BbTcyt4NUuw0Q8qvXsuEQa6pysO9CNZrAUmcPtXKlyDUNPvymrupyNL%2BTMEhXfQtQ9GR77FBbp2W1g6N%2BZC4U3Pyjd%2B5zay1bpkCArA0SfRd1XoibXzi71Y30tA%2FNUr4Rib62%2FqhPMoV5VVGpkLtyTBkmmVyf%2FESSQWdUjQsHkdlrlefv2cMA97YY4fWehghMcS0o3sWAL6LKEbcYmXkUd9uubUwzuGtrgY6sQGqVPKMUtXZrBKkrmums9UdPoAQiHM9bDEAcx6q6dTbsaND9EZI1kiWjVkhOtlNqyZzZiln%2BiwOaBZiB%2FQiRz7jN%2F4j0Xau5GsUBxICzxeYF6QfWg9kdjLfouuoymOG0OykNz%2FXKrjHdQ4BrNO6%2BP5iYizFhSP9s5uBbIRfMqyUWVBdXawoABdBVubTk5tCNVNh%2FWifWwE4VS1yIJoLSgY8wRQ3gW0tXMWlxD895PitKQQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=515bd60910ca803e4e7bc872f809758f636aca28f2a64727b08a7e40c90b9bd6"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2022-41354"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2023-05-25T19:49:06.641Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2023-04-25T19:49:02.481Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "All versions of Argo CD starting with v0.5.0 are vulnerable to an information disclosure bug allowing unauthorized users to enumerate application names by inspecting API error messages. \n\nSTEPS:\n1. Login argocd with a user who has not application module's priviledge.\n2. The user request 'api/v1/application/**/logs' restful api to download a log file.\n3. The log file's content lead a information disclosure bug, which allowing unauthorized users to enumerate application names by inspecting API error messages. The error messages like 'error gettingg applicaiton by name: ** not found'.\n\n## Impact\n\nAn attacker could use the discovered application names as the starting point of another attack. For example, the attacker might use their knowledge of an application name to convince an administrator to grant higher privileges (social engineering).",
  "bounty_amount": "2400.0",
  "formatted_bounty": "$2,400",
  "weakness": {
    "id": 82,
    "name": "Information Exposure Through an Error Message"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 2248545,
      "file_name": "argocd-application_enum_issue.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/wx14nx3dqmrnjujlt3hl28t329oa?response-content-disposition=attachment%3B%20filename%3D%22argocd-application_enum_issue.mp4%22%3B%20filename%2A%3DUTF-8%27%27argocd-application_enum_issue.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQQSQTJWE%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T143532Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICMbzzKBCraFobXOcCqfodxzM%2F89seEFEtkolz9ym8yYAiEA%2Fsvto%2F251HQZfvVraGJNSEE9N05zP%2BaGv%2FBSxh9MwpMqsgUIdxADGgwwMTM2MTkyNzQ4NDkiDLRiPgXnAALYKAeN%2BSqPBWHgzJxP51a7MbYBgyoxP1LDcsLwdgUbUtgcBcVihNzgjkpkX1z4v6%2FjmlETXMHpM%2FauQHP0xGmCQhKLjGzIinKmY6tZ4kZl141nt3bExoUI5fWVsWEB7O84QdqCtoGtUZA0f1O7EIdYBJQb%2FmNKqwZEWaU%2F7PgkRk0H3XNrhegcIQuivj4XNypNwJPOxdtitDeFDYLpO12smqVJ5amk5ztkBZAoq8E%2Fxhaobm%2BP%2BcLxlPXFMWF2mULZXnUB%2BQexzDE%2FeLT2%2F%2FCafZViAqQkXNNhRc1onMPfkORBF3TWhoGrNIEBTcxPrms3Wk4KLaYQfHMpRmDn8NdWo6rpTdWGmrWp15yhtPtvFe8ReFe1qwFRwBcnvbxbIpos0u911N8KZcdmsYZha%2FoJ5gCaJUsYWiujZHGn6f5ac2aDT02iO7y%2FvFGh%2BiiCuJnTr%2FTPbUjsuYpUKRWvX0lbNazDhrREV3P7R16HgWupyfQVvDMUxflgXVEIBtoH%2F3PlfIvSwDTjDdb04Ji5mlT6sdPmo0lfcQgYurG6SnsI6MgswsJjYI2WOlv2p1tmsRt%2ByFO3bcNXUIH7i5sX1gS7pDgOE42otZhfgnqjvs281xt%2FxdyiAtfzcabnG58C%2F6LMJcKeiNXLZWzeSL%2FsIKZbRGv7%2BbTcyt4NUuw0Q8qvXsuEQa6pysO9CNZrAUmcPtXKlyDUNPvymrupyNL%2BTMEhXfQtQ9GR77FBbp2W1g6N%2BZC4U3Pyjd%2B5zay1bpkCArA0SfRd1XoibXzi71Y30tA%2FNUr4Rib62%2FqhPMoV5VVGpkLtyTBkmmVyf%2FESSQWdUjQsHkdlrlefv2cMA97YY4fWehghMcS0o3sWAL6LKEbcYmXkUd9uubUwzuGtrgY6sQGqVPKMUtXZrBKkrmums9UdPoAQiHM9bDEAcx6q6dTbsaND9EZI1kiWjVkhOtlNqyZzZiln%2BiwOaBZiB%2FQiRz7jN%2F4j0Xau5GsUBxICzxeYF6QfWg9kdjLfouuoymOG0OykNz%2FXKrjHdQ4BrNO6%2BP5iYizFhSP9s5uBbIRfMqyUWVBdXawoABdBVubTk5tCNVNh%2FWifWwE4VS1yIJoLSgY8wRQ3gW0tXMWlxD895PitKQQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=da2d9b53b7926b59a3149cc433a5d740205ce4022651a853e166f90511ab5212",
      "file_size": 18154118,
      "type": "video/mp4",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2023-05-25T19:49:02.560Z",
  "allow_singular_disclosure_after": -22790790.08555018,
  "singular_disclosure_allowed": true,
  "vote_count": 9,
  "voters": [
    "zy9ard3",
    "bl4de",
    "kerolesmagdy",
    "bean-zhang",
    "sudarshan_xx",
    "maria_smith1346",
    "alsufyani1",
    "ohhhey",
    "anonymouss25"
  ],
  "severity": {
    "rating": "medium",
    "score": 5.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 154298,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/argoproj/argoproj",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 284261,
      "category": "team",
      "content": "Authenticated but unauthorized users may enumerate Application names via the API\n\nImpact\nAll versions of Argo CD starting with v0.5.0 are vulnerable to an information disclosure bug allowing unauthorized users to enumerate application names by inspecting API error messages. An attacker could use the discovered application names as the starting point of another attack. For example, the attacker might use their knowledge of an application name to convince an administrator to grant higher privileges (social engineering).\n\nMany Argo CD API endpoints accept an application name as the only parameter. Since Argo CD RBAC requires both the application name and its configured project name (and, if apps-in-any-namespace is enabled, the application's namespace), Argo CD fetches the requested application before performing the RBAC check. If the application does not exist, the API returns a \"not found\". If the application does exist, and the user does not have access, the API returns an \"unauthorized\" error. By trial and error, an attacker can infer which applications exist and which do not.\n\nNote that application resources are not fetched for API calls from unauthenticated users. If your Argo CD instance is accessible from the public internet, unauthenticated users will not be able to cause Argo CD to make Kubernetes API calls.\n\nThe patch changes API behavior to return \"unauthorized\" both when the application is missing and when the user is not authorized to access it. This change in API behavior may impact API clients. Check your code to make sure it will handle the new API behavior properly.\n\nPatches\nA patch for this vulnerability has been released in the following Argo CD versions:\n\nv2.6.7\nv2.5.16\nv2.4.28\nWorkarounds\nThere are no workarounds besides upgrading.\n\nCredits\nThank you to bean.zhang of HIT-IDS ChunkL Team who discovered the issue and reported it confidentially according to our guidelines.\n\nFull GHSA: https://github.com/argoproj/argo-cd/security/advisories/GHSA-2q5c-qw9c-fmvq",
      "user": {
        "id": 904892,
        "username": "kunderkoffler",
        "name": "Kayla Underkoffler",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2020-01-13T19:26:22.339Z",
        "url": "https://hackerone.com/kunderkoffler",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
