{
  "id": 1024899,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMDI0ODk5",
  "url": "https://hackerone.com/reports/1024899",
  "title": "file read on MCS servers via supplying a QCOW2 image with external backing file",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2020-11-03T01:02:04.543Z",
  "submitted_at": "2020-11-03T01:02:04.562Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "neex",
    "url": "/neex",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/mxguogqjdb4jdwjc379o0se6457e/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 65,
    "url": "https://hackerone.com/mailru",
    "handle": "mailru",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mail.ru",
      "twitter_handle": "",
      "website": "https://vk.company/",
      "about": "Building the Internet since 1998"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-03-19T10:04:50.070Z",
  "bug_reporter_agreed_on_going_public_at": "2021-03-18T18:06:29.657Z",
  "team_member_agreed_on_going_public_at": "2021-03-19T10:04:49.916Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "bounty_amount": "15000.0",
  "formatted_bounty": "$15,000",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-04-17T18:06:29.768Z",
  "allow_singular_disclosure_after": -89149906.4968044,
  "singular_disclosure_allowed": true,
  "vote_count": 220,
  "voters": [
    "velozs",
    "act1on3",
    "secseth",
    "mathec",
    "ec0",
    "dninjadave",
    "th3hidd3nmist",
    "n1m0",
    "sw33tlie",
    "ralamosm",
    "and 210 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 8.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 40416,
    "asset_type": "OTHER",
    "asset_identifier": "Mail.Ru Cloud Solutions (MCS)",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 31855,
      "category": "team",
      "content": "Local file read in mcs.mail.ru by providing QCOW2 disk image with backing image pointing to external file",
      "user": {
        "id": 4836,
        "username": "3apa3a",
        "name": "Vladimir Dubrovin",
        "bio": "En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ",
        "cleared": false,
        "verified": false,
        "website": "https://3proxy.org/",
        "location": "Nizhny Novgorod, Russia",
        "created_at": "2014-04-10T22:08:47.745Z",
        "url": "https://hackerone.com/3apa3a",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "id": 31856,
      "category": "researcher",
      "content": "Mail.ru Cloud Solutions allows uploading custom images for disks. This functionality supported QCOW2 disk images. A QCOW2 disk image can have a so-called \"backing image\" - a file to read sectors not present in the original image.\n\nAn attacker could upload a QCOW2 disk image with some external file (e.g. /etc/passwd) set as a backing image. The image was (presumably) converted to another format inside MCS infrastructure, capturing the file's contents from one of the MCS's servers. The attacker could retrieve it by attaching the drive to an instance and reading the first bytes of /dev/vdb.\n\nTo create a QCOW2 image that is backed by a file, one can use the following command:\n\n```\nqemu-img create -f qcow2 -b /etc/hostname -u -F file pizda.qcow2 1024000\n```\n\nAfter that, `pizda.qcow2` could be uploaded as a custom drive image in the MCS interface and attached to an instance. The contents of `/etc/hostname` from some MCS server could be retrieved by looking through the attached drive's first bytes (e.g. ` head -c 32000 /dev/vdb`).\n\nDespite `qemu-img` supports http backing images as well, I could not get it working. To create an image that is backed by a remote file (and, presumably, achieve SSRF), one can use something like this:\n\n```\nqemu-img create -f qcow2 -b http://some.internal.host/ -u -F http pizda.qcow2 1024000\n```\n",
      "user": {
        "id": 14987,
        "username": "neex",
        "name": "Emil Lerner",
        "bio": "",
        "cleared": false,
        "verified": true,
        "website": null,
        "location": "",
        "created_at": "2014-12-06T13:42:40.171Z",
        "url": "https://hackerone.com/neex",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/mxguogqjdb4jdwjc379o0se6457e/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/mxguogqjdb4jdwjc379o0se6457e/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/mxguogqjdb4jdwjc379o0se6457e/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
