{
  "id": 84287,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NDI4Nw==",
  "url": "https://hackerone.com/reports/84287",
  "title": "DKIM records not present, Email Hijacking is possible",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2015-08-24T06:01:50.086Z",
  "submitted_at": "2015-08-24T06:01:50.086Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ashesh",
    "url": "/ashesh",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/003/791/220e701eb9be549162dfdb1da9b1a1b72ee2dd08_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1868,
    "url": "https://hackerone.com/gratipay",
    "handle": "gratipay",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Gratipay",
      "twitter_handle": "Gratipay",
      "website": "https://gratipay.com/",
      "about": "Gratitude? Gratipay! The easiest way for your company to pay for open source."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2015-09-23T19:52:19.182Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2015-08-24T19:52:13.529Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Your SPF record is \r\n\r\n`v=spf1 include:email.freshdesk.com include:spf.mandrillapp.com include:_spf.google.com -all`\r\nWhich very well shows that you don't want **spoofed** email to be sent from your domains, but you just forget one thing: \r\n\r\nDKIM (DomainKeys Identified Mail) is an important authentication mechanism to help protect both email receivers and email senders from forged and phishing email. Forged email is a serious threat to all parties in an email exchange.\r\n\r\nDomainKeys Identified Mail (DKIM) is an email validation system designed to detect email spoofing by providing a mechanism to allow receiving mail exchangers to check that incoming mail from a domain is authorized by that domain's administrators and that the email (including attachments) has not been modified during transport. A digital signature included with the message can be validated by the recipient using the signer's public key published in the DNS. In technical term, DKIM is a technique to authorize the domain name which is associated with a message through cryptographic authentication.\r\n \r\n\r\nDKIM was aimed at:\r\n \r\nReducing false negatives\r\nProvide authentication reporting\r\nApply sender policies at the receiving end\r\nReduce phishing\r\nBe scalable\r\n\r\n#Advantages:\r\n\r\n1. Use with spam filtering\r\n\r\nDKIM is a method of labeling a message, and it does not itself filter or identify spam. However, widespread use of DKIM can prevent spammers from forging the source address of their messages, a technique they commonly employ today. If spammers are forced to show a correct source domain, other filtering techniques can work more effectively. In particular, the source domain can feed into a reputation system to better identify spam. Conversely, DKIM can make it easier to identify mail that is known not to be spam and need not be filtered. If a receiving system has a whitelist of known good sending domains, either locally maintained or from third party certifiers, it can skip the filtering on signed mail from those domains, and perhaps filter the remaining mail more aggressively.\r\n\r\n2. Anti-phishing\r\n\r\nDKIM can be useful as an anti-phishing technology. Mailers in heavily phished domains can sign their mail to show that it is genuine. Recipients can take the absence of a valid signature on mail from those domains to be an indication that the mail is probably forged. The best way to determine the set of domains that merit this degree of scrutiny remains an open question; DKIM has an optional feature called ADSP that lets authors that sign all their mail self-identify, but the effectiveness of this approach is questionable, and ADSP was demoted to historic status in November 2013\r\n\r\n3. Compatibility\r\n\r\nBecause it is implemented using DNS records and an added RFC 5322 header field, DKIM is compatible with the existing e-mail infrastructure. In particular, it is transparent to existing e-mail systems that lack DKIM support\r\n\r\n4. Protocol overhead\r\n\r\nDKIM requires cryptographic checksums to be generated for each message sent through a mail server, which results in computational overhead not otherwise required for e-mail delivery. This additional computational overhead is a hallmark of digital postmarks, making sending bulk spam more (computationally) expensive.his facet of DKIM may look similar to hashcash, except that the receiver side verification is not a negligible amount of work.\r\n \r\n  \r\n\r\n Generate your DKIM easily here: http://dkimcore.org/tools/keys.html\r\n  \r\n \r\n\r\nYou can read more about DKIM records and their uses here: http://www.gettingemaildelivered.com/dkim-explained-how-to-set-up-and-use-domainkeys-identified-mail-effectively.\r\n_________________________________________________________________________________________________\r\n**Why should you implement this**\r\n\r\nWhen I try to send a spoofed email from your domain to anyone like from `support@gratipay.com to `abcd@example.com`\r\n\r\nThey get the simple spoofed message which shows no sign of fakeness to any normal user.\r\n\r\nLike this : http://ultraimg.com/images/fd74d04ff463.png\r\n\r\n\r\nBut when a domain has DKIM record then they get this \r\n\r\n\thttp://i.gyazo.com/59c6acf761ff010bb16aa93d19c6fc39.png\r\n\r\nThe main point here is that DKIM prevents spoofing by adding this line:\r\n\r\n>It has a from address in mailjet.com but has failed mailjet.com's required tests for authentication.\r\n\r\nNow, thats how DKIM comes to rescue\r\n\r\n_____________________________________________________________________________________________\r\n\r\nThe following command \"nslookup -querytype=TXT google._domainkey.gratipay.com  8.8.8.8\"\r\n\r\nGive the follwong detail:\r\nNo DKIM record published.\r\n\r\nWhich shows that you are missing this security feature.\r\n\r\nYou should publish a valid DKIM record for your domain to prevent any misunderstanding and to prevent hackers from using your email.\r\n\r\nDKIM for `hackerone.com`:\r\n\r\n    v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCNUXaBB+MhTVs2lNbWVHC60n2peEysniIKqI90SJDKN6tmZhN4zURif+X7r52lJtvm0aaYJ6IFOgHYteDynOBrLlFicW9LWsiXXHdljElgIFGlzMeHKVxx3qG7xcGxQ3gVMvVL9ibhFQnK+rnttPBlRqSaiqkcTZlHm4cMh3SXuQIDAQAB\r\n",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2015-09-23T19:52:13.777Z",
  "allow_singular_disclosure_after": -264786751.97016072,
  "singular_disclosure_allowed": true,
  "vote_count": 1,
  "voters": [
    "shivammusic"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
