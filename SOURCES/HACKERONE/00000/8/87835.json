{
  "id": 87835,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzgzNQ==",
  "url": "https://hackerone.com/reports/87835",
  "title": "Webview Vulnerablity [OwnCloudAndroid Application] ",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-09-07T11:57:09.447Z",
  "submitted_at": "2015-09-07T11:57:09.447Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "avicoder_",
    "url": "/avicoder_",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tebnvtakyjc0ckvduj113lbf42oo/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 3059,
    "url": "https://hackerone.com/owncloud",
    "handle": "owncloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/003/059/d31dc64427bbbf2e428a0b0b97bce59b98d2ba0d_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "ownCloud",
      "twitter_handle": "ownCloud",
      "website": "https://www.owncloud.com",
      "about": "ownCloud GmbH is the company behind the ownCloud Project - the most downloaded open source project for data and file sync, share and view."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2013-4710"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2015-10-11T07:04:45.321Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2015-09-11T07:04:40.170Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi **OwnCloud Team** ,\r\n\r\n###Vulnerability Description:###\r\n\r\n**What is Webview?:** We can load a remote URL or display HTML pages stored in our application within an activity using WebView. Internally it uses WebKit rendering engine to display web pages. It supports methods to navigate forward and backward, text searches, etc. It has some nice features such as support for the usage of JavaScript.\r\n\r\n###Where I found it?###\r\n\r\nIn **SamlWebViewDialog.java.class** located under the path ` android/src/com/owncloud/android/ui/dialog/` \r\n\r\nI clipped the important code which introduced this vulnerability in your app.\r\n\r\n            if (mSsoWebView == null) {\r\n            // initialize the WebView\r\n            mSsoWebView = new SsoWebView(getActivity().getApplicationContext());\r\n            mSsoWebView.setFocusable(true);\r\n            mSsoWebView.setFocusableInTouchMode(true);\r\n            mSsoWebView.setClickable(true);\r\n            \r\n            WebSettings webSettings = mSsoWebView.getSettings();\r\n            webSettings.setJavaScriptEnabled(true);\r\n            webSettings.setBuiltInZoomControls(false);\r\n            webSettings.setLoadWithOverviewMode(false);\r\n            webSettings.setSavePassword(false);\r\n            webSettings.setUserAgentString(MainApp.getUserAgent());\r\n            webSettings.setSaveFormData(false);\r\n            \r\n            CookieManager cookieManager = CookieManager.getInstance();\r\n            cookieManager.setAcceptCookie(true);\r\n            cookieManager.removeAllCookie();\r\n            \r\n            mSsoWebView.loadUrl(mInitialUrl);\r\n        }\r\n        \r\n\r\nhere you can see that:\r\n\r\n    `webSettings.setJavaScriptEnabled(true);`\r\n\r\nThe *WebView* Object been activated to parse javascript inside it.\r\n\r\n**However by default when we create an WebView object JavaScript is disabled by default until and unless it explicitly declare by the developer.** \r\n\r\nThe untrusted Javascript code can call into the Java Reflection APIs exposed by the Interface and execute arbitrary commands. Some distributions of the Android Browser app have an addJavascriptInterface call tacked on, and thus are vulnerable to RCE.\r\n\r\n###Mitigation:###\r\n\r\nIf you turn off the setJavaScriptEnabled as follows, adversaries will not be able to run any JavaScript in order to perform XSS \r\n`webSettings.setJavaScriptEnabled(False);`\r\n\r\n\r\n###SEVERITY: High ###\r\n\r\nIt is not just limited to XSS because of javascript ! In fact, using this, an attacker can even use JavaScript to invoke certain methods on the phone, such as sending an SMS to another number, making a call, or even getting a remote shell using tools such as Drozer.\r\n\r\n**I highly recommend my article on github for the mitgation and understanding of the attack**\r\n\r\n##https://github.com/vjex/WriteUp/blob/master/WebviewVuln.md##\r\n\r\n###More References:###\r\n\r\n   - http://www.wintellect.com/devcenter/paulballard/new-report-sites-significant-security-vulnerabilities-in-android-devices\r\n   - http://www.cvedetails.com/cve/CVE-2013-4710/\r\n   - https://community.rapid7.com/community/metasploit/blog/2015/01/02/2014-a-year-of-android-exploits-in-metasploit\r\n   - https://github.com/jduck/VulnWebView/\r\n\r\n**Happy to help.**\r\nCheers\r\n#:)#\r\n\r\n@avicoder",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2015-10-11T07:04:44.827Z",
  "allow_singular_disclosure_after": -263277657.99389312,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "shivammusic",
    "amohar",
    "ceortiz"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
