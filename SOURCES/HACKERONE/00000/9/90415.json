{
  "id": 90415,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85MDQxNQ==",
  "url": "https://hackerone.com/reports/90415",
  "title": "CSV Excel Macro Injection in Export Response",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-09-25T09:56:40.981Z",
  "submitted_at": "2015-09-25T09:56:40.981Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "alyssa_herrera",
    "url": "/alyssa_herrera",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/PGiKyhRYWCkCp45rkdBZUAvL/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 695,
    "url": "https://hackerone.com/zaption",
    "handle": "zaption",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/695/b8975893f4c9838f55b4f656bc93528666fa68ba_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/695/b8975893f4c9838f55b4f656bc93528666fa68ba_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Zaption",
      "twitter_handle": "zaption",
      "website": "http://www.zaption.com",
      "about": "Interactive video for learning."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2015-10-01T18:05:37.417Z",
  "bug_reporter_agreed_on_going_public_at": "2015-10-01T17:47:28.100Z",
  "team_member_agreed_on_going_public_at": "2015-10-01T18:05:37.315Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Scenario: An attacker creates a response like =AND(2>1) in a tour that allows open response or discussion.  Then when a user who created this tour clicks analytic and clicks to export responses as csv, he will see TRUE instead of  =AND(1>2) Meaning that cell is now active, and an attacker could make a response  using a malicious function to execute malware on a team member's pc. Since functions aren't escaped, the possibilities of using this can be limitless and can cause a severe impact. One example is having it execute malware on staff's computer as seen below, leveraging cmd to execute commands.\n\nCrude Poc for executing cmd\nuse -2+3+cmd|' /C calc'!D2 and could execute malicious commands through CMD. \nD2 is the cell it's located in.\n\n\nThis can be adapted to other spread sheet views like Libre as well\nAlthough excel has a feature to block this by tell a user that it wants to execute an external script, the team member would believe it's a trusted file coming from a trusted website and you will have a very high chance of this being executed. Seeing that it's generated by your site, they may believe it's an enhance functionality of it to stream line data viewing.\n\nBest way to mitigate this vulnerability is if you append ' to the list of triggers, = , + , - Excel will ignore the ' and just show ='AND(2>1) instead\n\nSource: https://www.owasp.org/index.php/CSV_Excel_Macro_Injection\n\n\n\n",
  "weakness": {
    "id": 58,
    "name": "Command Injection - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2015-10-31T17:47:28.200Z",
  "allow_singular_disclosure_after": -261511124.39364034,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "alyssa_herrera",
    "shivammusic",
    "spetr0x"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
