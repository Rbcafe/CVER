{
  "id": 64941,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NDk0MQ==",
  "url": "https://hackerone.com/reports/64941",
  "title": "Header Misconfiguration - PHP API",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-05-30T18:12:37.773Z",
  "submitted_at": "2015-05-30T18:12:37.773Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "paulos__",
    "url": "/paulos__",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/008/601/abf2077609ef0546be8676abd1bec49aaefc9ff2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2015-06-11T19:56:43.885Z",
  "bug_reporter_agreed_on_going_public_at": "2015-06-11T19:56:43.484Z",
  "team_member_agreed_on_going_public_at": "2015-06-11T19:56:34.528Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hey,\r\n\r\nYour index api page auth can easily be bypassed because it doesn't use proper auth practices in its PHP core. Here is the master code from Shopify: \r\n\r\nhttps://github.com/Shopify/shopify_php_api/blob/master/index.php\r\n\r\nit says:\r\n\r\nif (!isset($_SESSION['shop']) || !isset($_SESSION['token'])) header(\"Location: login.php\");\r\n\r\nThis easily can be bypassed because the browser can decide to receive 301/302 redirects. and since if not logged in, the code tries to decide to redirect back to the login page, and the browser can ignore it. this can create an authentication bypass and also full path disclosure.\r\n\r\n I have written a similar example in my blog, http://www.paulosyibelo.com/2014/08/header-based-login-bypass.html\r\n\r\nP.S: The issue exists not only on the index.php page, but in almost every page. (ex: https://github.com/Shopify/shopify_php_api/blob/master/login.php)\r\n\r\nThe best practice I would recommend would be creating another function instead of the header one, like:\r\n\r\nfunction redirect($url){\r\n    header(\"Location: $url\");\r\n    exit();\r\n}\r\n\r\nThe easiest approch is to exit(); the code after the redirection. or else, the rest of the page still renders no matter what. I hope I don't need to provide a POC as its a crystal clear bug (also with the link).\r\n\r\nThanks,",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2015-07-11T19:56:34.703Z",
  "allow_singular_disclosure_after": -271179866.7085848,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "drsniper",
    "b01763066cbe8d45b934cce",
    "shivammusic"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
