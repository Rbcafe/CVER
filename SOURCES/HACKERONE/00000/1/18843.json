{
  "id": 18843,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODg0Mw==",
  "url": "https://hackerone.com/reports/18843",
  "title": "use-after-free vulnerability in Flash Player",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2014-07-03T05:06:17.257Z",
  "submitted_at": "2014-07-03T05:06:17.257Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "yopwn",
    "url": "/yopwn",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJAEOSEA%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T113042Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIFGoM7UVkpoUFXOwmBO1YCW3cw%2F4NyxP2Yan%2BgrkBav8AiEAyCUaZteSGAOL1VybC9wE4FNtA9ZRB0rOhRCfRb1SJtUqsgUIcBADGgwwMTM2MTkyNzQ4NDkiDK4laJFhO348YrQkpSqPBT0JpdttzMzvj7d49wHxo6XKhZp6ShyKPYUpw0Uq4AHmWnLgN8g%2BsTPzAignfCeJBrRSLMJVkOL0W5ter7990DhqIASPNW1EZwrDyGA7kuePP%2BF4tcrX3LO0OOR6gGZx9EtA5T7iJB1DFapuW5N7q%2F51A5Mu7ZLK0NaZo8zhsohgiWzzyR2iluk%2FLl3XGm%2Fa6%2BcTwHua%2BNjD%2F97XLRv1zF3YE7sSdAY3bunMdQ6NaH%2BxtZj7FOWcsouUYmSWYMItq7rFc2QX6eLL04LoQhGF%2BsAlIJRuG9morj%2FzbUBeITu4Wjw1YqZoqh4stcI25Q3hf6RXlfWGW%2FpPgFVXTaKeiqdUSu86Hp0mtdhvWjZ%2F3frTMpqYRrp2a1mbGWETUc5Uf0mzI3H5oA%2B3GNQfu3cWaPp6Vj5kQ0fBwtej92wxqBKYcwQGX1OqkYgzXEkCCIsQfZxhAaPTN%2FtgMRJ58JVzNuHtKdPerJm1tZ8fQ6tljGtPSMxjFhDzyA9m9NHez5izRf7KqXOVO9vYJFw%2Fi00wL4IHCuGJag8I%2Fxka6p1qKR%2BLgjmHhEme4qKwVcZHLFn9ks9Opq5yjYs0%2BDnJLzW8EoTTImazBY6PuaPKcKQY8cuOfRLUWHjfDoiEvtTVUk8hNiRL7PEmq8TnurN%2BlvDbNHfB1bc7T4OkQ0bkDfDKxp%2Bw6kMpFfLzp3zMh4sVkCicAf8phxPfZ3ImBweoHetjdWVM%2FAaqoQFfIvSuNFRLjBRBvd1PbhmnN5Jq5WNPDsGhoXmnlt9dIMyM30uqRrm5JWVLqPt5x3tJ%2F6XEKfiDRzBMK4wT7DJ94Iud7aggpV%2BQl9JVRf86hwRXR9rFbvmmDTUka9kitEZLd%2FlL7mfvrF8wlKGsrgY6sQG6xY6iPHcuzMUPYlF%2BiPLSQhv%2F6pGqgLnKtUql08pwI3ttBcBcKWvZH4WOc5lXL1qEfHHkJQ1HwYwKvH5vG3URLBINtmvkDZGhy%2F605sBLv1QwPSjd91a2Orn1TKno6iqHfQCQTcPrP0NyRztLXpdgkxXv3JyY%2FNXpBhGdrABNb%2BwkB78q7U4iWLt6tducslFnRZ4D7lUbbNW%2FhxyDCkCcwec2EWKyZiZLijLaLBQG2P4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=017f7a4d0c6094da2a535a6042d6cb1037069be21a8fc9d1b748a98c5cb5838a",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJAEOSEA%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T113042Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIFGoM7UVkpoUFXOwmBO1YCW3cw%2F4NyxP2Yan%2BgrkBav8AiEAyCUaZteSGAOL1VybC9wE4FNtA9ZRB0rOhRCfRb1SJtUqsgUIcBADGgwwMTM2MTkyNzQ4NDkiDK4laJFhO348YrQkpSqPBT0JpdttzMzvj7d49wHxo6XKhZp6ShyKPYUpw0Uq4AHmWnLgN8g%2BsTPzAignfCeJBrRSLMJVkOL0W5ter7990DhqIASPNW1EZwrDyGA7kuePP%2BF4tcrX3LO0OOR6gGZx9EtA5T7iJB1DFapuW5N7q%2F51A5Mu7ZLK0NaZo8zhsohgiWzzyR2iluk%2FLl3XGm%2Fa6%2BcTwHua%2BNjD%2F97XLRv1zF3YE7sSdAY3bunMdQ6NaH%2BxtZj7FOWcsouUYmSWYMItq7rFc2QX6eLL04LoQhGF%2BsAlIJRuG9morj%2FzbUBeITu4Wjw1YqZoqh4stcI25Q3hf6RXlfWGW%2FpPgFVXTaKeiqdUSu86Hp0mtdhvWjZ%2F3frTMpqYRrp2a1mbGWETUc5Uf0mzI3H5oA%2B3GNQfu3cWaPp6Vj5kQ0fBwtej92wxqBKYcwQGX1OqkYgzXEkCCIsQfZxhAaPTN%2FtgMRJ58JVzNuHtKdPerJm1tZ8fQ6tljGtPSMxjFhDzyA9m9NHez5izRf7KqXOVO9vYJFw%2Fi00wL4IHCuGJag8I%2Fxka6p1qKR%2BLgjmHhEme4qKwVcZHLFn9ks9Opq5yjYs0%2BDnJLzW8EoTTImazBY6PuaPKcKQY8cuOfRLUWHjfDoiEvtTVUk8hNiRL7PEmq8TnurN%2BlvDbNHfB1bc7T4OkQ0bkDfDKxp%2Bw6kMpFfLzp3zMh4sVkCicAf8phxPfZ3ImBweoHetjdWVM%2FAaqoQFfIvSuNFRLjBRBvd1PbhmnN5Jq5WNPDsGhoXmnlt9dIMyM30uqRrm5JWVLqPt5x3tJ%2F6XEKfiDRzBMK4wT7DJ94Iud7aggpV%2BQl9JVRf86hwRXR9rFbvmmDTUka9kitEZLd%2FlL7mfvrF8wlKGsrgY6sQG6xY6iPHcuzMUPYlF%2BiPLSQhv%2F6pGqgLnKtUql08pwI3ttBcBcKWvZH4WOc5lXL1qEfHHkJQ1HwYwKvH5vG3URLBINtmvkDZGhy%2F605sBLv1QwPSjd91a2Orn1TKno6iqHfQCQTcPrP0NyRztLXpdgkxXv3JyY%2FNXpBhGdrABNb%2BwkB78q7U4iWLt6tducslFnRZ4D7lUbbNW%2FhxyDCkCcwec2EWKyZiZLijLaLBQG2P4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2a62766cc441a89e498dd311a8fcaaee3464192d77953d441cbfa899185c9d8b"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-11-12T09:44:13.020Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2019-10-13T09:44:10.141Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "It looks there is an use-after-free vulnerability in Adobe Flash Player when it's working with Internet Explorer. Following are the steps to reproduce the crash:\r\n\r\n1. The OS is Windows 7 x64 with IE 11, Flash Player is the latest 14.0.0.125, all is fully updated. Please use the 64bit Windows since I found it's not easy to trigger it on 32bit.\r\n2. To trigger the vulnerability better, let's enable page heap for IE, using the command \"gflags.exe /p /enable iexplore.exe /full\".\r\n3. Serve the attached \"repro.html\" file (password: \"infected\") to a http sever.\r\n\r\nVisit the \"repro.html\" like \"http://10.10.10.1/repro.html\", it will take you about 30 seconds to redirect to another url \"http://damncok.blogspot.com\", as you may find the following html in the beginning:\r\n\r\n--\r\n<meta content='30;URL=http://damncok.blogspot.com/' http-equiv='refresh'/>\r\n--\r\n\r\nSometimes, IE will crash at the moment when it's redirecting to the \"http://damncok.blogspot.com\", if it doesn't crash, try close the IE after the page \"http://damncok.blogspot.com\" is loaded. Anyway, you will see a crash like:\r\n\r\n--\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\nerror: out of memory\r\nerror: out of memory\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): C++ EH exception - code e06d7363 (first chance)\r\n(670.1050): Access violation - code c0000005 (first chance)\r\nFirst chance exceptions are reported before any exception handling.\r\nThis exception may be expected and handled.\r\n20296425 ??              ???\r\n1:020:x86> kv\r\nChildEBP RetAddr  Args to Child             \r\nWARNING: Frame IP not in any known module. Following frames may be wrong.\r\n0a52c21c 68c6513f 38fa0000 68fba654 38fa0000 0x20296425\r\n0a52c224 68fba654 38fa0000 0a52c270 0a52c328 Flash32_14_0_0_125!DllUnregisterServer+0xa725d\r\n0a52c238 68fba7a1 0a52c270 00000001 00000000 Flash32_14_0_0_125!IAEModule_IAEKernel_UnloadModule+0x716f4\r\n00000000 00000000 00000000 00000000 00000000 Flash32_14_0_0_125!IAEModule_IAEKernel_UnloadModule+0x71841\r\n1:020:x86> ub 68c6513f\r\nFlash32_14_0_0_125!DllUnregisterServer+0xa7240:\r\n68c65122 8d442403        lea     eax,[esp+3]\r\n68c65126 83c404          add     esp,4\r\n68c65129 e9ed760f00      jmp     Flash32_14_0_0_125!DllUnregisterServer+0x19e939 (68d5c81b)\r\n68c6512e 56              push    esi\r\n68c6512f 8bf1            mov     esi,ecx\r\n68c65131 8b8e98050000    mov     ecx,dword ptr [esi+598h]\r\n68c65137 8b01            mov     eax,dword ptr [ecx]\r\n68c65139 ff90f0000000    call    dword ptr [eax+0F0h]\r\n1:020:x86> dd esi+598\r\n638bdda8  3904d000 66d0dff0 80000000 00000000\r\n638bddb8  39055f60 6d7cc090 00000000 00000000\r\n638bddc8  00000000 39054ba0 00000000 00020000\r\n638bddd8  00000000 00000000 00000000 00000000\r\n638bdde8  63921038 00000000 00000000 00000000\r\n638bddf8  00000000 00000000 00000001 66c3b868\r\n638bde08  66c3b880 00000000 00000000 00000000\r\n638bde18  00000000 695692ec 00000000 00000000\r\n1:020:x86> dd 3904d000\r\n3904d000  69689c5c 00000000 373c6740 373cf4d0\r\n3904d010  00000000 00000000 00000000 6959f5a0\r\n3904d020  6994ce70 38fa0000 00000000 00000000\r\n3904d030  3904d000 695ad63c 00000000 638bd810\r\n3904d040  373c5140 00000000 3904e081 3904f041\r\n3904d050  00000000 39059030 38fa0000 00000000\r\n3904d060  69974360 00000054 00000030 00000000\r\n3904d070  00000000 00000000 00000000 00000000\r\n1:020:x86> dd 69689c5c+f0\r\n69689d4c  20296425 6c636572 656d6961 64252064\r\n69689d5c  6f687720 7020656c 73656761 64252820\r\n69689d6c  29626b20 206e6920 66322e25 6c696d20\r\n69689d7c  2073696c 342e2528 29732066 0000000a\r\n69689d8c  6d656d5b 7773205d 2d706565 72617473\r\n69689d9c  00000a74 2e63672e 6c6c6f43 00746365\r\n69689dac  2e63672e 6c6c6f43 69746365 6f576e6f\r\n69689dbc  00006b72 68fbaf60 68fba890 68fbaf80\r\n1:020:x86> db 69689c5c+f0-10\r\n69689d3c  00 00 00 00 5b 6d 65 6d-5d 20 73 77 65 65 70 28  ....[mem] sweep(\r\n69689d4c  25 64 29 20 72 65 63 6c-61 69 6d 65 64 20 25 64  %d) reclaimed %d\r\n69689d5c  20 77 68 6f 6c 65 20 70-61 67 65 73 20 28 25 64   whole pages (%d\r\n69689d6c  20 6b 62 29 20 69 6e 20-25 2e 32 66 20 6d 69 6c   kb) in %.2f mil\r\n69689d7c  6c 69 73 20 28 25 2e 34-66 20 73 29 0a 00 00 00  lis (%.4f s)....\r\n69689d8c  5b 6d 65 6d 5d 20 73 77-65 65 70 2d 73 74 61 72  [mem] sweep-star\r\n69689d9c  74 0a 00 00 2e 67 63 2e-43 6f 6c 6c 65 63 74 00  t....gc.Collect.\r\n69689dac  2e 67 63 2e 43 6f 6c 6c-65 63 74 69 6f 6e 57 6f  .gc.CollectionWo\r\n--\r\n\r\nThe bytes at 0x69689d4c is a part of a string, but it's wrongly used as a pointer.\r\n\r\nWith a little debugging, you will find that the vulnerability is highly exploitable. Attackers can easily spray bytes to replace the freed object for future exploitation, even, the attacker can just spray around the memory 0x20296425 (though, it requires a \"jit-spray\" to bypass DEP).\r\n\r\nSome notes:\r\n\r\n1. This bug is actually quite strange (found by visiting some random page that loads that PoC as a frame:P), I tried to reduce the PoC, unfortunately it became unstable. I'm not sure exactly why, but I'd bet the root cause is due to some \"out-of-memory\" conditions - probably Flash Player doesn't handle some OOM condition correctly which causes future code in an use-after-free situation.\r\n(I'd be very glad to hear from the vendor for root cause discussions, if possible.:-))\r\n\r\n2. On my computer, most times it will reproduce successfully. Please note that most times you need to wait for 30 seconds after it redirects to another url, then close the IE, you will see the crash. However, if you find it's really hard to reproduce even after trying many times, let me know (email to ███). Maybe I will share a Fiddler .saz traffic to you.\r\n\r\n\r\nThanks,\r\nHaifei",
  "weakness": {
    "id": 2,
    "name": "Memory Corruption - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 12559,
      "file_name": "repro.zip",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/012/559/bafd48aed07d299c986d472ecbb25cb21df28bc2/repro.zip?response-content-disposition=attachment%3B%20filename%3D%22repro.zip%22%3B%20filename%2A%3DUTF-8%27%27repro.zip&response-content-type=application%2Fzip&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSJAEOSEA%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T113042Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIFGoM7UVkpoUFXOwmBO1YCW3cw%2F4NyxP2Yan%2BgrkBav8AiEAyCUaZteSGAOL1VybC9wE4FNtA9ZRB0rOhRCfRb1SJtUqsgUIcBADGgwwMTM2MTkyNzQ4NDkiDK4laJFhO348YrQkpSqPBT0JpdttzMzvj7d49wHxo6XKhZp6ShyKPYUpw0Uq4AHmWnLgN8g%2BsTPzAignfCeJBrRSLMJVkOL0W5ter7990DhqIASPNW1EZwrDyGA7kuePP%2BF4tcrX3LO0OOR6gGZx9EtA5T7iJB1DFapuW5N7q%2F51A5Mu7ZLK0NaZo8zhsohgiWzzyR2iluk%2FLl3XGm%2Fa6%2BcTwHua%2BNjD%2F97XLRv1zF3YE7sSdAY3bunMdQ6NaH%2BxtZj7FOWcsouUYmSWYMItq7rFc2QX6eLL04LoQhGF%2BsAlIJRuG9morj%2FzbUBeITu4Wjw1YqZoqh4stcI25Q3hf6RXlfWGW%2FpPgFVXTaKeiqdUSu86Hp0mtdhvWjZ%2F3frTMpqYRrp2a1mbGWETUc5Uf0mzI3H5oA%2B3GNQfu3cWaPp6Vj5kQ0fBwtej92wxqBKYcwQGX1OqkYgzXEkCCIsQfZxhAaPTN%2FtgMRJ58JVzNuHtKdPerJm1tZ8fQ6tljGtPSMxjFhDzyA9m9NHez5izRf7KqXOVO9vYJFw%2Fi00wL4IHCuGJag8I%2Fxka6p1qKR%2BLgjmHhEme4qKwVcZHLFn9ks9Opq5yjYs0%2BDnJLzW8EoTTImazBY6PuaPKcKQY8cuOfRLUWHjfDoiEvtTVUk8hNiRL7PEmq8TnurN%2BlvDbNHfB1bc7T4OkQ0bkDfDKxp%2Bw6kMpFfLzp3zMh4sVkCicAf8phxPfZ3ImBweoHetjdWVM%2FAaqoQFfIvSuNFRLjBRBvd1PbhmnN5Jq5WNPDsGhoXmnlt9dIMyM30uqRrm5JWVLqPt5x3tJ%2F6XEKfiDRzBMK4wT7DJ94Iud7aggpV%2BQl9JVRf86hwRXR9rFbvmmDTUka9kitEZLd%2FlL7mfvrF8wlKGsrgY6sQG6xY6iPHcuzMUPYlF%2BiPLSQhv%2F6pGqgLnKtUql08pwI3ttBcBcKWvZH4WOc5lXL1qEfHHkJQ1HwYwKvH5vG3URLBINtmvkDZGhy%2F605sBLv1QwPSjd91a2Orn1TKno6iqHfQCQTcPrP0NyRztLXpdgkxXv3JyY%2FNXpBhGdrABNb%2BwkB78q7U4iWLt6tducslFnRZ4D7lUbbNW%2FhxyDCkCcwec2EWKyZiZLijLaLBQG2P4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2cf9d846234633ed117f1cd10426b840bba0abcf7c7fd0b2f4fa1d8bcc298d5d",
      "file_size": 48720,
      "type": "application/zip",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2019-11-12T09:44:10.214Z",
  "allow_singular_disclosure_after": -134271992.0950516,
  "singular_disclosure_allowed": true,
  "vote_count": 1,
  "voters": [
    "shivammusic"
  ],
  "structured_scope": {
    "databaseId": 84122,
    "asset_type": "OTHER",
    "asset_identifier": "IBB (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
