{
  "id": 16910,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjkxMA==",
  "url": "https://hackerone.com/reports/16910",
  "title": "Cross-site information assertion leak via Content Security Policy",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2014-06-18T22:31:04.534Z",
  "submitted_at": "2014-06-18T22:31:04.534Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "zemnmez",
    "url": "/zemnmez",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/005/901/3bc595305f55caeb2f1b1b1b5bc1f5c82a20dca6_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVK6HBRP7%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T112953Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDsoBJx%2B4kwKN%2FWCaycvNOynx6crPPKIL%2BEAGIylt8fMAIhALe831Qq64MHj2Mc4oI5HTmICWF%2Bis27HMVDJjMR8iK%2FKrIFCHAQAxoMMDEzNjE5Mjc0ODQ5IgypI1m9MFcJXSl3lvAqjwVVB33LQh7HDzfem7Ao9ZxUuMYQUtaQsYdRUY%2F2hr5Ky9YlDorwJyiy4wHhgftzPtAaLxi0IKIz5%2FtUIJEwLUp9UAMU5V71uM8es0vGiZVS4udWmvfPjiQiNg44nYjExzcIrYMuIf%2FdMVGh7ytGy4Q3hpN8pZzyyvQneRgQYNYlJgv0kL07Z5qAQgMG%2BhQJh17%2FbIGHtuH2597CbQygh83BctSU51P9axo6qtXU0cemT6k9iG15t4jA%2FLNFUtGIjuIufrPdwM0zrS%2Bc%2F6W1SLEERO51I6NSS9sSjUxFNxkuBsjXU5DAKFrUOYWlBJvBcAVCT9fNb0%2Ba45oSQu5BrGVZViSSY8UCFLY0Xrcg%2Bvaqsep%2FApYwTmxxsYo2cs3xrUXZtuRnXE5MsH5EQO1ruwqzRMjvlBIClLJd1d215p9Z%2BlKdbWfrbW9vUNwrl7LDO9hRf5CawMSg4lQrWDeMK7svFeoYs8xzne4WNYaDjGH3gTfCsbJ0Q9Atplqduv7%2BGOL889H79tdUCDwyP2nkfuqmEPgKEodEP9Eva0klHgYQ%2FZVMQRF0C8OyOB492WM7KrVI%2FW%2FLxsonMF3mTIV%2FzK7ytVuq0b44exxMqt8UABXDOSTKy4AdBpxU46Jybp5Cak%2Bstk%2BC8aTkrjRSZKmUlRcZrxS4Oitf9%2FbXxlH0ZIHtr%2BEsMIjzuGF7XCQ00GHSJDHZVgi90OmOpcIzzIWgZdcysQWddOcII54f8PrnYNFhJtLPASEm81TGpdRIFz0oD%2FcY27e6iOK7GJaxLs0Ki89NSIeNfs8Bhsr%2BrnyEBiQE0BPjXCSlDyKXAtYmZxUd3Re%2B0%2FVQhoY3x3ZHC7%2F%2Blr47wtwAOyjCQYqWHpaUszSDMJ6brK4GOrABkkycl7ociIFa9xqO66KqZf95H4RpA1YVas5zhYo%2Bobqh1k3cAYK6A1EXLiCnDT5PSS%2F1ejTXbuU7Tpah6vxYYvGmB9H3Af2jMT9enGyUACIubvVr3uW9JTYqGv3o6Vp9RKWOKXs4F6gnFhjJsENY%2F9WGuHzDZPlrsrXolqaVtDqRQ1%2BEFbkxw8gl7uNfXz53JejvDvz93hw4Pm%2Fly7F5pGIHIBsKA%2Ff5OadydxsE3xc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4008fb84c5f7b4949e7964b9794e916ad2678e40c900fcb98e0558f70c65cd6d",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVK6HBRP7%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T112953Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDsoBJx%2B4kwKN%2FWCaycvNOynx6crPPKIL%2BEAGIylt8fMAIhALe831Qq64MHj2Mc4oI5HTmICWF%2Bis27HMVDJjMR8iK%2FKrIFCHAQAxoMMDEzNjE5Mjc0ODQ5IgypI1m9MFcJXSl3lvAqjwVVB33LQh7HDzfem7Ao9ZxUuMYQUtaQsYdRUY%2F2hr5Ky9YlDorwJyiy4wHhgftzPtAaLxi0IKIz5%2FtUIJEwLUp9UAMU5V71uM8es0vGiZVS4udWmvfPjiQiNg44nYjExzcIrYMuIf%2FdMVGh7ytGy4Q3hpN8pZzyyvQneRgQYNYlJgv0kL07Z5qAQgMG%2BhQJh17%2FbIGHtuH2597CbQygh83BctSU51P9axo6qtXU0cemT6k9iG15t4jA%2FLNFUtGIjuIufrPdwM0zrS%2Bc%2F6W1SLEERO51I6NSS9sSjUxFNxkuBsjXU5DAKFrUOYWlBJvBcAVCT9fNb0%2Ba45oSQu5BrGVZViSSY8UCFLY0Xrcg%2Bvaqsep%2FApYwTmxxsYo2cs3xrUXZtuRnXE5MsH5EQO1ruwqzRMjvlBIClLJd1d215p9Z%2BlKdbWfrbW9vUNwrl7LDO9hRf5CawMSg4lQrWDeMK7svFeoYs8xzne4WNYaDjGH3gTfCsbJ0Q9Atplqduv7%2BGOL889H79tdUCDwyP2nkfuqmEPgKEodEP9Eva0klHgYQ%2FZVMQRF0C8OyOB492WM7KrVI%2FW%2FLxsonMF3mTIV%2FzK7ytVuq0b44exxMqt8UABXDOSTKy4AdBpxU46Jybp5Cak%2Bstk%2BC8aTkrjRSZKmUlRcZrxS4Oitf9%2FbXxlH0ZIHtr%2BEsMIjzuGF7XCQ00GHSJDHZVgi90OmOpcIzzIWgZdcysQWddOcII54f8PrnYNFhJtLPASEm81TGpdRIFz0oD%2FcY27e6iOK7GJaxLs0Ki89NSIeNfs8Bhsr%2BrnyEBiQE0BPjXCSlDyKXAtYmZxUd3Re%2B0%2FVQhoY3x3ZHC7%2F%2Blr47wtwAOyjCQYqWHpaUszSDMJ6brK4GOrABkkycl7ociIFa9xqO66KqZf95H4RpA1YVas5zhYo%2Bobqh1k3cAYK6A1EXLiCnDT5PSS%2F1ejTXbuU7Tpah6vxYYvGmB9H3Af2jMT9enGyUACIubvVr3uW9JTYqGv3o6Vp9RKWOKXs4F6gnFhjJsENY%2F9WGuHzDZPlrsrXolqaVtDqRQ1%2BEFbkxw8gl7uNfXz53JejvDvz93hw4Pm%2Fly7F5pGIHIBsKA%2Ff5OadydxsE3xc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d0b660d1123117917fdd92647159033d9b6e7d81c35bdc6b922e8bd7bab0b681"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-09-05T02:23:54.114Z",
  "bug_reporter_agreed_on_going_public_at": "2018-08-13T02:21:51.742Z",
  "team_member_agreed_on_going_public_at": "2018-09-05T02:23:53.999Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "It is possible to test for the satisfaction of certain assertions across origins by abuse of Content Security Policy. These could be assertions such as 'is the client logged into this website', or 'is the client logged in as this user', or 'does the client have access to these panels'. This general exploit affects a very large portion of non-static websites.\r\n\r\nContent Security Policy allows an endpoint to define certain controls on where specific kinds of content can be located, and most importantly allows the endpoint to define an endpoint where trespasses should be reported.\r\n\r\nHere is an example, to leak the result of the assertion 'is the user logged in as X' on Google Plus:\r\n\r\nHere is an example exploit flow to work out if the current user is 'Zemnmez', https://plus.google.com/106624718886599931522/.\r\n\r\nThe user is directed to an endpoint (ib) returning Content-Type text/html, an HTML image tag of src: https://plus.google.com/me/posts and a header:\r\n\r\nContent-Security-Policy:default-src *; img-src https://plus.google.com/me/posts https://plus.google.com/106624718886599931522/posts; report-uri ib\r\n\r\nIf the user is Zemnmez, the assertion does not fail and no report is generated since the image resolves to https://plus.google.com/106624718886599931522/posts which passes the Content Security Policy. If the user is not Zemnmez, the Content Security Policy sends a report back to the endpoint indicating that the policy was violated.\r\n\r\nThe report is sent back to 'ib' and looks like this:\r\n\r\nblocked-uri: \"https://plus.google.com\"\r\ndocument-uri: \"[...]\"\r\noriginal-policy: \"default-src *; img-src https://plus.google.com/me/posts https://plus.google.com/106624718886599931522/posts; report-uri ib\"\r\nreferrer: \"\"\r\nstatus-code: 200\r\nviolated-directive: \"img-src https://plus.google.com/me/posts https://plus.google.com/106624718886599931522/posts\"\r\n\r\nA similar exploit can be demonstrated for YouTube:\r\n\r\nYoutube exposes a video enhancement interface for videos at: https://www.youtube.com/enhance?feature=vm&v=[videoid]\r\n\r\nIf the current account accessing the video is not the owner of the video, they are directed to /oops.\r\n\r\nHere is a video owned by me:\r\n\r\nhttps://www.youtube.com/watch?v=G_bnKTH3Lts\r\n\r\nThe corresponding enhancement URL would be: https://www.youtube.com/enhance?feature=vm&v=G_bnKTH3Lts\r\n\r\nGiven the CSP header:\r\n\r\nContent-Security-Policy:default-src *; img-src https://www.youtube.com/enhance?feature=vm&v=G_bnKTH3Lts; report-uri ib\r\n\r\nIf the user is not logged in as me, this breaks the content security policy when \"https://www.youtube.com/enhance?feature=vm&v=G_bnKTH3Lts\" is embedded as an image, notifying the attacker that the assertion is false.\r\n\r\nAs another example, here is an exploit flow for the assertion 'is the user logged in on Google':\r\n\r\n When the user is not logged in, http://calendar.google.com redirects to http://accounts.google.com.\r\n\r\nAn attacker can load a webpage with a Content-Security-Policy header whitelisting calendar.google.com, google.com and www.google.com but not accounts.google.com, and specifying that incidents should be reported.\r\n\r\nBy embedding an image with the URL http://calendar.google.com, the attacker can detect if the user is logged into Google or not.\r\n\r\nThis can be exploited by an endpoint with the image and this header:\r\n\r\nContent-Security-Policy:default-src *; img-src calendar.google.com google.com www.google.com; report-uri ib\r\n\r\nWhere /ib is the relative URL of the endpoint. When not logged into Google, this request payload was sent to my server:\r\n\r\nblocked-uri: \"https://accounts.google.com\"\r\ndocument-uri: \"http://[...]/ib\"\r\noriginal-policy: \"default-src *; img-src calendar.google.com google.com www.google.com; report-uri ib\"\r\nreferrer: \"\"\r\nstatus-code: 200\r\nviolated-directive: \"img-src calendar.google.com google.com www.google.com\"\r\n\r\n\r\nThe general modus is to not whitelist an endpoint that may occur as the result of some action, and use the report feature to detect what path was taken by the action. To assert that a user has access to a control panel, a CSP can be set up that specifies only the control panel is an allowed image. For most control panels, inadequate privileges cause a Location header to be sent to a login page or other endpoint. This is detected and sent back to the server as a report.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-09-12T02:21:51.826Z",
  "allow_singular_disclosure_after": -171104881.85240352,
  "singular_disclosure_allowed": true,
  "vote_count": 13,
  "voters": [
    "mattaustin",
    "ali",
    "savitar0x01",
    "neil-tsakatsa",
    "eveeez",
    "zemnmez",
    "cryptographer",
    "shivammusic",
    "0x08",
    "spetr0x",
    "and 3 more..."
  ],
  "structured_scope": {
    "databaseId": 84121,
    "asset_type": "OTHER",
    "asset_identifier": "IBB (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
