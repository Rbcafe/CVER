{
  "id": 53088,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MzA4OA==",
  "url": "https://hackerone.com/reports/53088",
  "title": "SSRF vulnerability (access to metadata server on EC2 and OpenStack)",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-03-23T15:08:49.061Z",
  "submitted_at": "2015-03-23T15:08:49.061Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "agarri_fr",
    "url": "/agarri_fr",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/223/9346bb3a772b6433536cfbbe2a0a6c4c7a786fe9_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 18,
    "url": "https://hackerone.com/phabricator",
    "handle": "phabricator",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Phabricator",
      "twitter_handle": "phabricator",
      "website": "http://phacility.com/phabricator/",
      "about": "Phabricator is a collection of open source web applications that help software companies build better software."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2015-03-26T18:37:57.571Z",
  "bug_reporter_agreed_on_going_public_at": "2015-03-26T18:37:57.356Z",
  "team_member_agreed_on_going_public_at": "2015-03-26T18:33:49.042Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "In bug [#50537](https://hackerone.com/reports/50537), **haquaman** reported a SSRF vulnerability in the meme creation section of Phabricator. Ticket [T6755](https://secure.phabricator.com/T6755) was created and the HackerOne issue was closed as \"Won't fix\".\r\n\r\n[T6755](https://secure.phabricator.com/T6755) states that *\"attackers can use the machine's ability to access the network, which may allow them to find services (and, in some rare cases, interact with services that have very, very weak authentication and act over HTTP GET)\"*.\r\n\r\nHoewever, some common deployement scenarios (using Amazon EC2 or OpenStack) include a \"metadata\" web server listening on a multicast IP (169.254.169.254):\r\n- EC2: http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html\r\n- OpenStack:http://docs.openstack.org/admin-guide-cloud/content/section_metadata-service.html\r\n\r\nGiven the multicast IP address, this server can only reached from the instance itself.\r\n\r\nPlenty of interesting information are stored at /latest/meta-data/ ([hostname](http://169.254.169.254/latest/meta-data/hostname), private and public IP addresses, ...). However, the worst scenario is auto-starting instances, where a startup script is stored in [/latest/user-data](http://169.254.169.254/latest/user-data). These startup scripts may include passwords, private keys, source code, ...\r\n\r\nTest URLs:\r\n```\r\nhttp://169.254.169.254/latest/meta-data/hostname\r\nhttp://169.254.169.254/latest/user-data\r\n```\r\n\r\nOutside of EC2 and OpenStack, some services are commonly bound to localhost, including monitoring software, noSQL databases, administration interfaces, ...",
  "bounty_amount": "300.0",
  "formatted_bounty": "$300",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2015-04-25T18:33:49.221Z",
  "allow_singular_disclosure_after": -277837463.6209337,
  "singular_disclosure_allowed": true,
  "vote_count": 4,
  "voters": [
    "cxzer0",
    "shivammusic",
    "acka",
    "supern0va"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
