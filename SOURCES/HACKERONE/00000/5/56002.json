{
  "id": 56002,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NjAwMg==",
  "url": "https://hackerone.com/reports/56002",
  "title": "Shopify android client all API request's response leakage, including access_token, cookie, response header, response body content",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2015-04-12T08:51:42.562Z",
  "submitted_at": "2015-04-12T08:51:42.562Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "sukhoi",
    "url": "/sukhoi",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2015-07-04T15:45:09.606Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2015-06-04T15:44:57.768Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Shopify android client all API request's response leakage, including access_token, cookie, response header, response body content and much other information. An attacker can extract cookie and access_token of Shopify android client without any permission needed and user awareness.\r\n\r\n#Bug impact:\r\n\r\nA malicious android app can extract cookie and access_token and other user sensitive information in Shopify android client, and thus taking control of user's account.\r\n\r\nBug demostration (see two screenshots with stolen cookie in http headers printed in logcat and access_token).\r\n\r\n#Bug explaination:\r\n\r\nThe shopify client use implicit broadcast to communicate intra-app to pass network request's response infromation, with action \"com.shopify.service.requestComplete\". However this broadcast is not protected by permission, thus any android client can register a broadcast receiver and monitor response information, extracting sensitive account credentials.\r\n\r\nThe broadcast is send at com/shopify/service/netcomm/NetworkService, recvd at multiple points. including com/shopify/service/BaseRequestDelegate$RequestCompletionBroadcastReceiver$1.\r\n\r\n#Steps to reproduce:\r\n\r\n- Install the poc apk and shopify client, poc apk registered a receiver and monitor in background\r\n- Open shopify and login, the poc apk will now receives user's admin_cookie and access_token silently, print them in logcat as demonstrated in screenshots. Of course the attacker can send it to remote control center and fully take control of user's account.\r\n- As user operates the attacker can receives other response information.\r\n- logcat command:  adb logcat -s SHOPIFYHACK:V\r\n\r\n#Fix recommendations:\r\n\r\nUse signature level permission to protect the broadcast, or use a LocalBroadcastManager\r\n\r\nPOC apk attached, tested on Nexus 5 4.4.4. No special permission or root required. No user interactions and awareness.\r\n",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2015-07-04T15:45:05.395Z",
  "allow_singular_disclosure_after": -271799624.8521738,
  "singular_disclosure_allowed": true,
  "vote_count": 7,
  "voters": [
    "kapytein",
    "shivammusic",
    "armansameer",
    "jesuser14",
    "archsolar",
    "dirtbkr",
    "ceortiz"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
