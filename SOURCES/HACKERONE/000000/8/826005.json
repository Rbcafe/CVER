{
  "id": 826005,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MjYwMDU=",
  "url": "https://hackerone.com/reports/826005",
  "title": "Private account causes displayed through API",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2020-03-21T15:41:03.103Z",
  "submitted_at": "2020-03-21T15:41:03.103Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ech0fr",
    "url": "/ech0fr",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/de9wZnoBSA1TAbGKV31uiB7x/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 45900,
    "url": "https://hackerone.com/stagingdoteverydotorg",
    "handle": "stagingdoteverydotorg",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/hoDHhKEVFxx72KE8bgvqYgWz/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/hoDHhKEVFxx72KE8bgvqYgWz/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Staging.every.org",
      "twitter_handle": "everydotorg",
      "website": "https://staging.every.org",
      "about": "At https://staging.every.org, you can help improve security for a 501(c)(3) tech nonprofit with the mission to connect givers and nonprofits."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-04-21T19:02:59.588Z",
  "bug_reporter_agreed_on_going_public_at": "2020-04-21T18:09:29.868Z",
  "team_member_agreed_on_going_public_at": "2020-04-21T19:02:59.457Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nAny authenticated user can see which causes a private account user is interested in, by sending a GET request to the API, even though this information is not displayed anywhere on the profile page.\n\nIn the profile settings, the following message is displayed for \"Private Supporter\" option :  \n*People will be able to find and request to follow you, but only followers you accept will be able to see which organizations you support.*\n\nNothing is mentionned about the causes we're interested in, but as a private account, it would make sense to not disclose this information.\n\nThe fact that this information is not displayed on the web profile page makes me think that it is unintentional to send it as reponse to API requests from any user.\n\n## Steps To Reproduce:\nTo reproduce this issue, I simply sent an API GET request to /api/users/<user_id_or_username>\n\n  1. On https://www.every.org/settings/profile page, submit the form by clicking on \"Update\" button and get the send request with all csrf and cookie headers\n  2. The first line will be **PATCH /api/me HTTP/1.1**, simply modify this to **GET /api/users/any_username** and re-send the request (you do not need to keep the body json data)\n  3. Read the API Json response, especially the `\"causes\":[{\"entityName\":\"Cause Follow\",\"causeCategory\":\"SOME_CATEGORY\"}]` part\n\n## Example:\n\nI have two accounts :\nhttps://www.every.org/@bug.hunter (ech0bh+everyorg@wearehackerone.com) - \"Attacker\"\nhttps://www.every.org/@bug.hunter3 (ech0bh+everyorg3@wearehackerone.com) - PRIVATE profile\n\nThis is **bug.hunter3** private profile, interested in \"Education\" cause :\n\n{F755510}\n\nThis is an API GET request sent with **bug.hunter** account CSRF-Token (no cookie needed) :\n\n```\nGET /api/users/bug.hunter3 HTTP/1.1\nHost: www.every.org\nUser-Agent: Mozilla/5.0 (---------------------------------) Gecko/20100101 Firefox/74.0\nAccept: */*\nAccept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nReferer: https://www.every.org/settings/profile\nContent-Type: application/json\nX-CSRF-Token: <csrf_token_here>\nOrigin: https://www.every.org\nContent-Length: 0\nConnection: close\nCookie: \n```\n\nThis is the reponse body :\n\n```\n{\n  \"message\": \"Found user\",\n  \"data\": {\n    \"user\": {\n      \"entityName\": \"User\",\n      \"id\": \"e03bb4c9-c904-46d5-92db-59b235743690\",\n      \"firstName\": \"bug\",\n      \"lastName\": \"hunter3\",\n      \"profileImageUrl\": \"\",\n      \"username\": \"bug.hunter3\",\n      \"locationAddress\": \"\",\n      \"isPrivate\": true,\n      \"followedByCurrentUserStatus\": \"none\",\n      \"followingCurrentUserStatus\": \"none\",\n      \"causes\": [\n        {\n          \"entityName\": \"Cause Follow\",\n          \"causeCategory\": \"EDUCATION\"\n        }\n      ]\n    },\n    \"followInfo\": {\n      \"entityName\": \"Follow Info\",\n      \"userId\": \"e03bb4c9-c904-46d5-92db-59b235743690\",\n      \"followerCount\": 0,\n      \"followingCount\": 0\n    }\n  }\n}\n```\n\nAs we can see, I was able to know that bug.hunter3 is interested in \"Education\" cause, even though it is a private profile and I am not following it.\n\n## Additional information:\n\nPlease note that bug.hunter2 (ech0bh+everyorg2@wearehackerone.com) is also my account which wasn't of any use here. I created it to test another vulnerability.\n\nPS: The link reference in top of this submit page does not redirect to your security page. Indeed, there is a link to https://hackerone.com/every_org while your security page is https://hackerone.com/everydotorg.\n\nDo not hesitate to ask any information you would need and I'll be happy to help.\n\n## Impact\n\nFollowing cause category information disclosure of any account (even private account that we do not follow).",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 755510,
      "file_name": "causes.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/DBRLrA8FvN3mx64tQn1C8hWX?response-content-disposition=attachment%3B%20filename%3D%22causes.png%22%3B%20filename%2A%3DUTF-8%27%27causes.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ3H257GYG%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T134037Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIGoOoD7IqdXlQSMALqfdmBHb%2FwisMvEm1NldXxdnNeYCAiARy2w%2BYbeWpCI595roGwDkus42Lbn86e5evWfxBT9NOSqyBQh1EAMaDDAxMzYxOTI3NDg0OSIMhPAKuxRXUmGeFQneKo8F3DcJJTLeqY4WL2LSYxnsh9sLc5TIBgXhMZcfnWnfMScNTJ5phuisFPjvWUDTRl2jiPdCnVNDEZTh0V%2FzIfuaRGTEFLdttdVM%2B7XRPGS6Z0DsZrpCecbEHHiNrvbSv9rEH4WRaiYG2AiT800A%2BhISire0KP%2FxWN%2Bq3fGg3S7IYi3fo9FxjeHTJXwzRwtp8p2sKp0llq1XgyIM5HcUKwfeJRLDxhXB4KjtrJm8Nl1HJjYd38Kl4OOD%2BVQ4qgxVg6S3QUXiVui8uRmS6QSomCFcHKrWwhKDdkwleR0A2DhXEcMBOpr5uZdFBRMTTLVfLJqt8b7Gn%2FP1kEndSvANJn4pKANWGSKKrLKm%2FW5SYwuMcwCwVWZkm2kI7%2FaC07CZWLriJLbb0B9h3p9uZQd2JXPcy9UJrOtHD39hJ2TSV7hqrFKdIH1VDFc1o4xN9CfMK41Iz19t%2BXB%2BiBobpQMJkamH6%2BMqlg%2BRnibesjoUaznTAKjTv04b1H2Gfup9n8qf1CYIWVaypF0psfpQ4tvZMbk6A9lrEcUCjjcacQFwHaOjcE1VoMC9x8Y3SAcSGe1fgFB6OLJLsOalgVmTZQIr2sn%2FSBi9GibFMnQs9e5r%2F7uE1BdL1f%2FCFWqUOKwCQctUsNAkTlcVSIqcZpy6Wm2pgFJXvhoksSuVTlHoBuvWUpF4GomHdrlRKMJqiHROUMKzy4%2Bellc5ulcf3UuSY1k6dZTA5MpfF5QPJ2XV03V5EhF2iFMJDrqHZ%2B%2F0jo2dVNDNDizcLLqOfvfM%2BmZ7IXWl4eYmGZQoTIUs3oLbjrHhfzw1vaH3uiu8ixoDFPI3JWnWXXw%2ByN4jhOjFQUQU%2FCtTyf5HAodU0A%2FQKW77PGnTKFcxtzDMra2uBjqyAVQAtnTFFvc7GDPSVsVDtdiaEYk9BpW%2Fv8Td%2BbCI38P1sNEwB4ogOEtNgM7ztuaNj2ZReYSVM3%2BIJgEPDNx5i2UO45PoOWvvUmsULL9KC8Xx45bNoDwGXKdZ6pe2GQq%2Fsv22h8ChmpFIOFcTfENahRl6cIPxSXPhniNCt1V5BiQ%2FiqrO5YcfhIscKvt0FrmdE0Oc8bj0IS5H4NQvWQZaNALTeEhhVoNMsjxWfsEi6d9j4XE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a400dd41985370fb4f02e9330dff9028b01abffc547692753d955bf488c0e360",
      "file_size": 148757,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 5,
  "voters": [
    "1trick",
    "what_web",
    "ech0fr",
    "modrnproph3t",
    "rcl"
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 42365,
    "asset_type": "URL",
    "asset_identifier": "staging.every.org",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
