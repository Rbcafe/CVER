{
  "id": 875938,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzU5Mzg=",
  "url": "https://hackerone.com/reports/875938",
  "title": "User session access due to Oauth whitelist host bypass and postMessage",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2020-05-16T08:43:20.311Z",
  "submitted_at": "2020-05-16T08:43:20.311Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mariuszpoplawski",
    "url": "/mariuszpoplawski",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/43BtUKfowdJ8ZD7ZW4o2fnfM/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 65,
    "url": "https://hackerone.com/mailru",
    "handle": "mailru",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mail.ru",
      "twitter_handle": "",
      "website": "https://vk.company/",
      "about": "Building the Internet since 1998"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-07-20T16:47:32.833Z",
  "bug_reporter_agreed_on_going_public_at": "2020-07-02T14:04:16.395Z",
  "team_member_agreed_on_going_public_at": "2020-07-20T16:47:32.736Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-08-01T14:04:16.461Z",
  "allow_singular_disclosure_after": -111541216.79513516,
  "singular_disclosure_allowed": true,
  "vote_count": 30,
  "voters": [
    "sky003",
    "mizzle",
    "s1r1u5",
    "tess",
    "mik317",
    "romesful",
    "naategh",
    "mariuszpoplawski",
    "sa1tama0",
    "blackturtle",
    "and 20 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 7.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 40419,
    "asset_type": "OTHER",
    "asset_identifier": "Ext. B Scope",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 23588,
      "category": "team",
      "content": "A destination for postMessage was not properly restricted on connect.mail.ru allowing crossite access to session, as was shown for 3k.mail.ru application session.\n\nBoth connect.mail.ru and 3k.mail.ru belong to Ext.B scope, this scope does not offer a bounty for attacks with clientside vectors on the moment of reporting.",
      "user": {
        "id": 4836,
        "username": "3apa3a",
        "name": "Vladimir Dubrovin",
        "bio": "En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ",
        "cleared": false,
        "verified": false,
        "website": "https://3proxy.org/",
        "location": "Nizhny Novgorod, Russia",
        "created_at": "2014-04-10T22:08:47.745Z",
        "url": "https://hackerone.com/3apa3a",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "id": 23503,
      "category": "researcher",
      "content": "Vulnerability was classified  as CSRF which in our opinion is not valid classification, vulnerability was score as HIGH but no bounty was paid as CSRF is out of scope. Problem exists in oauth implementation mechanism in our opinion and should be classified as \"Improper Authentication - Generic\". \n\nThis type of approach  by bug bounties programs  is harmful for us - researchers. We spent hours to exploit / find vulnerabilities and help to improve security of our targets, in returns spent next hours to fight with owners of programs. I must say it was not first time and i am really upset, it's not just about paying out the bounties, but about the approach. In real world programs would pay much more for our findings, in case of exploit by black hats hackers they would pay millions of dollars costs.\n\nAttacker could bypass security whitelist check and send malicious domain to scope of postMessage(). The whitelist check was server side protection. After bypass attacker could steal any 3rd app users session, sig, code, bearer tokens, and takeover user account. We managed to bypass whitelist of scope parameter using HTTP schema baisc auth https://*.mail.ru:a@attacker-domain.com. Only part till \":\" port separator was check on server side.Vulnerable was all *.mail.ru apps.  Vulnerability exists in \"connect.mail.ru\" endpoint due to improper parameter handling. To trigger the vulnerability attacker had to manipulate user to visit malicious website or place exploit code on webapplication with huge traffic, no future action from user was required. User that visit website was fully compromised.\n\n\nRegards,\n\n",
      "user": {
        "id": 154398,
        "username": "mariuszpoplawski",
        "name": "Mariusz Pop≈Çawski",
        "bio": "Penetration Tester & Security Researcher | OSCP, eWPTXv2",
        "cleared": false,
        "verified": false,
        "website": "https://deepsec.pl/",
        "location": "",
        "created_at": "2017-03-28T10:54:47.733Z",
        "url": "https://hackerone.com/mariuszpoplawski",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/43BtUKfowdJ8ZD7ZW4o2fnfM/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/43BtUKfowdJ8ZD7ZW4o2fnfM/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/43BtUKfowdJ8ZD7ZW4o2fnfM/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
