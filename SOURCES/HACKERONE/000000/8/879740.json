{
  "id": 879740,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84Nzk3NDA=",
  "url": "https://hackerone.com/reports/879740",
  "title": "Repositories of datanucleus are fetched over insecure protocol (http insted of https)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2020-05-21T13:47:19.033Z",
  "submitted_at": "2020-05-21T13:47:19.033Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "keval_j",
    "url": "/keval_j",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35524,
    "url": "https://hackerone.com/central-security-project",
    "handle": "central-security-project",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/524/60c5e9c4b0090fc9ce80fa9d9ca3aecd88d01b00_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Central Security Project",
      "twitter_handle": "SaferOpenSource",
      "website": "https://www.sonatype.com/central-security-project",
      "about": "Ensuring Safer Open Source Across Ecosystems"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-10-05T16:46:01.731Z",
  "bug_reporter_agreed_on_going_public_at": "2020-10-05T16:46:01.497Z",
  "team_member_agreed_on_going_public_at": "2020-10-05T16:39:42.430Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 30,
    "name": "Man-in-the-Middle"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-11-04T16:39:42.512Z",
  "allow_singular_disclosure_after": -103323915.20358618,
  "singular_disclosure_allowed": true,
  "vote_count": 1,
  "voters": [
    "since2003"
  ],
  "severity": {
    "rating": "high",
    "score": 8.1,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 17122,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "Java Component in search.maven.org",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 24723,
      "category": "team",
      "content": "Maven artifact\ngroupId: org.datanucleus\nartifactId: datanucleus-maven-parent\nversion: 4.0.0\n\nVulnerability\nthe jar files inside repositories are fetched using insecure protocol (http instead of https). This allows these artifacts to be potentially MITMed to maliciously compromise them and infect the build artifacts that are produced. Additionally, if any of these JARs or other dependencies were compromised, any developers or production servers using these could continue to be infected past updating to fix this.\n\nAdditional Details\nSource File and Line Number: https://search.maven.org/artifact/org.datanucleus/datanucleus-maven-parent/4.0.0/pom (line : 21)\nVulnerable File(s): http://www.datanucleus.org/downloads/maven2/\nVulnerability Introduction: the above mentioned repo is fetched over http and can be exploited by MITM attack.\n\nSteps To Reproduce:\nDue to complexity of these bug i avoided to attempt to genereate POC because it could possibly affected existing users. but the detailed POC is in the link below which was the same case back in 2014 please Refer the article to reproduce.\nhttps://medium.com/bugbountywriteup/want-to-take-over-the-java-ecosystem-all-you-need-is-a-mitm-1fc329d898fb\nhowever steps to reproduce are as follows:\nClone the Impacted Project\nChange this line in Dilettante so it is targeting the repository used in the build. https://github.com/mveytsman/dilettante/blob/master/dilettante.py#L143\nStart Dilettante on your local machine.\nProxy the HTTP traffic for the build through Dilettante\nExecute the Build's tests.\nYou should be greeted with the image of a cat\n\nPatch\nForce https insted of http.\n\nIn short the jar files in http://www.datanucleus.org/downloads/maven2/ repos are fetched over http which can be intercepted by MITM and could cause severe damage to the existing users.\n\nThis isn't just theoretical\n\nA proof of concept for performing this MITM and infecting JAR files on the fly has existed since 2014:\nHere's the blog post link:\nhttps://max.computer/blog/how-to-take-over-the-computer-of-any-java-or-clojure-or-scala-developer/\nHere's the GitHub repository with the POC code:\nhttps://github.com/mveytsman/dilettante\n\nImpact\nBy insecurely downloading code over an untrusted connection HTTP and executing the untrusted code inside of these JAR files as part of the unit/integration tests before a release opens these artifacts up to being maliciously compromised.\nRemote code execution on a production server. Malicious compromise of build artifacts.",
      "user": {
        "id": 531832,
        "username": "abrinkman",
        "name": "Austin Brinkman",
        "bio": null,
        "cleared": false,
        "verified": false,
        "website": null,
        "location": null,
        "created_at": "2019-03-07T19:21:40.177Z",
        "url": "https://hackerone.com/abrinkman",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
