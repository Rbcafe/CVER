{
  "id": 890747,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84OTA3NDc=",
  "url": "https://hackerone.com/reports/890747",
  "title": "PIN OK attack",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-06-04T11:40:13.603Z",
  "submitted_at": "2020-06-04T11:40:13.603Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": true,
    "username": "timyun",
    "url": "/timyun",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 215,
    "url": "https://hackerone.com/qiwi",
    "handle": "qiwi",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/215/f578bbb9421365fab2e51aa7482bea82006d7c0c_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "QIWI",
      "twitter_handle": "QiwiRussia",
      "website": "https://qiwi.com",
      "about": "The QIWI brand is a family brand that consolidates several directions: kiosks, wallet, bank."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-02-17T08:57:19.337Z",
  "bug_reporter_agreed_on_going_public_at": "2021-02-08T18:54:33.015Z",
  "team_member_agreed_on_going_public_at": "2021-02-17T08:57:19.261Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "PIN OK attack is an attack when a wedge-device (created for MiTM) is used to substitute the response from the card during an offline-PIN check and say that PIN was correct.\nReproduction steps:\n* An attacker with a stolen card without the correct PIN knowledge can use either a so-called wedge device for carrying out the \"man-in-the-middle\" attack and to use attended/unattended terminals or their own terminals which work only with DDA modes.\n* An attacker is making a payment for Â£100 using a chip. The card sends to the terminal its CVM list. The first rule in the CVM list for your card is \"4201 Encrypted PIN online\", which is correct and the CVM list should be protected with CDA. However if DDA is chosen, it's possible to conduct the CVM Tampering and to change the first CVM rule to the \"offline PIN\".\n* When Offline PIN was used but no PIN provided, your card sets \"Byte 2 Bit 3 = 1, Byte 2 Bit 2 = 1\" in IAD/CVR field indicating failed PIN verification, which can be used for detection of a fraudulent transaction on the processing side\n* And fraudulent Qiwi transaction has been authorised at 04 June 2020 10:37 GMT on the issuer's side even though there is no \"Offline PIN Verification Successful\" in IAD and no online PIN was presented.\n\nThe account is +79999913370, Card *0760\n\nFix:\nEven if cards like yours support CDA for EMV, for terminals that don't support them, you should check in CVR that PIN was correctly presented AND checked on the card. Default settings here would be:\nWhen your card actually verified PIN offline, the chip will set CVR\nByte 1 Bit 1 = 1 Offline PIN Verification Successful\n\nBut when no offline PIN verification was made, it will set\nByte 4 Bit 6 = 1 Offline PIN Verification Not Performed\n\nIf a wrong PIN was entered:\nByte 1 Bit 3 = 1 Offline PIN Verification Performed\nByte 1 Bit 2 = 1 Offline Encrypted PIN Verification Performed\nByte 4 Bit 5 = 1 Offline PIN Verification Failed\n\n## Impact\n\nThe attacker also can use lost&stolen cards to conduct fraudulent payments without the PIN knowledge.",
  "weakness": {
    "id": 65,
    "name": "Business Logic Errors"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-03-10T18:54:33.077Z",
  "allow_singular_disclosure_after": -92429504.15566432,
  "singular_disclosure_allowed": true,
  "vote_count": 39,
  "voters": [
    "whybee",
    "hunter",
    "maxarr",
    "organdonor",
    "ali",
    "romesful",
    "rahulkadavil_",
    "theappsec",
    "akashhamal0x01",
    "catferq",
    "and 29 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
