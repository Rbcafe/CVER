{
  "id": 773313,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NzMzMTM=",
  "url": "https://hackerone.com/reports/773313",
  "title": "Port and service scanning on localhost due to improper URL validation.",
  "state": "Closed",
  "substate": "not-applicable",
  "severity_rating": "medium",
  "readable_substate": "N/A",
  "created_at": "2020-01-13T09:25:45.926Z",
  "submitted_at": "2020-01-13T09:25:45.926Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "vshmuk",
    "url": "/vshmuk",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool for doing internet transfers"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-01-15T07:38:19.186Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2020-01-13T22:42:24.961Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nGenerally web masters and developers protect user-accessible CURL from requesting forbidden domains so that the attacker is not able to access internal resources. It is usually done using regular expressions.\nMostly addresses like 127.x.x.x, 192.168.x.x and \"integer\" notation of IP addresses (like 2130706433 = 127.0.0.1) are filtered out before executing curl using wrapper scripts.\nBut the ' * ' symbol is valid for CURL, allowing to request localhost's internal web resources and to scan ports. Unfortunately, since http0.9 is turned off by default now, it's harder to easily scan ports (without accessing stderr by the attacker). But if FTP protocol is not disabled, port scanning can still be achieved using time-based attack: active refusal of a closed port takes much less time than connecting by FTP to any other open port.\nAs far as i see, ' * ' and 'localhost' are not synonyms, and ' * ' string should be filtered out not on the webmaster's side but from inside of CURL.\n\n## Steps To Reproduce:\n```\n$ ./src/curl -V\ncurl 7.69.0-DEV (x86_64-pc-linux-gnu) libcurl/7.69.0-DEV OpenSSL/1.1.1d\n\n$ ./src/curl -v \"*\"\n*   Trying ::1:80...\n* TCP_NODELAY set\n* connect to ::1 port 80 failed: Connection refused\n*   Trying 127.0.0.1:80...\n* TCP_NODELAY set\n* connect to 127.0.0.1 port 80 failed: Connection refused\n* Failed to connect to * port 80: Connection refused\n* Closing connection 0\ncurl: (7) Failed to connect to * port 80: Connection refused\n\n$ ./src/curl -v \"*:8888\"\n*   Trying ::1:8888...\n* TCP_NODELAY set\n* connect to ::1 port 8888 failed: Connection refused\n*   Trying 127.0.0.1:8888...\n* TCP_NODELAY set\n* Connected to * (127.0.0.1) port 8888 (#0)\n> GET / HTTP/1.1\n> Host: *:8888\n> User-Agent: curl/7.69.0-DEV\n> Accept: */*\n> \n<skip>\nHello world!\n* Closing connection 0\n\n$ ./src/curl -v \"ftp://*:8888\"\n*   Trying ::1:8888...\n* TCP_NODELAY set\n* connect to ::1 port 8888 failed: Connection refused\n*   Trying 127.0.0.1:8888...\n* TCP_NODELAY set\n* Connected to * (127.0.0.1) port 8888 (#0)\n^C\n\n./src/curl -v \"ftp://*:80\"\n*   Trying ::1:80...\n* TCP_NODELAY set\n* connect to ::1 port 80 failed: Connection refused\n*   Trying 127.0.0.1:80...\n* TCP_NODELAY set\n* connect to 127.0.0.1 port 80 failed: Connection refused\n* Failed to connect to * port 80: Connection refused\n* Closing connection 0\ncurl: (7) Failed to connect to * port 80: Connection refused\n```\n\n## Supporting Material/References:\n\nAccording to https://tools.ietf.org/html/rfc1034, wildcards are special symbols in DNS and should not be used as domain names..\n\n## Impact\n\nThe vulnerability allows attacker to at least access internal web resources restricted to localhost, or at most to scan locally opened ports and expose services running on the machine.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 0,
  "voters": [],
  "severity": {
    "rating": "medium",
    "score": 6.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "adjacent",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
