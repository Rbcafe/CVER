{
  "id": 727727,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Mjc3Mjc=",
  "url": "https://hackerone.com/reports/727727",
  "title": "Path traversal in filename in LINE Mac client",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2019-11-02T02:32:37.617Z",
  "submitted_at": "2019-11-02T02:32:37.617Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "hackerontwowheels",
    "url": "/hackerontwowheels",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/3f4n44j7d5781pc2sg8zzpl4y29z/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13343,
    "url": "https://hackerone.com/line",
    "handle": "line",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/nfgd330erfzkfvdi70dv3txlgpah/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/nfgd330erfzkfvdi70dv3txlgpah/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "LY Corporation",
      "twitter_handle": "",
      "website": "https://line.me",
      "about": "LINE Security Bug Bounty Program"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-07-31T09:32:26.796Z",
  "bug_reporter_agreed_on_going_public_at": "2020-03-25T13:58:38.703Z",
  "team_member_agreed_on_going_public_at": "2020-07-31T09:32:26.623Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "weakness": {
    "id": 19,
    "name": "Path Traversal"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 167,
  "voters": [
    "korniltsev",
    "slingx",
    "kristoferent",
    "hackerontwowheels",
    "n0x496n",
    "foobar7",
    "zonduu",
    "mashoud1122",
    "mainteemoforfun",
    "mirhat",
    "and 157 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 8.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "low",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 40229,
    "asset_type": "APPLE_STORE_APP_ID",
    "asset_identifier": "539883307",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 23865,
      "category": "team",
      "content": "Initially, @hackerontwowheels and @renekroka discovered that by using a path traversal payload combined with `#` to block out the file extension, arbitrary, pre-installed applications could be executed. It was not possible to provide additional arguments to these applications, however. \n\nThe payload used for OS X Yosemite was: `..%2f..%2f..%2f..%2f..%2f..%2f..%2fApplications%2fCalculator.app#.zip`, which would execute the calculator app. \nRunning commands with parameters, was not possible (Example: `/Applications/iTerm.app ls -al`).\n\nAfterwards, the reporters also identified an issue where they could achieve code execution, given that gatekeeper was disabled, by chaining the upload of an executable file through \"Keep\" (a file storage service in the LINE App), then trigger the execution using the previous path traversal vulnerability. The filetype had to be a .terminal file, due to it not being on the blacklist, as Keep normally filters executables and restricts sharing of these types of files in order to avoid this type of issue.\n\nThe complete chain looked like this:\n1. Upload malicious .terminal file to Keep\n2. Share .terminal file with victim from Keep\n3. Victim downloads shared file\n4. Send malicious .zip file with path traversal vulnerability\n5. Victim clicks .zip file\n6. Code is executed (if Gatekeeper is turned off)\n",
      "user": {
        "id": 635803,
        "username": "p_p",
        "name": "Robin",
        "bio": "I used to manage the LINE Bug Bounty program. This account is now inactive! If there is anything, please contact me through Twitter.",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2019-06-05T03:33:10.847Z",
        "url": "https://hackerone.com/p_p",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/635/803/f09a40d90bc39c3099bf22e83e21b6ec71bf3f58_original.jpeg/d7b0d969b6320751e1c58b9e3efff1e228054ee3d8eade5c51c4c79b25513a9c"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "id": 20865,
      "category": "researcher",
      "content": "Through a logic error in file name parsing, it was possible for a malicious actor to send a specially crafted zip file to a target user, which when opened in the MAC App would execute any application or executable in ~/Downloads. Furthermore, we discovered two ways to bypass the file upload restrictions where we could send any file extension to users, for example ``.terminal`` files.  Using both logic errors, it was possible for an attacker to send a malicious executable, and then a malformed zipped file to execute the previous executable bypassing all file transfer restrictions and gaining code execution on unsuspecting users. ",
      "user": {
        "id": 53853,
        "username": "hackerontwowheels",
        "name": "hackerOnTwoWheels",
        "bio": "I  like to hack stuff and ride bikes.",
        "cleared": true,
        "verified": true,
        "website": "https://ugwst.com",
        "location": "USA",
        "created_at": "2016-02-02T03:04:01.459Z",
        "url": "https://hackerone.com/hackerontwowheels",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/3f4n44j7d5781pc2sg8zzpl4y29z/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/3f4n44j7d5781pc2sg8zzpl4y29z/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/3f4n44j7d5781pc2sg8zzpl4y29z/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
