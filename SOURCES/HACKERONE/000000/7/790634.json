{
  "id": 790634,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTA2MzQ=",
  "url": "https://hackerone.com/reports/790634",
  "title": "When you call your branch the same name as a git hash, it could be checked out by dependents",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-02-07T16:49:44.872Z",
  "submitted_at": "2020-02-07T16:49:44.872Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "retroplasma",
    "url": "/retroplasma",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-08-19T21:09:21.671Z",
  "bug_reporter_agreed_on_going_public_at": "2021-08-19T21:04:39.786Z",
  "team_member_agreed_on_going_public_at": "2021-08-19T21:09:21.479Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "### Summary\n\nIf we call a branch the same name like a git hash then the moment it's checked out somewhere, git prefers the branch name.\nSo let's say the git hash is \"e91803d442559d6efb63102b10c919e10901b01d\".\nAnd someone referenced that hash in their program.\nNow the developer or a hacker with access to the repo can create a branch named \"e91803d442559d6efb63102b10c919e10901b01d\".\nGit will checkout the branch and not the hash when someone puts \"git checkout e91803d442559d6efb63102b10c919e10901b01d\".\nGitHub prevents users from pushing branches that are the same name as hashes, but GitLab does not.\n\n### Steps to reproduce\n\n(Step-by-step guide to reproduce the issue, including:)\n\n1. Take a hash of a commit A\n2. Go to any other commit B\n3. Create a branch that is named the same as the hash from commit A\n4. Push\n5. If someone references the hash in their program, their \"git checkout\" will checkout commit B. Because it will use the branch name instead of the hash\n\n\n### Impact\n\nReferencing a hash isn't secure anymore. It would reference a branch that has completely different data.\ngit shows a warning but \"git checkout {...}\" is often used.\n\n### Examples\n\nAny project that refs a git ref\n\n### What is the current *bug* behavior?\n\nGitlab accepts pushed branches that are 40-char hexadecimals\n\n### What is the expected *correct* behavior?\n\nGitlab shouldn't accept pushed branches that are 40-char hexadecimals (like Github does9\n\n### Relevant logs and/or screenshots\n\n-\n\n### Output of checks\n\n-\n\n#### Results of GitLab environment info\n\n-\n\n## Impact\n\nRedirect pinned refrs of libraries if there is control of a library. A referenced hash won't point to a hash anymore. An attacker can make the branch which has the hash's name contain any other data.",
  "bounty_amount": "2000.0",
  "formatted_bounty": "$2,000",
  "weakness": {
    "id": 72,
    "name": "Resource Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 39,
  "voters": [
    "taha",
    "th3hidd3nmist",
    "arw9234",
    "n1m0",
    "w31rd0",
    "fqdn",
    "cupc4k3",
    "rzx007x",
    "bl4de",
    "ali",
    "and 29 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 18138,
    "asset_type": "URL",
    "asset_identifier": "gitlab.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
