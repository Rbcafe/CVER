{
  "id": 758445,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTg0NDU=",
  "url": "https://hackerone.com/reports/758445",
  "title": "HTTP Smuggling multiple issues in Squid 3.x & squid 4.x",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2019-12-14T11:11:17.654Z",
  "submitted_at": "2019-12-14T11:11:17.654Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "regilero",
    "url": "/regilero",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5DNGZVVG%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T133328Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICHLJPsWBp5sr6QP325sn3QmpUNWJkG1Rn9WpoDeqIg3AiEAiF8%2BSn1jT5ntK2r0sSCmNUGX9ZemOesqgbKFIUBuyWMqsAUIdhADGgwwMTM2MTkyNzQ4NDkiDD5dvB5yVZqhTClUciqNBapM8w3AEMj9vUut8ipBYyxkUXmIzrvgZ28gnqyQ6mhhFeeoPRU%2FpSxAJl9%2BpYrNip4ItC3BkgYDlk9abNplTrvNVi9OhutOp4ZE1wWKJlPpOzKXUOBoUe%2FRWzdh9xwCJuGDbGkQ7ngPegxy3y6LCFP5wP6sjVHLhEaT7e6L88U08XjQmZEZxAGGE5IESnoSUeW4EvOXBp5DQcR1t39zozskg4dISh5C2Ff6jgUnjDu9sYdoZA7dJgdByDPIA4VjLFdTVEjklaMXr4YtD7wTmG9hWanDSlJ11qBRruTBFPloL6Kq2YKCTOj8wC0UP9ctvuxeNwV7QKFhmu8bB6csA5mvLVxUvoelFVuLgYYhtCHZDGPo54Dzbn5soqg%2FJjzSexzqrvBtELxoPLfeuC9o2KpP0lfY7eBpdmAqxwpFPSBaxPJ66SICOozWWbpDqIqnFrnvz%2BXEMOe5z7dsDsKieBfX52kLKmUuAGG9Tv0jWo8CMlR7jOkbaaLMpho6b6rMGTGHucZmDgIYIwvcdVrd1njiiPPNTxx6qoUNz0WdZUAlGWBtiCv4fABRuY7ZjWGOAD0PFPT8FsbFoQ6mkw28XZaoMR735I%2FMJlHvafhgKlPNFVKsVzF%2F3GpLM7ECVpPoLq9VNtYgjHnuZ0U6e4r9781nElHBM1WdTrWia%2F9%2FJIwTVLKAnxWWWscJrGFA8kraj4Xrc3KPePGa2suQ5Fim1jPzWeLA%2Bfr7aEab%2FJVFYU%2F%2BIs0KPZarsTUlG%2B656GYmZcf%2Fa2gbirYZQRBwlZlZahqG0l8iMLSK0TCfJOwBIAuJd7wWISVFGCV0aYj458Ker2Pjca9HvyzcI8qiuhyhF68QiOr9MFM67rM70ExPMPHFra4GOrEB58pDHOC4avlR6xYMRYlBCOP%2F5dyV6PT6gr9Vs5I8zhf3jjEkzka6Au6GNesJTj11PvvCjC1fFqxeJeAvkQZYn2pzivrXx7RBTeI6fAxztLLN3Lu9uyUpmO1SqciT2zDRX2wO0JTz6DtjgCLlfMq%2FHCRF8EoZi0alN2KMbAkJBqtFpznpmUaem89ejwzJcKJLTQiW1rXarR6VZiM7isz2KsMf5L4b0KstHgl%2Fux6s5iUg&X-Amz-SignedHeaders=host&X-Amz-Signature=6e5f39fdbe59c61c98212ab5f5dd508407279738d9a2d41fa0787fff013fe331",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5DNGZVVG%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T133328Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICHLJPsWBp5sr6QP325sn3QmpUNWJkG1Rn9WpoDeqIg3AiEAiF8%2BSn1jT5ntK2r0sSCmNUGX9ZemOesqgbKFIUBuyWMqsAUIdhADGgwwMTM2MTkyNzQ4NDkiDD5dvB5yVZqhTClUciqNBapM8w3AEMj9vUut8ipBYyxkUXmIzrvgZ28gnqyQ6mhhFeeoPRU%2FpSxAJl9%2BpYrNip4ItC3BkgYDlk9abNplTrvNVi9OhutOp4ZE1wWKJlPpOzKXUOBoUe%2FRWzdh9xwCJuGDbGkQ7ngPegxy3y6LCFP5wP6sjVHLhEaT7e6L88U08XjQmZEZxAGGE5IESnoSUeW4EvOXBp5DQcR1t39zozskg4dISh5C2Ff6jgUnjDu9sYdoZA7dJgdByDPIA4VjLFdTVEjklaMXr4YtD7wTmG9hWanDSlJ11qBRruTBFPloL6Kq2YKCTOj8wC0UP9ctvuxeNwV7QKFhmu8bB6csA5mvLVxUvoelFVuLgYYhtCHZDGPo54Dzbn5soqg%2FJjzSexzqrvBtELxoPLfeuC9o2KpP0lfY7eBpdmAqxwpFPSBaxPJ66SICOozWWbpDqIqnFrnvz%2BXEMOe5z7dsDsKieBfX52kLKmUuAGG9Tv0jWo8CMlR7jOkbaaLMpho6b6rMGTGHucZmDgIYIwvcdVrd1njiiPPNTxx6qoUNz0WdZUAlGWBtiCv4fABRuY7ZjWGOAD0PFPT8FsbFoQ6mkw28XZaoMR735I%2FMJlHvafhgKlPNFVKsVzF%2F3GpLM7ECVpPoLq9VNtYgjHnuZ0U6e4r9781nElHBM1WdTrWia%2F9%2FJIwTVLKAnxWWWscJrGFA8kraj4Xrc3KPePGa2suQ5Fim1jPzWeLA%2Bfr7aEab%2FJVFYU%2F%2BIs0KPZarsTUlG%2B656GYmZcf%2Fa2gbirYZQRBwlZlZahqG0l8iMLSK0TCfJOwBIAuJd7wWISVFGCV0aYj458Ker2Pjca9HvyzcI8qiuhyhF68QiOr9MFM67rM70ExPMPHFra4GOrEB58pDHOC4avlR6xYMRYlBCOP%2F5dyV6PT6gr9Vs5I8zhf3jjEkzka6Au6GNesJTj11PvvCjC1fFqxeJeAvkQZYn2pzivrXx7RBTeI6fAxztLLN3Lu9uyUpmO1SqciT2zDRX2wO0JTz6DtjgCLlfMq%2FHCRF8EoZi0alN2KMbAkJBqtFpznpmUaem89ejwzJcKJLTQiW1rXarR6VZiM7isz2KsMf5L4b0KstHgl%2Fux6s5iUg&X-Amz-SignedHeaders=host&X-Amz-Signature=1cb697dab2ccb58fc2d64b7707ca60cdcad5e69dff8954b22db77987a0713001"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2019-18678",
    "CVE-2020-15811",
    "CVE-2020-8449"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-08-26T23:57:28.217Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2021-07-27T23:57:26.686Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello, as can be seen on a recent public security update by Squid I reported several smuggling issues.\nIf you want some background on impact of Smuggling issues You can check the current works of James Keetle or my own previous published works.\n\n* https://www.youtube.com/watch?v=upEMlJeU_Ik  HTTP Desync Attacks: Smashing Into The Cell Next Door - James Kettle\n* https://www.youtube.com/watch?v=dVU9i5PsMPY  DEF CON 24 - regilero - Hiding Wookiees in HTTP: HTTP smuggling\n\nBut I'm quite sure that the recent additions of Smuggling tools in Burp suite is making Smuggling impacts issues more easy to understand now.\n\n# CVE-2019-18678\n \n* http://www.squid-cache.org/Advisories/SQUID-2019_10.txt\n\ncurrent score (5 / 5.3) available at :\n* https://www.suse.com/fr-fr/security/cve/CVE-2019-18678/\n\n> --------------------------\n> Advisory ID:        SQUID-2019:10\n> Date:               November 05, 2019\n> Summary:            HTTP Request Splitting issue\n>                     in HTTP message processing.\n> Affected versions:  Squid 3.0 -> 3.5.28\n>                     Squid 4.x -> 4.8\n> Fixed in version:   Squid 4.9\n> ---------------------------->\n> \n> http://www.squid-cache.org/Advisories/SQUID-2019_10.txt\n> \n> (...)\n> \n> Credits:\n> \n>  This vulnerability was discovered by by RÃ©gis Leroy (regilero\n>  from Makina Corpus).\n>\n> Fixed by Amos Jeffries of Treehouse Networks Ltd.\n>  Revision history:\n>\n>  2019-07-24 11:52:51 UTC Initial Report\n>  2019-09-11 02:52:52 UTC Patches Released\n>  2019-11-04 13:43:22 UTC CVE Assignment\n\nI can give more details than what is publicly available.\nOn the initial report from 2019-07-24 there were 4 issues. Only 1 of these issues is currently covered by the CVE-2019-18678.\n\n## Issue 1 : undisclosed Squid 3 issue\n\nThere is also an undisclosed Security filter bypass for Squid 3.x. This is a wonfix for Squid because Squid 3.x is not maintained anymore.\nWithout complete details this is an abuse of separators characters which allows access to urls where a security filter in Squid is present to prevent such locations from being accessed.\n\nProject maintainer response:\n\n> Please be aware that Squid-3 has been deprecated for several years now.\n> Several of the problems you are pointing out are well-known issues with\n> the HTTP protocol design from RFC2616 itself not being clear. Squid-3\n> primarily implements that specification, with only sprinkling of RFC7230.\n>\n> Squid-4 increases the upgrade to RFC7230 specification with\n> implementation of the majority of message parsing updates. Though that\n> is still an ongoing work.\n>\n> (...)\n> As do Squid-4 releases. The fix is to upgrade the proxy to a version\n> where the problem has been fixed.\n\n## Issue 2 : HTTP Response Splitting issue on bad withespaces before header's colon\n\nSquid allowed bad withespaces characters between the header title and the colon (before value).\nThis is forbidden in RFC 7230.\n\n> 3.2.  Header Fields\n>\n> Each header field consists of a case-insensitive field name followed\n> by a colon (\":\"), optional leading whitespace, the field value, and\n> optional trailing whitespace.\n> header-field   = field-name \":\" OWS field-value OWS\n> field-name     = token\n> (...)\n> \n> 3.2.4.  Field Parsing\n> (...)\n> **No whitespace is allowed between the header field-name and colon**.  In\n> the past, differences in the handling of such whitespace have led to\n> security vulnerabilities in request routing and response handling.  **A**\n> **server MUST reject any received request message that contains**\n> **whitespace between a header field-name and colon** with a response code\n> of 400 (Bad Request).  A proxy MUST remove any such whitespace from a\n> response message before forwarding the message downstream.\n\nThis could be used to perform HTTP Smuggling attacks (if you want more details on exploitations I can add some very detailled examples, I'll just give you a short version).\n\nVarious invalid syntax where a space or pseudo space is added before ':' in the header line could be used against Squid to obtain an HTTP Response splitting attack:\n\n* Transfer-Encoding : chunked\\r\\n\n* Transfer-Encoding\\t: chunked\\r\\n\n* Transfer-Encoding\\f: chunked\\r\\n\n* Transfer-Encoding\\f: chunked\\r\\n\n* Transfer-Encoding\\r: chunked\\r\\n\n* Transfer-Encoding\\x0b: chunked\\r\\n\n* Transfer-Encoding\\t\\x0b \\r\\f: chunked\\r\\n\n\nSquid would give 3 response for this request (it should see only 2 requests, one from 01 to 12, and one from 13 to 15, but Squid saw one from 01 to 08, one from 09 to 12 and one from 14 to 15):\n\n01 POST /?t=41 HTTP/1.1\\r\\n\n02 Host: dummy-host.example.com\\r\\n\n03 X-REQUEST-IDENTIFIER: 41\\r\\n\n04 Content-Length: 92\\r\\n\n05 Transfer-Encoding\\x0b: chunked\\r\\n\n06 \\r\\n\n07 0\\r\\n\n08 \\r\\n\n09 GET /foo.html?t=42 HTTP/1.1\\r\\n\n10 Host: dummy-host.example.com\\r\\n\n11 X-REQUEST-IDENTIFIER: 42\\r\\n\n12 \\r\\n\n13 GET /bar.html?t=43 HTTP/1.1\\r\\n\n14 Host: dummy-host.example.com\\r\\n\n15 X-REQUEST-IDENTIFIER: 43\\r\\n\n15 \\r\\n\n\nImpacts are quite high, like HTTP Cache poisoning for any actor set in front of Squid, and security filter bypass for this previous actor also. Adding extra responses from the Squid stream is definitively a good way for adding choas on the HTTP chain (Dos, Xss, etc).\n\n## Issue 3 : Undisclosed SeverSide Request Forgery issue\n\nThis one is only fixed on master. The fix is not present on any published version of Squid. So we may talk about it later.\n\n\n## Issue 4 : Undisclosed HTTP Request Splitting\n\nThis one is still present and not yet fixed. So we may talk about it later, because I think it will be fixed one day.\nI'm pretty sure this issue will soon be discovered by other bounty hunters. So I don't know if I should already give more details to claim precedence, currently I'll keep the details undisclosed and let the project maintainers act on that.\n\n## Summary\n\nIssue `#2` is the one covered by the published CVE.\nFor issues `#3` & `#4` I'm pretty sure that I will make reports later.\nFor issue `#1` I'm not sure this can be covered by this program, I could give you more details if you want.\n\n## Impact\n\nLike most HTTP Smuggling issue impact is not always directly targeted on Squid, here (if we only talk about issue #2) the impact is very important for HTTP actors set in front of squid (like an SSL terminator).\n\nCache poisoning,  DOS, XSS, etc.",
  "weakness": {
    "id": 1,
    "name": "HTTP Response Splitting"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-08-26T23:57:26.852Z",
  "allow_singular_disclosure_after": -77808961.81853639,
  "singular_disclosure_allowed": true,
  "vote_count": 74,
  "voters": [
    "mass0ma",
    "tolga",
    "haxor31337",
    "fqdn",
    "zy9ard3",
    "nikitastupin",
    "run_win",
    "bl4de",
    "ali",
    "thetime",
    "and 64 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.6,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 84124,
    "asset_type": "OTHER",
    "asset_identifier": "IBB (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
