{
  "id": 765825,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NjU4MjU=",
  "url": "https://hackerone.com/reports/765825",
  "title": "Git repo on https://██████.mil/ discloses API password",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2019-12-29T16:49:49.871Z",
  "submitted_at": "2019-12-29T16:49:49.871Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "al-madjus",
    "url": "/al-madjus",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/340/244/c9666ba3cc7b1d2720860b836b33fdacfa969b78_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-03-24T20:49:00.187Z",
  "bug_reporter_agreed_on_going_public_at": "2021-03-22T17:11:56.877Z",
  "team_member_agreed_on_going_public_at": "2021-03-24T20:49:00.098Z",
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\nI found a .git repository on https://███████.mil/.git which discloses an API password for Yubikey on 2 different domains, together with full source code. \n\n**Description:**\nFetching the git repository and decompressing the objects results in the ability to read the source code of the server, which includes an API password for the Yubikey hardware authentication software. The API however does not appear to be functional on the main domain, but since the repository is very recent, I cannot be certain that it'll stay non-functional. \nAdditionally, the server discloses info.php at https://███████.mil/info.php. I'm uncertain if this should be reported separately, any comments on this would be very welcome! \n\n## Impact\nI'm rating the impact of this primarily as an information disclosure. The repository appears to have been active within the past months, so any future additions will be disclosed too. \nI was unable to use the found password as the API appears to be currently non-functional, but since the repo is active I would expect the server to be worked upon, and the API to be functional in the future. For this reason I've decided to make you aware of the issue. \nAlso, even if the password were to be changed, it would of course still be disclosed on the repository. \nFurthermore, the repository discloses the full source code of the served pages. \n\n## Step-by-step Reproduction Instructions\n\n1. Fetch the repo with wget:\n\n`wget --no-parent -r https://█████.mil/.git/ --no-check-certificate`\n2. Write the following python script (remember to update the 'pwd' variable): \n\n`import zlib\nimport os\npwd = INSERT FULL PATH WHERE THE REPO WAS DOWNLOADED + '█████████.mil/.git/objects/'\nfor subdir, dirs, files in os.walk(pwd):\n    for file in files:\n        if not file.startswith(\"index\"):\n            filename = subdir + '/' +  file\n            compressed_contents = open(filename, 'rb').read()\n            decompressed_contents = zlib.decompress(compressed_contents)\n            print(str(decompressed_contents) + '\\n')`\n\nThe script is also attached as a file. \n3. Run the script with \n\n`python gitreader.py | grep -i -E -o \".{0,138}restPW.{0,22}\"`\n\nWhich greps the output for the string where the password is, together with the paths/domains. \nOf course, the full contents of the repository are available to look through. \n\nExample output: \n`'https://███`\n\n## Product, Version, and Configuration (If applicable)\n\n## Suggested Mitigation/Remediation Actions\nRemove the .git repository from the server, since it contains sensitive information.\n\n## Impact\n\nI'm rating the impact of this primarily as an information disclosure. The repository appears to have been active within the past months, so any future additions will be disclosed too. \nI was unable to use the found password as the API appears to be currently non-functional, but since the repo is active I would expect the server to be worked upon, and the API to be functional in the future. For this reason I've decided to make you aware of the issue. \nAlso, even if the password were to be changed, it would of course still be disclosed on the repository. \nFurthermore, the repository discloses the full source code of the served pages.",
  "weakness": {
    "id": 24,
    "name": "Password in Configuration File"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 10,
  "voters": [
    "mr-medi",
    "researcher14",
    "bhl",
    "0xelkomy",
    "ahiezer",
    "brumens",
    "sa1tama0",
    "yaboyanees",
    "rutrut",
    "5p00n"
  ],
  "severity": {
    "rating": "high",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
