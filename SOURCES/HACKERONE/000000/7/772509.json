{
  "id": 772509,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NzI1MDk=",
  "url": "https://hackerone.com/reports/772509",
  "title": "[node-downloader-helper] Path traversal via Content-Disposition header",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-01-12T03:06:19.570Z",
  "submitted_at": "2020-01-12T03:06:19.570Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ryotak",
    "url": "/ryotak",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/Nb79aqy3v6SyMh8rwZZh43cu/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-11-11T11:59:51.144Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2020-10-12T11:59:42.772Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Summary\n\nI would like to report path traversal in `node-downloader-helper`.\nIt allows malicious server to choose download location via `../`. It may leads remote code execution.\n\n# Module\n\n**module name:** `node-downloader-helper`\n**version:** 1.0.11\n**npm page:** `https://www.npmjs.com/package/node-downloader-helper`\n\n## Module Description\n\nA simple http file downloader for node.js\n\nFeatures:\n\n- No thirdparty dependecies\n- Pause/Resume\n- Retry on fail\n- Supports http/https\n- Supports http redirects\n- Supports pipes\n- Custom native http request options\n- Usable on vanilla nodejs, electron, nwjs\n- Progress stats\n\n## Module Stats\n\n13,911 weekly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\nSince there is no sanitization of file path, malicious server is able to traversal path of victim machine.\nIt leads remote code execution by putting malicious executable to startup folder in Windows. (In Linux, it's possible to create authorized_key.).\n\n## Steps To Reproduce:\n\n1. Put `poc.php` to the server. (or you can use my server's PoC: https://exec.ga/download-test.php )\n2. Modify `poc.js` to set URL of the `poc.php`\n3. Execute `node poc.js`\n4. `evil.txt` will be saved to parent directory of the directory which contains `poc.js`\n\n## Supporting Material/References:\n\n- Windows 10\n- v12.13.1\n- 6.12.1\n\n# Wrap up\n\n- I contacted the maintainer to let them know: N\n- I opened an issue in the related repository: N\n\n## Impact\n\nAttacker is able to put malicious contents anywhere of victim's machine.",
  "weakness": {
    "id": 19,
    "name": "Path Traversal"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-11-11T11:59:42.859Z",
  "allow_singular_disclosure_after": -102735328.03455368,
  "singular_disclosure_allowed": true,
  "vote_count": 2,
  "voters": [
    "rook1337",
    "deneuve"
  ],
  "severity": {
    "rating": "medium",
    "score": 4.6,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 56839,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "node-downloader-helper",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
