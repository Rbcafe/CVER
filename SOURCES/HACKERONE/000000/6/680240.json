{
  "id": 680240,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82ODAyNDA=",
  "url": "https://hackerone.com/reports/680240",
  "title": "Stored XSS at Synthetics private locations (planted through location label or description)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2019-08-23T11:26:39.717Z",
  "submitted_at": "2019-08-23T11:26:39.717Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "skavans",
    "url": "/skavans",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 17011,
    "url": "https://hackerone.com/newrelic",
    "handle": "newrelic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "New Relic",
      "twitter_handle": "newrelic",
      "website": "https://newrelic.com",
      "about": "New Relic's Coordinated Disclosure Program"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-08-13T15:29:51.085Z",
  "bug_reporter_agreed_on_going_public_at": "2020-08-11T09:39:15.955Z",
  "team_member_agreed_on_going_public_at": "2020-08-13T15:29:50.959Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hey team,\n\nI've discovered stored XSS at Synthetics private locations list. The `Private locations` page contains a script with private locations metadata inside and the user-input of location label and description aren't properly escaped as you can see below:\n```html\n<script type=\"text/javascript\">\n        window._nr = {\"config\":{\"enforceBillingMultiplier\":2.0,\"environment\":\"production\",\"gaDates\":{\"infrastructure\":\"2016-11-16T00:00:00+00:00\"}, ... \"privateLocations\":{\"available\":true,\"successful\":true,\"privateLocations\":[{\"highSecurityMode\":false,\"private\":true,\"name\":\"2385914-xf8xssimg_srcxf8xss-F77\",\"label\":\"'\\\"xf8xss><img src=xf8xss>\",\"slug\":\"2385914-xf8xssimg_srcxf8xss-F77\",\"shortCode\":\"xf8xssimg_srcxf8xss\",\"available\":true,\"deprecated\":false,\"aliased\":false,\"description\":\"</script><script>alert(document.domain)</script>\"}]},\"userId\":2552670,\"isNREmployee\":false}};\n      </script>\n```\nSo, attacker (a user having access to private locations) can craft malicious private location and inject a payload into its label or description. Then, when the victim visits the private locations page, the payload will be executed.\n\n##Steps to reproduce\n1) Sign into the Synthetics app with account having access to Private Locations\n2) Add new private location with name `test` and description `test`\n3) Open this private location editing page **at the separate browser tab** and keep it open (it is needed because the payload breaks the legitimate page JS and the page becomes unusable, you could fix this later by editing this private location back at this saved tab)\n4) Open **one more** private location editing page (at other browser tab) and change private location description to `</script><script>alert(document.domain)</script>`\n5) Navigate to private locations list again and make sure the alert box is popped up\n{F563051}\n6) Change the malicious description back using a browser tab opened at step 3\n\n##Mitigation\nYou should properly escape the private location metadata before injecting them into the page.\n\n## Impact\n\nStored XSS",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 563051,
      "file_name": "______________2019-08-23___14.14.59.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/FZWXuGzR3nV4yoBuCrPsa7mb?response-content-disposition=attachment%3B%20filename%3D%22______________2019-08-23___14.14.59.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-08-23___14.14.59.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTRSPJQEY%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T132707Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIANREuSO5xRo5uYh9p3fj5lFZASOM0CJaqF9aRTyqP1tAiBMs6gYtXIgibXyOqYUXBJZxA%2Fdza4ke6K%2F%2F0b5E9m1RSqwBQh2EAMaDDAxMzYxOTI3NDg0OSIM8OmUCbC3Pqq1SyEDKo0F3cO4ThOa4uitsGZnpJd4WSWYKi0%2F5mL8qwHwgq3ZuZ1aNUqEK3JGtjDNNtehYQzb3K%2BVzvT15T5E0DeN3sE8NL7KIl3i0Dx5W04t%2FCwofuZVDH6Rwez2OIyLRGEiHKo%2FP%2FkbGO6J7x9mVhWTOKS2bFg4igbBGqP%2Bi2aedUT3vluiB7ukP1cc428RmdmCV%2BuhSI6mu%2Fx6zanZ8MjIY1iRcGFyRSvjl0iN9Apkcqbj2H8R4UNg8b2kqipVUPR0IhWE4Repf%2B6oHnySIQcgKlfP60eivKF7%2BDxEpCbVDsb91wMe67XzEaDtj4q3yEkaR59%2FnN0%2Fg51i8gvLHyAK2aB8UWfJhpojdnN%2FB%2BaF6aGM1Zep47eAH4cQQWhMZ2I26LKQhm7iwRj6IEHbgHd2m6nHPOKHU2uWuHo13GDorNeQWMI%2FABbIu1tC%2FBPGMydY2v4uUNIntKjUUw%2BXSGO9A9lk6BbiANo%2BTxvrgKzjhYstigi28K%2FJy2l%2B50z3nW5D8NMHVXHTF9%2FfZJj2T3gBRe9rfchTv6%2Bbpy1%2Bn8nOxmudj%2B9inUeddHC6rtgTt35Y1V%2FQuDeghaOCTLBIQIRUj2dXMLrSvM6ipTuqtOLpxyjWPKhlGteSd9sRZ2GulqFnPco4IJ18%2Fn03rD%2FZTFvntG5nnCfDUN1rKUSiHRLc%2Be2fxn1LToFrzjJFDRvOSJIM%2FpzLFcAYL8tTTyFBkIKfd049EasT8fD7XkmUkbP9SU%2Fz3oask16Cc%2FxTEDv733bE%2B2WRdqbzle4n0HY%2F8WFiXHg%2FcBG11MfaIEqM74wTZ5xO8lGQRD8qVunQROTT4innfbTfWRrrpjWEVYNiOx7p4%2BZ0qgpFMn9%2F3hcTkdABX%2BMwpcOtrgY6sgEIuPpZKWB6MctyieUs6Zf8b%2FX4IKPm%2BfhMeS2tI0il7r2OReIXdjDVkC4sQOPEZhbn%2BDfZAXOoMl6LPgx5C10nOg8D%2BTLxqQZt9rcPO7a6NY6DuIvhZo5c4RdVjEGuOfc%2FAROg4UmbOf0zkue94sBg8VslzPwR4H20rwyBYQqkWxtaGVbZKYCCbNb6IEpuSkgMadMJvwHOmUUOWS2k1Jnl6yQZixJKKroR7DQEK1J3Lebd&X-Amz-SignedHeaders=host&X-Amz-Signature=dd7da9db4bf2ee1d0bd3f967847cefc3535c52c4d09bb5c98eeb6762056c0e9f",
      "file_size": 61599,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-09-10T09:39:15.991Z",
  "allow_singular_disclosure_after": -108100071.17828524,
  "singular_disclosure_allowed": true,
  "vote_count": 8,
  "voters": [
    "wi11",
    "sameerphad72",
    "ali",
    "cryptographer",
    "pkhadka",
    "036467383637",
    "r7le",
    "mr0bart"
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 4411,
    "asset_type": "URL",
    "asset_identifier": "synthetics.newrelic.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
