{
  "id": 462321,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NjIzMjE=",
  "url": "https://hackerone.com/reports/462321",
  "title": "Ability to view monitor names of other NR accounts through internal API (v3) via \"monitor_id\" parameter ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2018-12-14T02:12:29.814Z",
  "submitted_at": "2018-12-14T02:12:29.814Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "jon_bottarini",
    "url": "/jon_bottarini",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 17011,
    "url": "https://hackerone.com/newrelic",
    "handle": "newrelic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "New Relic",
      "twitter_handle": "newrelic",
      "website": "https://newrelic.com",
      "about": "New Relic's Coordinated Disclosure Program"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-09-04T11:03:45.237Z",
  "bug_reporter_agreed_on_going_public_at": "2020-08-20T02:41:51.306Z",
  "team_member_agreed_on_going_public_at": "2020-09-04T11:03:45.137Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "NR Alerts gives you the granularity to set alert conditions on an alert policy depending on the conditions you specify at the https://alerts.newrelic.com/accounts/ACCOUNT_NUMBER/policies/POLICY_ID/conditions/new URL. When you select an entity for the condition, the application does not check to ensure that the entity ID you have select actually belongs to your account. This allows you to create a condition based on another user's account in New Relic. \n\n## Steps to Reproduce\n\n1. Login to the victim account and create a new Synthetic Monitor. Once you've created the monitor, copy down the **monitor ID** (It should look something like this: https://synthetics.newrelic.com/accounts/2142209/monitors/3998449d-95e3-4fe8-8543-709018a76b88) - you care about this part of the URL: `3998449d-95e3-4fe8-8543-709018a76b88`\n2. Logout of the victim account and login to the account of the attacker. Within the attacker account, navigate to https://alerts.newrelic.com/accounts/ACCOUNT_ID/policies/new\n3. Create a new policy \"by policy\" and click save alert policy. \n4. Once it is created, click on \"Create a condition\" and select the \"Synthetics\" product under \"Categorize\" it should look like this: \n\n{F390115}\n\n5. Click on \"Next - Select Entity\" and choose _any_ entity in this list. It does not matter, we will change the ID in the request itself. \n6. Click define thresholds\n7. Name the condition \"IDOR\" then click on \"Create condition\" \n8. Your new condition will be created. For whatever reason, we need to make another alert condition for this to work. Click on the \"Add a condition\" button and go through the same steps again - choose synthetics, select a random entity from your account, define the thresholds and name the condition \"IDOR 2\"  - before you click on \"Create condition\", turn on your proxy in Burp so you intercept the request\n\nThe following POST request will be made: \n\n```\nPOST /internal_api/v3/accounts/1523936/policies/444792/conditions HTTP/1.1\nHost: alerts.newrelic.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:64.0) Gecko/20100101 Firefox/64.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://alerts.newrelic.com/accounts/1523936/policies/365651/conditions/new\nX-NewRelic-ID: VRUGU1FbCAo=\nX-Requested-With: XMLHttpRequest\nContent-Type: application/json;charset=utf-8\nX-XSRF-TOKEN: myxsrftoken\nContent-Length: 452\nConnection: close\nCookie: mycookies\n\n{\"condition\":{\"policy_id\":444792,\"condition_type\":\"synthetics_monitor_failure\",\"name\":\"test\",\"monitors\":[\"AWS_AP_NORTHEAST_1\",\"AWS_AP_SOUTHEAST_1\",\"AWS_AP_SOUTHEAST_2\",\"AWS_EU_CENTRAL_1\",\"AWS_EU_WEST_1\",\"AWS_EU_WEST_2\",\"AWS_SA_EAST_1\",\"AWS_US_EAST_1\",\"AWS_US_EAST_2\",\"AWS_US_WEST_1\",\"AWS_US_WEST_2\",\"LINODE_US_CENTRAL_1\",\"LINODE_US_EAST_1\",\"LINODE_US_WEST_1\"],\"monitor_id\":\"6f554dd8-b839-4182-bb86-3a8495ccacfc\",\"enabled\":true,\"terms\":{\"critical\":{}}}}\n```\n\n9. Now, swap out the `\"monitor_id\"` within this POST request with the `\"monitor_id\"` from the victim's account. \n10. Send the request through and you'll see that the monitor name has been changed to reflect the monitor belonging to the other account, indicating the IDOR was successful:\n\n{F390120}\n\n## Impact\n\nRight now, it looks like I'm only able to grab the monitor name from the monitor ID I enter, but I'm working on generating some errors to see if it exposes monitor data as well",
  "bounty_amount": "2000.0",
  "formatted_bounty": "$2,000",
  "weakness": {
    "id": 55,
    "name": "Insecure Direct Object Reference (IDOR)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 390115,
      "file_name": "Screen_Shot_2018-12-13_at_6.43.20_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/390/115/ef22c8f850a3548cbbc90aa6b2f9415bc5a6cc86/Screen_Shot_2018-12-13_at_6.43.20_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-12-13_at_6.43.20_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-12-13_at_6.43.20_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ4ABT4GR%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T131516Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBy6B6CaeGOQsHQEVf6mmFMeFsyrU6xwojWydbGY7RrjAiEAt098VbuwY4XR0q%2FhT1%2BwOM5SQIHiByhn7YH5ul9I%2Bn0qsQUIdRADGgwwMTM2MTkyNzQ4NDkiDFBaVga66U2cxXTWDSqOBZ9tNE39KmDEn1M4BXloMcPBeBllafRlZWXN4mbzGTLJ8XKW77G1i6rQMiYeX0mALiTgT6%2BCHJg%2FXOkgcCoWTiU8AGVS8ygbrG6Rmef84ITNYSRHXYOiAmAtLriRM0FNkbvdPDxzRHKptbdJe%2FxQx6iHxnF4Wbz2d%2BiPKmLG1dOUk9Wd5PcY6e%2FpFK3MQHhbP60DtFaNSQZiLijq7McbVpknudWszl6E666zMtQlGzHcdmQhcfLUGV%2Fh2eQIW07Q8StsP0DnifOlRfH5wmBWZeOVGiQmAiu4vix6Kx70b5sEUa60B8XEzX3iLRbRpvoMJI2iFfwEhBUfyAO2kQFI891jfDtZMWBRAeJzS2TDBSZOFWdllL1Ku5BlluxzcTwgDBcj6U9BeRoIR%2FE%2F%2FzJhFrI6sO4C9sHXlsgFD4n6%2BV%2BMht3eSvRmwlqvwAGbQgoXg1TnmoDMTwU9bHj7KKScAqVQBI8hZ2NsP8SjJg8QJ0z%2BQTTuA8uOznjEUpW73jDmEQTBVhmpeZcwxP4%2BU6nQB8LguHWkl5NBmrNRrQGJGWsRxHHT40HVpMkdUBcHLz%2BE4kW3xThQV2%2FnlNJrQbkP9idnhRNm421huVhZIih2gBVsmfHNfFtpBWAgyhZal1fyaA5PfM8x1h1HAwbgAbx5pWpwX6P35EkSqglhC9hYX4Mx81Hh8c9ng5X9OnjAGOW2svJkxKq9ucSCCtD2ch3QThvWYUo6MweIyhK%2Fc7x1IsUKbcstBILZpn1l%2BukPwZKsmW0eclxFPYN5toUHjUictBuWWthA5Xkwhoewwr4uhuDUwpqTTEYBtxfAUMWwC9b4A0nNdO5YVjG1Et5gL7AXZuOawjRSr2cgQxq4C6b5gjDCs62uBjqxAShKZyKgt2m88YD0Vj8P6tXU495dvL8RKU8No53RBpg%2B0AGbaXTXUqyqWqfJgpK4Oo5BMDBxlCeUem5zsmh5i1y96ARljDRINVqBbClSxSFkigseR0xhxtkfysRfAXQQYk56acdX1y%2FUUtxG304UkKPWzZsl%2FZfaTuT815tCTUHh387Az8zDogkBD5OMCSblOcOAbl2D84THnFg9dMo8QXW7aVKysLeRwOxI5twdQX9Gug%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2704e9694aa6fe190e6d64549596fa9a7bf084efbb47a1979b307823888643f6",
      "file_size": 74067,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 390120,
      "file_name": "Screen_Shot_2018-12-13_at_7.03.22_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/390/120/9ad15f14a31ddb8682b975f10c54ea9c75a4acb7/Screen_Shot_2018-12-13_at_7.03.22_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-12-13_at_7.03.22_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-12-13_at_7.03.22_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ4ABT4GR%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T131516Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBy6B6CaeGOQsHQEVf6mmFMeFsyrU6xwojWydbGY7RrjAiEAt098VbuwY4XR0q%2FhT1%2BwOM5SQIHiByhn7YH5ul9I%2Bn0qsQUIdRADGgwwMTM2MTkyNzQ4NDkiDFBaVga66U2cxXTWDSqOBZ9tNE39KmDEn1M4BXloMcPBeBllafRlZWXN4mbzGTLJ8XKW77G1i6rQMiYeX0mALiTgT6%2BCHJg%2FXOkgcCoWTiU8AGVS8ygbrG6Rmef84ITNYSRHXYOiAmAtLriRM0FNkbvdPDxzRHKptbdJe%2FxQx6iHxnF4Wbz2d%2BiPKmLG1dOUk9Wd5PcY6e%2FpFK3MQHhbP60DtFaNSQZiLijq7McbVpknudWszl6E666zMtQlGzHcdmQhcfLUGV%2Fh2eQIW07Q8StsP0DnifOlRfH5wmBWZeOVGiQmAiu4vix6Kx70b5sEUa60B8XEzX3iLRbRpvoMJI2iFfwEhBUfyAO2kQFI891jfDtZMWBRAeJzS2TDBSZOFWdllL1Ku5BlluxzcTwgDBcj6U9BeRoIR%2FE%2F%2FzJhFrI6sO4C9sHXlsgFD4n6%2BV%2BMht3eSvRmwlqvwAGbQgoXg1TnmoDMTwU9bHj7KKScAqVQBI8hZ2NsP8SjJg8QJ0z%2BQTTuA8uOznjEUpW73jDmEQTBVhmpeZcwxP4%2BU6nQB8LguHWkl5NBmrNRrQGJGWsRxHHT40HVpMkdUBcHLz%2BE4kW3xThQV2%2FnlNJrQbkP9idnhRNm421huVhZIih2gBVsmfHNfFtpBWAgyhZal1fyaA5PfM8x1h1HAwbgAbx5pWpwX6P35EkSqglhC9hYX4Mx81Hh8c9ng5X9OnjAGOW2svJkxKq9ucSCCtD2ch3QThvWYUo6MweIyhK%2Fc7x1IsUKbcstBILZpn1l%2BukPwZKsmW0eclxFPYN5toUHjUictBuWWthA5Xkwhoewwr4uhuDUwpqTTEYBtxfAUMWwC9b4A0nNdO5YVjG1Et5gL7AXZuOawjRSr2cgQxq4C6b5gjDCs62uBjqxAShKZyKgt2m88YD0Vj8P6tXU495dvL8RKU8No53RBpg%2B0AGbaXTXUqyqWqfJgpK4Oo5BMDBxlCeUem5zsmh5i1y96ARljDRINVqBbClSxSFkigseR0xhxtkfysRfAXQQYk56acdX1y%2FUUtxG304UkKPWzZsl%2FZfaTuT815tCTUHh387Az8zDogkBD5OMCSblOcOAbl2D84THnFg9dMo8QXW7aVKysLeRwOxI5twdQX9Gug%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=fa91ac62831429395d1ffb31d2791c72578c3d23ef8f1e45355627f1d5bf777a",
      "file_size": 102076,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-09-19T02:41:51.354Z",
  "allow_singular_disclosure_after": -107346805.56237915,
  "singular_disclosure_allowed": true,
  "vote_count": 8,
  "voters": [
    "wi11",
    "ali",
    "f1ras",
    "prateek_thakare",
    "cryptographer",
    "zima00",
    "alamlearnn",
    "drealmranderson"
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 6454,
    "asset_type": "URL",
    "asset_identifier": "alerts.newrelic.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
