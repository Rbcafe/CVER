{
  "id": 425200,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MjUyMDA=",
  "url": "https://hackerone.com/reports/425200",
  "title": "XSS [flow] - on www.paypal.com/paypalme/my/landing (requires user interaction)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-10-18T00:36:35.334Z",
  "submitted_at": "2018-10-18T00:36:35.334Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "stefanovettorazzi",
    "url": "/stefanovettorazzi",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/2udi3vbdhzbpwjlrvhxisg1q29dk/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1915,
    "url": "https://hackerone.com/paypal",
    "handle": "paypal",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/E9WYrLcvXzomLyDprWfN7bq1/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/E9WYrLcvXzomLyDprWfN7bq1/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "PayPal",
      "twitter_handle": "paypal",
      "website": "http://paypal.com/",
      "about": "Send Money, Pay Online or Set Up a Merchant Account - PayPal."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-11-06T16:40:59.057Z",
  "bug_reporter_agreed_on_going_public_at": "2018-11-02T21:04:59.502Z",
  "team_member_agreed_on_going_public_at": "2018-11-06T16:40:58.970Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "### Steps to reproduce\nOn _Chrome and Firefox_:\n1. Go to `https://www.paypal.com/paypalme/my/landing?flow=cmV0dXJuVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDpceDNjc3ZnXHgyMG9ubG9hZD1hbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5XHgzZScmY2FuY2VsVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDpceDNjc3ZnXHgyMG9ubG9hZD1hbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5XHgzZSc=`\n1. Click on the __X__ at the top right of the modal window\n\nOn _Safari_:\n1. Go to `https://www.paypal.com/paypalme/my/landing?flow=cmV0dXJuVXJsPWphdmFzY3JpcFQ6UEFZUEFMLmNvbSUzZDEsbG9jYXRpb24lM2QnamF2YXNjcmlwdDphbGVydFx4Mjhkb2N1bWVudC5kb21haW5ceDI5JyZjYW5jZWxVcmw9amF2YXNjcmlwVDpQQVlQQUwuY29tJTNkMSxsb2NhdGlvbiUzZCdqYXZhc2NyaXB0OmFsZXJ0XHgyOGRvY3VtZW50LmRvbWFpblx4Mjkn`\n1. Click on the __X__ at the top right of the modal window\n\n### Explanation\nThe value of the paramter `flow` is a base64 value which decoded looks like this:\n```\nreturnUrl={paypal_url}&cancelUrl={paypal_url}\n```\n`cancelUrl` is passed as the `href` value of the __X__ button at the top right of the modal window that appears. It doesn't matter if you already created a paypal.me address.\n`returnUrl` is passed as the `href` value of the __Done__ button when you follow the instructions to create a paypal.me profile.\n\nThe problem is that `javascripT:paypal.com` is considered a valid value for `returnUrl` and `cancelUrl`. However, there a few restrictions already: you can't add a `%0a` character (or almost any special character, even using HTML encoding) and the URL has to start with `javascripT:*.paypal.com` or `javascripT:paypal.com` or `javascripT://paypal.com` or `javascripT://*.paypal.com`. \nFirst thing you have to take care of is about `paypal.com` because the object `paypal` doesn't exist, which will stop anything from working. The good thing is that `PAYPAL` does exist and `PAYPAL.com` is accepted as a valid value in the URL.\nThe second thing is that parentheses, quotes, semicolons and new lines are not allowed. But equal signs, commas and single quotes are allowed. So, you can set `PAYAPL.com` to any valid value you want like `PAYPAL.com=1`. Then you can use `location` and set it to something like `'javascript:alert\\x28\\x29'`. I encoded the invalid special characters in a encoding that Javascript understands and will decode before changing the `location`. Now you can put anything you want.\n\nOn Firefox and Chrome, the `location='javascript:alert\\x28\\x29'` writes `javascript:alert()` in the document, so I had to change it to make it work. Ended up with this: `location='javascript:\\x3csvg\\x20onload=alert\\x28document.domain\\x29\\x3e'`.\n\n## Impact\n\nYou could make actions as the authenticated user and probably more but I didn't tried.",
  "bounty_amount": "2900.0",
  "formatted_bounty": "$2,900",
  "weakness": {
    "id": 60,
    "name": "Cross-site Scripting (XSS) - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 98,
  "voters": [
    "honoki",
    "m4t35z",
    "sp1d3rs",
    "foobar7",
    "ramsexy",
    "mashoud1122",
    "benjamin-mauss",
    "bogdantcaciuc",
    "shailesh4594",
    "samux",
    "and 88 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.6,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 13591,
    "asset_type": "URL",
    "asset_identifier": "*.paypal.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
