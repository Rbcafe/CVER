{
  "id": 469668,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Njk2Njg=",
  "url": "https://hackerone.com/reports/469668",
  "title": "Passwords being stored as plain text in logging",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2018-12-18T16:44:58.604Z",
  "submitted_at": "2018-12-18T16:44:58.604Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "xatom",
    "url": "/xatom",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-08-31T12:45:35.999Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2019-08-01T12:45:31.723Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "When an exception occurs, any password sent to or being processed by the server may be stored as plain text in the log.\n\nI noticed that some methods are already being filtered in `ExceptionSerializer.php`, but many methods are missing from this list.\n\nSuggestion: instead of relying on a list of sensitive methods, filter every method with a `$password` parameter.\n\n----\n\nSteps to reproduce (example):\n\n1. Install NextCloud without SMTP server\n1. Create a new user at `https://nextcloud/settings/users`\n1. Check the logging at `https://nextcloud/settings/admin/logging`\n\nResults in 2 exceptions:\n\n```\n[ocs_api] Error: OCP\\AppFramework\\OCS\\OCSException: Unable to send the invitation mail at <<closure>>\n\n0. /var/www/html/lib/private/AppFramework/Http/Dispatcher.php line 166\n                                      vvvvvvvv\n   addUser(\"[redacted]\", \"[redacted - PASSWORD]\", \"[redacted]\", \"[redacted]\", [], [], \"10 GB\", \"en\")\n                                      ^^^^^^^^\n1. /var/www/html/lib/private/AppFramework/Http/Dispatcher.php line 99\n   executeController(OCA\\Provisioning ... {}, \"addUser\")\n2. /var/www/html/lib/private/AppFramework/App.php line 118\n   dispatch(OCA\\Provisioning ... {}, \"addUser\")\n3. /var/www/html/lib/private/AppFramework/Routing/RouteActionHandler.php line 47\n   main(\"OCA\\\\Provisioni ... r\", \"addUser\", OC\\AppFramework\\ ... {}, {_route: \"ocs.pr ... \"})\n4. <<closure>>\n   __invoke({_route: \"ocs.pr ... \"})\n5. /var/www/html/lib/private/Route/Router.php line 297\n   call_user_func(OC\\AppFramework\\ ... {}, {_route: \"ocs.pr ... \"})\n6. /var/www/html/ocs/v1.php line 82\n   match(\"/ocsapp/cloud/users\")\n7. /var/www/html/ocs/v2.php line 24\n   require_once(\"/var/www/html/ocs/v1.php\")\n\nPOST /ocs/v2.php/cloud/users\nfrom 172.18.0.4 by [redacted] at 2018-12-17T19:38:41+00:00\n```\n\n```\n[ocs_api] Error: Swift_TransportException: Connection could not be established with host 127.0.0.1 [Connection refused #111] at <<closure>>\n\n 0. /var/www/html/3rdparty/swiftmailer/swiftmailer/lib/classes/Swift/Transport/StreamBuffer.php line 58\n    establishSocketConnection()\n 1. /var/www/html/3rdparty/swiftmailer/swiftmailer/lib/classes/Swift/Transport/AbstractSmtpTransport.php line 143\n    initialize({protocol: \"\",ho ... ]})\n 2. /var/www/html/3rdparty/swiftmailer/swiftmailer/lib/classes/Swift/Mailer.php line 65\n    start()\n 3. /var/www/html/lib/private/Mail/Mailer.php line 180\n    send(Swift_Message {}, [])\n 4. /var/www/html/settings/Mailer/NewUserMailHelper.php line 169\n    send(OC\\Mail\\Message {})\n 5. /var/www/html/apps/provisioning_api/lib/Controller/UsersController.php line 307\n    sendMail(OC\\User\\User {}, OC\\Mail\\EMailTemplate {})\n 6. /var/www/html/lib/private/AppFramework/Http/Dispatcher.php line 166\n                                       vvvvvvvv\n    addUser(\"[redacted]\", \"[redacted - PASSWORD]\", \"[redacted]\", \"[redacted]\", [], [], \"10 GB\", \"en\")\n                                       ^^^^^^^^\n 7. /var/www/html/lib/private/AppFramework/Http/Dispatcher.php line 99\n    executeController(OCA\\Provisioning ... {}, \"addUser\")\n 8. /var/www/html/lib/private/AppFramework/App.php line 118\n    dispatch(OCA\\Provisioning ... {}, \"addUser\")\n 9. /var/www/html/lib/private/AppFramework/Routing/RouteActionHandler.php line 47\n    main(\"OCA\\\\Provisioni ... r\", \"addUser\", OC\\AppFramework\\ ... {}, {_route: \"ocs.pr ... \"})\n10. <<closure>>\n    __invoke({_route: \"ocs.pr ... \"})\n11. /var/www/html/lib/private/Route/Router.php line 297\n    call_user_func(OC\\AppFramework\\ ... {}, {_route: \"ocs.pr ... \"})\n12. /var/www/html/ocs/v1.php line 82\n    match(\"/ocsapp/cloud/users\")\n13. /var/www/html/ocs/v2.php line 24\n    require_once(\"/var/www/html/ocs/v1.php\")\n\nPOST /ocs/v2.php/cloud/users\nfrom 172.18.0.4 by [redacted] at 2018-12-17T19:38:41+00:00\n```\n\n## Impact\n\nGet various user names, e-mail addresses and passwords from log files.",
  "weakness": {
    "id": 33,
    "name": "Cleartext Storage of Sensitive Information"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2019-08-31T12:45:31.807Z",
  "allow_singular_disclosure_after": -140574599.1463406,
  "singular_disclosure_allowed": true,
  "vote_count": 30,
  "voters": [
    "mashoud1122",
    "sameerphad72",
    "ali",
    "dhakal_bibek",
    "ness",
    "bb00x",
    "cryptographer",
    "codingchili",
    "lenses",
    "faultytoo",
    "and 20 more..."
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 13,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "nextcloud/server",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
