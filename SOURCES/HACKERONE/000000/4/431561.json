{
  "id": 431561,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MzE1NjE=",
  "url": "https://hackerone.com/reports/431561",
  "title": "Specially constructed multi-part requests cause multi-second response times; vulnerable to DoS",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-10-31T00:31:56.429Z",
  "submitted_at": "2018-10-31T00:31:56.429Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bjeanes",
    "url": "/bjeanes",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 22,
    "url": "https://hackerone.com/rails",
    "handle": "rails",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/022/5e2b46658c8b86bed62f574d8e1793f353cbbc63_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Ruby on Rails",
      "twitter_handle": "rails",
      "website": "http://rubyonrails.org/security",
      "about": "Web development that doesn't hurt."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2018-16470"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-12-05T21:46:17.275Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2018-11-05T21:46:09.389Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The multi-part body parsing in Rack and consequently Rails has a worse-than-linear performance relative to the number of parts in the request body.\n\nIn small scale (i.e. non-disruptive) tests on a variety of Rails applications on the internet, including my own, GitHub.com, Heroku API, Instacart, Shopify, Bugcrowd, and others, it was trivial to cause request servicing to take long enough to cause gateway timeouts. It would not be particularly difficult to generate enough of these requests to tie up the majority of web serving resources for a typical Rails application.\n\nThis vulnerability has also been separately disclosed to rack-core mailing list by me.\n\n## Steps To Reproduce:\n\nI've created a script that can be run here against any Rack-based application: https://gist.github.com/bjeanes/63580e27c197885d4b07160fae132108\n\nBy default it generates a request body with 10,000 parts which, in my testing, was enough to cause GitHub API to take between 15-25 seconds to service the request once the request transfer had completed.\n\n## Addendum\n\nSome benchmarking of Rack is included here, which was also sent to rack-core:\n\n```\nN = number of parts, \nboundary used is as generated by Chrome, but larger boundaries cause\nhigher impact\n\nRehearsal --------------------------------------------\nN: 1       0.032670   0.006635   0.039305 (  0.044159)\nN: 100     0.008245   0.001319   0.009564 (  0.009971)\nN: 1000    0.149332   0.079087   0.228419 (  0.255769)\nN: 2000    0.398711   0.276931   0.675642 (  0.691356)\nN: 5000    2.254126   1.569181   3.823307 (  3.871649)\nN: 10000   7.134949   4.350681  11.485630 ( 12.083888)\nN: 20000  15.946187  10.491861  26.438048 ( 28.684177)\n---------------------------------- total: 42.699915sec\n\n               user     system      total        real\nN: 1       0.000372   0.000003   0.000375 (  0.000371)\nN: 100     0.004889   0.000021   0.004910 (  0.004977)\nN: 1000    0.117571   0.015548   0.133119 (  0.192915)\nN: 2000    0.468934   0.309703   0.778637 (  0.870675)\nN: 5000    2.086055   1.482317   3.568372 (  3.830543)\nN: 10000   7.110589   4.488229  11.598818 ( 12.110710)\nN: 20000  14.559701   9.948678  24.508379 ( 25.537332)\n```\n\nThis is not technically in the Rails codebase, but it is in a non-optional dependency of every Rails application. Furthermore, I did receive some feedback from core members that a Rack vulnerability is likely to be eligible for this bounty: https://twitter.com/_matthewd/status/1057266505056800768.\n\nDiscovered by Bo Jeanes (@bjeanes) and Jack Chen (@chendo) and vetted after the fact by Charlie Somerville (@charliesome).\n\n## Impact\n\nResource starvation of web request servicing, by causing multiple long-running requests. Attack can be constructed with just a HTML web form, making it literally click-button easy. That it can be generated from a form also has potential implications when combined with XSS or some other mechanism where an attacker could cause arbitrary user agents en masse to send such requests.",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-12-05T21:46:09.452Z",
  "allow_singular_disclosure_after": -163783637.45711076,
  "singular_disclosure_allowed": true,
  "vote_count": 17,
  "voters": [
    "bjeanes",
    "sameerphad72",
    "bl4de",
    "ali",
    "leetboi",
    "savitar0x01",
    "geeknik",
    "eveeez",
    "khizer47",
    "peeper35",
    "and 7 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 160,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "https://github.com/rails/rails",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
