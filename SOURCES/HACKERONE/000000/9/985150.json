{
  "id": 985150,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85ODUxNTA=",
  "url": "https://hackerone.com/reports/985150",
  "title": "Privilege Escalation in Point Of Sale Application from POS Manage Staff Role to potentially Store Owner",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-09-18T06:33:28.728Z",
  "submitted_at": "2020-09-18T06:33:28.990Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "imgnotfound",
    "url": "/imgnotfound",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/kfb97hnubizb8ot4cfd7ie8uhm7w/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-11-19T16:23:26.769Z",
  "bug_reporter_agreed_on_going_public_at": "2020-11-19T16:23:26.720Z",
  "team_member_agreed_on_going_public_at": "2020-10-22T17:42:24.822Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I was playing a bit with the Point Of Sale application and it came to my attention that it is possible to navigate from the Point Of Sale Application up to the Plan & Permission in the admin. I am not sure if this is  intentional, but since it leads to potentially take over a shop, I'm reporting it.\n\nWithin he Point Of Sale application, a staff with full admin permissions can open the Point Of Sale channel using the embedded **Magage POS roles** link. By doing so and by using some nested links, it is possible to navigate up to the Plan & Permissions admin view giving him access to some store owner permissions:\n 1. Add staff account\n 1. Manage staff account\n 1. Update login service\n 1. Transfer ownership (requires the shop owner password but could be used to bypass the 2FA protection)\n\nGiven that, a POS staff with only Manage Role could escalate his privileges up to Full Permissions and potentially even take over the shop if knows the admin password.\n\n## Steps to reproduce\n1. Create a Staff with Full Permissions\n1. Create a POS user with only Manage Staff permissions\n1. From the Point Of Sale Application, log-in with the admin user then enter the PIN of the POS User from Step 2\n1. Go to **Staff**, select the staff with Full Permissions from Step 1 and change its PIN to 1234\n1. Lock the application screen and log back in using the 1234 PIN, giving you Full Permissions access within the Application\n1. Go to **Staff**, select any staff, edit its **POS APP ACCESS** and click on **Manage POS Roles**\n1. From the Roles listing page, open the Full Permissions staff's role and scroll at the bottom down so you can see the **Assigned Staff** section and click on the Staff\n1. Scroll at the bottom again and click on **Manage Shopify admin access**, this is opening up the staff page from **Plan and Permissions**.\n1. At the top of the page, click on breadcrumb navigation **Plan and Permissions** link bringing you to the `https://shop.myshopify.com/admin/settings/account`\n\nAt this point, as the Point Of Sale application is using the physically authenticated user, you're given access to store owner features as mentioned earlier.\n\n## Impact\n\nA staff with **Manager Staff Role** within the Point Of Sale application can escalate his privilege to a Full Permission staff and could potentially transfer the shop ownership by using the **Transfer ownership** link within the **Plans & Permissions** page.",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 8,
  "voters": [
    "th3hidd3nmist",
    "xploiterr",
    "drsniper",
    "th4nu_0x0",
    "tess",
    "hakivvi",
    "xplicit",
    "hackmastro"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 37198,
    "asset_type": "OTHER",
    "asset_identifier": "Shopify Developed Apps",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 24966,
      "category": "team",
      "content": "@francisbeaudoin reported an issue where a malicious staff member on a Point of Sale device was able to add staff members to the Shopify admin of the store.\n\nThough this same result could be obtained by stealing the access token used by POS (known behaviour), in this case the UI itself has a flow that allows a user who would normally only have access to point of sale to access the web administrative interface.\n\nMitigating factors for this issue included:\n\n* The user logged into the POS terminal must be the account owner\n* The POS user exploiting this issue must have the Staff Management retail permission\n* A persistent attacker with physical access to the device could achieve a similar result by stealing the access token being used by POS",
      "user": {
        "id": 915134,
        "username": "murakumo_shopify",
        "name": "",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2020-01-21T14:51:01.106Z",
        "url": "https://hackerone.com/murakumo_shopify",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
