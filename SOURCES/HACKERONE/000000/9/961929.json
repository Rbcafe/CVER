{
  "id": 961929,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjE5Mjk=",
  "url": "https://hackerone.com/reports/961929",
  "title": "Ability to see password protected content by bypassing the password page of shopify preview URL for new development stores (as of August 17, 2020)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2020-08-18T22:55:44.253Z",
  "submitted_at": "2020-08-18T22:55:44.494Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "saltymermaid",
    "url": "/saltymermaid",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/dn43gxssekzodutj70ovfe3vusis/bbbf913458c48565d99f975f7ab9fc18ad1e989aa4f8811c1209ed725333d1ec"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-08-25T15:55:25.920Z",
  "bug_reporter_agreed_on_going_public_at": "2020-08-25T15:55:25.864Z",
  "team_member_agreed_on_going_public_at": "2020-08-24T21:42:56.236Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi,\n\n## Description\nI have found a way to bypass the password page of a shopify preview URL for new development stores created  as of August 17, 2020. Currenty, with older development stores, when we share a preview url with someone, we are able to see the content of the store without having to enter a password even if the password protectection is on. For newly created development stores, if you share a preview url with someone, you are asked to enter a password before you can go any further, so I believe that as of august 17, 2020, when sharing a preview url of a development store, we also have to provide the store password for someone to preview the content. \n\nAs cited in https://help.shopify.com/en/partners/dashboard/managing-stores/development-stores#the-development-store-password-page :\n\n```\n All newly created development stores are password protected. This means that visitors to development stores can access your development store in the following ways only:\n\n    1. By entering a password on the development store password page\n    2. By logging into the development store's admin\n    3. Through a Shopify Theme Store or Shopify App Store demo link\n       Unlike the customizable password page for a store that's on a free trial or paid plan, the development store password page isn't linked to the online \n       store's theme and can't be customized.\n\n You can remove the password page only after you transfer the store to a merchant or switch the store to a paid plan.\n```\n\n## Steps to reproduce\n1. Create a new development store that meets the new standard (August 17, 2020)\n2. Go to `Sales channels > Online Store > Themes`\n3. At the top of the page, under the **Themes** title, click the **View your store** link button\n4. Look at the url in the address bar and copy the `?_bt=<some-long-token>` query parameter\n5. Open a preview url that was generated from another store and that also meets the new standard (August 17, 2020).\n6. Paste the `?_bt=<some-long-token>` query parameter you copied from step #4 at the end of the preview url in the address bar and send it\n7. You should have bypassed the password authentication and be able to see the store content\n\nI will be attaching a POC video, but if you need extra details just let me know.\n\n## Impact\n\nEven if unlikely to happen, if someone had the preview url in hand, but did not have the store password, this method could be used to bypass the password authentication and have access to the store content. This would lead to information disclosure.",
  "bounty_amount": "1500.0",
  "formatted_bounty": "$1,500",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 28,
  "voters": [
    "slingx",
    "drsniper",
    "imgnotfound",
    "ali",
    "zeroxyele",
    "naategh",
    "sa1tama0",
    "zerocool20",
    "themidnight",
    "h1-qualys-scan",
    "and 18 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 413,
    "asset_type": "URL",
    "asset_identifier": "your-store.myshopify.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
