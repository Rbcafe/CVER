{
  "id": 946409,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NDY0MDk=",
  "url": "https://hackerone.com/reports/946409",
  "title": "RCE on build server via misconfigured pip install",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2020-07-29T10:18:34.275Z",
  "submitted_at": "2020-07-29T10:18:34.275Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "alexbirsan",
    "url": "/alexbirsan",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/c8iyhelw8y0ttcuqvcjjg48epadx/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 545,
    "url": "https://hackerone.com/yelp",
    "handle": "yelp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Yelp",
      "twitter_handle": "",
      "website": "https://www.yelp.com",
      "about": "Connecting people to great local businesses in communities around the world."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2021-02-09T20:01:01.407Z",
  "bug_reporter_agreed_on_going_public_at": "2021-02-09T18:10:43.946Z",
  "team_member_agreed_on_going_public_at": "2021-02-09T20:01:01.283Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The following Python library has been installed on at least one Yelp owned build server directly from the public PyPI registry.\n\n* https://pypi.org/project/yelp-cgeom/\n\nThis package should normally be downloaded from the internal Yelp registry, but a misconfiguration appears to have caused it to be downloaded from `pypi.org` instead.\n\nThis package name was previously unclaimed on PyPI. In order to detect such misconfigurations, I have uploaded my own code under the `yelp-cgeom` name.\n\nWhenever `yelp-cgeom` is installed, my `setup.py` script is executed on the machine where it is downloaded. The script sends a callback to my server containing:\n\n* the originating IP\n* the machine's hostname\n* the current working directory\n\nTo avoid breaching the program policy, no further actions are taken.\n\n# Vulnerable machine\n\nAt `Wed jul 29 2020 04:27:23 GMT`, and again 20 seconds later, I have received the following callback:\n\n* originating IP: `54.71.19.248`\n* hostname: `10-81-21-60-uswest2bdevc.uswest2-devc.yelpcorp.com`\n* home directory: `/nail/home/jenkins`\n* directory: `/ephemeral/tmpdir/pip-install-o6jnSv/yelp-cgeom`\n\nThis indicates that my preinstall script was executed on the server above.\n\n## Impact\n\nIf this package had been claimed by an attacker, this would have led to arbitrary code execution on the affected server, as well as allowing the attacker to add backdoors inside the affected project(s) during the build process.",
  "weakness": {
    "id": 149,
    "name": "Download of Code Without Integrity Check"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2021-03-11T18:10:43.988Z",
  "allow_singular_disclosure_after": -92346032.5498187,
  "singular_disclosure_allowed": true,
  "vote_count": 350,
  "voters": [
    "0xrodnt",
    "tokyoenigma",
    "wonda_tea_coffee",
    "libcontainer",
    "ec0",
    "osman1337",
    "az3z3l",
    "mass0ma",
    "cxzer0",
    "n4tur3_",
    "and 340 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 10.0,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 43913,
    "asset_type": "WILDCARD",
    "asset_identifier": "*.yelp.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 26577,
      "category": "researcher",
      "content": "[Dependency Confusion: How I Hacked Into Apple, Microsoft and Dozens of Other Companies](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610?sk=991ef9a180558d25c5c6bc5081c99089)",
      "user": {
        "id": 76545,
        "username": "alexbirsan",
        "name": "Alex Birsan",
        "bio": "",
        "cleared": true,
        "verified": true,
        "website": null,
        "location": "",
        "created_at": "2016-05-12T15:36:06.209Z",
        "url": "https://hackerone.com/alexbirsan",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/c8iyhelw8y0ttcuqvcjjg48epadx/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/c8iyhelw8y0ttcuqvcjjg48epadx/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/c8iyhelw8y0ttcuqvcjjg48epadx/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
