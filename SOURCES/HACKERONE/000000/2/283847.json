{
  "id": 283847,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODM4NDc=",
  "url": "https://hackerone.com/reports/283847",
  "title": "GraphQL sessions aren't immediately invalidated when user password is changed",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2017-10-28T21:59:08.330Z",
  "submitted_at": "2017-10-28T21:59:08.330Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bigbug",
    "url": "/bigbug",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/193/109/585fd367d9fe6feb8fb35840fdadb04d16004b0b_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": true,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-11-30T22:28:39.938Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2017-11-30T22:28:17.269Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\n\nWhile changing password, once user clicks on \"Change password\" button after giving necessary values, on https://hackerone.com/settings/pass/edit, the session expires and the user is redirected to https://hackerone.com/users/sign_in for logging in again with the updated/changed password. A graphql mutation is used to change password. But, it is observed that the user can still change password with same graphql token and same session id, used in previous graphql request **even after signing out**. Inshort graphql token nor host session expires. \n \n**Description:**\n\nSorry if I categorized this into wrong weakness category. Also apologize for the complicated title.\n\nWhen clicking on \"change password\" after supplying values for  current password, password and confirm password, user is directed to sign_in page to log in again with changed password. \n\nThe password change takes place through graphql mutation request that contains graphql token and session id. \n\nIt was observed that after capturing the above request with the help of a web debugging tool (charles proxy), the above request could be replayed with same graphql token  **x-auth-token** and host session **__Host-session**, with appropriate password values after sign out and the password is changed.\n\nInshort **A user can change password even after he/she is signed out or session expires, without having to login again, with the help of previously captured graphql request.**\n\n**Impact**\n\nAn attacker could simply change the password again by capturing previous request. As the change can be done even after sign out or expired session, it is more severe.\n\n**Remedy**\n\nMust enforce graphql token expiration. Also check for host_sesssion cookie value.\n\n### Steps To Reproduce\n\n1. Login to the account and navigate to https://hackerone.com/settings/pass/edit to change password.\n2. Input necessary values and click \"Change password\" button. Capture the request using a proxy.\n    (User is now logged out and redirected to sign_in page)\n3. Repeat the previous \"graphql mutation\" request using proxy with changed password. Password is\n     changed again without having to login.  \n",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-12-30T22:28:17.598Z",
  "allow_singular_disclosure_after": -193155920.5530987,
  "singular_disclosure_allowed": true,
  "vote_count": 9,
  "voters": [
    "shubham_srt",
    "eveeez",
    "lordjerry0x01",
    "t4ym",
    "cr4xerbik4sh",
    "japz",
    "sumit7",
    "dyabla",
    "seven6"
  ],
  "structured_scope": {
    "databaseId": 3,
    "asset_type": "URL",
    "asset_identifier": "hackerone.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
