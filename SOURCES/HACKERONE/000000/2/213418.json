{
  "id": 213418,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTM0MTg=",
  "url": "https://hackerone.com/reports/213418",
  "title": "User able to access company details in yrityspalvelu without proper permissions",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2017-03-14T15:28:11.444Z",
  "submitted_at": "2017-03-14T15:28:11.444Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "billy_blaze",
    "url": "/billy_blaze",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 8416,
    "url": "https://hackerone.com/localtapiola",
    "handle": "localtapiola",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "LocalTapiola",
      "twitter_handle": "",
      "website": "http://www.lahitapiola.fi",
      "about": "LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-06-22T08:03:47.678Z",
  "bug_reporter_agreed_on_going_public_at": "2018-06-22T08:03:47.593Z",
  "team_member_agreed_on_going_public_at": "2018-06-19T05:22:15.453Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Basic report information\n**Summary:** User able to access company details in yrityspalvelu without proper permissions\n\n**Description:** User can access \"any\" company detail information, contracts, bills etc if able to do TUPAS authentication. If company already have \"pääkäyttäjä\" accounts made, this most like wont work. I tried with \"clean/fresh\" company.\n\n**Domain:** https://yrityspalvelu.tapiola.fi/\n\n## Browsers / Apps Verified In:\n\n  * Chrome\n\n## Steps To Reproduce:\n\n 1. Go to https://yrityspalvelu.tapiola.fi/a3/YvpAuthWebKoha/verkkopalveluhakemus/\n 2. Fill with company info you want examine (y-tunnus)\n 3. Give any bogus user data\n 4. Do TUPAS authentication and follow registration till end.\n 5. Login using fresh credentials (email+passwd)\nhttps://yrityspalvelu.tapiola.fi/a1/tatuma/jsp/kayttaja/kirjaudu.jsp\n 6. View bills, company information, made insurance claims etc..\n\n## Additional material\n\n  * not this time.\n\n## Related reports, best practices\n\n*tick on \"Minulla on lupa tehdä yrityksen verkkopalvelusopimus.\" should not be enough properly ensure user permission to view company information and in some cases quite sensitive one.",
  "bounty_amount": "2000.0",
  "formatted_bounty": "$2,000",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 63,
  "voters": [
    "foobar7",
    "mvc",
    "muon4",
    "jq123",
    "bl4de",
    "4bg0p",
    "yumi",
    "miguel_santareno",
    "spam404",
    "ali",
    "and 53 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.1,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 1048,
    "asset_type": "URL",
    "asset_identifier": "yrityspalvelu.tapiola.fi",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 3869,
      "category": "team",
      "content": "##Issue\n\nThe reporter found a way to circumvent the privilege system for the admin-user for a company account. Once circumvented, a user could gain access to critical information in the company account, including user data. The finding requires the use of TUPAS-authentication as an entry point which made exploitability harder. \n\n##Fix\n\nNo final fix yet. Process-level controls added.\n\n##Reasoning\n\nThe implementation as such was based on a business decision which included proper risk assessment. Initially this report was dismissed based on the existing risk assessment. The reporter however showed exemplary persistence and did a very thorough rebuttal of the bug bounty team's conclusions and decisions. The issue was then escalated within LähiTapiola with the specific angle of privacy and potential information leak of privacy sensitive data. The original business decision was re-evaluated and it was found to be out of line in light of the upcoming regulatory changes. The bounty reflects both criticality and exploitability.\n",
      "user": {
        "id": 60017,
        "username": "localtapiola-thomas",
        "name": "localtapiola-thomas",
        "bio": "LocalTapiola Bug Bounty Coordinator - @tsmalmbe",
        "cleared": false,
        "verified": false,
        "website": "http://www.lahitapiola.fi",
        "location": "Espoo, Finland",
        "created_at": "2016-03-09T13:58:17.117Z",
        "url": "https://hackerone.com/localtapiola-thomas",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
