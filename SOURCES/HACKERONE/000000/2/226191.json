{
  "id": 226191,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjYxOTE=",
  "url": "https://hackerone.com/reports/226191",
  "title": "Android MailRu Email: Thirdparty can access private data files with small user interaction",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-05-04T20:35:14.198Z",
  "submitted_at": "2017-05-04T20:35:14.198Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "dzmitry",
    "url": "/dzmitry",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 65,
    "url": "https://hackerone.com/mailru",
    "handle": "mailru",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/065/1ec04a6b87b02422d913b5c53d5247de91d64718_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Mail.ru",
      "twitter_handle": "",
      "website": "https://vk.company/",
      "about": "Building the Internet since 1998"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-01-02T18:01:25.040Z",
  "bug_reporter_agreed_on_going_public_at": "2018-01-02T18:01:24.977Z",
  "team_member_agreed_on_going_public_at": "2017-12-28T15:15:01.220Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello, Team\n\n\nDomain, site, application\n---\nAndroid Mail.Ru Email v. 5.5.1.21258\n\n\nTesting environment\n---\nTested on non rooted Nexus 5x Android 7.1.2, \n\n\nIntro\n---\nI found that #90693 was fixed incompletely and additionaly the attack can be improved using self sending activity.\n\n\nSteps\n---\n1. Create some word readable file in \"/data/data/thirdparty/file.txt\"\n2. Create soft link on that file \"/data/data/thirdparty/link.txt\"\n3. Send this soft via Intent.EXTRA_STREAM to the Mail.Ru \"ru.mail.ui.writemail.MailToMySelfActivity\"\n4. After some delay, for example 1000ms, remove soft link and create new, but which will point at any file from \"/data/data/ru.mail.mailapp/*\". Pay attention, that MailToMySelfActivity is do sending automatically and you need find for your PoC delay which will fit in time. (Or you can use ru.mail.ui.writemail.SharingActivity)\n5. The message will be sent. If user will open that message than attachment will be downloaded automatically into the \"/sdcard/Android/data/ru.mail.mailapp/....\" folder. \n6. It means that any app will be able to read this attachment data which may contain private file content, for example message database.\n\n\nPoC\n---\nI attach PoC source\nVideo link (accessed only by url): https://youtu.be/tXAadbkhDCM\n",
  "bounty_amount": "300.0",
  "formatted_bounty": "$300",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 181920,
      "file_name": "mailru-app-data-send.zip",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/181/920/d3b26c82629edb1159a5826670629d10816dafb7/mailru-app-data-send.zip?response-content-disposition=attachment%3B%20filename%3D%22mailru-app-data-send.zip%22%3B%20filename%2A%3DUTF-8%27%27mailru-app-data-send.zip&response-content-type=application%2Fzip&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQQ3BKZOEE%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T124126Z&X-Amz-Expires=1701&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIG6IenXByqkn3Q4DzIOoyCRmUa9piCrSguk1c5%2FILyJ7AiEAykcOsXd4dfj0MtryP7Ypqcz0EGqy2srC7Ahyju9P1wwqsgUIcBADGgwwMTM2MTkyNzQ4NDkiDNoh%2FatXkiXqzvRarSqPBSxRPdxDhM3ZWovfuUDFze8TKTTXyWnM%2BqLvvwol8L9J5VDQFkQXA7smucDX4AEp9WwjM1M5SoDxfIqGVNACAZ%2FhCWOou%2FjPGm5hXxkVid3k%2FfBEIUStu2OCGILQXKrFXckdXocqxibxJkp9FBscVVfy1z9spS224jk9a64wEyKkB%2FEqDONaGznbocoqfOWRO2gk3kN2mF%2FlFYwuvjMbBGI25CA0c8P0uDrdXv75mMgHiHzhQ2UA0io6mOBJRxlcl5iTWXpEwOcbqq7%2B5ONf7AQWMJlf044SZPS7ctrMSsbHt11897THGeHPEYn6tBP8I5Fnd6qJj2f%2FVMm2nAjyPv65mqH9IFrso33MbOg9OScFT8GcXL%2FSL9CsmuqI8DAuHV2TQ6tOcf60FFoK%2FNc8%2BH1opXPi5t84Wy8dXz0ShSZARezbri6JYCQuZaMmQWSTRbaOxgDpQUbmc2MtnSfbshwx0iX%2BKoAaAhWHkgNlastBKxxdkZZfKj3uPWL%2FAZpJ5vQ3aCiYuhMiLdSNoDq04UJUEE6U3x5bncELirAw9rSBGBlZ2LnTIizRqNNZcm4bzUeL8KfXYWONTy2NjqxuN2Pv%2FhvWs7ZeUu%2Bl5RyG%2BaglXVojqzVcfe0pYyyTxENUtLQnCxv1F6%2BFRPB1kbi%2FlMdY30Ih91ui923zixOr4x2bTvqsEUosHXQuAePevTEs9cXth9Tl9dEZ77qdYODIErVxnZKWIWL%2Bdg57Wo05wOYkPoMuK0ANx9QnIFRVpYN51rM3ygm3cI0FCy6O67TKyAzlM4W7pyg0gugDJWcmjphUjUsnNWj%2BZQCUHNlg0hrBypo%2BHXJ4oZgGe0%2F80G6Eur1xfPo2GRyn5qtYCGPsRlYw8qesrgY6sQGYbS8MxVrsunWUBMnltzktg6eAZ8fvxgC5j8%2BYmwaIMOuBsufYAl7nKraCTIkLFC7rGgVC8sqvqoXBLrYQFqgLumTDGfWJUNAVMAVtqNo%2BIL8JvOZD%2FTW4GOmqGMXOgQRmU1Wa7j36A2IvAe7wpP5z8dprPILpwsnYzL4pzdM%2FrRrGA5fhAddbNV%2BDoX4yqjS2RN%2BKe8v5EYqHMPr2TCLmUPcDm070amRAZC10%2F9gLePE%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=66b91b3a4a7da4b42e23522892c5a56bb5b2d4b561715a0036228dd089d657e5",
      "file_size": 44186,
      "type": "application/zip",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2018-01-27T15:15:01.413Z",
  "allow_singular_disclosure_after": -190761985.1673106,
  "singular_disclosure_allowed": true,
  "vote_count": 12,
  "voters": [
    "kanytu",
    "heeeeen",
    "bagipro",
    "whitesector",
    "eveeez",
    "t4ym",
    "cr4xerbik4sh",
    "zerotoone",
    "3apa3a",
    "244",
    "and 2 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.4,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "local",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 239,
    "asset_type": "GOOGLE_PLAY_APP_ID",
    "asset_identifier": "ru.mail.mailapp",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 6188,
      "category": "team",
      "content": "Malicious local application can trick user into sending file from Mail.Ru Mail Android application folder by exploiting TOCTOU condition in ru.mail.ui.writemail.MailToMySelfActivity via symlink manipulation.",
      "user": {
        "id": 4836,
        "username": "3apa3a",
        "name": "Vladimir Dubrovin",
        "bio": "En la agostada senda he visto al buen lagarto (gota de cocodrilo) meditando. ",
        "cleared": false,
        "verified": false,
        "website": "https://3proxy.org/",
        "location": "Nizhny Novgorod, Russia",
        "created_at": "2014-04-10T22:08:47.745Z",
        "url": "https://hackerone.com/3apa3a",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/004/836/57b93fd96b524d0ed13eef717ecd070ad8468f86_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
