{
  "id": 262665,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNjI2NjU=",
  "url": "https://hackerone.com/reports/262665",
  "title": "CVE-2017-5969: libxml2 when used in recover mode, allows remote attackers to cause a denial of service (NULL pointer dereference)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-08-23T18:59:34.267Z",
  "submitted_at": "2017-08-23T18:59:34.267Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "geeknik",
    "url": "/geeknik",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/7xfGZCKCxUuGLYGfuUZM3XyY/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5A3QBGAF%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T124841Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDOmRjyw5I%2FTlNnXkSaQt0HWBvcx4KUqlbsBDywYvgMjAIgc1T3omLkZfSHGnxG7u3M%2BDm3ZU5hXXACm6d42GSb7EAqsQUIdhADGgwwMTM2MTkyNzQ4NDkiDI1cp4QslnXVHIUCaCqOBecH%2BJNC0KwQ%2BfCYMGM86f%2FOS1Dm%2BIA%2BHjSlOORnFjZmELOvSSorEYFhUaPaxwQcFsTE7OMurOw%2BQnTNbwJzmGH%2FjDpGT%2FxwOi1Yf0v9t5xHdyje9QeqWvWnPlxRuLTKdeHLfuYjPaGYHjDPk%2ByYZLTVi%2F6fLFk1LMc7Dx726KzEvXPKCa4bME8qI31URj4F9nDQiBGwytvr7Hm1EMgKGmVAK6%2Fbzd%2BJiZVqxHd3sYJSTbmtS%2BAl2zqAc8BSfBosM0X88oi3lBTlSqMNhfG3CaAXBePpXwzrVOqz74NfDYXdsP4VQdYegntsv6fFEZFiKkjhlglh0X4pAXPbvFNkY8C7BzpUD2tNRzacCXSlRaco9RM5vUg086o63M3dgo9tb8DkSAwOHamrNu%2F2KO2aggnlYsi1aZ7EJQTnQ4h%2BcjkM2D28%2Bxcxlpa3Ec2gB5yd%2BQcUjU%2BzbbmFbStd4UJXYiE38Skp99somT%2BpCEikiE7WFVYA5Pgb9J6BqOzjaorE7DzLysbe4e0jMnv06eVq4H%2Bz42eH%2FkluYPtzip94lWrairjO%2BPy%2BVDKDVJai6d1iVpfcEFmbncPaNpU53sKrhSNhpvIUbUDu5YaFK6X%2FbL%2BeFksXVgGaf0JwUeSzAh%2FGbxLEuo6xDzuhAOmMHndLW%2FF8uphSoqM7NkjvQNWF4znkPMyfsDxu0sKfOHhED1nQ5geErhYuMeCPDWNlWvJKC2X93i%2B8i8WntV0NtA21WXhLXSnrHVz2HCPlDghBMIvH7mgPpfyFhSMGQDeGjpSbj3uInocAFuDTAgJeZIwRGGMYeOXoRMIVrM6FWdeiP%2FaI3a0LUECdOBOPVvRMLQuf7VJvF0078t1crT4PlcQMPTC%2Fwq2uBjqxAVnkBdxFUTWQ4ZupRlHVu9PZr1k7xqw4QHDS7pllKyJWE05aIrKtcQLI8f74A6IlC2qLL0KpjvsW622557lHAqxIiBIxR28dhgaLkoywMH6F6KWd%2BowMbbVNahcgFgF8sWKuHHJPaj4kiHcEz7czNhJgm88FkmgTRhhw7HW2Z01FS2x%2BrnGRx5%2BvOZPEvDu%2BIRvDNGu%2FVrwK5wtu%2BRwxD8V7oEVMXOuAFSFlduj5GO6kbQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f2a130f852d38343fa784306023586c22292e33b8c41031dc031af1eed7725c7",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5A3QBGAF%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T124841Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDOmRjyw5I%2FTlNnXkSaQt0HWBvcx4KUqlbsBDywYvgMjAIgc1T3omLkZfSHGnxG7u3M%2BDm3ZU5hXXACm6d42GSb7EAqsQUIdhADGgwwMTM2MTkyNzQ4NDkiDI1cp4QslnXVHIUCaCqOBecH%2BJNC0KwQ%2BfCYMGM86f%2FOS1Dm%2BIA%2BHjSlOORnFjZmELOvSSorEYFhUaPaxwQcFsTE7OMurOw%2BQnTNbwJzmGH%2FjDpGT%2FxwOi1Yf0v9t5xHdyje9QeqWvWnPlxRuLTKdeHLfuYjPaGYHjDPk%2ByYZLTVi%2F6fLFk1LMc7Dx726KzEvXPKCa4bME8qI31URj4F9nDQiBGwytvr7Hm1EMgKGmVAK6%2Fbzd%2BJiZVqxHd3sYJSTbmtS%2BAl2zqAc8BSfBosM0X88oi3lBTlSqMNhfG3CaAXBePpXwzrVOqz74NfDYXdsP4VQdYegntsv6fFEZFiKkjhlglh0X4pAXPbvFNkY8C7BzpUD2tNRzacCXSlRaco9RM5vUg086o63M3dgo9tb8DkSAwOHamrNu%2F2KO2aggnlYsi1aZ7EJQTnQ4h%2BcjkM2D28%2Bxcxlpa3Ec2gB5yd%2BQcUjU%2BzbbmFbStd4UJXYiE38Skp99somT%2BpCEikiE7WFVYA5Pgb9J6BqOzjaorE7DzLysbe4e0jMnv06eVq4H%2Bz42eH%2FkluYPtzip94lWrairjO%2BPy%2BVDKDVJai6d1iVpfcEFmbncPaNpU53sKrhSNhpvIUbUDu5YaFK6X%2FbL%2BeFksXVgGaf0JwUeSzAh%2FGbxLEuo6xDzuhAOmMHndLW%2FF8uphSoqM7NkjvQNWF4znkPMyfsDxu0sKfOHhED1nQ5geErhYuMeCPDWNlWvJKC2X93i%2B8i8WntV0NtA21WXhLXSnrHVz2HCPlDghBMIvH7mgPpfyFhSMGQDeGjpSbj3uInocAFuDTAgJeZIwRGGMYeOXoRMIVrM6FWdeiP%2FaI3a0LUECdOBOPVvRMLQuf7VJvF0078t1crT4PlcQMPTC%2Fwq2uBjqxAVnkBdxFUTWQ4ZupRlHVu9PZr1k7xqw4QHDS7pllKyJWE05aIrKtcQLI8f74A6IlC2qLL0KpjvsW622557lHAqxIiBIxR28dhgaLkoywMH6F6KWd%2BowMbbVNahcgFgF8sWKuHHJPaj4kiHcEz7czNhJgm88FkmgTRhhw7HW2Z01FS2x%2BrnGRx5%2BvOZPEvDu%2BIRvDNGu%2FVrwK5wtu%2BRwxD8V7oEVMXOuAFSFlduj5GO6kbQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5b2669a497ef4aabea089f2ce58f50c200642be502ae6df5cbd63fa7a93b9c09"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2017-5969"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-10-04T17:40:19.246Z",
  "bug_reporter_agreed_on_going_public_at": "2019-10-04T16:22:39.857Z",
  "team_member_agreed_on_going_public_at": "2019-10-04T17:40:19.159Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I first reported this bug to the developers on [20 November 2015](https://bugzilla.gnome.org/show_bug.cgi?id=758422). A patch was finally committed on 7 June 2017 [here](https://git.gnome.org/browse/libxml2/commit/?id=94691dc884d1a8ada39f073408b4bb92fe7fe882). The caveat here is that this only happens in recover mode which the developers say no sane person should ever use in production and/or against untrusted inputs. A CVE was assigned in April 2017.\n\nThe original crash involved some memory corruption which lead to a null pointer dereference and subsequent segfault after running `./xmllint --recover` against XML similar to `<!DOCTYPE[<!ELEMENT l((|s)>`.\n\n```\ntest00.xml:1: parser error : xmlParseDocTypeDecl : no DOCTYPE name !\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n         ^\ntest00.xml:1: parser error : Space required after 'ELEMENT'\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                        ^\ntest00.xml:1: parser error : Input is not proper UTF-8, indicate encoding !\nBytes: 0xDF 0x28 0xE2 0x2C\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                        ^\ntest00.xml:1: parser error : Space required after the element name\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                         ^\ntest00.xml:1: parser error : ContentDecl : Name or '(' expected\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                             ^\ntest00.xml:1: parser error : internal error: xmlParseInternalSubset: error detected in Markup declaration\n\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                               ^\ntest00.xml:1: parser error : DOCTYPE improperly terminated\n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                               ^\n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x452A72: xmlNextChar (parserInternals.c:535)\n==100630==    by 0x4CF45F: xmlParseInternalSubset (parser.c:8460)\n==100630==    by 0x4E655D: xmlParseDocument (parser.c:10852)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x452E0C: xmlNextChar (parserInternals.c:538)\n==100630==    by 0x4CF45F: xmlParseInternalSubset (parser.c:8460)\n==100630==    by 0x4E655D: xmlParseDocument (parser.c:10852)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x452EE3: xmlNextChar (parserInternals.c:540)\n==100630==    by 0x4CF45F: xmlParseInternalSubset (parser.c:8460)\n==100630==    by 0x4E655D: xmlParseDocument (parser.c:10852)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4D39A7: xmlParseMisc (parser.c:10723)\n==100630==    by 0x4E6197: xmlParseDocument (parser.c:10872)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4D39FA: xmlParseMisc (parser.c:10726)\n==100630==    by 0x4E6197: xmlParseDocument (parser.c:10872)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4D3A3F: xmlParseMisc (parser.c:10726)\n==100630==    by 0x4E6197: xmlParseDocument (parser.c:10872)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \ntest00.xml:1: parser error : internal error: Huge input lookup\n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x445E2C: xmlParserPrintFileContextInternal (error.c:184)\n==100630==    by 0x448B99: xmlReportError (error.c:404)\n==100630==    by 0x44FB9C: __xmlRaiseError (error.c:631)\n==100630==    by 0x474CA5: xmlFatalErr (parser.c:538)\n==100630==    by 0x474CA5: xmlGROW (parser.c:2075)\n==100630==    by 0x4E5CCF: xmlParseDocument (parser.c:10878)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x445E6C: xmlParserPrintFileContextInternal (error.c:184)\n==100630==    by 0x448B99: xmlReportError (error.c:404)\n==100630==    by 0x44FB9C: __xmlRaiseError (error.c:631)\n==100630==    by 0x474CA5: xmlFatalErr (parser.c:538)\n==100630==    by 0x474CA5: xmlGROW (parser.c:2075)\n==100630==    by 0x4E5CCF: xmlParseDocument (parser.c:10878)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                               ^\n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4749A8: xmlGROW (parser.c:2079)\n==100630==    by 0x4E5CCF: xmlParseDocument (parser.c:10878)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x4E55FC: xmlParseDocument (parser.c:10879)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \ntest00.xml:1: parser error : Start tag expected, '<' not found\n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x445E2C: xmlParserPrintFileContextInternal (error.c:184)\n==100630==    by 0x448B99: xmlReportError (error.c:404)\n==100630==    by 0x44FB9C: __xmlRaiseError (error.c:631)\n==100630==    by 0x4E5012: xmlFatalErrMsg (parser.c:565)\n==100630==    by 0x4E5012: xmlParseDocument (parser.c:10880)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n==100630== Conditional jump or move depends on uninitialised value(s)\n==100630==    at 0x445E6C: xmlParserPrintFileContextInternal (error.c:184)\n==100630==    by 0x448B99: xmlReportError (error.c:404)\n==100630==    by 0x44FB9C: __xmlRaiseError (error.c:631)\n==100630==    by 0x4E5012: xmlFatalErrMsg (parser.c:565)\n==100630==    by 0x4E5012: xmlParseDocument (parser.c:10880)\n==100630==    by 0x50657F: xmlDoRead (parser.c:15340)\n==100630==    by 0x50657F: xmlReadFile (parser.c:15402)\n==100630==    by 0x41CD6F: parseAndPrintFile (xmllint.c:2401)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630== \n<!DOCTYPE[<?l?><!ELEMENT�(�,()>\n                               ^\n==100630== Invalid read of size 4\n==100630==    at 0x5BD149: xmlDumpElementContent (valid.c:1181)\n==100630==    by 0x5CD871: xmlDumpElementDecl (valid.c:1706)\n==100630==    by 0xA06A82: xmlBufDumpElementDecl (xmlsave.c:501)\n==100630==    by 0xA06A82: xmlNodeDumpOutputInternal (xmlsave.c:939)\n==100630==    by 0xA06A82: xmlNodeListDumpOutput (xmlsave.c:825)\n==100630==    by 0xA06A82: xmlDtdDumpOutput (xmlsave.c:749)\n==100630==    by 0xA032B2: xmlDocContentDumpOutput (xmlsave.c:1234)\n==100630==    by 0xA032B2: xmlSaveDoc (xmlsave.c:1936)\n==100630==    by 0x416BA6: parseAndPrintFile (xmllint.c:2705)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\n==100630== \n==100630== \n==100630== Process terminating with default action of signal 11 (SIGSEGV)\n==100630==  Access not within mapped region at address 0x0\n==100630==    at 0x5BD149: xmlDumpElementContent (valid.c:1181)\n==100630==    by 0x5CD871: xmlDumpElementDecl (valid.c:1706)\n==100630==    by 0xA06A82: xmlBufDumpElementDecl (xmlsave.c:501)\n==100630==    by 0xA06A82: xmlNodeDumpOutputInternal (xmlsave.c:939)\n==100630==    by 0xA06A82: xmlNodeListDumpOutput (xmlsave.c:825)\n==100630==    by 0xA06A82: xmlDtdDumpOutput (xmlsave.c:749)\n==100630==    by 0xA032B2: xmlDocContentDumpOutput (xmlsave.c:1234)\n==100630==    by 0xA032B2: xmlSaveDoc (xmlsave.c:1936)\n==100630==    by 0x416BA6: parseAndPrintFile (xmllint.c:2705)\n==100630==    by 0x410409: main (xmllint.c:3759)\n==100630==  If you believe this happened as a result of a stack\n==100630==  overflow in your program's main thread (unlikely but\n==100630==  possible), you can try to increase the size of the\n==100630==  main thread stack using the --main-stacksize= flag.\n==100630==  The main thread stack size used in this run was 8388608.\nSegmentation fault\n```\n\n\n",
  "weakness": {
    "id": 51,
    "name": "NULL Pointer Dereference"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2019-11-03T16:22:39.942Z",
  "allow_singular_disclosure_after": -135030362.0574369,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "0xd0m7",
    "geeknik",
    "japz"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 84121,
    "asset_type": "OTHER",
    "asset_identifier": "IBB (Legacy)",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
