{
  "id": 355859,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNTU4NTk=",
  "url": "https://hackerone.com/reports/355859",
  "title": "CRITICAL-CLICKJACKING at Yelp Reservations Resulting in exposure of victim Private Data (Email info) + Victim Credit Card MissUse. ",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-05-22T11:27:00.031Z",
  "submitted_at": "2018-05-22T11:27:00.031Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "hk755a",
    "url": "/hk755a",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ayki6pwgcjiefesvrbaq5ltxujq0/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 545,
    "url": "https://hackerone.com/yelp",
    "handle": "yelp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Yelp",
      "twitter_handle": "",
      "website": "https://www.yelp.com",
      "about": "Connecting people to great local businesses in communities around the world."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-08-21T20:51:23.801Z",
  "bug_reporter_agreed_on_going_public_at": "2020-07-28T21:13:37.865Z",
  "team_member_agreed_on_going_public_at": "2020-08-21T20:51:23.710Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Please have a look at this interesting article with precise explanation about Click-jacking security flaw:\nhttps://www.linkedin.com/pulse/20141202104842-120953718-why-am-i-anxious-about-clickjacking/\n\nIn Yelp platform the response headers of the Reservation page does not contain the X-Frame-Options header, thus allowing malicious actors to embed these pages as hidden i-frames on some external or their own innocuous looking website. \nUpon successful exploitation the victim would have made unintentional reservation to some restaurant/bar and his Email Id/Mobile Number would have been shared with the business. \nAll this would  happen without victim's  knowledge or consent.\n\nHere's how a sample Reservation page looks like:\n███\n\nREQUEST RESPONSE HEADERS OF A RESERVATION PAGE:\n██████\n\nPlease note the missing X-Frame-Options header in the response headers.\n\n#POC:\nFor POC and steps to reproduce please watch the video \n\n#EXPLOIT SCENARIOS:\nPlease look at the different scenarios this could be exploited :\n\n#==>(1) The attacker may himself register a business at yelp, copy and embed his own reservation url as hidden i-frame. Make reservation in the background upon victim's click. He gains email/mobile of the victim account.\n#==>(2) He may reserve a table of some business that charges upon cancellation and the victim may face monetary loss. \n#==>(3) He may target a business and  try to restrict all the genuine bookings. It would be possible to do so by booking all table slots of different timings from all the different visitors that are coming to his malicious but genuine looking website.\n\nThe impact of this vulnerability depends on the number of visitors attacker might be able to bring to his website. This is not a very big deal in the presence of huge social media websites nowadays. Or he may paste link to his website somewhere on yelp (review/about/talk etc sections) platform itself so as to bring authenticated yelp users to his website.\n\n## Impact\n\nWhile the  overall risk may only be a medium rating; the impact is high as the vulnerability affects both the yelp users and also business owners\n\n#The vulnerability impacts the victim in the following ways:\n==>1.) Loss of Confidentiality: Private info such as Email/phone is disclosed\n==> 2.) Unauthorized Reservations from User Account: This certainly is not wanted by any user.\n==> 3.) Monetary loss upon Cancellation of reservation: Some businesses say they would charge upon \ncancellation of reservation.\n==> 4.) Apart from this client's trust on Yelp platform is also lost.\n\n#The vulnerability impacts the business owners in the following ways:\n==>1.) Fake reservations may restrict genuine reservations:\nSuch Fake reservations may restrict genuine users from booking tables. And on the other end the business owners have no way to distinguish between fake and genuine ones.\nThis leads to customer/monetary loss to business owners itself.",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-08-27T21:13:37.927Z",
  "allow_singular_disclosure_after": -109266651.6412687,
  "singular_disclosure_allowed": true,
  "vote_count": 17,
  "voters": [
    "ali",
    "webranger",
    "eveeez",
    "sa1tama0",
    "can",
    "test0401",
    "mr360",
    "jesuser14",
    "rooot0401",
    "go4krishanu",
    "and 7 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 6.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "low",
      "availability": "low"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 24155,
      "category": "team",
      "content": "@hk755a reported that the `/reservations` page was vulnerable to clickjacking. By exploiting the nature of autofill fields, an attacker can cause a victim to make a reservation without their knowledge, thereby forwarding the victim's email address to the business.\n\nSince then, Yelp has deployed a site-wide CSP policy to prevent such clickjacking attacks from occurring.",
      "user": {
        "id": 105043,
        "username": "aaronloo",
        "name": "Aaron Loo",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2016-08-29T20:54:28.410Z",
        "url": "https://hackerone.com/aaronloo",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
