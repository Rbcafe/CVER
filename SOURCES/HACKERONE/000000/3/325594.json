{
  "id": 325594,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjU1OTQ=",
  "url": "https://hackerone.com/reports/325594",
  "title": "Leakage badges on disabled user",
  "state": "Closed",
  "substate": "informative",
  "severity_rating": "low",
  "readable_substate": "Informative",
  "created_at": "2018-03-13T17:22:10.328Z",
  "submitted_at": "2018-03-13T17:22:10.328Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "e333jsjs7se",
    "url": "/e333jsjs7se",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13,
    "url": "https://hackerone.com/security",
    "handle": "security",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "HackerOne",
      "twitter_handle": "Hacker0x01",
      "website": "https://hackerone.com",
      "about": "Vulnerability disclosure should be safe, transparent, and rewarding."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-03-15T09:29:12.291Z",
  "bug_reporter_agreed_on_going_public_at": "2018-03-14T09:08:42.715Z",
  "team_member_agreed_on_going_public_at": "2018-03-15T09:29:12.175Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "ï»¿**********************************************\n                                  Indonesia Here ;)\n**********************************************\n\n*Hi HackerOne Team,*\n\n**Description:**\nThis attack occurs when an attacker uses this graphql code:\n\n\nand this builds the path of the attacker getting disclosure information about how many programs already in the close Resolved from the Public or Disable user.\n\nokay now I do not say if the Public User just open the username profile page target will also look hacktivity that has been already Resolved or already sent bounty (bounty awarded).\n\nbut what if you open a username that is disabled? (disabled) you can not see the user page profile, and this bug can see badges username disabled.\n\nThis means that anyone who gets 10 badges means that you have submitted a report to 10 Program Handles. (This applies also to Public users)\n\n##POC:\n*  for the first I will enum and check username disable or not through UserID. POST /graphql\n\n```\n{\n  \"query\": \"query Profile_settings_MeRelayQL($id_0:ID!,$size_1:ProfilePictureSizes!) {\\n  node(id:$id_0) {\\n    id,\\n    __typename,\\n    ...F0\\n  }\\n}\\nfragment F0 on User {\\n  id,\\n  username,\\n  disabled,\\n  bio,\\n  location,\\n  website,\\n  _profile_picture:profile_picture(size:$size_1),\\n  website,\\n  next_update_username_date\\n}\",\n  \"variables\": {\n    \"id_0\": \"Z2lkOi8vaGFja2Vyb25lL1VzZXIvMzA5\",\n    \"size_1\": \"xtralarge\"\n  }\n}\n```\n**for example \nI use @alex-rice UserID 15  or @janpaul123 UserID 309\ngid://hackerone/User/309\ngid://hackerone/User/15**\n\nBody Response:\n\n```\n{\n  \"data\": {\n    \"node\": {\n      \"id\": \"Z2lkOi8vaGFja2Vyb25lL1VzZXIvMzA5\",\n      \"__typename\": \"User\",\n      \"username\": \"janpaul123\",\n      \"disabled\": true,\n......\n......\n......\n}\n  }\n}\n```\nwell user ```janpaul123``` disabled. \n\n* then if you open the user profile page will not appear. https://hackerone.com/janpaul123\n\n**let's get to the point:**\nPOST /graphql\n\n\n```{\"query\":\"query User_badges($first_0:Int!) {\\n query {\\n id,\\n ...F0\\n }\\n}\\nfragment F0 on Query {\\n _user:user(username:\\\"janpaul123\\\") {\\n username,\\n _badges:badges(first:$first_0) {\\n edges {\\n node {\\n id,\\n created_at,\\n badge {\\n name,\\n description,\\n image_path,\\n id\\n }\\n },\\n cursor\\n },\\n pageInfo {\\n hasNextPage,\\n hasPreviousPage\\n }\\n },\\n id\\n },\\n id\\n}\",\"variables\":{\"first_0\":100}}```\n\nAnd Response Body: ( I made it short. )\n```\n\"created_at\": \"2016-06-15T10:03:25.319Z\",\n                \"badge\": {\n                  \"name\": \"Publish or Perish\",\n                  \"description\": \"Publicly disclosed a report\",\n\n\"created_at\": \"2013-11-07T22:54:43.947Z\",\n                \"badge\": {\n                  \"name\": \"Hacking Hackers\",\n                  \"description\": \"Hacked HackerOne\",\n\n\"created_at\": \"2013-11-07T22:54:43.947Z\",\n                \"badge\": {\n                  \"name\": \"Insecticide\",\n                  \"description\": \"First report closed as resolved\",\n\n\"created_at\": \"2013-11-29T22:31:21.260Z\",\n                \"badge\": {\n                  \"name\": \"Bounty Hunter\",\n                  \"description\": \"First bounty received\",\n```\n**this means that there are only 4 handle programs that have been completed by** ```janpaul123```\n\n**Maybe you will ask me can you see the handle completed there (resolved)?\nI will reply: Of course I can not see the handle that has been resolved.**\n\n**and if according to your discussion there is nothing about security, then why I can see a badge of user profile page that can not be seen publicly.**\n\n*sorry if there is my writing is wrong, please understand my english bad, I use google translate hahaha*\n\n*Best Regards,*\n@terlupakan\n\n## Impact\n\nDepending on the context in which it is used, an attacker can see the badges and the description.\nbut this user is disabled, but the attacker can still see it.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 8,
  "voters": [
    "shubham_srt",
    "apapedulimu",
    "kunal94",
    "b07b97e2b8dc9d79d7de0bd",
    "0619",
    "e333jsjs7se",
    "indonesiamerdeka1945",
    "someonelikemark"
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 3,
    "asset_type": "URL",
    "asset_identifier": "hackerone.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
