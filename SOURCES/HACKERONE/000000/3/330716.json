{
  "id": 330716,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzA3MTY=",
  "url": "https://hackerone.com/reports/330716",
  "title": "F5 BIG-IP Cookie Remote Information Disclosure",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-03-28T09:44:30.271Z",
  "submitted_at": "2018-03-28T09:44:30.271Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "petruknisme",
    "url": "/petruknisme",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/186/729/158986ee00061f98d0a6592b795bad9d23e742d0_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 8416,
    "url": "https://hackerone.com/localtapiola",
    "handle": "localtapiola",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "LocalTapiola",
      "twitter_handle": "",
      "website": "http://www.lahitapiola.fi",
      "about": "LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-06-21T11:24:16.526Z",
  "bug_reporter_agreed_on_going_public_at": "2018-06-21T11:24:16.412Z",
  "team_member_agreed_on_going_public_at": "2018-06-21T07:46:14.709Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Basic report information\n**Summary:** \nThe remote host for myynti.lahitapiolarahoitus.fi is appears to be an F5 BIG-IP load balancer(or behind load balancer) and the unencrypted cookie may disclose BigIP pool name, backend's IP address and port, routed domain.\n\n**Description:** \nThe remote host appears to be an F5 BIG-IP load balancer. The load balancer encodes the IP address of the actual web server that it is acting on behalf of within a cookie. Additionally, information after 'BIGipServer' is configured by the user and may be the logical name of the device. These values may disclose sensitive information, such as internal IP addresses and names.\n\nAs you can see, when i'm testing with curl, it will show like this\n```\n< Set-Cookie: BIGipServermy██████████oitus-fi_pool=2079████████6.0000; path=/\n< Set-Cookie: TS013d0012=0147052ac538e5a096f03ce792d4dfca4fa7aa1446dea5089d1317f68b65cec609e178c83e1b5a758b8525b5d28fa72da9dc462362; Path=/\n```\n\n**Impact:**\nAttacker can leaks backend information (pool name, backend's IP address and port, routed domain) through cookies inserted by the BigIP system.\n\n## Browsers / Apps Verified In:\n\n  * Metasploit\n\n## Steps To Reproduce:\n\n  For this case, you can use metasploit auxilary module to scan vuln:\n```\nuse auxiliary/gather/f5_bigip_cookie_disclosure\nset RHOST myynti.lahitapiolarahoitus.fi\nrun\n```\n\n## Additional material\n\n  * I've attaching screenshot in this report\n\n```\nmsf auxiliary(gather/f5_bigip_cookie_disclosure) > run\n\n[*] Starting request /\n[+] F5 BigIP load balancing cookie \"BIGipServermy█████oitus-fi_pool = 2079██████████6.0000\" found\n[+] Load balancing pool name \"my██████oitus-fi_pool\" found\n[+] Backend 19█████████2:81 found\n```\n\n## Remediations\n\n  * Encrypting the cookies from BigIP : http://www.systemadvise.com/2016/11/f5-big-ip-cookie-remote-information.html\n\n## Related reports, best practices\n\n  * https://support.f5.com/csp/article/K14784?sr=45997495\n  * http://www.systemadvise.com/2016/11/f5-big-ip-cookie-remote-information.html\n  * https://www.rapid7.com/db/modules/auxiliary/gather/f5_bigip_cookie_disclosure\n\n## Impact\n\nAttacker can leaks backend information (pool name, backend's IP address and port, routed domain) through cookies inserted by the BigIP system.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 279438,
      "file_name": "tapiola-bigipdisclosure.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/279/438/d9da518e570fc4bfa0621d9b2b71d65544d7d588/tapiola-bigipdisclosure.png?response-content-disposition=attachment%3B%20filename%3D%22tapiola-bigipdisclosure.png%22%3B%20filename%2A%3DUTF-8%27%27tapiola-bigipdisclosure.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXDXMWQX4%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T130131Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBXiIatSvXxAR8ZBwoq9n9qamV3%2Beh4VxZ3KYO4Dx8ipAiBhqaPFcz1fCY4UiwnoQpCKbjkuyniJ5UnHxhrd1V7sPCqxBQh2EAMaDDAxMzYxOTI3NDg0OSIMI7x1nUgRkEN0qOmcKo4FXYYyeBqpZepmBlG%2Bn8RIW4ybBvBDLTs5NzQS7p452M4cH8%2FOy1nnGTSEGOnFuQ1hr8I838Py4bbR2k0%2FeAXwEKBwp9kUx1f6xHqwuZ%2BZJE6IBIkxerlv%2FE3eoTBjleGGo2wwfiOgBypgZ5sXatzcXx72vmVtwhxsDHzFmuJonyOALDBbiuqGbIPREpmA3jUxq%2BMAacTvuf9XMxNE478SaHCKprf1SFobf84oc7fT%2FWNU4UeJ8GNMQeSenAKYY%2BrLefa1UY4wwj6g5D0GjwCVp9bHXI21rt%2BOchx%2BJy%2Ff8hhrWt2fFEziDHK2ejHlzmon20KSav3Ecka%2Fl7q%2FXbFq%2B5cHQ3Fnv6Hsuz%2BtzfIL4EI8nN4PTXJ959QXCgSq68M3r%2FCq038IGGPaf9q5IZ44XiRhpk9WyrUqaUvKDpIG2kZMpC6jLDCikWY%2F0pq0aLMVs8K3zMuHvUvoA%2B2gV%2Bcm6EdoBU1pM0KqEZ4gTsmJdr8mPFqfdK1P4IwECSvHVNNvRZ%2FytigAMyryjJi%2FzrEs38Y9%2FrEkIQq4jS7aMXa2dJvo8qo%2BMpwzgI63Zc9%2BUb7QMMj32n1iEhgvRp0P4HsvjBZW5a45NrCNrdPawRXUjURzopS4c1KkPmoIyqVJLA%2FcZfSuGhSIBnYcB3irx3ar6nXnb1BlJQeYwVq%2BGugPDwYF7JnE98PVLlThTxxkQLe6rmhG98KDMqkM2rSCOaoIoCAr8pyrGNylV531TI6WsbwObHBBin8dGaMs5bPKof2pfOiufJXYwPbUfatl0yR4eeNEDZ2ojVwsNt%2FXz0I%2BnOHi3gFnlaTXXL2pE75y8B8i2gdpWyljLCB%2Bnh8JAX4zJ9W5uSJwboRkdOBCbm1EMOnJra4GOrIBAGTU0E8gZ3I1JcYpghGRH630deXcWBT7WyMmozUTe6qarc28Ss1LWSuryHkoMrH7Sud0DqGFERBVj7YzRXPoLL7BGEhCuNa2uCE2kvLJYBOVb8O0U%2BA8CX4iNwz55KlL7rByi1vNt6ahpUI7DJZTOvkkTX1DSVfQF%2Baicg%2BfMtGKT4Z2J8HGmzqC%2FR%2FqkC6K2vyecQNgl1yG%2BNZWxHLH3sMFQGgXVbyipFgwNo8D0TTcrQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=adcac48ece380e415e1e61716ba8c6cf9e51b246b2e150b63a198ad95c6302b9",
      "file_size": 32538,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 18,
  "voters": [
    "ali",
    "savitar0x01",
    "apapedulimu",
    "already_in_use_",
    "eveeez",
    "khizer47",
    "t4ym",
    "japz",
    "cryptographer",
    "klau5",
    "and 8 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 6798,
    "asset_type": "URL",
    "asset_identifier": "myynti.lahitapiolarahoitus.fi",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 7750,
      "category": "team",
      "content": "##Issue\n\nThe reporter found that the f5 Big-IP cookies potentially reveal BigIP pool name, backend's IP address and port, routed domain.\n\n##Fix\n\nThere is an option in Big-IP to fix this. Just click, apply and you are done.\n\n##Reasoning\n\nThe issue is not critical,but it was an easy fix. Note: we will apply this to all domains and no further reports on this for other domains will be accepted never ever.\n",
      "user": {
        "id": 60017,
        "username": "localtapiola-thomas",
        "name": "localtapiola-thomas",
        "bio": "LocalTapiola Bug Bounty Coordinator - @tsmalmbe",
        "cleared": false,
        "verified": false,
        "website": "http://www.lahitapiola.fi",
        "location": "Espoo, Finland",
        "created_at": "2016-03-09T13:58:17.117Z",
        "url": "https://hackerone.com/localtapiola-thomas",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
