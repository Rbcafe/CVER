{
  "id": 387250,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zODcyNTA=",
  "url": "https://hackerone.com/reports/387250",
  "title": "OpenSSL::X509::Name Equality Check Does Not Work, Patch included",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-07-26T17:24:30.371Z",
  "submitted_at": "2018-07-26T17:24:30.371Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "tylereckstein",
    "url": "/tylereckstein",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/317/542/ed29b5bedb72b0858535e2395adfaf74a392ae9e_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 7724,
    "url": "https://hackerone.com/ruby",
    "handle": "ruby",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/007/724/bb067434deef370d6a0b16c2cbbc030b57c75e92_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Ruby",
      "twitter_handle": "",
      "website": "https://www.ruby-lang.org",
      "about": "A Programmer's Best Friend"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2018-16395"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-10-19T21:59:23.989Z",
  "bug_reporter_agreed_on_going_public_at": "2018-10-19T14:46:00.227Z",
  "team_member_agreed_on_going_public_at": "2018-10-19T21:59:23.921Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "When two OpenSSL::X509::Name objects are compared using ==, depending on the ordering, non-equal objects will return true. When the first argument is one character longer than the second, or the second argument contains a character that is one less than a character in the same position of the first argument, the result of == will be true. Example below:\n\nirb(main):001:0> require 'openssl'\n=> true\nirb(main):002:0> a = OpenSSL::X509::Name.new([[\"CN\", \"www.example.com\"]])\n=> #<OpenSSL::X509::Name:0x007fa127cdf3f0>\nirb(main):003:0> b = OpenSSL::X509::Name.new([[\"CN\", \"www.example.co\"]])\n=> #<OpenSSL::X509::Name:0x007fa127cd0260>\nirb(main):004:0> c = OpenSSL::X509::Name.new([[\"CN\", \"www.exbmple.com\"]])\n=> #<OpenSSL::X509::Name:0x007fa127cb68b0>\nirb(main):005:0> a == b\n=> true                    # Should NOT be true\nirb(main):006:0> a == c\n=> false\nirb(main):007:0> c == a\n=> true                    # Should NOT be true\nirb(main):008:0> b == a\n=> false\n\n\n\nThis appears to be from the ossl_x509name_cmp function and I was able to fix this with the following diff, with included tests that would fail without the change to ossl_x509name_cmp:\n\ndiff --git a/ext/openssl/ossl_x509name.c b/ext/openssl/ossl_x509name.c\nindex c900bcb..15e4bb0 100644\n--- a/ext/openssl/ossl_x509name.c\n+++ b/ext/openssl/ossl_x509name.c\n@@ -400,7 +400,7 @@ ossl_x509name_cmp(VALUE self, VALUE other)\n\n     result = ossl_x509name_cmp0(self, other);\n     if (result < 0) return INT2FIX(-1);\n-    if (result > 1) return INT2FIX(1);\n+    if (result > 0) return INT2FIX(1);\n\n     return INT2FIX(0);\n }\ndiff --git a/test/test_x509name.rb b/test/test_x509name.rb\nindex 2d92e64..ae8a8fb 100644\n--- a/test/test_x509name.rb\n+++ b/test/test_x509name.rb\n@@ -426,10 +426,24 @@ class OpenSSL::TestX509Name < OpenSSL::TestCase\n     name0 = OpenSSL::X509::Name.new([[\"DC\", \"org\"], [\"DC\", \"ruby-lang\"], [\"CN\", \"bar.ruby-lang.org\"]])\n     name1 = OpenSSL::X509::Name.new([[\"DC\", \"org\"], [\"DC\", \"ruby-lang\"], [\"CN\", \"bar.ruby-lang.org\"]])\n     name2 = OpenSSL::X509::Name.new([[\"DC\", \"org\"], [\"DC\", \"ruby-lang\"], [\"CN\", \"baz.ruby-lang.org\"]])\n+    name3 = OpenSSL::X509::Name.new([[\"DC\", \"org\"], [\"DC\", \"ruby-lang\"], [\"CN\", \"bar.ruby-langg.org\"]])\n+    name4 = OpenSSL::X509::Name.new([[\"DC\", \"org\"], [\"DC\", \"ruby-lang\"], [\"CN\", \"bbz.ruby-lang.org\"]])\n     assert_equal true, name0 == name1\n     assert_equal true, name0.eql?(name1)\n+    assert_equal true, name1 == name0\n+    assert_equal true, name1.eql?(name0)\n     assert_equal false, name0 == name2\n     assert_equal false, name0.eql?(name2)\n+    assert_equal false, name2 == name0\n+    assert_equal false, name2.eql?(name0)\n+    assert_equal false, name0 == name3\n+    assert_equal false, name0.eql?(name3)\n+    assert_equal false, name3 == name0\n+    assert_equal false, name3.eql?(name0)\n+    assert_equal false, name0 == name4\n+    assert_equal false, name0.eql?(name4)\n+    assert_equal false, name4 == name0\n+    assert_equal false, name4.eql?(name0)\n   end\n\n## Impact\n\nWhenever names are compared during certificate validation an attacker could use a certificate with a different name, but the comparison will return that they are equal. This would allow an attacker to create an illegitimate certificate that may be accepted as legitimate and then used in signing or encryption operations.",
  "weakness": {
    "id": 28,
    "name": "Improper Certificate Validation"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-11-18T14:46:00.287Z",
  "allow_singular_disclosure_after": -165277340.08666956,
  "singular_disclosure_allowed": true,
  "vote_count": 11,
  "voters": [
    "kapytein",
    "ali",
    "leetboi",
    "eveeez",
    "japz",
    "bb00x",
    "cryptographer",
    "jhonwick",
    "semvoigtlander",
    "tylereckstein",
    "and 1 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
