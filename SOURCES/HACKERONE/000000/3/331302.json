{
  "id": 331302,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzEzMDI=",
  "url": "https://hackerone.com/reports/331302",
  "title": "Improper protection of FileContentProvider",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2018-03-30T08:21:53.366Z",
  "submitted_at": "2018-03-30T08:21:53.366Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mmmds",
    "url": "/mmmds",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 13291,
    "url": "https://hackerone.com/nextcloud",
    "handle": "nextcloud",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/tnqlkt8d6fcch8hj8brdjp8nw864/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Nextcloud",
      "twitter_handle": "nextclouders",
      "website": "https://nextcloud.com",
      "about": "Access, share and protect your files, calendars, contacts, communication & more at home and in your enterprise."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [
    "CVE-2018-3765"
  ],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2020-03-01T14:05:16.781Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2020-01-31T14:05:15.501Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Some data in the FileContentProvider is protected against applications not related to NextCloud. The application checks if calling application package name contains \"com.nextcloud.client\" string. Every application with such substring in package name is allowed to fully access FileContentProvider.\n\ncom.owncloud.android.providers.FileContentProvider\n\n``` java\n    private boolean isCallerNotAllowed() {\n        String callingPackage = this.mContext.getPackageManager().getNameForUid(Binder.getCallingUid());\n        return callingPackage == null || !callingPackage.contains(this.mContext.getPackageName());\n    }\n```\n\n## Impact\n\nMalicious applications with \"com.nextcloud.client\" in their package names are able to access FileContentProvider without restrictions. For example they are able to read private keys to end-to-end encryption using URI: content://org.nextcloud/arbitrary_data",
  "weakness": {
    "id": 26,
    "name": "Improper Access Control - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2020-03-01T14:05:15.587Z",
  "allow_singular_disclosure_after": -124757784.60780422,
  "singular_disclosure_allowed": true,
  "vote_count": 6,
  "voters": [
    "a_d_a_m",
    "ali",
    "eveeez",
    "japz",
    "cryptographer",
    "thenooobguy"
  ],
  "severity": {
    "rating": "low",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 1,
    "asset_type": "GOOGLE_PLAY_APP_ID",
    "asset_identifier": "com.nextcloud.client",
    "max_severity": "medium"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
