{
  "id": 331940,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzE5NDA=",
  "url": "https://hackerone.com/reports/331940",
  "title": "Race Condition : Exploiting the loyalty claim https://xxx.vendhq.com/loyalty/claim/email/xxxxx url and gain x amount of loyalty bonus/cash",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2018-04-02T11:09:17.995Z",
  "submitted_at": "2018-04-02T11:09:17.995Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "stok",
    "url": "/stok",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/e8jhqjy8v13HtLdUEFc2a7pP/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 20545,
    "url": "https://hackerone.com/vend_vdp",
    "handle": "vend_vdp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/020/545/a775382b6cc2ea39dd205cec8a8c6217a6165aae_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/020/545/a775382b6cc2ea39dd205cec8a8c6217a6165aae_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": false,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Vend VDP",
      "twitter_handle": "vendhq",
      "website": "https://www.vendhq.com",
      "about": "Vend is retail POS software, inventory management, ecommerce & customer loyalty for iPad, Mac and PC. Easily manage & grow your business in the cloud."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-06-07T06:01:13.585Z",
  "bug_reporter_agreed_on_going_public_at": "2018-06-07T06:01:13.452Z",
  "team_member_agreed_on_going_public_at": "2018-05-02T02:44:40.818Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hey Team! \nI love loyalty bonuses, that turns first time users into returning customers , but sometimes loyalty can be exploited, just like in this chase.\n\n## LT:DR\nA firtstime loyalty customer will get x times the amount of loyalty bonus from the story by racing the loyalty link x amount of times in one go.  \nhttps://stokhackerone.vendhq.com/loyalty/claim/XXXXXX\n\n## See POC video for full Walkthrough\nhttps://youtu.be/MFvNs99NvnA\n\n# POC: \n1. Create a store\n1. Enable the loyalty program\n1. Make a sale\n1. Add the first time customers email adress\n1. open up loyalty email \n1. submit the post 1,2,30,50 times depending on how mutch loyalty you want to receive\n1. enjoy your loyalty.\n\nI tried it a couple times with two unique users, sometimes its a 100% race, ie\n50 times 100 = 5000, sometimes its a little lower, depends on load and latency.\ni only tried it twice to be sure not to DOS. \n\n## Once again, finally, thanks got having an awesome product, it saves so mutch time for SMB's!\nStay epic!\n\n//f\n\n## Impact\n\nAn attacker could race the loyalty claim post to get x amount of loyalty bonus and if the site has enabled the ecom version, and then use that cash as a loyalty\n\n##How do customers redeem their loyalty\nhttps://support.vendhq.com/hc/en-us/articles/201382810-Setting-Up-and-Using-Loyalty-in-Vend#redeem\n\nWhen a customer wants to pay for a sale with their loyalty balance, it's simple and easy for your staff.\n\nJust add the items to the sale, add the customer to the sale, and click 'Pay'.\nCustomers can pay:\n\nAll of the sale with loyalty\nPart of sale with loyalty\n\nTo pay the entire sale with loyalty, simply choose the loyalty payment type. This will be greyed out if the customer does not have enough loyalty to pay for the whole sale.\n\nTo pay part of a sale with loyalty, type the amount to be paid by loyalty into the total field. This must be equal to, or less than, the total loyalty the customer has. If it is, the loyalty payment button will now be available. Click the loyalty payment button. Then, pay the remainder of the sale off using another payment type.",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 91,
  "voters": [
    "bazzadrox",
    "jokebookservice1",
    "d0kkillo",
    "mashoud1122",
    "shubs",
    "str0k1rch",
    "bibekshah",
    "sameerphad72",
    "bl4de",
    "miguel_santareno",
    "and 81 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 5.3,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "high",
      "availability": "none"
    }
  },
  "structured_scope": {
    "databaseId": 549,
    "asset_type": "URL",
    "asset_identifier": "your-store.vendecommerce.com",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
