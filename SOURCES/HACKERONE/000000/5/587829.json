{
  "id": 587829,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81ODc4Mjk=",
  "url": "https://hackerone.com/reports/587829",
  "title": "CSTI at Plugin page leading to active stored XSS (Publisher name)",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "high",
  "readable_substate": "Resolved",
  "created_at": "2019-05-22T12:45:01.797Z",
  "submitted_at": "2019-05-22T12:45:01.797Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "skavans",
    "url": "/skavans",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 17011,
    "url": "https://hackerone.com/newrelic",
    "handle": "newrelic",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/3813a300hyp02ziarjcgo7ph6uxv/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "New Relic",
      "twitter_handle": "newrelic",
      "website": "https://newrelic.com",
      "about": "New Relic's Coordinated Disclosure Program"
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2020-08-13T10:57:40.541Z",
  "bug_reporter_agreed_on_going_public_at": "2020-08-11T09:30:34.720Z",
  "team_member_agreed_on_going_public_at": "2020-08-13T10:57:40.457Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hey team,\n\nI have discovered the CSTI vulnerability at NR single Plugin page leading to stored XSS.\n\nTo plant the payload you need to publish new plugin using account having the payload inside its name. Below I show you the easiest way to reproduce this using a python script which creates the new plugin using the Plugins API.\n\n###Steps to reproduce:\n1) Sign into the NR app with \"Admin\" account\n2) Change the account name to `xsstest{{'a'.constructor.prototype.charAt=[].join;$eval('x=alert(1)');}}`\n3) Open attached python-script and change the `YOUR_LICENSE_KEY` to your own license key\n4) Install the necessary python dependency with `sudo pip install requests`\n5) Run the changed script with `python nr_new_plugin.py`\n6) Navigate to NR Plugins and then to your new created plugin\n7) Make sure the XSS payload is fired\n{F494473}\n\n###Remediation\nThe vulnerability exists because of using the Angular framework. Here is the HTML-code of plugin page:\n```html\n...\n<section class='span-4 last' ng-app='Plugins'>\n<div class='branding-block clearfix'>\n<p>Published and supported by</p>\n<div class='logo'>\n<img alt=\"Branding-default\" height=\"44\" src=\"/images/v4/platform/branding-default.png?e9181bf\" width=\"44\" />\n</div>\n<div class='information'>\n<h1>PUBLISHER_NAME_HERE</h1>\n<ul>\n<li>\n<a href='' target='_blank'>About us</a>\n&nbsp;|&nbsp;\n...\n```\nAs you can see, the `PUBLISHER_NAME_HERE` is inside the element which is the Angular-app container (`<section class='span-4 last' ng-app='Plugins'>`, look at the `ng-app` attribute). It means that its content will be considered as Angular template so attacker can use the Angular template sandbox escape vulnerability to trigger an XSS here.\n\nThe right way to fix this is not to return the user controlled data inside the Angular app container. All user controlled data should be retrieved using Angular built-in AJAX. As the immediate fix, you can just filter the `{}` signs.\n\nThe vulnerability impact seems to be **higher than usual**, because after publishing this plugin, **every user from any account can be attacked**, when he visits the infected plugin page, not only users inside the attacker's account. So the impact here is up to the **arbitrary account takeover**.\n\n## Impact\n\nAttacker can force victim to execute arbitrary JS-code.",
  "weakness": {
    "id": 62,
    "name": "Cross-site Scripting (XSS) - Stored"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 494473,
      "file_name": "______________2019-05-22___15.29.56.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/494/473/b9b483ef48d6d0c36fd90708a786c87398c3fa3f/______________2019-05-22___15.29.56.png?response-content-disposition=attachment%3B%20filename%3D%22______________2019-05-22___15.29.56.png%22%3B%20filename%2A%3DUTF-8%27%27______________2019-05-22___15.29.56.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXDXMWQX4%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T132303Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBXiIatSvXxAR8ZBwoq9n9qamV3%2Beh4VxZ3KYO4Dx8ipAiBhqaPFcz1fCY4UiwnoQpCKbjkuyniJ5UnHxhrd1V7sPCqxBQh2EAMaDDAxMzYxOTI3NDg0OSIMI7x1nUgRkEN0qOmcKo4FXYYyeBqpZepmBlG%2Bn8RIW4ybBvBDLTs5NzQS7p452M4cH8%2FOy1nnGTSEGOnFuQ1hr8I838Py4bbR2k0%2FeAXwEKBwp9kUx1f6xHqwuZ%2BZJE6IBIkxerlv%2FE3eoTBjleGGo2wwfiOgBypgZ5sXatzcXx72vmVtwhxsDHzFmuJonyOALDBbiuqGbIPREpmA3jUxq%2BMAacTvuf9XMxNE478SaHCKprf1SFobf84oc7fT%2FWNU4UeJ8GNMQeSenAKYY%2BrLefa1UY4wwj6g5D0GjwCVp9bHXI21rt%2BOchx%2BJy%2Ff8hhrWt2fFEziDHK2ejHlzmon20KSav3Ecka%2Fl7q%2FXbFq%2B5cHQ3Fnv6Hsuz%2BtzfIL4EI8nN4PTXJ959QXCgSq68M3r%2FCq038IGGPaf9q5IZ44XiRhpk9WyrUqaUvKDpIG2kZMpC6jLDCikWY%2F0pq0aLMVs8K3zMuHvUvoA%2B2gV%2Bcm6EdoBU1pM0KqEZ4gTsmJdr8mPFqfdK1P4IwECSvHVNNvRZ%2FytigAMyryjJi%2FzrEs38Y9%2FrEkIQq4jS7aMXa2dJvo8qo%2BMpwzgI63Zc9%2BUb7QMMj32n1iEhgvRp0P4HsvjBZW5a45NrCNrdPawRXUjURzopS4c1KkPmoIyqVJLA%2FcZfSuGhSIBnYcB3irx3ar6nXnb1BlJQeYwVq%2BGugPDwYF7JnE98PVLlThTxxkQLe6rmhG98KDMqkM2rSCOaoIoCAr8pyrGNylV531TI6WsbwObHBBin8dGaMs5bPKof2pfOiufJXYwPbUfatl0yR4eeNEDZ2ojVwsNt%2FXz0I%2BnOHi3gFnlaTXXL2pE75y8B8i2gdpWyljLCB%2Bnh8JAX4zJ9W5uSJwboRkdOBCbm1EMOnJra4GOrIBAGTU0E8gZ3I1JcYpghGRH630deXcWBT7WyMmozUTe6qarc28Ss1LWSuryHkoMrH7Sud0DqGFERBVj7YzRXPoLL7BGEhCuNa2uCE2kvLJYBOVb8O0U%2BA8CX4iNwz55KlL7rByi1vNt6ahpUI7DJZTOvkkTX1DSVfQF%2Baicg%2BfMtGKT4Z2J8HGmzqC%2FR%2FqkC6K2vyecQNgl1yG%2BNZWxHLH3sMFQGgXVbyipFgwNo8D0TTcrQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d8d02f744332be27f008bb561e393b20b79174f111465457822b533dca9be9e5",
      "file_size": 302033,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2020-09-10T09:30:34.766Z",
  "allow_singular_disclosure_after": -108100349.092609,
  "singular_disclosure_allowed": true,
  "vote_count": 91,
  "voters": [
    "wi11",
    "p1stachios",
    "sourc7",
    "mashoud1122",
    "spongebhav",
    "e4366eolywrgpidfbio",
    "newbipath12",
    "vovohelo",
    "ali",
    "amine_aboud",
    "and 81 more..."
  ],
  "severity": {
    "rating": "high",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 18678,
    "asset_type": "URL",
    "asset_identifier": "rpm.newrelic.com",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 127132,
      "category": "researcher",
      "content": "My Telegram channel about being the full-time bug bounty hunter, my tips and tricks:\nüá∫üá∏ [BugBountyPLZen](https://t.me/+mY0ndZYzGbYxYmYy)\n\n–ú–æ–π Telegram-–∫–∞–Ω–∞–ª –ø—Ä–æ —Ñ—É–ª–ª—Ç–∞–π–º –±–∞–≥-—Ö–∞–Ω—Ç–∏–Ω–≥, —Å–æ–≤–µ—Ç—ã –∏ –º–µ—Ç–æ–¥–∏–∫–∏:\nüá∑üá∫ [BugBountyPLZ](https://t.me/+WYgyG5n2_kM1Yzdi)",
      "user": {
        "id": 14089,
        "username": "skavans",
        "name": "Anton Subbotin",
        "bio": "Swapped my office work for the bounty hunting ‚öîÔ∏è",
        "cleared": false,
        "verified": false,
        "website": "https://skavans.ru/en/",
        "location": "Russia",
        "created_at": "2014-11-14T23:02:26.903Z",
        "url": "https://hackerone.com/skavans",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/014/089/00a08f6b566bcdfe82b2f0be62bdde605a030823_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
