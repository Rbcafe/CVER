{
  "id": 537670,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81Mzc2NzA=",
  "url": "https://hackerone.com/reports/537670",
  "title": "[Zomato for Business Android] Vulnerability in exported activity WebView",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2019-04-13T22:49:58.519Z",
  "submitted_at": "2019-04-13T22:49:58.519Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "shell_c0de",
    "url": "/shell_c0de",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/286/336/6c31698bb7e83a8bb394303ec2b1a31513a1bb99_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 2943,
    "url": "https://hackerone.com/zomato",
    "handle": "zomato",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Zomato",
      "twitter_handle": "Zomato",
      "website": "https://www.zomato.com",
      "about": "The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2021-09-23T05:56:45.667Z",
  "bug_reporter_agreed_on_going_public_at": "2021-07-05T14:28:10.987Z",
  "team_member_agreed_on_going_public_at": "2021-09-23T05:56:45.576Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello, i want to report the vulnerability found,\nSince the following activity `com.application.zomatomerchant.home.HomeSalt` has `exported=\"true\"` it can be exploited by another application.\n\n###Application Information\n\nApplication: [Zomato for Business](https://play.google.com/store/apps/details?id=com.application.zomatomerchant)\nPackage Name: `com.application.zomatomerchant`\nVersion: `4.2.5`\nVersion Status: Last\nVulnerable class: `com.application.zomatomerchant.deeplink.SaltDeepLinkRouterActivity`\n\n###Vulnerability\n\nUsing a special intent, you can send a malicious url to class `com.application.zomatomerchant.ZWebView`\n```java\npublic class HomeSalt extends PhiAppCompatActivityWithSimpleToolbar implements C0806a, C0928a {\nprotected void onCreate(Bundle bundle) {\n        super.onCreate(bundle);\n        if (this.f2062r == null) {\n            this.f2062r = C0940a.m2184a(this);\n        }\n        mo7458b(R.layout.home_salt);\n        mo7475d(R.string.app_name);\n        this.f2061q = (Toolbar) findViewById(R.id.toolbar_simple_root);\n        this.f2059o = (DrawerLayout) findViewById(R.id.drawer_layout);\n        if (getIntent() != null) {\n            Uri data = getIntent().getData();\n            if (data != null && m2113a(data.toString())) {\n                Bundle extras = getIntent().getExtras();\n                if (extras == null || !extras.getBoolean(\"notification_popup\", false)) {\n                    mo10440c(data);//put data\n//...\n public void mo10440c(Uri uri) {\n        if (!C0807b.f1729a.equals(uri)) {\n            if (mo10218b(uri)) {\n                mo10217a(uri);\n            } else {\n                SaltDeepLinkRouterActivity.m1755a((Context) this, uri);//put data\n//...\npublic static void m1755a(Context context, Uri uri) {\n        Intent intent = new Intent(context, SaltDeepLinkRouterActivity.class);\n        intent.setFlags(268435456);\n        intent.setData(uri);\n        context.startActivity(intent);\n    }\n//...\n protected void onCreate(Bundle bundle) {\n        super.onCreate(bundle);\n        Intent intent = getIntent();\n        if (!(intent == null || intent.getData() == null)) {\n            Uri data = intent.getData();\n            if (mo10218b(data)) {\n                mo10217a(data);//put data\n//..\n public void mo10217a(Uri uri) {\n        if (uri != null) {\n            Intent intent;\n            C0810e a = C0810e.m1769a((Activity) this);\n            String host = uri.getHost();\n            List pathSegments = uri.getPathSegments();\n            int size = pathSegments != null ? pathSegments.size() : 0;\n         \n                } else if (!C2150af.m6783a(uri.getScheme()) && uri.getScheme().startsWith(\"http\")) {\n                    intent = new Intent(this, ZWebView.class);//load url\n                    intent.putExtra(\"open_external\", true);\n                    intent.putExtra(NativeProtocol.IMAGE_URL_KEY, uri.toString());//put data\n```\nHost check missing.\nF468292\n###PoC\n\nJava PoC:\n```java\nIntent intent = new Intent(\"android.intent.action.VIEW\");\nintent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION|Intent.FLAG_ACTIVITY_NEW_TASK);\nintent.setClassName(\"com.application.zomatomerchant\",\"com.application.zomatomerchant.home.HomeSalt\");\nintent.setData(Uri.parse(\"███████/\"));\nstartActivity(intent);\n```\nPayload: ██████\n###Fix\n\nCheck the host before load to WebView\n\n## Impact\n\nXSS/Ability of open arbitrary sites in your internal WebView\n\nAllows you to replace the content in the application on malicious website. The user will not be able to understand the difference.\n\nThe vulnerability is included in the [Google Play Security Reward Program](https://hackerone.com/googleplay) (section 2 Theft of insecure private date)",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 468292,
      "file_name": "webviewz.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/468/292/0074522cdd03fdb5d84172b3a421e3c1d8c8b456/webviewz.jpg?response-content-disposition=attachment%3B%20filename%3D%22webviewz.jpg%22%3B%20filename%2A%3DUTF-8%27%27webviewz.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXDXMWQX4%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T132121Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBXiIatSvXxAR8ZBwoq9n9qamV3%2Beh4VxZ3KYO4Dx8ipAiBhqaPFcz1fCY4UiwnoQpCKbjkuyniJ5UnHxhrd1V7sPCqxBQh2EAMaDDAxMzYxOTI3NDg0OSIMI7x1nUgRkEN0qOmcKo4FXYYyeBqpZepmBlG%2Bn8RIW4ybBvBDLTs5NzQS7p452M4cH8%2FOy1nnGTSEGOnFuQ1hr8I838Py4bbR2k0%2FeAXwEKBwp9kUx1f6xHqwuZ%2BZJE6IBIkxerlv%2FE3eoTBjleGGo2wwfiOgBypgZ5sXatzcXx72vmVtwhxsDHzFmuJonyOALDBbiuqGbIPREpmA3jUxq%2BMAacTvuf9XMxNE478SaHCKprf1SFobf84oc7fT%2FWNU4UeJ8GNMQeSenAKYY%2BrLefa1UY4wwj6g5D0GjwCVp9bHXI21rt%2BOchx%2BJy%2Ff8hhrWt2fFEziDHK2ejHlzmon20KSav3Ecka%2Fl7q%2FXbFq%2B5cHQ3Fnv6Hsuz%2BtzfIL4EI8nN4PTXJ959QXCgSq68M3r%2FCq038IGGPaf9q5IZ44XiRhpk9WyrUqaUvKDpIG2kZMpC6jLDCikWY%2F0pq0aLMVs8K3zMuHvUvoA%2B2gV%2Bcm6EdoBU1pM0KqEZ4gTsmJdr8mPFqfdK1P4IwECSvHVNNvRZ%2FytigAMyryjJi%2FzrEs38Y9%2FrEkIQq4jS7aMXa2dJvo8qo%2BMpwzgI63Zc9%2BUb7QMMj32n1iEhgvRp0P4HsvjBZW5a45NrCNrdPawRXUjURzopS4c1KkPmoIyqVJLA%2FcZfSuGhSIBnYcB3irx3ar6nXnb1BlJQeYwVq%2BGugPDwYF7JnE98PVLlThTxxkQLe6rmhG98KDMqkM2rSCOaoIoCAr8pyrGNylV531TI6WsbwObHBBin8dGaMs5bPKof2pfOiufJXYwPbUfatl0yR4eeNEDZ2ojVwsNt%2FXz0I%2BnOHi3gFnlaTXXL2pE75y8B8i2gdpWyljLCB%2Bnh8JAX4zJ9W5uSJwboRkdOBCbm1EMOnJra4GOrIBAGTU0E8gZ3I1JcYpghGRH630deXcWBT7WyMmozUTe6qarc28Ss1LWSuryHkoMrH7Sud0DqGFERBVj7YzRXPoLL7BGEhCuNa2uCE2kvLJYBOVb8O0U%2BA8CX4iNwz55KlL7rByi1vNt6ahpUI7DJZTOvkkTX1DSVfQF%2Baicg%2BfMtGKT4Z2J8HGmzqC%2FR%2FqkC6K2vyecQNgl1yG%2BNZWxHLH3sMFQGgXVbyipFgwNo8D0TTcrQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=43e22ecd44f2c54328fd82ab2b027f480726d1b0d2120af76116e1c103ade86e",
      "file_size": 41448,
      "type": "image/jpeg",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 49,
  "voters": [
    "lostsoulofawolf",
    "tolga",
    "alp",
    "muminkoykiran",
    "run_win",
    "imranhudaa",
    "shell_c0de",
    "ali",
    "rahulkadavil_",
    "sudi",
    "and 39 more..."
  ],
  "severity": {
    "rating": "medium",
    "author_type": "User"
  },
  "structured_scope": {
    "databaseId": 388,
    "asset_type": "GOOGLE_PLAY_APP_ID",
    "asset_identifier": "com.application.zomatomerchant",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
