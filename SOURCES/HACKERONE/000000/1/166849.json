{
  "id": 166849,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjY4NDk=",
  "url": "https://hackerone.com/reports/166849",
  "title": "IDOR(indirect object references) on add friend,complement and send message ",
  "state": "Closed",
  "substate": "not-applicable",
  "readable_substate": "N/A",
  "created_at": "2016-09-08T14:14:07.347Z",
  "submitted_at": "2016-09-08T14:14:07.347Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": true,
    "username": "w3b7ricks73r",
    "url": "/w3b7ricks73r",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 545,
    "url": "https://hackerone.com/yelp",
    "handle": "yelp",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/545/de556165eaf2da7600f9ce75d1179281ee2d538f_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Yelp",
      "twitter_handle": "",
      "website": "https://www.yelp.com",
      "about": "Connecting people to great local businesses in communities around the world."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-11-09T20:15:26.577Z",
  "bug_reporter_agreed_on_going_public_at": "2016-09-09T18:41:50.836Z",
  "team_member_agreed_on_going_public_at": "2017-11-09T20:15:26.400Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi security ,\n\nDescription:\nI found user id in encrypted form from there profile url \nhttps://www.yelp.com/user_details?userid=<user id's>\n\non intercepting request of add friend, complement and send message i can identify user id ..\nwhen i change identified user ID to other user's ID then request of add friend is send to other user without any token and secession validation .. scenario for the complement and send message is same.\n\nImpact:\n->an attacker can add the authenticated user to his account or any others accounts ..\n->can send message to any one by user's account \n->can complement on other users by victim user \n\nMore information about this issue is available here:\n\nhttps://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References\nhttps://www.owasp.org/index.php/Testing_for_Insecure_Direct_Object_References_(OTG-AUTHZ-004)\n\nReproduction Steps:- for add friend \n1.>login to your test account \n2.>visit any two user's profile \n3.>click on add friend on user one \n4.>intercepting request \n5.>identify user id and change it to second user's id on each request \n6.>click on send\n7.>intercept request and change user id \n8.>check the screen with the message od request is send to second user \n(request is send to another user)\n\nReproduction Steps:- for complement\n1.>login to your test account \n2.>visit any two user's profile \n3.>click on complement of user one\n4.>intercepting request \n5.>identify user id and change it to other user's id on each request \n6.>type the complement\n7.>intercept request and change user id \n8.>check the screen with message that complement is send to second user\n(complement is send to second user)\n\nReproduction Steps:- for send message \n1.>login to your test account \n2.>visit any two user's profile \n3.>click on send message of user one \n4.>intercepting request \n5.>identify user id and change it to other user's id on each request \n6.>type the message \n7.>intercept request and change user id \n8.>check the screen with message that complement is send to second user\n(message is send to second user)\n\nPlease Find the video POC from the links\n\nhttps://mega.nz/#!FR5CxSrD!wxqSN9BomoznTwDATDc-DiiAHsFj80W7VqNPklO4FYs\n\nhttps://mega.nz/#!UQBBWY7C!85q0Nn9F9icsf_KXfuis_YNJVc7tIp6ebr4Javi6Za0\n\n\nRegards \nAaysha Khilji\n\n\n\n\n    ",
  "weakness": {
    "id": 57,
    "name": "Violation of Secure Design Principles"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 4,
  "voters": [
    "rashedul_css",
    "nomindsec",
    "khokho1986",
    "b4155f7c29acd42c27d007a"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
