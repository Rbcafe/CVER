{
  "id": 158979,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTg5Nzk=",
  "url": "https://hackerone.com/reports/158979",
  "title": "PM with can Set up email for invoices and estimates (Access control Issue)",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-08-13T05:23:52.255Z",
  "submitted_at": "2016-08-13T05:23:52.255Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "indoappsec",
    "url": "/indoappsec",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 237,
    "url": "https://hackerone.com/harvest",
    "handle": "harvest",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/pyh0ce4oyfvefdxsl0z3vhga5d5b/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/pyh0ce4oyfvefdxsl0z3vhga5d5b/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Harvest",
      "twitter_handle": "",
      "website": "https://getharvest.com",
      "about": "Harvest is a leader in online time tracking and invoicing. Work better, and make smarter decisions for your business."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-09-29T23:02:59.606Z",
  "bug_reporter_agreed_on_going_public_at": "2016-08-30T23:02:55.056Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi Team,\n\nDescription : Project Manager With limited access Invoices and estimates don't have access to Company information. In the company Information there is a option of adding an Email to send invoices and estimations. The limited access Project manager should not be able to Access this sections and shouldn't be able to add the email to send invoices on that.\nBut the Adding Email HTTP request have some access control issues.Hence it let's the Project manager (with limited) to Add new email . \n\nSteps to reproduce : \n1.Create a New account with Owner(UserA) and add a Project manager(Attacker) where he doesn't have access to invoices and addition features.\n2.Open the Project Manager's account and you will see that he's not able to access the Invoice and estimation section where you can change the company info.\n3.Run the Below Mentioned HTTP request  From any proxy tool : \n\nPOST /sender_emails HTTP/1.1\nHost: vijaygangani.harvestapp.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/javascript, text/html, application/xml, text/xml, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nX-Requested-With: XMLHttpRequest\nX-Prototype-Version: 1.7\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nReferer: https://vijaygangani.harvestapp.com/invoices/configure\nContent-Length: 287\nCookie: [Cookie_values]\nConnection: keep-alive\n\nutf8=%E2%9C%93&url_hash=thank_you_email&sender_email%5Bname%5D=[Sender's Name]&sender_email%5Bemail%5D=[Email]&authenticity_token=[Token_Value]&x_requested_with=XMLHttpRequest\n\n4.After sending  this Request to server ,It won't check the access and The verification email will be sent to your mentioned email in the HTTP request. \n5. Now Attacker can go to the email and add his email by verifying the email.\n\nNote : The above Mentioned HTTP request can be get by below mentioned link and add email :  https://vijaygangani.harvestapp.com/invoices/configure#company_information_edit\n\n\nImpact :  Any Project Manager with limited access can add his own email to get All the estimation and invoice Details.\n\nLet me know if you need Video POC or any other information regarding this issue.\n\nBest Regards !\nVijay Kumar \n\n\n\n",
  "bounty_amount": "250.0",
  "formatted_bounty": "$250",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2016-09-29T23:02:55.168Z",
  "allow_singular_disclosure_after": -232636661.42932534,
  "singular_disclosure_allowed": true,
  "vote_count": 10,
  "voters": [
    "thisishrsh",
    "vijay_kumar",
    "dmatrix",
    "dilawer",
    "jens",
    "jbbbkj",
    "sumit7",
    "oldzk34911",
    "akshay_raj",
    "dyabla"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
