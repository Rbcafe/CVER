{
  "id": 144385,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDQzODU=",
  "url": "https://hackerone.com/reports/144385",
  "title": "SMTP server allows anonymous relay from internal addresses to internal addresses",
  "state": "Closed",
  "substate": "duplicate",
  "readable_substate": "Duplicate",
  "created_at": "2016-06-12T18:04:06.387Z",
  "submitted_at": "2016-06-12T18:04:06.387Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "phenix",
    "url": "/phenix",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/011/209/aa6c949c27f2bc67ba8b28a193eb1a98dc3b640e_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 8539,
    "url": "https://hackerone.com/paragonie",
    "handle": "paragonie",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/008/539/72f76fed45e5220b47ba2f679371ebf9ccb19c70_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "paused",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Paragon Initiative Enterprises",
      "twitter_handle": "ParagonIE",
      "website": "https://github.com/paragonie",
      "about": "Cryptography and Application Security Consultants - We Produce Various Open Source Libraries"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-10-16T05:51:25.288Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2017-10-16T05:51:18.349Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello,\n\n## Issue descripton\nyour incoming SMTP servers, provided by google , seems to be accepting without authentication mails from addresses `@paragonie.com` and destined for addresses `@paragonie.com`.\n\nThis can greatly ease spear-phishing attacks, as users usually put much trust into emails coming from their own domain name, let alone people they actually know.\nFor instance, an attacker could craft an email impersonating your CEO or your IT dept. and asking to open a malicious link or attachment, then send it to some of your users by leveraging this vulnerabilty.\n\n## Issue reproduction\nusing the sendemail script (http://caspian.dotconf.net/menu/Software/SendEmail/) :\n`sendemail -s alt1.aspmx.l.google.com:25 -o message-file=mail2.txt -t security@paragonie.com -f scott@paragonie.com -u \"security testing of mail relay\" -vvv`\n\nIf you will, I can also reproduce the issue at your request, with any \"from:\" and \"to:\" addresses that you like.\n\n## Trace output\nAs this trace shows, I was able to send an email from scott@paragonie.com to security@paragonie.com, without authentication.\n```\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO => Sending:     MAIL FROM:<scott@paragonie.com>\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS => Received:         250 2.1.0 OK s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO => Sending:     RCPT TO:<security@paragonie.com>\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS => Received:         250 2.1.5 OK s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO => Sending:     DATA\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS => Received:         354  Go ahead s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: INFO => Sending message body\nJun 12 19:08:48 vps289445 sendemail[2081]: Setting content-type: text/plain\nJun 12 19:08:48 vps289445 sendemail[2081]: SUCCESS => Received:         250 2.0.0 OK 1465751328 s12si11327788lfe.119 - gsmtp\nJun 12 19:08:48 vps289445 sendemail[2081]: Generating a detailed exit message\nJun 12 19:08:48 vps289445 sendemail[2081]: Email was sent successfully!  From: <scott@paragonie.com> To: <security@paragonie.com> Subject: [security testing of mail relay] Server: [alt1.aspmx.l.google.com:25]\n```\n\n## Recommendation\nAuthentication shall be requested for incoming emails from internal `@paragonie.com` email addresses, especially when they come from untrusted networks such as Internet.\n\nMore information on how to fix this vulnerability with DMARC records can be found here:\nhttps://support.google.com/mail/answer/2451690\n\nBest regards.\n",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": 135283,
  "original_report_url": "https://hackerone.com/reports/135283",
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 4,
  "voters": [
    "silv3rpoision",
    "mohammedatary",
    "hck3r",
    "326070"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
