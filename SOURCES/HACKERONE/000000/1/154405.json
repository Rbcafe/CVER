{
  "id": 154405,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNTQ0MDU=",
  "url": "https://hackerone.com/reports/154405",
  "title": "Read access to hidden orders,products,customers etc. by limited access Staff member through reference page in Comments (Information disclosure )",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-07-27T17:41:29.157Z",
  "submitted_at": "2016-07-27T17:41:29.157Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "indoappsec",
    "url": "/indoappsec",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/QUAjqUf576QNBhxg691WB8YG/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2018-12-06T15:04:05.384Z",
  "bug_reporter_agreed_on_going_public_at": "2017-07-18T20:44:09.632Z",
  "team_member_agreed_on_going_public_at": "2018-12-06T15:04:05.268Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi Team ,\n\nNote : I have reported multiple issues related to information which were closed a N/A due to some information lack. But this issue will look similar by title but it's different then other issues. Before testing anything i have insured that all other permissions are limited for the account so by any way he should not be able to get these information. \nDescription : Any staff member with limited access can view the details of it's limited area. \nEx: If staff member have limited access to orders , He can still view orders. If he has limited access to customers , he can still view customers details like name, email etc. \nThis can be possible by comment section in products ,orders etc. In comment section you will see the # sign by which you can refer any page. Now you won't have access to the pages where your access is limited. Suppose you have access to products but no access to orders. When you will see # sign you can only find pages of products but you won't find the order related pages.\nNow while commenting you need to add the ID of that order and you will be able to see details of that order in the comment . \n\n\nSteps to reproduce : \nLet's say a staff member has limited access to products and orders but he has access to products.\n*Access details : No access to order, order_creation, customers , reports ,discount etc. \n\n1. Now open any transfer from product menu and and you will see the comment section where you will see the # sign by which you can refer any page of orders,products,customers etc. \n2. When you will click on this # you will notice that it will only show the products related reference pages. But it won't show the orders and customers pages because of your access issue. It means you don't access to it and you can't refer these pages.\n3. Now put any product page and add some comment to it and save it. Intercept this request and change the product ID to order ID and the order details will be posted.Instead of order ID if you put customer ID , you will get the customers name and it's email address. \n\nSo this is how any user who has limited access to any feature can access it by this method. \n\nPOC : \n\nsuppose a staff member have limited access to orders , draft_order and customers then he should not be able to access these information. \n\nHTTP request  Modified : \n\nPOST /admin/transfers/774529/timeline_comments HTTP/1.1\nHost: vijaygangani1110store.myshopify.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nX-CSRF-Token: RZIoZCcT7SGMNDwD6wl0gHzb1ACcOm1uSXy/NbItuXwQr/95Jzg+24HCWIM4Wzc0Z/F76VYd4iuPF1jj7X0zrQ==\nX-Requested-With: XMLHttpRequest\nReferer: https://vijaygangani1110store.myshopify.com/admin/transfers/774529\nContent-Length: 187\nContent-Type: multipart/form-data; boundary=---------------------------191772538514734\nCookie:[cookie_values]\nConnection: keep-alive\n\n-----------------------------191772538514734\nContent-Disposition: form-data; name=\"timeline_comment[body]\"\n\n[#O3599995137|Order #1005]\n-----------------------------191772538514734--\n\n\nI changed product ID to order ID here. In the timeline_body you have to add order ID to get the order details. If you want to retrieve the customers details you need to add the customer ID in the following format  : [#C3502872769| anyword] \n\nHere you will be able to get the email address ,name and profile photo of the customer. \n\n\nImpact : \nIf any shopify owner wants to hire a expert in such a way that he should not be accessing customer details, orders ,order_creation and related items then staff member should not access these things from any where. But by this way the staff member can get access to all these information. \n\nLet me know of you need any other help from my side to reproduce this issue. I can provide VIdeo POC if needed. \n\n\nBest Regards !\nVijay Kumar \n",
  "bounty_amount": "500.0",
  "formatted_bounty": "$500",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 18,
  "voters": [
    "drsniper",
    "sp1d3rs",
    "sameerphad72",
    "ali",
    "s_p_q_r",
    "geeknik",
    "mobius07",
    "ak1t4",
    "t4ym",
    "cyberunit",
    "and 8 more..."
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "id": 4481,
      "category": "team",
      "content": "This report demonstrated that an admin user without having corresponding resource permissions can reveal summary of resources by adding a reference to  the resources (products, orders, inventory etc) in timeline comments. This can be achieved by posting a comment [#O3103227907|foobar] which reveals summary of the order in the comment.\n",
      "user": {
        "id": 89976,
        "username": "lalith-shopify",
        "name": "Lalith Rallabhandi",
        "bio": "",
        "cleared": false,
        "verified": false,
        "website": null,
        "location": "",
        "created_at": "2016-07-04T17:52:35.589Z",
        "url": "https://hackerone.com/lalith-shopify",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "company",
        "profile_picture_urls": {
          "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png",
          "xtralarge": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
