{
  "id": 195058,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTUwNTg=",
  "url": "https://hackerone.com/reports/195058",
  "title": "Users can download old project exports due to unclaimed namespace",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2017-01-01T15:58:28.420Z",
  "submitted_at": "2017-01-01T15:58:28.420Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "jobert",
    "url": "/jobert",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/ht4b9SmcYNqmpbyCFXd7cxHB/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-01-23T23:10:00.394Z",
  "bug_reporter_agreed_on_going_public_at": "2017-01-23T20:47:30.697Z",
  "team_member_agreed_on_going_public_at": "2017-01-23T23:10:00.313Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "TL;DR: Happy new year and happy birthday, @douwem!\n\n# Vulnerability details\nWhen a user renames its namespace, another user can claim the namespace and download old export files from the victim. The attack scenario here is that someone would scrape existing GitLab namespaces (users and groups, which are public) and see if they're renamed (freeing up the old namespace). The attacker can then claim the namespace the victim's old export files.\n\n# Impact\nThis may expose confidential project information, including the repository code, merge requests, issues, and snippets.\n\n# Proof of concept\nFollow the steps below to reproduce the vulnerability.\n\n**As the victim**\n1. Create a group called `test`\n2. Create a new private project in the `test` group called `test`\n3. Click the `Generate export` button in the project's settings page\n4. Now rename the group to `new-test`\n\n**As the attacker**\n1. Create a group called `test` (this is possible because the old group was renamed to `new-test`)\n2. Create a new private project in the `test` group called `test`\n3. Go to http://gitlab-instance/test/test/download_export\n4. Profit! The attacker will download the export file generated by the victim \n\n# Remediation\nExpire download links when the namespace OR project URL changes. This vulnerability also applies when changing the project URL, although that is less severe. This might grant users access to private repositories, although far less likely than the PoC outlined in this report.",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-02-22T20:47:30.772Z",
  "allow_singular_disclosure_after": -220031058.5747316,
  "singular_disclosure_allowed": true,
  "vote_count": 10,
  "voters": [
    "ayoubfathi_",
    "mpz",
    "eveeez",
    "khizer47",
    "japz",
    "sumit7",
    "secdoor",
    "spetr0x",
    "cryptosector",
    "arice"
  ],
  "severity": {
    "rating": "medium",
    "score": 4.8,
    "author_type": "User",
    "metrics": {
      "attack_vector": "network",
      "attack_complexity": "high",
      "privileges_required": "low",
      "user_interaction": "required",
      "scope": "unchanged",
      "confidentiality": "high",
      "integrity": "none",
      "availability": "none"
    }
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
