{
  "id": 112723,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTI3MjM=",
  "url": "https://hackerone.com/reports/112723",
  "title": "PHP-FPM fpm_log.c memory leak and buffer overflow",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-01-25T17:19:21.537Z",
  "submitted_at": "2016-01-25T17:19:21.537Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "imrerad",
    "url": "/imrerad",
    "profile_picture_urls": {
      "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 54349,
    "url": "https://hackerone.com/ibb",
    "handle": "ibb",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXONP3G7Q%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T115531Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIA2ZBVtmGFXj3HuPOBAltyOYEJfYXwVkH0ySkcAGpVd4AiEA%2FDbRJn8xJyLOBOEYKm2tFe1zOLHG4xfoF6jHA4ytsPsqsQUIcBADGgwwMTM2MTkyNzQ4NDkiDCK6PxvBpzf1F5KaJiqOBemZvO%2FLscUV1ZjOsz8brbXhANz7HIMOSB2RXJXYiR%2FlB9gmsfLsQROHda4MBDaGh8OJBO0EvuRoSEg5NRIOz8nDEI9y9Egt18ofl%2By1MTr6cUhanP8Z91XoBQNxUui3l2MGIL7qsJtc9RZmcAZ4NMNu%2FqFqCNKerQ%2FCWuyHlcNW0xaEex3CRS9KjSzXDAUXUV3PabIwLr%2FdfY8gGyPcg7IL%2BzmfI8wF4j01HVVyiwcpxAzQLvkJgUuBwREtv2NEf9pTV%2BsWpyd9L6oPddt7igVKBBWBG9Mm9OtI%2Ft6Y4%2FpVY76tX5vl3VnSWfzxI02vHfG9zVB4t1jHdu6EZunMXfiLBztG2kWPDJ9LoNe%2FniKzjuWbN3pDE4AwMPJi9tB7ufm53KrUmpJ42co3PJcblQK3US7XIdJTiPTirUR1MM9r0xPFTrxP%2BSFln%2BO%2FOx9GfWCgpN5%2FFKPdVvLxco7rykVi%2B6728eCejjpZLo5098xnVTSHUUTYVpFJyXHnvzJStYRxfb4%2B6C7YzTf7lL%2Bt5EBZNRi8F307nhMp1gUrCxPLZklUdsZE3sA%2FQ5UQy4kWL%2Foj%2B5Lxy0v1TB4sgsi1IqV7IBnKQS5LBayRq%2Bs82RBkeBuKeTFJgVr%2FtfExdSBXEXWPOVjELUJL%2B3U1I%2BpS0H0DMPNNMXCDByr6oImu68vX9qBe%2BfFaDewfP5kOL%2BQxv9yny4iZ5YHS1Ajy%2FK4EIytNES7%2FPGP9h66mlZY38U8vrv0U62zbd5ScMlOR13KWedEBDcN6Gm1BBKFTFyQ5sOkpFg9UVXbjkxeuBkAHNgpWeXzPdgtc96IvyqsT%2F04KdyTv9N7jCDn1Vzvc7ltf4C9ll7UgHke80JkTVRN2bDDipayuBjqxAS00qNM1Pcd2XdxW6A3MnUgI3wydtLPBjQ8eXQLVqnaDcuKP%2BCUhIz2JrMtccLBUiViw%2FcyUzKXbLNNLYkBaDppySqWKqeNrx0Bz1GD6Jlf8aZk%2BfmjLGxSjuF%2F%2B3Da2sQ7TPrCwzDxmQK1yA6ads9rL%2BLU6oRr9JYx18RckM75gJJiJtzAYBs2Sv0yMB9rTVnZbvxiEO5rsNv0fTWwKU4c0cUND%2FMZIDiJtywrsm47IHw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=18457651abfa57c038f143b5051eef356f475f47cbddba92d232db598a1471f6",
      "medium": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/v0qywgoh5hm4cbhuanu8mqdtowhr/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937?response-content-disposition=inline%3B%20filename%3D%22ibb%20revision%205%20copy.png%22%3B%20filename%2A%3DUTF-8%27%27ibb%2520revision%25205%2520copy.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXONP3G7Q%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T115531Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIA2ZBVtmGFXj3HuPOBAltyOYEJfYXwVkH0ySkcAGpVd4AiEA%2FDbRJn8xJyLOBOEYKm2tFe1zOLHG4xfoF6jHA4ytsPsqsQUIcBADGgwwMTM2MTkyNzQ4NDkiDCK6PxvBpzf1F5KaJiqOBemZvO%2FLscUV1ZjOsz8brbXhANz7HIMOSB2RXJXYiR%2FlB9gmsfLsQROHda4MBDaGh8OJBO0EvuRoSEg5NRIOz8nDEI9y9Egt18ofl%2By1MTr6cUhanP8Z91XoBQNxUui3l2MGIL7qsJtc9RZmcAZ4NMNu%2FqFqCNKerQ%2FCWuyHlcNW0xaEex3CRS9KjSzXDAUXUV3PabIwLr%2FdfY8gGyPcg7IL%2BzmfI8wF4j01HVVyiwcpxAzQLvkJgUuBwREtv2NEf9pTV%2BsWpyd9L6oPddt7igVKBBWBG9Mm9OtI%2Ft6Y4%2FpVY76tX5vl3VnSWfzxI02vHfG9zVB4t1jHdu6EZunMXfiLBztG2kWPDJ9LoNe%2FniKzjuWbN3pDE4AwMPJi9tB7ufm53KrUmpJ42co3PJcblQK3US7XIdJTiPTirUR1MM9r0xPFTrxP%2BSFln%2BO%2FOx9GfWCgpN5%2FFKPdVvLxco7rykVi%2B6728eCejjpZLo5098xnVTSHUUTYVpFJyXHnvzJStYRxfb4%2B6C7YzTf7lL%2Bt5EBZNRi8F307nhMp1gUrCxPLZklUdsZE3sA%2FQ5UQy4kWL%2Foj%2B5Lxy0v1TB4sgsi1IqV7IBnKQS5LBayRq%2Bs82RBkeBuKeTFJgVr%2FtfExdSBXEXWPOVjELUJL%2B3U1I%2BpS0H0DMPNNMXCDByr6oImu68vX9qBe%2BfFaDewfP5kOL%2BQxv9yny4iZ5YHS1Ajy%2FK4EIytNES7%2FPGP9h66mlZY38U8vrv0U62zbd5ScMlOR13KWedEBDcN6Gm1BBKFTFyQ5sOkpFg9UVXbjkxeuBkAHNgpWeXzPdgtc96IvyqsT%2F04KdyTv9N7jCDn1Vzvc7ltf4C9ll7UgHke80JkTVRN2bDDipayuBjqxAS00qNM1Pcd2XdxW6A3MnUgI3wydtLPBjQ8eXQLVqnaDcuKP%2BCUhIz2JrMtccLBUiViw%2FcyUzKXbLNNLYkBaDppySqWKqeNrx0Bz1GD6Jlf8aZk%2BfmjLGxSjuF%2F%2B3Da2sQ7TPrCwzDxmQK1yA6ads9rL%2BLU6oRr9JYx18RckM75gJJiJtzAYBs2Sv0yMB9rTVnZbvxiEO5rsNv0fTWwKU4c0cUND%2FMZIDiJtywrsm47IHw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=03ca761a173e8bb436341e222d9e75d352b2631835111a6fa8653eba9859fafc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Internet Bug Bounty",
      "twitter_handle": "",
      "website": "https://www.hackerone.com/internet-bug-bounty",
      "about": "The Internet Bug Bounty rewards security research into vulnerabilities impacting Open Source Software Projects."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2019-11-12T09:38:12.882Z",
  "bug_reporter_agreed_on_going_public_at": null,
  "team_member_agreed_on_going_public_at": "2019-10-13T09:38:01.114Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The FastCGI Process Manager (FPM) SAPI of PHP was vulnerable to memory leak and buffer overflow in the access logging feature.\n\nPHP-FPM offers customization of the access log lines based on format string variables which can be specified with the access.format option of the FPM configuration file.\nThe log lines were compiled in php-fpm.c. The %{something}e fields were processed at line 237:\n\nlen2 = snprintf(b, FPM_LOG_BUFFER - len, \"%s\", env ? env : \"-\");\n\nThen later in the code:\nlen += len2;\n...\n    if (!test && strlen(buffer) > 0) {\n         buffer[len] = '\\n';\n        write(fpm_log_fd, buffer, len + 1);\n    }\n\nIn case the string being appended to the access log line buffer was longer than the remaining space, the len variable became longer than the buffer (FPM_LOG_BUFFER) size, because snprintf returns the number of characters (excluding the terminating null byte) which would have been written to the final string if enough space had been available. Then the PHP engine performed an out-of-boundaries read and also wrote a \\n character outside of the allocated memory.\n\nThe fix is available with the commit\nhttp://git.php.net/?p=php-src.git;a=commit;h=2721a0148649e07ed74468f097a28899741eb58f\nThe fixed versions of PHP are: 5.5.31, 5.6.17 and 7.0.2.\n\nMore information (public security advisory):\nhttp://www.search-lab.hu/about-us/news/111-some-unusual-vulnerabilities-in-the-php-engine",
  "bounty_amount": "500.0",
  "formatted_bounty": "$500",
  "weakness": {
    "id": 48,
    "name": "Denial of Service"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2019-11-12T09:38:01.218Z",
  "allow_singular_disclosure_after": -134273850.04490572,
  "singular_disclosure_allowed": true,
  "vote_count": 1,
  "voters": [
    "dyabla"
  ],
  "structured_scope": {
    "databaseId": 84120,
    "asset_type": "OTHER",
    "asset_identifier": "PHP",
    "max_severity": "none"
  },
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
