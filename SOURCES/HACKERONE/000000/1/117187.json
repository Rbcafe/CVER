{
  "id": 117187,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTcxODc=",
  "url": "https://hackerone.com/reports/117187",
  "title": "Prevent content spoofing on /~username/emails/verify.html",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "medium",
  "readable_substate": "Resolved",
  "created_at": "2016-02-18T18:25:19.254Z",
  "submitted_at": "2016-02-18T18:25:19.254Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ishahriyar",
    "url": "/ishahriyar",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/018/459/49b3c418eb2d3dbc8e14a0dee670f4b432ba5f73_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1868,
    "url": "https://hackerone.com/gratipay",
    "handle": "gratipay",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/001/868/a75c6649c5b4671b3cf44160af884a7da9fd0b67_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "disabled",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Gratipay",
      "twitter_handle": "Gratipay",
      "website": "https://gratipay.com/",
      "about": "Gratitude? Gratipay! The easiest way for your company to pay for open source."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": false,
  "disclosed_at": "2017-06-16T06:32:21.346Z",
  "bug_reporter_agreed_on_going_public_at": "2017-06-16T06:32:21.301Z",
  "team_member_agreed_on_going_public_at": "2017-06-15T14:30:51.344Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "Hi,\nWhen an user add his email  then a verification link has been sent to that email.\nthe link looks like this\nhttps://gratipay.com/~exampleuser/emails/verify.html?email=example%40gmail.com&nonce=cb2487f6-61cf-4a8a-81af-c8fab6fe0f90\n\nThe link has three changeable things.\n1. Username (ex: ~exampleuser)\n2. User's requested email (ex: example%40gmail.com)\n3. Nonce \n\nBut here the Nonce token is working for any user. Also you have missed to verify the email format\nSo  anyone can send fake messages to any  gratipay user. \n\nSteps to reproduce\nIf you have an account on gratipay then navigate the url like this\nhttps://gratipay.com/~[your-user-name]/emails/\n\nThen put your email address and click the button named \"Add email address\"\n\nYou will get an email copy the link\nhttps://gratipay.com/~exampleuser/emails/verify.html?email=example%40gmail.com&nonce=cb2487f6-61cf-4a8a-81af-c8fab6fe0f90\n\nNow put some messages instead of your email in your link , Like this\nhttps://gratipay.com/~exampleuser/emails/verify.html?email=You Has been Sent. Hi This is official. You can get pro account by sending us 10 USD through our official paypal example@example.com&nonce=cb2487f6-61cf-4a8a-81af-c8fab6fe0f90\n\nJust find a user from gratipay and put his name in the url instead of  \"exampleuser\"\nLet's we have found a user named victimsusername\n\nSo the url will be this\n\nhttps://gratipay.com/~victimsusername/emails/verify.html?email=You Has been Sent. Hi This is official. You can get pro account by sending us 10 USD through our official paypal example@example.com&nonce=cb2487f6-61cf-4a8a-81af-c8fab6fe0f90\n\nNow send the link to the victim.\nAnyone can misuse your app by this scope to send fake messages.\n\n\nIf you need anymore information feel free to ask.\nThanks.\n",
  "bounty_amount": "10.0",
  "formatted_bounty": "$10",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-07-15T14:30:51.377Z",
  "allow_singular_disclosure_after": -207696469.4783192,
  "singular_disclosure_allowed": true,
  "vote_count": 5,
  "voters": [
    "eveeez",
    "spetr0x",
    "mrnull1337",
    "alj1",
    "naveena_2006"
  ],
  "severity": {
    "rating": "medium",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
