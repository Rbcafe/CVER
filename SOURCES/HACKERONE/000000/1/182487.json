{
  "id": 182487,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xODI0ODc=",
  "url": "https://hackerone.com/reports/182487",
  "title": "CSRF Token Bypass in Account Deletion",
  "state": "Closed",
  "substate": "resolved",
  "severity_rating": "low",
  "readable_substate": "Resolved",
  "created_at": "2016-11-16T11:14:50.871Z",
  "submitted_at": "2016-11-16T11:14:50.871Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "7h0r4pp4n",
    "url": "/7h0r4pp4n",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/049/473/07654bfb1b6d3c864ae4308a340c28bff6a87ebe_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 264,
    "url": "https://hackerone.com/gitlab",
    "handle": "gitlab",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/f0hovtq73f9ap815a0r1w42bocp4/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "GitLab",
      "twitter_handle": "gitlab",
      "website": "https://about.gitlab.com",
      "about": "A single application for the entire software development lifecycle."
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2017-04-20T16:50:53.899Z",
  "bug_reporter_agreed_on_going_public_at": "2017-04-20T08:57:12.318Z",
  "team_member_agreed_on_going_public_at": "2017-04-20T16:50:53.850Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The authentication token `authenticity_token` used in the POST request for deleting an account can be bypassed, by replacing the same with a token generated for deleting another account. This way, a self submitting form can be used to delete another user's account as long as he/she's logged in.\n\n**Steps to Reproduce:**\n1. Create an account and copy the POST request for deleting it.\n\n```\nPOST /users HTTP/1.1\nHost: gitlab.com\nReferer: https://gitlab.com/profile/account\nCookie: _gitlab_session=1staccount_cookie;\nContent-Type: application/x-www-form-urlencoded\n\n_method=delete&authenticity_token=auth_1staccount\n```\n2. Create another account and send the above request after replacing the `_gitlab_session` cookie with that of the new one.  The `authenticity_token` remains the same as that of the first account.\n3. Send the request and the new account gets deleted.\n\nI have not explored all possible scenarios like different IP addresses or something. But the above situation, where I used accounts created using emails from a temporary email address generator, was reproduced multiple times.",
  "weakness": {
    "id": 45,
    "name": "Cross-Site Request Forgery (CSRF)"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2017-05-20T08:57:12.368Z",
  "allow_singular_disclosure_after": -212556631.77424616,
  "singular_disclosure_allowed": true,
  "vote_count": 6,
  "voters": [
    "eveeez",
    "silv3rpoision",
    "osama123",
    "rbcafe",
    "spetr0x",
    "madarkitekt"
  ],
  "severity": {
    "rating": "low",
    "author_type": "Team"
  },
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
